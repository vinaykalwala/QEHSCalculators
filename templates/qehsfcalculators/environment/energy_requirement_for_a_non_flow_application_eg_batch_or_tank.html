{% extends 'base.html' %}
{% block title %}Energy requirement for a non-flow application (e.g. batch or tank){% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy requirement for a non-flow application (e.g. batch or tank)</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
<style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover¬†effect¬†*/
        }
        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
             overflow-y: auto; 
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        {% comment %} /* Input rows for better organization */
        .input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-row .form-group {
            flex: 1;
        }
        
        @media (max-width: 600px) {
            .input-row {
                flex-direction: column;
                gap: 10px;
            }
        } {% endcomment %}

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
          
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }

                .rate-display {
                display: flex;
                gap: 20px;
                justify-content: center;
                align-items: center;
                flex-wrap: wrap; /* responsive */
                text-align: center;
            }

            .rate-block {
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 120px; /* keeps blocks same width */
            }

            .rate-label {
                font-weight: bold;
                font-size: 16px;
                color: #444;
                margin-bottom: 5px;
            }

            .rate-value {
                font-size: 40px;
                font-weight: 700;
                color: #2980b9;
                line-height: 1.2;
            }

            .rate-unit {
                font-size: 14px;
                color: #777;
                margin-top: 4px;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .rate-value { font-size: 32px; }
            }

            @media (max-width: 480px) {
                .rate-value { font-size: 26px; }
                
                .rate-unit { font-size: 12px; }
                
            }



        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
                .result-feedback {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 18px 20px;
    border-left: 4px solid #3498db;
    text-align: left;
    max-width: 800px; /* keeps it readable on large screens */
    margin: 0 auto;   /* centers it */
}

.feedback-title {
    font-weight: 600;
    margin-bottom: 8px;
    color: #2c3e50;
    font-size: 18px;
}

.feedback-content { 
    color: #34495e; 
    font-size: 16px;
    line-height: 1.5;
}

/* Responsive breakpoints */
@media (max-width: 768px) {
    .result-feedback {
        padding: 15px;
        font-size: 15px;
    }

    .feedback-title {
        font-size: 16px;
    }

    .feedback-content {
        font-size: 14px;
    }
}

@media (max-width: 480px) {
    .result-feedback {
        padding: 12px;
        border-left-width: 3px;
    }

    .feedback-title {
        font-size: 15px;
    }

    .feedback-content {
        font-size: 13px;
    }
}

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

<div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>
<div class="calculator-container printable" id="printArea">


{% include "includes/print_header_footer.html" %}

<div class="calculator-header">
    <h1>Batch Heating Energy Requirement Calculator</h1>
    <p>Calculate the mean heat transfer rate (kW) required to heat a fluid in a non-flow (batch) system.</p>
</div>

<div class="calc-content">
    <div class="calc-card">
        <h2>Enter Parameters</h2>

        <div class="input-row">
            <div class="form-group">
                <label for="mass">Mass of Fluid (m) [kg]</label>
                <input type="number" id="mass" class="form-input" step="0.01" min="0.01" placeholder="e.g., 100" aria-label="Mass of fluid">
            </div>

            <div class="form-group">
                <label for="cp">Specific Heat Capacity (c<sub>p</sub>) [kJ/kg¬∑¬∞C]</label>
                <input type="number" id="cp" class="form-input" step="0.01" min="0.1" placeholder="e.g., 4.18" aria-label="Specific heat capacity">
            </div>
        </div>

        <div class="input-row">
            <div class="form-group">
                <label for="deltaT">Temperature Increase (ŒîT) [¬∞C]</label>
                <input type="number" id="deltaT" class="form-input" step="0.1" min="0.1" placeholder="e.g., 50" aria-label="Temperature increase">
            </div>

            <div class="form-group">
                <label for="time">Heating Time (t) [seconds]</label>
                <input type="number" id="time" class="form-input" step="1" min="1" placeholder="e.g., 3600" aria-label="Heating time">
            </div>
        </div>

        <button class="calculate-btn" onclick="calculateHeatRate()">Calculate Heat Transfer Rate</button>
    </div>

    <!-- Result Section -->
    <div class="result-card">
        <div class="result-placeholder" id="placeholder">
            <img src="/static/images/mlc_environment_result.png" alt="energy requirement">
            <p>This calculator estimates the mean heat transfer rate (power) needed to achieve the desired temperature rise in a batch system.</p>
        </div>

        <div class="result-error hidden" id="resultError" role="alert" aria-live="polite">
            <div class="error-icon">‚ùå</div>
            <div class="error-message" id="errorMessage"></div>
        </div>

        <div class="result-value hidden" id="resultValue" aria-live="polite">
            <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                <h2>Heat Transfer Rate</h2>
            </div>

            <div class="rate-display" style="gap:12px; align-items:center; justify-content:center;">
                <div class="rate-value" id="heatRate">0.00</div>
                <div class="rate-label" style="font-size:16px; color: #2980b9;">kW</div>
            </div>

            <div class="result-feedback">
                <div class="feedback-title">Assessment</div>
                <div class="feedback-content" id="feedbackContent"></div>
            </div>

            <div class="btn-wrapper">
                <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
            </div>
        </div>
    </div>
</div>

<!-- Notes Section -->
<div class="note-section">

  <!-- 1. About -->
  <div class="note-card">
    <h3>üìò About This Calculator</h3>
    <p>
      This calculator estimates the mean heat transfer rate (kW) required to heat a specified mass of fluid over a set duration. 
      It is useful for QEHS evaluations, energy audits, and ensuring industrial safety compliance. 
      By applying basic thermodynamic principles, it provides insight into the heating requirements of batch systems and helps 
      engineers size equipment, plan energy supply, and evaluate process safety.
    </p>
  </div>

  <!-- 2. Parameters -->
  <div class="note-card">
    <h3>‚öô Parameters Used</h3>
    <ul>
      <li><strong>Mass (m) [kg]</strong>: Mass of fluid to be heated.</li>
      <li><strong>Specific Heat Capacity (c<sub>p</sub>) [kJ/kg¬∑¬∞C]</strong>: Energy required to raise 1 kg of fluid by 1¬∞C.</li>
      <li><strong>Temperature Increase (ŒîT) [¬∞C]</strong>: Target temperature rise.</li>
      <li><strong>Time (t) [s]</strong>: Duration over which heating occurs.</li>
    </ul>
  </div>

  <!-- 3. Input Validation Rules -->
  <div class="note-card">
    <h3>‚úÖ Input Validation Rules</h3>
    <ul>
      <li>Mass (m): Required, numeric, >0.01 kg and ‚â§50,000 kg.</li>
      <li>Specific Heat Capacity (c<sub>p</sub>): Required, numeric, >0.1 and ‚â§10 kJ/kg¬∑¬∞C.</li>
      <li>Temperature Increase (ŒîT): Required, numeric, >0.1¬∞C and ‚â§500¬∞C.</li>
      <li>Time (t): Required, numeric, >0 s and ‚â§86,400 s (24 hours).</li>
      <li>Logical consistency: ŒîT and t should be physically realistic for the chosen fluid and system.</li>
    </ul>
  </div>

  <!-- 4. Output Validations -->
  <div class="note-card">
    <h3>‚úÖ Output Validations</h3>
    <ul>
      <li>Heat transfer rate (QÃá) must be positive, finite, and realistically achievable for industrial systems.</li>
      <li>Warnings are displayed if values are extreme:
        <ul>
          <li>Heat transfer rate (QÃá) &lt; 0.01 ‚Üí Very low power; system may take excessively long to heat.</li>
          <li>Heat transfer rate (QÃá) &gt; 1000 ‚Üí High power requirement; verify system capacity.</li>
          <li>ŒîT / t &gt; 1 ‚Üí High temperature ramp rate; check fluid stability and safety.</li>
        </ul>
      </li>
      <li><strong>Assessment Categories (shown with results):</strong>
        <ul>
          <li>&lt;1 kW ‚Üí Low heating rate ‚Äì safe but slow.</li>
          <li>1‚Äì10 kW ‚Üí Moderate heating rate ‚Äì typical industrial batch process.</li>
          <li>10‚Äì100 kW ‚Üí High heating rate ‚Äì check energy supply and safety.</li>
          <li>&gt;100 kW ‚Üí Very high heating rate ‚Äì potential fire/explosion hazard, review required.</li>
        </ul>
      </li>
    </ul>
  </div>

  <!-- 5. Governing Principle -->
  <div class="note-card">
    <h3>üìê Governing Principle</h3>
    <p>
      The energy requirement for a non-flow application is primarily governed by the 
      <strong>First Law of Thermodynamics</strong>, which states that the change in a system's internal energy equals 
      the heat added minus the work done by the system (ŒîU = Œ¥Q ‚Äì Œ¥W). 
      This principle applies to non-flow (or closed) processes, where energy is exchanged with the surroundings 
      as heat or work, and the system's energy balance is accounted for by these interactions and the resulting 
      change in internal energy.
    </p>
    <p>
      In practical terms, batch heating assumes that the system does not involve mass flow across its boundaries. 
      Therefore, the only contributors to the energy balance are heat input and, in some cases, boundary work 
      (e.g., expansion against external pressure). For liquids in tanks or reactors, the dominant factor is 
      the heat transfer needed to raise the temperature, which directly depends on mass, specific heat, 
      and temperature change. This thermodynamic foundation ensures consistency with energy audits, 
      industrial heating design, and safety assessments.
    </p>
  </div>

  <!-- 6. Conclusion -->
  <div class="note-card">
    <h3>üèÅ Conclusion</h3>
    <p>
      This calculator provides actionable insight into the required power for batch fluid heating. 
      By integrating validated inputs, safety-based output assessments, and thermodynamic governing principles, 
      it supports efficient, reliable, and compliant heating operations. 
      Results should be used for equipment design, energy planning, and process optimization, while 
      recognizing that real-world systems may involve heat losses, variable specific heat, or 
      non-uniform temperature distribution that are not accounted for in this simplified model.
    </p>
  </div>

</div>


<script>
function showErrors(errors) {
    const errorBox = document.getElementById("resultError");
    const errorMessage = document.getElementById("errorMessage");
    const placeholder = document.getElementById("placeholder");
    const resultValue = document.getElementById("resultValue");

    errorMessage.innerHTML = errors.join("<br>");
    errorBox.classList.remove("hidden");
    placeholder.classList.add("hidden");
    resultValue.classList.add("hidden");
}

function calculateHeatRate() {
    const m = parseFloat(document.getElementById("mass")?.value.trim());
    const cp = parseFloat(document.getElementById("cp")?.value.trim());
    const deltaT = parseFloat(document.getElementById("deltaT")?.value.trim());
    const t = parseFloat(document.getElementById("time")?.value.trim());

    const heatRateEl = document.getElementById("heatRate");
    const feedbackEl = document.getElementById("feedbackContent");
    document.getElementById("resultError").classList.add("hidden");
    feedbackEl.innerHTML = "";

    const errors = [];
    const warnings = [];

    // Numeric validation
    if (![m, cp, deltaT, t].every(Number.isFinite)) {
        errors.push("All inputs are required and must be numeric.");
        return showErrors(errors);
    }

    // Range validation
    if (m <= 0.01 || m > 50000) errors.push("Mass must be >0.01 kg and ‚â§50,000 kg.");
    if (cp <= 0.1 || cp > 10) errors.push("Specific Heat Capacity must be >0.1 and ‚â§10 kJ/kg¬∑¬∞C.");
    if (deltaT <= 0.1 || deltaT > 500) errors.push("Temperature Increase must be >0.1¬∞C and ‚â§500¬∞C.");
    if (t <= 0 || t > 86400) errors.push("Heating time must be >0 s and ‚â§86,400 s.");
    if (errors.length) return showErrors(errors);

    // Compute heat transfer rate (kW)
    const Qdot = (m * cp * deltaT) / t;

    // Warnings / edge cases
    if (Qdot < 0.01) warnings.push("Very low power; system may take excessively long to heat.");
    if (Qdot > 1000) warnings.push("High power requirement; verify system capacity.");
    if (deltaT / t > 1) warnings.push("High temperature ramp rate; check fluid stability and safety.");

    // Assessment
    let assessment;
    if (Qdot < 1) assessment = "Low heating rate ‚Äì safe but slow.";
    else if (Qdot < 10) assessment = "Moderate heating rate ‚Äì typical industrial batch process.";
    else if (Qdot < 100) assessment = "High heating rate ‚Äì check energy supply and safety.";
    else assessment = "Very high heating rate ‚Äì potential fire/explosion hazard, review required.";

    // Display
    heatRateEl.textContent = Qdot.toFixed(2);
    feedbackEl.innerHTML = `
        <div>Assessment: <b>${assessment}</b></div>
        <div>${warnings.join(" | ")}</div>
    `;
    document.getElementById("placeholder").classList.add("hidden");
    document.getElementById("resultValue").classList.remove("hidden");
    document.getElementById("resultError").classList.add("hidden");
}

function printReport() {
  const el = document.getElementById('printDate');
  if (el) {
    el.textContent = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
  }
  window.print();
}
</script>


<script src="{% static 'js/print.js' %}"></script>

</body>
</html>
{% endblock %}

<!-- 
üìå Heat Rate Calculator (Essentials)

üîπ Formula (internal, not displayed to user):
    ‚Ä¢ QÃá = (m √ó Cp √ó ŒîT) / t
      - QÃá     = Heat transfer rate [kW]
      - m      = Mass of substance [kg]
      - Cp     = Specific heat capacity [kJ/kg¬∑¬∞C]
      - ŒîT     = Temperature increase [¬∞C]
      - t      = Heating time [s]

üîπ Input Validations:
    ‚Ä¢ m (Mass):
        - Required, numeric
        - Range: >0.01 kg and ‚â§50,000 kg
    ‚Ä¢ Cp (Specific Heat Capacity):
        - Required, numeric
        - Range: >0.1 and ‚â§10 kJ/kg¬∑¬∞C
    ‚Ä¢ ŒîT (Temperature Increase):
        - Required, numeric
        - Range: >0.1¬∞C and ‚â§500¬∞C
    ‚Ä¢ t (Heating Time):
        - Required, numeric
        - Range: >0 s and ‚â§86,400 s

üîπ Warnings / Edge Cases:
    ‚Ä¢ QÃá < 0.01 ‚Üí ‚ö†Ô∏è Very low power; system may take excessively long
    ‚Ä¢ QÃá > 1000 ‚Üí ‚ö†Ô∏è High power requirement; verify system capacity
    ‚Ä¢ ŒîT / t > 1 ‚Üí ‚ö†Ô∏è High temperature ramp rate; check fluid stability and safety

üîπ Output Validations & Feedback:
    ‚Ä¢ Heat transfer rate QÃá displayed in kW
    ‚Ä¢ Assessment based on magnitude of QÃá:
        - Low heating rate (<1 kW): safe but slow
        - Moderate heating rate (1‚Äì10 kW): typical industrial batch
        - High heating rate (10‚Äì100 kW): check energy supply and safety
        - Very high heating rate (>100 kW): potential fire/explosion hazard, review required
    ‚Ä¢ Warnings displayed inline if triggered
-->
