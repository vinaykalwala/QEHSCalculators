{% extends 'base.html' %}
{% block title %}Volumetric Flow Rate Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volumetric Flow Rate Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
<style>
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
      .btn-wrapper {
    text-align: center; /* centers inline-block buttons */
    margin-top: 20px;
  }

   .btn-wrapper {
    text-align: center; /* centers the button */
    margin-top: 20px;
  }

  .print-btn {
    display: inline-block;
    background:linear-gradient(#1560bd,#000040);
    color: white;
    padding: 8px 18px;   /* control button size */
    border: none;
    border-radius: 6px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    width: auto !important; /* prevent full width */
  }

  .print-btn:hover {
    background: #1560bd;
  }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center; 
        }

        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

<div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>
<div class="calculator-container printable" id="printArea">

{% include "includes/print_header_footer.html" %}

<div class="calculator-header">
    <h1>Volumetric Flow Rate Calculator</h1>
    <p>Calculate the volumetric flow rate (Q) of a fluid using the formula.</p>
</div>

<div class="calc-content">
    <!-- Calculator -->
    <div class="calc-card">
        <h2>Enter Parameters</h2>

            <div class="form-group">
                <label for="area">Cross-Sectional Area (A, m¬≤)</label>
                <input type="number" id="area" class="form-input" step="any" min="0" placeholder="e.g., 0.5" aria-label="Cross-sectional area">
            </div>

            <div class="form-group">
                <label for="velocity">Velocity (u, m/s)</label>
                <input type="number" id="velocity" class="form-input" step="any" placeholder="e.g., 2.5" aria-label="Velocity">
            </div>
        

        <button class="calculate-btn" onclick="calculateFlowRate()">Calculate Flow Rate</button>
    </div>

    <!-- Result Section -->
    <div class="result-card">
        <div class="result-placeholder" id="placeholder">
            <img src="/static/images/mlc_environment_result.png" alt="Flow illustration">
            <p>This tool calculates the <strong>Volumetric Flow Rate (Q)</strong> using the formula.</p>
        </div>

        <div class="result-error hidden" id="resultError" role="alert" aria-live="polite">
            <div class="error-icon">‚ùå</div>
            <div class="error-message" id="errorMessage"></div>
        </div>

        <div class="result-value hidden" id="resultValue" aria-live="polite">
            <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                <h2>Volumetric Flow Rate</h2>
            </div>

            <div class="rate-display" style="gap:12px; align-items:center; justify-content:center;">
                <div class="rate-value" id="flowRate">0.00</div>
                <div class="rate-label" style="font-size:16px; color: #2980b9;">m¬≥/s</div>
            </div>

            <div class="result-feedback">
                <div class="feedback-title">Flow Assessment</div>
                <div class="feedback-content" id="feedbackContent"></div>
            </div>

            <div class="btn-wrapper">
                <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
            </div>
        </div>
    </div>
</div>

<!-- Notes Section -->
<div class="note-section">
    <div class="note-card">
        <h3>üìò About This Calculator</h3>
        <p>
            This calculator determines the volumetric flow rate of a fluid, which is essential for designing and analyzing fluid systems in various industrial, environmental, and safety applications.
        </p>
    </div>

    <div class="note-card">
        <h3>üìä Interpretation</h3>
        <p>Volumetric flow rate values can be interpreted as:</p>
        <ul class="note-list">
            <li><span class="good">High flow rate</span> (> 5 m¬≥/s): Suitable for large industrial applications but may require specialized piping.</li>
            <li><span class="average">Moderate flow rate</span> (0.5-5 m¬≥/s): Common in industrial processes and municipal water systems.</li>
            <li><span class="bad">Low flow rate</span> (< 0.5 m¬≥/s): Appropriate for small-scale applications but may indicate issues in larger systems.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>üìê Parameters</h3>
        <ul class="note-list">
            <li><strong>Cross-Sectional Area (A):</strong> The area through which fluid flows, measured in square meters (m¬≤).</li>
            <li><strong>Velocity (u):</strong> The speed at which the fluid moves, measured in meters per second (m/s).</li>
        </ul>
    </div>


    <div class="note-card">
        <h3>‚ö†Ô∏è Input Validations</h3>
        <ul class="note-list">
            <li><strong>Cross-Sectional Area (A):</strong> Must be positive and greater than 0.0001 m¬≤.</li>
            <li><strong>Velocity (u):</strong> Must be a valid number (positive or negative for direction).</li>
            <li>‚ùå Negative or zero area values are invalid.</li>
            <li>‚ö†Ô∏è Area values below 0.001 m¬≤ may indicate measurement errors.</li>
            <li>‚ö†Ô∏è Velocity values above 50 m/s may be unrealistic for most applications.</li>
            <li>‚ö†Ô∏è Velocity values below -50 m/s may indicate reverse flow measurement errors.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>üåç Key Applications</h3>
        <ul class="note-list">
            <li><strong>Water Supply Systems:</strong> Designing and monitoring municipal water distribution networks.</li>
            <li><strong>Industrial Processes:</strong> Controlling fluid flow in chemical, oil, and gas industries.</li>
            <li><strong>Fire Safety Systems:</strong> Ensuring adequate water flow for sprinkler and suppression systems.</li>
            <li><strong>Environmental Monitoring:</strong> Measuring river and stream flows for ecosystem management.</li>
            <li><strong>HVAC Systems:</strong> Designing air and liquid flow in heating, ventilation, and cooling systems.</li>
        </ul>
    </div>
</div>

</div>
<script>
    function calculateFlowRate() {
        // Get input values
        const area = parseFloat(document.getElementById('area').value);
        const velocity = parseFloat(document.getElementById('velocity').value);
        
        // Get result elements
        const placeholder = document.getElementById('placeholder');
        const resultError = document.getElementById('resultError');
        const resultValue = document.getElementById('resultValue');
        const flowRate = document.getElementById('flowRate');
        const feedbackContent = document.getElementById('feedbackContent');
        const errorMessage = document.getElementById('errorMessage');
        
        // Reset display - hide everything first
        placeholder.classList.add('hidden');
        resultError.classList.add('hidden');
        resultValue.classList.add('hidden');
        
        // Validate inputs
        let error = '';
        
        // Check if inputs are provided
        if (isNaN(area) || isNaN(velocity)) {
            error = 'Please enter valid numbers for both area and velocity.';
        }
        // Validate area
        else if (area <= 0) {
            error = 'Cross-sectional area must be a positive number greater than zero.';
        } else if (area < 0.0001) {
            error = 'Cross-sectional area is too small. Minimum value is 0.0001 m¬≤.';
        } else if (area > 100) {
            error = 'Cross-sectional area is unusually large. Maximum value is 100 m¬≤.';
        }
        // Validate velocity
        else if (Math.abs(velocity) > 100) {
            error = 'Velocity is unusually high. Maximum absolute value is 100 m/s.';
        }
        
        // Show error if validation failed
        if (error) {
            errorMessage.textContent = error;
            resultError.classList.remove('hidden');
            return;
        }
        
        // Calculate flow rate using the formula: Q = A √ó u
        const Q = area * velocity;
        
        // Display the result
        flowRate.textContent = Q.toFixed(4);
        
        // Generate feedback based on the result
        let feedback = '';
        let feedbackColor = '#2980b9';
        
        if (Q > 5) {
            feedback = '‚úÖ High flow rate: Suitable for large industrial applications. Ensure piping can handle this flow rate.';
            feedbackColor = '#27ae60';
        } else if (Q >= 0.5) {
            feedback = '‚ö†Ô∏è Moderate flow rate: Common in industrial processes and municipal water systems.';
            feedbackColor = '#f39c12';
        } else if (Q > 0) {
            feedback = 'üîπ Low flow rate: Appropriate for small-scale applications. Check if this meets system requirements.';
            feedbackColor = '#2980b9';
        } else if (Q < 0) {
            feedback = 'üîÅ Reverse flow detected: Fluid is moving in the opposite direction. Verify if this is intentional.';
            feedbackColor = '#9b59b6';
        } else {
            feedback = '‚ö™ Zero flow: No fluid movement detected. Check system conditions.';
            feedbackColor = '#7f8c8d';
        }
        
        // Add specific warnings based on input values
        if (area < 0.001) {
            feedback += ' Note: The small cross-sectional area may lead to measurement inaccuracies.';
        }
        
        if (Math.abs(velocity) > 30) {
            feedback += ' Note: High velocity detected. This may cause erosion or pressure issues in piping systems.';
        }
        
        feedbackContent.textContent = feedback;
        feedbackContent.style.color = feedbackColor;
        
        // Show result, hide error
        resultValue.classList.remove('hidden');
        resultError.classList.add('hidden');
    }
    
    function printReport() {
        window.print();
    }
</script>

  <script src="{% static 'js/print.js' %}"></script>

</body>
</html>
{% endblock %}
<!--
Input Validations:
Cross-Sectional Area (A)

Must be positive (> 0)

Minimum: 0.0001 m¬≤ (to prevent unrealistically small values)

Maximum: 100 m¬≤ (to prevent unrealistically large values)

Velocity (u)

Can be positive or negative (to indicate direction)

Maximum absolute value: 100 m/s (to prevent unrealistically high values)
------------------------------------------------------------------------------------------------
Edge Case Validations:
Division by zero protection (not applicable to this formula)

Unrealistic input combinations (e.g., very small area with very high velocity)

Extreme outliers that might indicate measurement errors

Negative flow detection (reverse flow)
---------------------------------------------------------------------------------------------------
Output Validations:
Flow rate is displayed with appropriate precision (4 decimal places)

Feedback is provided based on the calculated flow rate value

Warnings for unusual input combinations

-------------------------------------------------------------------------------------------------
The formula used in the code is:

Q = A √ó u

Where:

Q = Volumetric Flow Rate (m¬≥/s)

A = Cross-Sectional Area (m¬≤)

u = Velocity (m/s)


-->