{% extends 'base.html' %}
{% block title %}steam condensing rate for horizontal pipes in still air calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>steam condensing rate for horizontal pipes in still air calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .back-btn {
            background: linear-gradient(#1560bd, #000040);
            color: #ffffff;
            border: 2px solid #1560bd;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd;
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05);
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }

        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd, #000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center;
            flex-wrap: wrap;
        }

        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
            line-height: 1.1;
        }

        .rate-label { 
            color: #7f8c8d;
            font-size: 20px;
            font-weight: bold;
        }

        /* Responsive styles */
        @media (max-width: 1200px) {
            .rate-value {
                font-size: 38px;
            }
            .rate-label {
                font-size: 18px;
            }
        }
        
        @media (max-width: 992px) {
            .rate-value {
                font-size: 34px;
            }
            .rate-label {
                font-size: 17px;
            }
        }
        
        @media (max-width: 768px) {
            .rate-value {
                font-size: 30px;
                margin-bottom: 8px;
            }
            .rate-label {
                font-size: 16px;
            }
        }
        
        @media (max-width: 576px) {
            .rate-value {
                font-size: 28px;
                margin-bottom: 6px;
            }
            .rate-label {
                font-size: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .rate-display {
                flex-direction: column;
                gap: 2px;
                text-align: center;
            }
            .rate-value {
                font-size: 24px;
                margin-bottom: 4px;
            }
            .rate-label {
                font-size: 14px;
            }
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

    <div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>


<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}


<div class="calculator-header">
    <h1>Steam Condensing Rate Calculator</h1>
    <p>Estimate the <strong>Steam Condensation Rate (kg/h)</strong> in horizontal pipes under still air conditions to evaluate thermal efficiency and steam losses.</p>
</div>

<div class="calc-content">
    <!-- Calculator -->
    <div class="calc-card">
        <h2>Enter Data</h2>

        <div class="form-group">
            <label for="heatEmission">Heat Emission (W/m)</label>
            <input type="number" id="heatEmission" class="form-input" min="1" step="any" placeholder="e.g., 250">
        </div>

        <div class="form-group">
            <label for="pipeLength">Effective Pipe Length (m)</label>
            <input type="number" id="pipeLength" class="form-input" min="0.1" step="any" placeholder="e.g., 5">
        </div>

        <div class="form-group">
            <label for="enthalpy">Enthalpy of Evaporation (kJ/kg)</label>
            <input type="number" id="enthalpy" class="form-input" min="100" step="any" placeholder="e.g., 2257">
        </div>
        
        <button class="calculate-btn" onclick="calculateCondensationRate()">Calculate Condensation Rate</button>
    </div>

    <!-- Result Section -->
    <div class="result-card">
        <div class="result-placeholder" id="placeholder">
            <img src="/static/images/mlc_environment_result.png" alt="Steam condensation illustration">
            <p>This tool will calculate the <strong>Steam Condensation Rate (kg/h)</strong>.</p>
        </div>
        
        <div class="result-error hidden" id="resultError">
            <div class="error-icon">❌</div>
            <div class="error-message" id="errorMessage"></div>
        </div>
         
        <div class="result-value hidden" id="resultValue">
            <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                <h2>Calculated Steam Condensation Rate</h2>
            </div>

            <div class="rate-display">
                <div class="rate-value" id="rateValue">0.0000</div>
                <div class="rate-label" style="color:#2980b9; font-size:20px; font-weight:bold;">kg/h</div>
            </div>

            <div class="result-feedback">
                <div class="feedback-title">Assessment</div>
                <div class="feedback-content" id="feedbackContent"></div>
            </div>
            <div class="btn-wrapper">
                <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
            </div>
        </div>
    </div>
</div>

<!-- Notes Section -->
<div class="note-section">
    <!-- About -->
    <div class="note-card">
        <h3>📘 About This Calculator</h3>
        <p>
            The <strong>Steam Condensing Rate Calculator</strong> estimates the amount of steam condensing into liquid water per hour in horizontal pipes exposed to still air.
            It helps evaluate heat losses, optimize insulation, and support energy audits and boiler efficiency assessments in industrial facilities.
        </p>
    </div>

    <!-- Parameters -->
    <div class="note-card">
        <h3>⚙ Parameters Used</h3>
        <ul class="note-list">
            <li><strong>Heat Emission (Q, W/m):</strong> Thermal energy lost per meter of pipe length due to cooling.</li>
            <li><strong>Pipe Length (L, m):</strong> Effective length of the pipe section through which steam flows.</li>
            <li><strong>Enthalpy of Evaporation (h_fg, kJ/kg):</strong> Energy required to convert water into steam at the given pressure.</li>
        </ul>
    </div>

    <!-- Input Validation Rules -->
    <div class="note-card">
        <h3>✅ Input Validation Rules</h3>
        <ul class="note-list">
            <li>✔️ Heat Emission must be numeric and between <b>1 – 5000 W/m</b>.</li>
            <li>✔️ Pipe Length must be numeric and between <b>0.1 – 100 m</b>.</li>
            <li>✔️ Enthalpy of Evaporation must be numeric and between <b>100 – 3000 kJ/kg</b>.</li>
            <li>❌ Zero, negative, or non-numeric entries are invalid.</li>
            <li>⚠️ Extremely low or high inputs may trigger warnings for sensor error or unrealistic conditions.</li>
        </ul>
    </div>

    <!-- Output Validations -->
    <div class="note-card">
        <h3>🔎 Output Validations</h3>
        <ul class="note-list">
            <li>✔️ Condensation Rate must be finite and &gt; 0 kg/h.</li>
            <li>⚠️ &lt; 0.1 kg/h → Very low condensation; verify measurement or input accuracy.</li>
            <li>⚠️ &gt; 500 kg/h → Extremely high condensation; may indicate unrealistic inputs or system failure.</li>
            <li>✅ Assessment is displayed with result for QEHS/audit context:
                <ul>
                    <li><strong>Low condensation (Rate &lt; 10 kg/h):</strong> Good insulation and efficiency.</li>
                    <li><strong>Moderate condensation (10 ≤ Rate ≤ 50 kg/h):</strong> Consider insulation or thermal optimization.</li>
                    <li><strong>High condensation (Rate &gt; 50 kg/h):</strong> Significant heat loss; corrective action required.</li>
                </ul>
            </li>
        </ul>
    </div>

    <!-- Standards -->
    <div class="note-card">
        <h3>📏 Standards</h3>
        <p>
            Follow industrial energy audit guidelines and boiler efficiency standards when interpreting results. Use reference materials such as:
            <ul>
                <li>ISO 50001 – Energy Management Systems</li>
                <li>ASME Boiler & Pressure Vessel Codes (BPVC)</li>
                <li>Plant Standard Operating Procedures (SOPs) for heat loss and steam monitoring</li>
            </ul>
            Always cross-check with actual plant instrumentation and steam table data when performing safety or efficiency evaluations.
        </p>
    </div>

    <!-- Conclusion -->
    <div class="note-card">
        <h3>✅ Conclusion</h3>
        <p>
            This calculator provides a quick KPI for steam condensation and supports energy efficiency and QEHS reporting. 
            Use the displayed assessment and warnings alongside operational measurements to guide insulation improvements, maintenance decisions, and thermal system optimization.
        </p>
    </div>
</div>


<script>
/* Show error messages */
function showErrors(errors) {
  const errorBox = document.getElementById("resultError");
  const errorMessage = document.getElementById("errorMessage");
  const placeholder = document.getElementById("placeholder");
  const resultValue = document.getElementById("resultValue");

  errorMessage.innerHTML = errors.join("<br>");
  errorBox.classList.remove("hidden");
  placeholder.classList.add("hidden");
  resultValue.classList.add("hidden");
}

function calculateCondensationRate() {
  const Qraw = document.getElementById("heatEmission").value.trim();
  const Lraw = document.getElementById("pipeLength").value.trim();
  const hfgRaw = document.getElementById("enthalpy").value.trim();

  const errorBox = document.getElementById("resultError");
  const errorMessage = document.getElementById("errorMessage");
  const placeholder = document.getElementById("placeholder");
  const resultValue = document.getElementById("resultValue");
  const rateEl = document.getElementById("rateValue");
  const feedbackEl = document.getElementById("feedbackContent");

  errorBox.classList.add("hidden");
  errorMessage.innerHTML = "";
  feedbackEl.innerHTML = "";

  const errors = [];
  const warnings = [];

  if (Qraw === "") errors.push("👉 Please enter Heat Emission (W/m).");
  if (Lraw === "") errors.push("👉 Please enter Pipe Length (m).");
  if (hfgRaw === "") errors.push("👉 Please enter Enthalpy of Evaporation (kJ/kg).");

  if (errors.length) return showErrors(errors);

  const Q = parseFloat(Qraw);
  const L = parseFloat(Lraw);
  const hfg = parseFloat(hfgRaw);

  // Core input validations
  if (!Number.isFinite(Q) || Q < 1 || Q > 5000) errors.push("👉 Heat Emission must be between 1 and 5000 W/m.");
  if (!Number.isFinite(L) || L < 0.1 || L > 100) errors.push("👉 Pipe Length must be between 0.1 and 100 m.");
  if (!Number.isFinite(hfg) || hfg < 100 || hfg > 3000) errors.push("👉 Enthalpy of Evaporation must be between 100 and 3000 kJ/kg.");

  if (errors.length) return showErrors(errors);

  // Calculation
  const m_s = (3.6 * Q * L) / hfg;
  if (!Number.isFinite(m_s) || m_s <= 0) {
    return showErrors(["⚠️ Computed condensation rate is invalid."]);
  }

  // Logical warnings
  if (m_s < 0.1) warnings.push("⚠️ Extremely low condensation rate – verify inputs.");
  if (m_s > 500) warnings.push("⚠️ Extremely high condensation rate – check system losses or input errors.");

  // Assessment
  let statusMsg = "";
  if (m_s < 10) {
    statusMsg = "✅ Low condensation – Good insulation and efficiency.";
  } else if (m_s <= 50) {
    statusMsg = "⚠️ Moderate condensation – Consider insulation or optimization.";
  } else {
    statusMsg = "🔴 High condensation – Significant heat loss, corrective action required.";
  }

  let details = `<div>Condensation Rate: <b>${m_s.toFixed(3)}</b> kg/h</div>`;
  if (warnings.length) {
    details += `<div style="margin-top:6px; color:#b35d00; font-size:0.95em;">${warnings.join(" | ")}</div>`;
  }

  rateEl.textContent = m_s.toFixed(3);
  feedbackEl.innerHTML = `<div>${statusMsg}</div>${details}`;

  placeholder.classList.add("hidden");
  resultValue.classList.remove("hidden");
  errorBox.classList.add("hidden");
}

function printReport() {
  const el = document.getElementById('printDate');
  if (el) {
    el.textContent = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
  }
  window.print();
}
</script>

    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}

<!-- 
📌 Condensation Rate Calculator (Essentials)

🔹 Formula:
    • Condensation Rate (m_s, kg/h) = (3.6 × Q × L) / h_fg
      - Q    = Heat Emission (W/m)
      - L    = Pipe Length (m)
      - h_fg = Enthalpy of Evaporation (kJ/kg)

🔹 Input Validations:
    • Heat Emission (Q):
        - Required
        - Must be numeric
        - Must be between 1 and 5000 W/m
    • Pipe Length (L):
        - Required
        - Must be numeric
        - Must be between 0.1 and 100 m
    • Enthalpy of Evaporation (h_fg):
        - Required
        - Must be numeric
        - Must be between 100 and 3000 kJ/kg

🔹 Output Validations:
    • Condensation Rate (m_s):
        - Must be finite and > 0
        - Warning if:
            - m_s < 0.1 → extremely low, check inputs
            - m_s > 500 → extremely high, check system or inputs
    • Assessment / Classification:
        - m_s < 10 → Low condensation – good insulation/efficiency
        - 10 ≤ m_s ≤ 50 → Moderate condensation – consider insulation/optimization
        - m_s > 50 → High condensation – significant heat loss, corrective action required
-->
