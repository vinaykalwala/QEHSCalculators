{% extends 'base.html' %}
{% block title %}Vegan Footprint Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vegan Footprint Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
       
    <style>
    .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
            overflow-y: auto;
            justify-content: center;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
      .btn-wrapper {
    text-align: center; /* centers inline-block buttons */
    margin-top: 20px;
  }

   .btn-wrapper {
    text-align: center; /* centers the button */
    margin-top: 20px;
  }

  .print-btn {
    display: inline-block;
    background:linear-gradient(#1560bd,#000040);
    color: white;
    padding: 8px 18px;   /* control button size */
    border: none;
    border-radius: 6px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    width: auto !important; /* prevent full width */
  }

  .print-btn:hover {
    background: #1560bd;
  }

        /* Result Card */
        
.result-card::-webkit-scrollbar {
    width: 8px;
}

.result-card::-webkit-scrollbar-thumb {
    background: #1560bd;
    border-radius: 6px;
}

.result-card::-webkit-scrollbar-track {
    background: #f1f1f1;
}

.result-card {
    justify-content: flex-start; /* align from top */
    align-items: stretch;
    min-height: 420px;
    text-align: center;
    overflow-y: auto;       /* Enable vertical scrolling */
    max-height: 450px;      /* Set max height to control output size */
    padding: 20px;          /* keep spacing */
}

        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center; 
        }
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Vegan Impact Cards */
        .vegan-impact-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        .vegan-impact-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .vegan-impact-card:hover {
            transform: translateY(-5px);
        }
        
        .impact-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .vegan-impact-card p {
            margin: 0;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .vegan-impact-card strong {
            color: #1560bd;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        /* Time unit selector */
        .time-unit-select {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            margin-top: 8px;
        }
       
    </style>
</head>
<body>

        <div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>

    <div class="calculator-container printable" id="printArea">

    {% include "includes/print_header_footer.html" %}

    <div class="calculator-header">
        <h1>Vegan Footprint Calculator</h1>
        <p>Estimate your positive environmental impact based on how long you've been following a vegan lifestyle.</p>
    </div>

    <div class="calc-content">
        <!-- Calculator -->
        <div class="calc-card">
            <h2>Enter Data</h2>

            <div class="input-row">
                <div class="form-group">
                    <label for="veganDuration">Time you've been vegan:</label>
                    <input type="number" id="veganDuration" class="form-input" step="any" min="0" placeholder="e.g., 365" aria-label="Vegan duration">
                    
                    <label for="timeUnit" style="margin-top: 10px;">Time unit:</label>
                    <select id="timeUnit" class="time-unit-select">
                        <option value="days">Days</option>
                        <option value="weeks">Weeks</option>
                        <option value="months">Months</option>
                        <option value="years">Years</option>
                    </select>
                </div>
            </div>

            <button class="calculate-btn" onclick="calculateVeganImpact()">Calculate Impact</button>
        </div>

        <!-- Result Section -->
        <div class="result-card">
            <div class="result-placeholder" id="placeholder">
                <img src="/static/images/mlc_environment_result.png" alt="Vegan impact illustration">
                <p>This tool estimates the positive environmental impact of following a vegan lifestyle.</p>
            </div>

            <div class="result-error hidden" id="resultError" role="alert" aria-live="polite">
                <div class="error-icon">❌</div>
                <div class="error-message" id="errorMessage"></div>
            </div>

            <div class="result-value hidden" id="resultValue" aria-live="polite">
                <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                    <h2>Your Vegan Impact</h2>
                </div>

                <div id="veganImpactResults" class="vegan-impact-container"></div>

                <div class="result-feedback">
                    <div class="feedback-title">Environmental Contribution</div>
                    <div class="feedback-content" id="feedbackContent"></div>
                </div>

                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notes Section -->
    <div class="note-section">
        <div class="note-card">
            <h3>📘 About This Calculator</h3>
            <p>
                This calculator estimates the positive environmental impact of following a vegan lifestyle based on the formula: 
                
            </p>
        </div>

        <div class="note-card">
        <h3>✅ Input Validations</h3>
        <ul class="note-list">
            <li>Duration is <b>required</b> — cannot be left blank.</li>
            <li>Duration must be a <b>positive finite number</b>.</li>
            <li>Duration must be <b>less than 100 years</b> (to prevent unrealistic inputs).</li>
            <li>Time unit must be one of the provided options (days, weeks, months, years).</li>
            <li>Computed results must be <b>valid positive numbers</b>.</li>
        </ul>
        </div>

        <div class="note-card">
            <h3>🛑 Limitations</h3>
            <ul class="note-list">
                <li>Estimates are based on average values and may vary by region and individual consumption patterns.</li>
                <li>Does not account for variations in food production methods or supply chains.</li>
                <li>Actual environmental impact may differ based on specific dietary choices within veganism.</li>
                <li>Forest and water savings estimates are approximations based on land and water use for animal agriculture.</li>
            </ul>
        </div>

        <div class="note-card">
            <h3>🌱 How is vegan footprint calculated?</h3>
            <p>The calculator relies on the premise that, by being vegan for a day, you can save:</p>
            <ul class="note-list">
                <li>1 animal life;</li>
                <li>1,100 gallons of water;</li>
                <li>40 pounds of grain;</li>
                <li>30 square feet of forest; and</li>
                <li>20 pounds of CO<sub>2</sub>.</li>
            </ul>
            <p>Once you enter the time you've been vegan, the calculator will estimate the resources and animal lives you've saved.</p>
        </div>
    </div>

</div>

<script>
/* Helper: show errors consistently */
function showErrors(errors) {
  const errorBox = document.getElementById('resultError');
  const errorMsg = document.getElementById('errorMessage');
  const resultValue = document.getElementById('resultValue');
  const placeholder = document.getElementById('placeholder');

  // Hide other displays
  placeholder.classList.add('hidden');
  resultValue.classList.add('hidden');

  // Show error box and set message
  errorBox.classList.remove('hidden');
  errorMsg.innerHTML = errors.join('<br>');
}

/* Helper: show results */
function showResults() {
  const errorBox = document.getElementById('resultError');
  const resultValue = document.getElementById('resultValue');
  const placeholder = document.getElementById('placeholder');

  // Hide other displays
  errorBox.classList.add('hidden');
  placeholder.classList.add('hidden');

  // Show result
  resultValue.classList.remove('hidden');
}

/* Helper: format numbers with commas */
function formatNumber(num) {
  return num.toLocaleString();
}

/* Print the report */
function printReport() {
  window.print();
}

/* Main calculation function */
function calculateVeganImpact() {
  // Get input values
  const durationInput = document.getElementById('veganDuration').value.trim();
  const unit = document.getElementById('timeUnit').value;
  
  // Validation checks
  const errors = [];
  
  // Check if duration is empty
  if (!durationInput) {
    errors.push('❌ Please enter a duration value.');
    showErrors(errors);
    return;
  }
  
  // Parse and validate duration
  const duration = parseFloat(durationInput);
  
  if (isNaN(duration) || !isFinite(duration)) {
    errors.push('❌ Please enter a valid number for the duration.');
    showErrors(errors);
    return;
  }
  
  if (duration <= 0) {
    errors.push('❌ Duration must be a positive number.');
    showErrors(errors);
    return;
  }
  
  // Check for maximum reasonable input (100 years)
  let maxDays;
  switch(unit) {
    case 'days': maxDays = 100 * 365; break;
    case 'weeks': maxDays = 100 * 52 * 7; break;
    case 'months': maxDays = 100 * 12 * 30; break;
    case 'years': maxDays = 100 * 365; break;
    default: maxDays = 100 * 365;
  }
  
  // Convert to days for validation
  let days;
  switch(unit) {
    case 'days': days = duration; break;
    case 'weeks': days = duration * 7; break;
    case 'months': days = duration * 30; break;
    case 'years': days = duration * 365; break;
    default: days = duration;
  }
  
  if (days > maxDays) {
    errors.push('❌ Please enter a duration less than 100 years for accurate estimation.');
    showErrors(errors);
    return;
  }
  
  // Calculate results
  const results = {
    animals: Math.floor(days),
    water: days * 1100,
    grain: days * 40,
    forest: days * 30,
    co2: days * 20
  };
  
  // Validate results are finite numbers
  if (!Object.values(results).every(value => isFinite(value) && value >= 0)) {
    errors.push('❌ Calculation resulted in invalid values. Please try different inputs.');
    showErrors(errors);
    return;
  }
  
  // Format results for display
  const resultsHTML = `
    <div class="vegan-impact-card">
      <div class="impact-icon">🐄</div>
      <p><strong>Animals Saved:</strong><br> ${formatNumber(results.animals)}</p>
    </div>
    <div class="vegan-impact-card">
      <div class="impact-icon">💧</div>
      <p><strong>Water Saved:</strong><br> ${formatNumber(results.water)} gallons</p>
    </div>
    <div class="vegan-impact-card">
      <div class="impact-icon">🌾</div>
      <p><strong>Grain Saved:</strong><br> ${formatNumber(results.grain)} lbs</p>
    </div>
    <div class="vegan-impact-card">
      <div class="impact-icon">🌳</div>
      <p><strong>Forest Saved:</strong><br> ${formatNumber(results.forest)} sq ft</p>
    </div>
    <div class="vegan-impact-card">
      <div class="impact-icon">☁️</div>
      <p><strong>CO₂ Prevented:</strong><br> ${formatNumber(results.co2)} lbs</p>
    </div>
  `;
  
  // Generate feedback based on impact
  let feedback = '';
  if (days < 30) {
    feedback = 'Every day makes a difference! Your commitment to a vegan lifestyle is already contributing to a more sustainable planet.';
  } else if (days < 365) {
    feedback = 'Your consistent vegan choices are making a significant positive impact on animal welfare and environmental conservation.';
  } else {
    feedback = 'Your long-term commitment to veganism has created substantial positive change for animals and the environment. Thank you for your dedication!';
  }
  
  // Display results
  document.getElementById('veganImpactResults').innerHTML = resultsHTML;
  document.getElementById('feedbackContent').textContent = feedback;
  
  // Show results section
  showResults();
}
</script>

  <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--
----------------------------------------------
Formula Implementation
 formula: Impact = Duration in Days × Daily Saving Constant

Daily constants: 1 animal, 1100 gal water, 40 lbs grain, 30 sq ft forest, 20 lbs CO₂
--------------------------------------------------------------------------------------
Input Validations
Duration must be a positive finite number

Duration cannot be empty

Maximum limit of 100 years to prevent unrealistic inputs

Time unit validation (must be one of the provided options)

Results validation (must be finite positive numbers)
-----------------------------------------------------------------------
Output Validations
All results are formatted with thousands separators

Results are checked to be finite numbers

Appropriate feedback based on duration
--------------------------------------------------------------------------
Test Cases
Valid inputs: 30 days, 1 year, 6 months

Edge cases: 0 days, very large values (>100 years), decimal values

Invalid inputs: Negative numbers, non-numeric values, empty inputs
--------------------------------------------------------------------------
Edge Case Handling
Division by zero prevention

Extremely large value handling

Non-numeric input detection

Empty input validation




-->