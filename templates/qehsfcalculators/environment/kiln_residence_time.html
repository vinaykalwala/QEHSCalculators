{% extends 'base.html' %}
{% block title %}Kiln Residence Time Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kiln Residence Time Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
<style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
             /* display: flex;  */
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
            /* overflow-y: auto;  */
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Input rows for better organization */
        .input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-row .form-group {
            flex: 1;
        }
        
        @media (max-width: 600px) {
            .input-row {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }

                .rate-display {
                display: flex;
                gap: 20px;
                justify-content: center;
                align-items: center;
                flex-wrap: wrap; /* responsive */
                text-align: center;
            }

            .rate-block {
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 120px; /* keeps blocks same width */
            }

            .rate-label {
                font-weight: bold;
                font-size: 16px;
                color: #444;
                margin-bottom: 5px;
            }

            .rate-value {
                font-size: 40px;
                font-weight: 700;
                color: #2980b9;
                line-height: 1.2;
            }

            .rate-unit {
                font-size: 14px;
                color: #777;
                margin-top: 4px;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .rate-value { font-size: 32px; }
            }

            @media (max-width: 480px) {
                .rate-value { font-size: 26px; }
                
                .rate-unit { font-size: 12px; }
                
            }



        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
                .result-feedback {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 18px 20px;
    border-left: 4px solid #3498db;
    text-align: left;
    max-width: 800px; /* keeps it readable on large screens */
    margin: 0 auto;   /* centers it */
}

.feedback-title {
    font-weight: 600;
    margin-bottom: 8px;
    color: #2c3e50;
    font-size: 18px;
}

.feedback-content { 
    color: #34495e; 
    font-size: 16px;
    line-height: 1.5;
}

/* Responsive breakpoints */
@media (max-width: 768px) {
    .result-feedback {
        padding: 15px;
        font-size: 15px;
    }

    .feedback-title {
        font-size: 16px;
    }

    .feedback-content {
        font-size: 14px;
    }
}

@media (max-width: 480px) {
    .result-feedback {
        padding: 12px;
        border-left-width: 3px;
    }

    .feedback-title {
        font-size: 15px;
    }

    .feedback-content {
        font-size: 13px;
    }
}

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

<div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>
<div class="calculator-container printable" id="printArea">


{% include "includes/print_header_footer.html" %}

<div class="calculator-header">
    <h1>Kiln Residence Time Calculator</h1>
    <p>Estimate <strong>Mean Residence Time (minutes)</strong> inside a rotary kiln from geometry, slope and rotational speed.</p>
</div>

<div class="calc-content">
    <!-- Calculator (keeps original layout elements) -->
    <div class="calc-card">
        <h2>Enter Parameters</h2>

        <div class="input-row">
            <div class="form-group">
                <label for="length">Kiln Length (L, ft)</label>
                <input type="number" id="length" class="form-input" step="any" min="0" placeholder="e.g., 300">
            </div>

            <div class="form-group">
                <label for="diameter">Kiln Diameter (D, ft)</label>
                <input type="number" id="diameter" class="form-input" step="any" min="0" placeholder="e.g., 6">
            </div>
        </div>

        <div class="input-row">
            <div class="form-group">
                <label for="slope">Kiln Rake Slope (S, in./ft)</label>
                <input type="number" id="slope" class="form-input" step="any" min="0" placeholder="e.g., 1.5">
            </div>

            <div class="form-group">
                <label for="speed">Rotational Speed (N, rev/min)</label>
                <input type="number" id="speed" class="form-input" step="any" min="0" placeholder="e.g., 1.0">
            </div>
        </div>

        <button class="calculate-btn" onclick="calculateResidenceTime()">Calculate Residence Time</button>
    </div>

    <!-- Result Section (kept original structure) -->
    <div class="result-card">
        <div class="result-placeholder" id="placeholder">
            <img src="/static/images/mlc_environment_result.png" alt="Kiln illustration">
            <p>This tool calculates mean residence time inside a rotary kiln from length, diameter, slope and rpm.</p>
        </div>

        <div class="result-error hidden" id="resultError" role="alert" aria-live="polite">
            <div class="error-icon">❌</div>
            <div class="error-message" id="errorMessage"></div>
        </div>

        <div class="result-value hidden" id="resultValue" aria-live="polite">
            <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                <h2>Residence Time</h2>
            </div>

            <div class="rate-display" style="gap:12px; align-items:center; justify-content:center;">
                <div class="rate-value" id="residenceTime">0.0000</div>
                <div class="rate-label" style="font-size:16px; color: #2980b9;">minutes</div>
            </div>

            <div class="result-feedback">
                <div class="feedback-title">Assessment</div>
                <div class="feedback-content" id="feedbackContent"></div>
            </div>

            <div class="btn-wrapper">
                <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
            </div>
        </div>
    </div>
</div>

<!-- Notes Section (updated to match kiln context) -->
<div class="note-section">
    <div class="note-card">
        <h3>📘 About This Calculator</h3>
        <p>
            The calculator estimates mean residence time in a rotary kiln using geometry (L/D), kiln slope and rotational speed.
            Residence time is critical for ensuring complete thermal processing, compliance with emissions and destruction requirements,
            and maintaining product quality and energy efficiency.
        </p>
    </div>
    <div class="note-card">
    <h3>❓ Parameters</h3>
    <ul class="note-list">
        <li><b>Kiln Length (L, ft):</b> Total length of rotary kiln; must be > 0; typical range 10–1000 ft for industrial applications.</li>
        <li><b>Kiln Diameter (D, ft):</b> Internal diameter of kiln; must be > 0; typical range 1–20 ft.</li>
        <li><b>Kiln Slope (S, in./ft):</b> Incline angle affecting material travel; must be > 0; typical range 0.1–6 in./ft.</li>
        <li><b>Rotational Speed (N, rev/min):</b> Kiln rotation rate; must be > 0; typical range 0.1–5 rpm.</li>
    </ul>
</div>


    <div class="note-card">
        <h3>✅ Input Validations</h3>
        <ul class="note-list">
            <li><strong>Length (L, ft):</strong> Must be positive. Hard range: 1 – 2000 ft. Typical industrial kilns: 10 – 1000 ft.</li>
            <li><strong>Diameter (D, ft):</strong> Must be positive. Hard range: 0.2 – 100 ft. Typical values: 1 – 20 ft.</li>
            <li><strong>Slope (S, in./ft):</strong> Must be > 0 and ≤ 12 in./ft. Typical kiln slopes: 0.1 – 6 in./ft.</li>
            <li><strong>Speed (N, rev/min):</strong> Must be > 0 and ≤ 60 rpm. Typical kiln speeds: 0.1 – 5 rpm.</li>
            <li><strong>Length-to-Diameter Ratio (L/D):</strong> Advisory check: 5 – 50. Out-of-range values flagged as unusual.</li>
            <li><strong>Residence Time (t, minutes):</strong> Output validity check: values > 1440 min (24 hr) are treated as implausible.</li>
        </ul>
    </div>


    <div class="note-card">
        <h3>✅ Output Validations</h3>
        <ul class="note-list">
            <li><strong>t &lt; 5 min</strong> → ⚠️Very short residence time — risk of incomplete processing.</li>
            <li><strong>5 ≤ t ≤ 30 min</strong> → ✅ Typical/target residence time for many processes.</li>
            <li><strong>30 &lt; t ≤ 120 min</strong> → ⚠️Long residence time — may increase fuel consumption and emissions.</li>
            <li><strong>t &gt; 120 min</strong> → 🔴 Very long residence time — review process and feed conditions.</li>
        </ul>
    </div>
    <div class="note-card ">
    <h3>📐 Governing Principle</h3>
    <p>
        A <strong>Kiln Residence Time Calculator</strong> is not tied to a single universal standard but relies on formulas and models developed within the cement and other process industries 
        to determine material residence time based on kiln characteristics and material properties. 
        These calculations draw on principles from engineering and thermodynamics to predict how long materials will spend in the kiln.
    </p>

    <h3>Key Factors in Residence Time Calculation:</h3>
    <ul>
        <li><strong>Kiln Dimensions:</strong> Length and effective diameter of the kiln.</li>
        <li><strong>Kiln Inclination:</strong> The angle at which the kiln is tilted.</li>
        <li><strong>Rotation Speed:</strong> The rate at which the kiln rotates (RPM).</li>
        <li><strong>Material Properties:</strong> The angle of repose of the material, which describes its tendency to pile up.</li>
        <li><strong>Material Flow:</strong> The rate at which material moves through the kiln.</li>
    </ul>

    <h3>Where These Calculators Are Used:</h3>
    <ul>
        <li><strong>Ensure Proper Clinkerization:</strong> Guarantee materials have sufficient time to reach the high temperatures required for chemical transformation into clinker.</li>
        <li><strong>Control Material Loading:</strong> Maintain appropriate levels of material within the kiln to prevent overloading or insufficient material flow.</li>
        <li><strong>Optimize Production:</strong> Fine-tune kiln operations for maximum efficiency and output.</li>
    </ul>

    <h3>Why There Isn't One Universal Standard:</h3>
    <ul>
        <li><strong>Proprietary Methods:</strong> Different companies and engineering firms may develop their own proprietary formulas and methodologies, often derived from established principles but adapted to their specific equipment.</li>
        <li><strong>Context-Specific:</strong> The "standard" for a residence time calculation is often dictated by the specific application, such as the type of material being processed or the specific design of the kiln.</li>
        <li><strong>Focus on Principles:</strong> Instead of a strict standard, the focus is on the underlying engineering principles and thermodynamic models that accurately describe material flow and chemical reactions within the kiln.</li>
    </ul>
</div>

<div class="note-card">
    <h3>💡 Conclusion</h3>
    <p>
        This calculator estimates <strong>mean residence time in rotary kilns</strong>, a critical parameter for ensuring 
        complete thermal processing, regulatory compliance, and product quality. Optimal residence times (typically 5–30 minutes) 
        balance processing efficiency with fuel consumption and emissions control. Always verify calculated residence times 
        against operational data, manufacturer specifications, and regulatory requirements to ensure proper kiln performance 
        and environmental compliance.
    </p>
</div>

</div>

<script>
/* helper: display unified errors (keeps your UX) */
function showErrors(errors) {
  const errorBox = document.getElementById("resultError");
  const errorMessage = document.getElementById("errorMessage");
  const placeholder = document.getElementById("placeholder");
  const resultValue = document.getElementById("resultValue");

  errorMessage.innerHTML = errors.join("<br>");
  errorBox.classList.remove("hidden");
  placeholder.classList.add("hidden");
  resultValue.classList.add("hidden");
}

/* Main validated calculation: t = (2.28*(L/D)) / (S*N) */
function calculateResidenceTime() {
  const Lraw = (document.getElementById("length").value || "").toString().trim();
  const Draw = (document.getElementById("diameter").value || "").toString().trim();
  const Sraw = (document.getElementById("slope").value || "").toString().trim();
  const Nraw = (document.getElementById("speed").value || "").toString().trim();

  const errorBox = document.getElementById("resultError");
  const errorMessage = document.getElementById("errorMessage");
  const placeholder = document.getElementById("placeholder");
  const resultValue = document.getElementById("resultValue");
  const rtEl = document.getElementById("residenceTime");
  const feedbackEl = document.getElementById("feedbackContent");

  // Reset UI
  errorBox.classList.add("hidden");
  errorMessage.innerHTML = "";
  feedbackEl.innerHTML = "";

  const errors = [];
  const warnings = [];

  // Required checks
  if (!Lraw) errors.push("👉 Please enter Kiln Length L (ft).");
  if (!Draw) errors.push("👉 Please enter Kiln Diameter D (ft).");
  if (!Sraw) errors.push("👉 Please enter Kiln Slope S (in./ft).");
  if (!Nraw) errors.push("👉 Please enter Rotational Speed N (rev/min).");
  if (errors.length) return showErrors(errors);

  // Parse
  const L = parseFloat(Lraw);
  const D = parseFloat(Draw);
  const S = parseFloat(Sraw);
  const N = parseFloat(Nraw);

  // Numeric + sign checks (hard rejections with helpful ranges)
  if (!Number.isFinite(L) || L <= 0) errors.push("👉 Kiln Length (L) must be a positive number (ft). Typical: 10 – 1000 ft.");
  if (!Number.isFinite(D) || D <= 0) errors.push("👉 Kiln Diameter (D) must be a positive number (ft). Typical: 1 – 20 ft.");
  if (!Number.isFinite(S) || S <= 0) errors.push("👉 Kiln Slope (S) must be > 0 in./ft. Typical: 0.1 – 6 in./ft.");
  if (!Number.isFinite(N) || N <= 0) errors.push("👉 Rotational Speed (N) must be > 0 rev/min. Typical: 0.1 – 5 rpm.");
  if (errors.length) return showErrors(errors);

  // Hard plausibility bounds (reject clearly impossible inputs)
  if (L < 1 || L > 2000) {
    return showErrors([
      "⚠️ Kiln Length outside plausible range.",
      "👉 Acceptable range for this tool: 1 – 2000 ft. Recheck units and input."
    ]);
  }
  if (D < 0.2 || D > 100) {
    return showErrors([
      "⚠️ Kiln Diameter outside plausible range.",
      "👉 Acceptable range for this tool: 0.2 – 100 ft. Recheck units and input."
    ]);
  }
  if (S <= 0 || S > 12) {
    return showErrors([
      "⚠️ Kiln Slope outside plausible range.",
      "👉 Acceptable range for this tool: >0 – 12 in./ft. Typical: 0.1 – 6 in./ft."
    ]);
  }
  if (N <= 0 || N > 60) {
    return showErrors([
      "⚠️ Rotational speed outside plausible range.",
      "👉 Acceptable range for this tool: >0 – 60 rev/min. Typical kiln speeds are much lower (~0.1–5 rpm)."
    ]);
  }

  // Precision guidance (reporting)
  const ldec = (Lraw.split('.')[1] || '').length;
  const ddec = (Draw.split('.')[1] || '').length;
  const sdec = (Sraw.split('.')[1] || '').length;
  const ndec = (Nraw.split('.')[1] || '').length;
  if (ldec > 3 || ddec > 3 || sdec > 3 || ndec > 3) {
    warnings.push("⚠️ High decimal precision detected — round inputs to ≤ 3 decimals for reporting consistency.");
  }

  // Cross-field checks
  const ldRatio = L / D;
  if (!Number.isFinite(ldRatio) || ldRatio <= 0) {
    return showErrors([
      "⚠️ Invalid L/D ratio computed. Check Length and Diameter inputs.",
      "👉 L/D must be positive (L and D > 0)."
    ]);
  }
  if (ldRatio < 2 || ldRatio > 500) {
    warnings.push("⚠️ L/D is outside typical practical range (recommended ~5–50). Verify kiln geometry.");
  }

  // Advisory warnings on S and N for typical operation
  if (S < 0.05) warnings.push("⚠️ Very low slope — material travel may be very slow; check design.");
  if (S > 6) warnings.push("⚠️ Steep slope — materials may surge or move too quickly; check mechanical design.");
  if (N < 0.05) warnings.push("⚠️ Very low rpm — residence time may be excessively long; confirm measured rpm.");
  if (N > 5) warnings.push("⚠️ High rpm for a rotary kiln — verify that this is intentional and within mechanical limits.");

  // Compute residence time using the empirical correlation
  const numerator = 2.28 * ldRatio;
  const denominator = S * N; // S (in/ft) * N (rev/min)
  if (denominator === 0) {
    return showErrors([
      "⚠️ Invalid denominator (S × N) equals zero.",
      "👉 Ensure S > 0 and N > 0."
    ]);
  }

  const t = numerator / denominator; // minutes

  // Result plausibility checks (no intermediate values shown in errors)
  if (!Number.isFinite(t) || t <= 0) {
    return showErrors([
      "⚠️ Computed residence time is invalid. Check inputs and units."
    ]);
  }
  if (t > 1440) { // > 24 hours — implausible for most kiln processes
    return showErrors([
      "⚠️ Computed residence time is unrealistically high (> 24 hours).",
      "👉 Recheck Length, Diameter, Slope and Speed (units may be incorrect)."
    ]);
  }

  // Classification (site-specific guidance)
  let statusMsg = "";
  if (t < 5) {
    statusMsg = "❌ Very short residence time — risk of incomplete processing.";
  } else if (t <= 30) {
    statusMsg = "✅ Typical/target residence time for many processes.";
  } else if (t <= 120) {
    statusMsg = "⚠️ Long residence time — may increase fuel consumption and emissions.";
  } else {
    statusMsg = "🔴 Very long residence time — review process and feed conditions.";
  }

  // Additional audit advisories
  if (t > 60) warnings.push("⚠️ For QEHS audits, check emissions, fuel burn, and thermal destruction efficiency for long residence times.");
  if (t < 5) warnings.push("⚠️ For short residence times, confirm product quality and destruction/combustion completeness.");

  // Build details (show inputs & L/D but avoid echoing intermediate error values)
  let details = `<div>Residence Time (t): <b>${t.toFixed(4)}</b> minutes</div>`;
  if (warnings.length) {
    details += `<div style="margin-top:6px; color:#b35d00; font-size:0.95em;">${warnings.join(" | ")}</div>`;
  }

  // Display result
  rtEl.textContent = t.toFixed(4);
  feedbackEl.innerHTML = `<div>${statusMsg}</div>${details}`;

  placeholder.classList.add("hidden");
  resultValue.classList.remove("hidden");
  errorBox.classList.add("hidden");
}

/* print (unchanged) */
function printReport() {
  const el = document.getElementById('printDate');
  if (el) {
    el.textContent = new Date().toLocaleDateString('en-US', { year:'numeric', month:'long', day:'numeric' });
  }
  window.print();
}
</script>

<script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}

<!-- /
===========================================
Rotary Kiln Residence Time Calculator
===========================================

📌 Formula:
    t = (2.28 * (L / D)) / (S * N)

    where:
      L = Kiln Length (ft)
      D = Kiln Diameter (ft)
      S = Kiln Slope (in./ft)
      N = Rotational Speed (rev/min)
      t = Residence Time (minutes)

-------------------------------------------
✅ Input Validations:

1. Required fields:
   - L (Length)
   - D (Diameter)
   - S (Slope)
   - N (Speed)

2. Must be positive numbers:
   - L > 0 (Typical: 10 – 1000 ft)
   - D > 0 (Typical: 1 – 20 ft)
   - S > 0 (Typical: 0.1 – 6 in./ft)
   - N > 0 (Typical: 0.1 – 5 rpm)

3. Plausibility bounds:
   - L: 1 – 2000 ft
   - D: 0.2 – 100 ft
   - S: >0 – 12 in./ft
   - N: >0 – 60 rpm

4. Cross-checks:
   - L/D ratio must be > 0
   - Typical L/D range: 5 – 50 (warn if <2 or >500)

5. Precision check:
   - Warn if more than 3 decimals in inputs

-------------------------------------------
⚠️ Output Validations:

1. Computed t must be:
   - Finite and > 0
   - Not greater than 1440 minutes (24 hrs)

2. Classification of t:
   - < 5 min → ❌ Very short (incomplete processing risk)
   - 5 – 30 min → ✅ Typical
   - 30 – 120 min → ⚠️ Long (high fuel/emissions)
   - > 120 min → 🔴 Very long (process review needed)

3. Advisory warnings:
   - t > 60 → check emissions/fuel efficiency
   - t < 5 → check product quality and combustion completeness
===========================================
/ -->
