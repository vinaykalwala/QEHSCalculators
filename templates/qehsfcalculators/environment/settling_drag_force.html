{% extends 'base.html' %}
{% block title %}Settling Drag Force Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settling Drag Force Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        
/* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
             /* display: flex;  */
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
            /* overflow-y: auto;  */
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Input rows for better organization */
        .input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-row .form-group {
            flex: 1;
        }
        
        @media (max-width: 600px) {
            .input-row {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }

                .rate-display {
                display: flex;
                gap: 20px;
                justify-content: center;
                align-items: center;
                flex-wrap: wrap; /* responsive */
                text-align: center;
            }

            .rate-block {
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 120px; /* keeps blocks same width */
            }

            .rate-label {
                font-weight: bold;
                font-size: 16px;
                color: #444;
                margin-bottom: 5px;
            }

            .rate-value {
                font-size: 40px;
                font-weight: 700;
                color: #2980b9;
                line-height: 1.2;
            }

            .rate-unit {
                font-size: 14px;
                color: #777;
                margin-top: 4px;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .rate-value { font-size: 32px; }
            }

            @media (max-width: 480px) {
                .rate-value { font-size: 26px; }
                
                .rate-unit { font-size: 12px; }
                
            }



        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
                .result-feedback {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 18px 20px;
    border-left: 4px solid #3498db;
    text-align: left;
    max-width: 800px; /* keeps it readable on large screens */
    margin: 0 auto;   /* centers it */
}

.feedback-title {
    font-weight: 600;
    margin-bottom: 8px;
    color: #2c3e50;
    font-size: 18px;
}

.feedback-content { 
    color: #34495e; 
    font-size: 16px;
    line-height: 1.5;
}

/* Responsive breakpoints */
@media (max-width: 768px) {
    .result-feedback {
        padding: 15px;
        font-size: 15px;
    }

    .feedback-title {
        font-size: 16px;
    }

    .feedback-content {
        font-size: 14px;
    }
}

@media (max-width: 480px) {
    .result-feedback {
        padding: 12px;
        border-left-width: 3px;
    }

    .feedback-title {
        font-size: 15px;
    }

    .feedback-content {
        font-size: 13px;
    }
}

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

<div class="btn-container">
    <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
</div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <div class="calculator-header">
        <h1>Settling Drag Force Calculator</h1>
        <p>Calculate the drag force experienced by an object moving through a fluid for environmental and industrial applications.</p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Parameters</h2>
             <div class="input-row">
            <div class="form-group">
                <label for="dragCoefficient">Drag Coefficient (C<sub>n</sub>)</label>
                <input type="number" id="dragCoefficient" class="form-input" step="any" min="0" placeholder="e.g., 0.47">
            </div>

            <div class="form-group">
                <label for="fluidDensity">Fluid Density (ρ, kg/m³)</label>
                <input type="number" id="fluidDensity" class="form-input" step="any" min="0" placeholder="e.g., 1000">
            </div>
                  </div>
                  <div class="input-row">
            <div class="form-group">
                <label for="projectedArea">Projected Area (A<sub>p</sub>, m²)</label>
                <input type="number" id="projectedArea" class="form-input" step="any" min="0" placeholder="e.g., 0.0001">
            </div>

            <div class="form-group">
                <label for="velocity">Velocity (v, m/s)</label>
                <input type="number" id="velocity" class="form-input" step="any" min="0" placeholder="e.g., 2.5">
            </div>
                 </div>
            <button class="calculate-btn" onclick="calculateDragForce()">Calculate Drag Force</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <div class="result-placeholder" id="placeholder">
                <img src="/static/images/mlc_environment_result.png" alt="Drag force illustration">
                <p>This tool calculates drag force for fluid dynamics and engineering applications.</p>
            </div>

            <div class="result-error hidden" id="resultError">
                <div class="error-icon">❌</div>
                <div class="error-message" id="errorMessage"></div>
            </div>

            <div class="result-value hidden" id="resultValue">
                <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                    <h2>Drag Force (F<sub>d</sub>)</h2>
                </div>

                <div class="rate-display">
                    <div class="rate-value" id="forceValue">0.000</div>
                    <div class="rate-unit">N</div>
                </div>

                <div class="result-feedback">
                    <div class="feedback-title"> Assessment</div>
                    <div class="feedback-content" id="feedbackContent"></div>
                </div>

                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

 <div class="note-section">

    <div class="note-card">
        <h3>📘 About This Calculator</h3>
        <p>
            The <strong>Settling Drag Force Calculator</strong> determines the force exerted by a fluid on an object moving through it. 
            This is essential in environmental engineering, aerodynamics, vehicle design, and industrial processes 
            involving fluid flow and particle movement. The tool helps predict drag forces accurately, allowing engineers 
            and researchers to optimize system design and ensure safety.
        </p>
    </div>

    <div class="note-card">
        <h3>⚙ Parameters Used</h3>
        <ul class="note-list">
            <li><strong>C<sub>n</sub> (Drag Coefficient):</strong> Dimensionless coefficient representing the drag force characteristics of the object.</li>
            <li><strong>ρ (Fluid Density):</strong> Density of the fluid in kg/m³.</li>
            <li><strong>A<sub>p</sub> (Projected Area):</strong> Cross-sectional area of the object perpendicular to flow direction in m².</li>
            <li><strong>v (Velocity):</strong> Velocity of the object relative to the fluid in m/s.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>✅ Input Validation Rules</h3>
        <ul class="note-list">
            <li><strong>Drag Coefficient (C<sub>n</sub>):</strong> Must be > 0 (typical range: 0.04–2.0 for streamlined to bluff bodies).</li>
            <li><strong>Fluid Density (ρ):</strong> Must be > 0 kg/m³ (typical range: 1–1200 kg/m³ for air/water).</li>
            <li><strong>Projected Area (A<sub>p</sub>):</strong> Must be > 0 m² (typical range: 1e-6–100 m²).</li>
            <li><strong>Velocity (v):</strong> Must be ≥ 0 m/s (typical range: 0.01–100 m/s for most applications).</li>
            <li><strong>Extreme Values:</strong> Values outside typical ranges will trigger warnings but not errors.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>🔎 Output Validations</h3>
        <ul class="note-list">
            <li><strong>Drag Force (F<sub>d</sub>) must be finite:</strong> If result is NaN or Infinity → ❌ Invalid result, check inputs.</li>
            <li><strong>Drag Force (F<sub>d</sub>) > 1000 N:</strong> ⚠️ Very high force → Extremely high drag force detected. Check input values for accuracy. This may indicate extreme conditions. (Assessment/Feedback: Very High Force)</li>
            <li><strong>0.1 N ≤ Drag Force (F<sub>d</sub>) ≤ 1000 N:</strong> ✅ Appropriate Range → Drag force is within typical range for engineering applications. (Assessment/Feedback: Appropriate Force)</li>
            <li><strong>0 < Drag Force (F<sub>d</sub>) < 0.1 N:</strong> ⚠️ Very low force → Drag force is minimal and may be negligible in many applications. (Assessment/Feedback: Very Low Force)</li>
            <li><strong>Drag Force (F<sub>d</sub>) = 0:</strong> ✅ No drag force → Only occurs when velocity is zero. (Assessment/Feedback: No Drag Force)</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>📏 Governing Principle</h3>
        <p>
            A <strong>Settling Drag Force Calculator</strong> is not based on one single standard but uses Stokes' Law for very small particles and incorporates empirical correlations and models for larger or irregularly shaped particles, reflecting fundamental principles of fluid dynamics and experimental data across a broad range of Reynolds numbers. The underlying standard is the fundamental physics of fluid dynamics, but specific calculations depend on the particle's size, shape, and the fluid's properties, which vary widely.
        </p>
        <p>
            <strong style="color: #1976d2;">Key Standards and Principles:</strong><br>
            <strong>Stokes' Law (1851):</strong> Foundational analytical solution for drag force and settling velocity for very small, smooth spheres in a viscous fluid (Newtonian fluid) under slow-flow conditions (very low Reynolds number).<br>
            <strong>Drag Coefficient (Cd):</strong> Dimensionless number depending on particle shape and Reynolds number; determined using empirical correlations or models.<br>
            <strong>Particle Reynolds Number (Re<sub>s</sub>):</strong> Ratio of inertial to viscous forces determining flow regime and applicability of Stokes' Law.<br>
            <strong>Empirical Correlations:</strong> Experimental data-based models predict Cd for various particle shapes and Reynolds numbers, including non-spherical particles.<br>
            <strong>How it Works:</strong> The settling velocity is determined by balancing the gravitational force with the drag force. Drag is calculated using Cd, fluid density (ρ), projected area (A<sub>p</sub>), and velocity (v). For low Re, Stokes' Law applies; for higher Re, empirical correlations are used.
        </p>
        <p>
            In summary, while Stokes' Law is the foundation, a comprehensive settling drag force calculator integrates fluid dynamics principles and empirical data to account for complex factors influencing drag force and settling velocity.
        </p>
    </div>

    <div class="note-card">
        <h3>📝 Conclusion</h3>
        <p>
            The <strong>Settling Drag Force Calculator</strong> helps determine the resistance experienced by objects moving through fluids. 
            By combining object characteristics, fluid properties, and velocity, it provides an accurate force estimate with safety validations. 
            This assists engineers and students in analyzing flow behavior, designing efficient systems, and ensuring safety in environmental and industrial processes.
        </p>
    </div>

</div>

<script>
function showErrors(errors) {
    const errorBox = document.getElementById("resultError");
    const errorMessage = document.getElementById("errorMessage");
    const placeholder = document.getElementById("placeholder");
    const resultValue = document.getElementById("resultValue");

    errorMessage.innerHTML = errors.join("<br>");
    errorBox.classList.remove("hidden");
    placeholder.classList.add("hidden");
    resultValue.classList.add("hidden");
}

function calculateDragForce() {
    // Read values
    const dragCoefficient = parseFloat(document.getElementById("dragCoefficient").value);
    const fluidDensity = parseFloat(document.getElementById("fluidDensity").value);
    const projectedArea = parseFloat(document.getElementById("projectedArea").value);
    const velocity = parseFloat(document.getElementById("velocity").value);

    const forceValueEl = document.getElementById("forceValue");
    const feedbackEl = document.getElementById("feedbackContent");
    document.getElementById("resultError").classList.add("hidden");
    feedbackEl.innerHTML = "";

    const errors = [];
    const warnings = [];

    // Validation
    if (![dragCoefficient, fluidDensity, projectedArea, velocity].every(Number.isFinite)) {
        return showErrors(["👉 Please enter all values (numeric)."]);
    }
    
    if (dragCoefficient <= 0) errors.push("👉 Drag coefficient must be > 0.");
    if (fluidDensity <= 0) errors.push("👉 Fluid density must be > 0 kg/m³.");
    if (projectedArea <= 0) errors.push("👉 Projected area must be > 0 m².");
    if (velocity < 0) errors.push("👉 Velocity cannot be negative.");
    
    // Warning for unusual values
    if (dragCoefficient > 2.0) warnings.push("⚠️ Drag coefficient unusually high (>2.0).");
    if (dragCoefficient < 0.04) warnings.push("⚠️ Drag coefficient unusually low (<0.04).");
    if (fluidDensity > 1200) warnings.push("⚠️ Fluid density unusually high (>1200 kg/m³).");
    if (fluidDensity < 1) warnings.push("⚠️ Fluid density unusually low (<1 kg/m³).");
    if (projectedArea > 100) warnings.push("⚠️ Projected area unusually large (>100 m²).");
    if (projectedArea < 1e-6) warnings.push("⚠️ Projected area unusually small (<1e-6 m²).");
    if (velocity > 100) warnings.push("⚠️ Velocity unusually high (>100 m/s).");
    if (velocity < 0.01 && velocity > 0) warnings.push("⚠️ Velocity unusually low (<0.01 m/s).");

    if (errors.length) return showErrors(errors);

    // Formula: F_d = (1/2) × C_n × ρ × A_p × v²
    const dragForce = 0.5 * dragCoefficient * fluidDensity * projectedArea * velocity * velocity;

    if (!Number.isFinite(dragForce)) {
        return showErrors(["⚠️ Computed drag force is invalid (possible calculation error)."]);
    }

    // Classification
    let classification, suggestion, color;
    if (dragForce > 1000) {
        classification = "Very High Force";
        suggestion = "⚠️ Extremely high drag force detected. Check input values for accuracy. This may indicate extreme conditions.";
        color = "#e65100";
    } else if (dragForce >= 0.1) {
        classification = "Appropriate Force";
        suggestion = "✅ Drag force is within typical range for engineering applications.";
        color = "#2e7d32";
    } else if (dragForce > 0) {
        classification = "Very Low Force";
        suggestion = "⚠️ Drag force is minimal and may be negligible in many applications.";
        color = "#c62828";
    } else {
        classification = "No Drag Force";
        suggestion = "✅ No drag force present (velocity is zero).";
        color = "#1560bd";
    }

    // Format the force for display
    let displayValue;
    if (dragForce < 0.01 && dragForce > 0) {
        displayValue = dragForce.toExponential(4);
    } else {
        displayValue = dragForce.toFixed(4);
    }

    // Display result
    forceValueEl.textContent = displayValue;
    feedbackEl.innerHTML = `
        <div>Drag Force (F<sub>d</sub>) = <b>${displayValue}</b> N</div>
        <div>Classification: <b style="color:${color};">${classification}</b></div>
        <div style="margin-top:6px;">${suggestion}</div>
        ${warnings.length ? `<div style="margin-top:8px; color:#b35d00;">${warnings.join(" | ")}</div>` : ""}
    `;

    document.getElementById("placeholder").classList.add("hidden");
    document.getElementById("resultValue").classList.remove("hidden");
}

function printReport() {
    const el = document.getElementById('printDate');
    if (el) el.textContent = new Date().toLocaleDateString();
    window.print();
}
</script>
<script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--

Input Validations

Each parameter must follow physical and practical rules:

Drag Coefficient (Cₙ):

Must be > 0.

Typical range: 0.04 – 2.0
⚠ Warning if:

< 0.04 → unusually low

2.0 → unusually high

Fluid Density (ρ, kg/m³):

Must be > 0.

Typical range: 1 – 1200 kg/m³ (air ≈ 1.2, water ≈ 1000).
⚠ Warning if:

< 1 → too low

1200 → too high

Projected Area (Aₚ, m²):

Must be > 0.

Typical range: 1e-6 – 100 m²
⚠ Warning if:

< 1e-6 → unrealistically small

100 → unrealistically large

Velocity (v, m/s):

Must be ≥ 0.

Typical range: 0.01 – 100 m/s
⚠ Warning if:

< 0.01 (but > 0) → very small/negligible

100 → too high

✅ Output Validations (Fₑ result)

The formula is:

𝐹
𝑑
=
1
2
 
𝐶
𝑛
 
𝜌
 
𝐴
𝑝
 
𝑣
2
F
d
	​

=
2
1
	​

C
n
	​

ρA
p
	​

v
2

Check for valid number:

If NaN or Infinity → ❌ Invalid result (input error).

Force Range Classification:

Fₑ = 0 → ✅ No drag (velocity is zero).

0 < Fₑ < 0.1 N → ⚠ Very Low Force (likely negligible).

0.1 ≤ Fₑ ≤ 1000 N → ✅ Appropriate Range (typical for engineering).

Fₑ > 1000 N → ⚠ Very High Force (check inputs, extreme conditions).

✅ Edge Case Validations

All inputs empty/non-numeric → ❌ Show error "Please enter all values (numeric)."

Negative values → ❌ Not allowed (for density, area, velocity, drag coefficient).

Zero velocity → Valid → Force = 0 (special case).

Extremely small projected area (<1e-6) → ⚠ Warning, but calculation continues.

Extremely high values (area >100, velocity >100 m/s, density >1200) → ⚠ Warn user inputs may be unrealistic.

-->