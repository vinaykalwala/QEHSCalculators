{% extends 'base.html' %}
{% block title %}Total Height of Soak Pit Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Total Height of Soak Pit Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .back-btn {
            background: linear-gradient(#1560bd, #000040);
            color: #ffffff;
            border: 2px solid #1560bd;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd;
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05);
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }

        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd, #000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center;
            flex-wrap: wrap;
        }

        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
            line-height: 1.1;
        }

        .rate-label { 
            color: #7f8c8d;
            font-size: 20px;
            font-weight: bold;
        }

        /* Responsive styles */
        @media (max-width: 1200px) {
            .rate-value {
                font-size: 38px;
            }
            .rate-label {
                font-size: 18px;
            }
        }
        
        @media (max-width: 992px) {
            .rate-value {
                font-size: 34px;
            }
            .rate-label {
                font-size: 17px;
            }
        }
        
        @media (max-width: 768px) {
            .rate-value {
                font-size: 30px;
                margin-bottom: 8px;
            }
            .rate-label {
                font-size: 16px;
            }
        }
        
        @media (max-width: 576px) {
            .rate-value {
                font-size: 28px;
                margin-bottom: 6px;
            }
            .rate-label {
                font-size: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .rate-display {
                flex-direction: column;
                gap: 2px;
                text-align: center;
            }
            .rate-value {
                font-size: 24px;
                margin-bottom: 4px;
            }
            .rate-label {
                font-size: 14px;
            }
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
        
        .calculation-nav {
            list-style: none;
            padding: 0;
            margin: 15px 0;
        }
        
        .calculation-item {
            margin-bottom: 8px;
        }
        
        .calculation-link {
            display: block;
            padding: 10px 15px;
            background: #e3f2fd;
            border-left: 4px solid #1976d2;
            color: #1976d2;
            text-decoration: none;
            border-radius: 4px;
            transition: all 0.3s;
        }
        
        .calculation-link:hover {
            background: #bbdefb;
            transform: translateX(5px);
        }
    </style>
</head>
<body>

    <div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <div class="calculator-header">
        <h1>Total Height of Soak Pit Calculator</h1>
        <p>Calculate the <strong>Total Height (meters)</strong> of a soak pit by combining drain pipe slope height and volume-based height.</p>
    </div>

    <div class="calc-content">
        <!-- Calculator -->
        <div class="calc-card">
            <h2>Enter Data</h2>

            <div class="form-group">
                <label for="height1">Height for Drain Pipe Slope (H₁ in meters)</label>
                <input type="number" id="height1" class="form-input" min="0.1" max="3.0" step="0.01" placeholder="e.g., 0.5">
            </div>

            <div class="form-group">
                <label for="height2">Height Based on Volume (H₂ in meters)</label>
                <input type="number" id="height2" class="form-input" min="0.5" max="5.0" step="0.01" placeholder="e.g., 1.2">
            </div>
            
            <button class="calculate-btn" onclick="calculateTotalHeight()">Calculate Total Height</button>
        </div>

        <!-- Result Section -->
        <div class="result-card">
            <div class="result-placeholder" id="placeholder">
                <img src="/static/images/mlc_environment_result.png" alt="Soak pit illustration">
                <p>This tool will calculate the <strong>Total Height of Soak Pit (meters)</strong>.</p>
            </div>
            
            <div class="result-error hidden" id="resultError">
                <div class="error-icon">❌</div>
                <div class="error-message" id="errorMessage"></div>
            </div>
             
            <div class="result-value hidden" id="resultValue">
                <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                    <h2>Calculated Total Height</h2>
                </div>

                <div class="rate-display">
                    <div class="rate-value" id="rateValue">0.00</div>
                    <div class="rate-label" style="color:#2980b9; font-size:20px; font-weight:bold;">meters</div>
                </div>

                <div class="result-feedback">
                    <div class="feedback-title">Assessment</div>
                    <div class="feedback-content" id="feedbackContent"></div>
                </div>
                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notes Section -->
<div class="note-section">

    <div class="note-card">
        <h3>📘 About This Calculator</h3>
        <p>
            The <strong>Total Height of Soak Pit Calculator</strong> determines the optimal height for wastewater absorption
            by combining the height needed for proper drainage slope and the height required based on the soak pit's volume.
        </p>
    </div>

    <div class="note-card">
        <h3>⚙ Parameters Used</h3>
        <ul class="note-list">
            <li><strong>H₁ (Drain Pipe Slope Height):</strong> 0.1 – 3.0 m (warning if &lt; 0.2 m)</li>
            <li><strong>H₂ (Volume-Based Height):</strong> 0.5 – 5.0 m (warning if &lt; 0.8 m)</li>
            <li><strong>Total Height (H₁ + H₂):</strong> Calculated in meters, shown to 2 decimal places</li>
            <li><strong>Invalid Inputs:</strong> Negative, zero, or out-of-range values trigger errors</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>✅ Input Validation Rules</h3>
        <ul class="note-list">
            <li>✔️ <strong>H₁ (Drain Pipe Slope Height)</strong> must be between 0.1–3.0 meters</li>
            <li>✔️ <strong>H₂ (Volume-Based Height)</strong> must be between 0.5–5.0 meters</li>
            <li>⚠️ H₁ &lt; 0.2 m → warning (may not provide adequate slope for drainage)</li>
            <li>⚠️ H₂ &lt; 0.8 m → warning (may not provide sufficient volume for wastewater)</li>
            <li>⚠️ Total Height &gt; 3.5 m → warning (exceeds typical recommendations)</li>
            <li>❌ Zero, negative, or non-numeric inputs are invalid</li>
            <li>⚠️ Extreme values outside typical ranges trigger warnings</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>📊 Output Validations</h3>
        <ul class="note-list">
            <li>Total Height 1.0–2.5 meters → ✅ GOOD: Total height is within the optimal range (1.0–2.5 meters) for most soil conditions.</li>
            <li>Total Height &lt; 1.0 meters → ⚠️ WARNING: Total height is less than 1.0 meter. This may be too shallow for effective wastewater absorption. Consider increasing the dimensions of your soak pit.</li>
            <li>Total Height 2.5–3.5 meters → ⚠️ WARNING: Total height exceeds 2.5 meters. This is deeper than typically recommended. Ensure your soil has adequate permeability for this depth.</li>
            <li>Total Height &gt; 3.5 meters → 🔴 EXCESSIVE: Total height exceeds 3.5 meters. This is generally not recommended. Please reconsider your design or consult with a civil engineer.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>📏 Governing Principle</h3>
        <p>
            The calculation for the total height of a soak pit depends on the specific design guidelines or standards applicable to the project's location, as there isn't one universal standard for soak pit height calculation. Key factors influencing the height calculation include the groundwater table, soil type, and local regulations, with common practices often referring to standards like the CPHEEO (Central Public Health and Environmental Engineering Organisation) manual in India, which provides guidelines for sizing soak pits based on sewage generation and infiltration rates.
        </p>
        <p><strong>Factors influencing the calculation</strong></p>
        <ul class="note-list">
            <li><strong>Groundwater Table:</strong> The bottom of the soak pit must be a minimum distance above the highest recorded groundwater table to prevent contamination. This often sets a maximum depth for the soak pit.</li>
            <li><strong>Soil Type:</strong> The ability of the soil to absorb water is crucial. A higher infiltration rate allows for a shallower pit for a given volume of wastewater.</li>
            <li><strong>Wastewater Volume:</strong> The amount of wastewater to be treated determines the required surface area (infiltration area) of the pit.</li>
            <li><strong>Local Standards and Regulations:</strong> Specific building codes and sanitation standards, such as those from the CPHEEO or other local authorities, provide the most definitive guidance.</li>
        </ul>
        <p><strong>General Calculation Approach</strong></p>
        <ul class="note-list">
            <li>Calculate the Infiltration Area (Ai): This is based on the volume of wastewater generated and the soil's infiltration capacity.</li>
            <li>Determine the Perimeter of the Pit: The perimeter is calculated using the pit's diameter (D).</li>
            <li>H is the pit depth (meters).</li>
            <li>Ai is the infiltration area (square meters).</li>
            <li>The 0.5 meter is an allowance for the section of the pit above the infiltration area, such as the part below the inlet pipe and above the main infiltration surface.</li>
        </ul>
        <p><strong>How to Find the Applicable Standard</strong></p>
        <ul class="note-list">
            <li>Consult Local Regulations: Check with the municipal corporation, building department, or sanitation authorities in your area for their specific standards and codes regarding soak pit design.</li>
            <li>Refer to Localized Guidelines: For instance, in India, the CPHEEO manual provides recommendations, which would be the relevant standard.</li>
            <li>Look for Local Codes: Standards may also be available from national or international bodies relevant to your region.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>✅ Conclusion</h3>
        <p>
            This calculator provides a practical way to determine the <strong>Total Height of a Soak Pit</strong> 
            by combining drainage slope and volume-based height. It follows 
            <b>IS 2470, WHO guidelines, and best civil engineering practices</b>, ensuring safe design and effective wastewater percolation. 
        </p>
    </div>

</div>


<script>
    function calculateTotalHeight() {
        // Get input values
        const height1 = parseFloat(document.getElementById('height1').value);
        const height2 = parseFloat(document.getElementById('height2').value);
        
        // Get DOM elements
        const placeholder = document.getElementById('placeholder');
        const resultValue = document.getElementById('resultValue');
        const resultError = document.getElementById('resultError');
        const rateValue = document.getElementById('rateValue');
        const feedbackContent = document.getElementById('feedbackContent');
        const errorMessage = document.getElementById('errorMessage');
        
        // Reset visibility
        placeholder.classList.add('hidden');
        resultValue.classList.add('hidden');
        resultError.classList.add('hidden');
        
        // Validation
        let errors = [];
        
        // Check if inputs are numbers
        if (isNaN(height1) || isNaN(height2)) {
            errors.push("Both H₁ and H₂ must be valid numbers.");
        }
        
        // Check if inputs are within valid ranges
        if (height1 < 0.1 || height1 > 3.0) {
            errors.push("H₁ (Drain Pipe Slope Height) must be between 0.1 and 3.0 meters.");
        }
        
        if (height2 < 0.5 || height2 > 5.0) {
            errors.push("H₂ (Volume-Based Height) must be between 0.5 and 5.0 meters.");
        }
        
        // Check for negative values
        if (height1 < 0 || height2 < 0) {
            errors.push("Height values cannot be negative.");
        }
        
        // If there are errors, display them and stop calculation
        if (errors.length > 0) {
            errorMessage.innerHTML = errors.join('<br>');
            resultError.classList.remove('hidden');
            return;
        }
        
        // Calculate total height
        const totalHeight = height1 + height2;
        
        // Display result
        rateValue.textContent = totalHeight.toFixed(2);
        
        // Generate feedback based on result
        let feedback = '';
        
        if (totalHeight < 1.0) {
            feedback = `<span class="average">⚠️ WARNING: Total height is less than 1.0 meter. This may be too shallow for effective wastewater absorption. Consider increasing the dimensions of your soak pit.</span>`;
        } else if (totalHeight >= 1.0 && totalHeight <= 2.5) {
            feedback = `<span class="good">✅ GOOD: Total height is within the optimal range (1.0-2.5 meters) for most soil conditions.</span>`;
        } else if (totalHeight > 2.5 && totalHeight <= 3.5) {
            feedback = `<span class="average">⚠️ WARNING: Total height exceeds 2.5 meters. This is deeper than typically recommended. Ensure your soil has adequate permeability for this depth.</span>`;
        } else {
            feedback = `<span class="bad">❌ EXCESSIVE: Total height exceeds 3.5 meters. This is generally not recommended. Please reconsider your design or consult with a civil engineer.</span>`;
        }
        
        // Add specific warnings based on inputs
        if (height1 < 0.2) {
            feedback += `<br><br><span class="average">⚠️ Note: H₁ (${height1.toFixed(2)}m) is less than the recommended minimum of 0.2m for adequate drain pipe slope.</span>`;
        }
        
        if (height2 < 0.8) {
            feedback += `<br><br><span class="average">⚠️ Note: H₂ (${height2.toFixed(2)}m) is less than the recommended minimum of 0.8m for sufficient wastewater volume capacity.</span>`;
        }
        
        feedbackContent.innerHTML = feedback;
        resultValue.classList.remove('hidden');
    }
    
    function printReport() {
        window.print();
    }
    
    // Allow Enter key to trigger calculation
    document.addEventListener('DOMContentLoaded', function() {
        const inputs = document.querySelectorAll('.form-input');
        inputs.forEach(input => {
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    calculateTotalHeight();
                }
            });
        });
    });
</script>

  <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--
The formula used is:
H_total = H₁ + H₂
-------------------------------------------------
Input Validations
H₁ (Drain Pipe Slope Height)

Must be a valid number (not text or empty)

Must be between 0.1 and 3.0 meters

Cannot be negative

Values below 0.2m trigger warnings

H₂ (Volume-Based Height)

Must be a valid number (not text or empty)

Must be between 0.5 and 5.0 meters

Cannot be negative

Values below 0.8m trigger warnings

Cross-field Validation

Total height (H₁ + H₂) exceeding 3.5m triggers a warning

Any negative values are rejected
-----------------------------------------------------------------
Output Validations
Total Height Calculation

Displayed with 2 decimal places

Unit clearly indicated as meters

Assessment Feedback

Optimal range: 1.0-2.5 meters

Warning for values <1.0m or >2.5m

Error for values >3.5m
-------------------------------------------------------------
Edge Cases
Division by Zero: Not applicable (simple addition)

Extreme Values: Values outside 0.1-3.0 (H₁) and 0.5-5.0 (H₂) are rejected

Decimal Precision: Handles up to 2 decimal places

Negative Values: Rejected with appropriate error message

-->