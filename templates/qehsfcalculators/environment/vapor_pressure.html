{% extends 'base.html' %}
{% block title %}Vapor Pressure Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vapor Pressure Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
             /* display: flex;  */
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
            /* overflow-y: auto;  */
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Input rows for better organization */
        .input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-row .form-group {
            flex: 1;
        }
        
        @media (max-width: 600px) {
            .input-row {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }

                .rate-display {
                display: flex;
                gap: 20px;
                justify-content: center;
                align-items: center;
                flex-wrap: wrap; /* responsive */
                text-align: center;
            }

            .rate-block {
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 120px; /* keeps blocks same width */
            }

            .rate-label {
                font-weight: bold;
                font-size: 16px;
                color: #444;
                margin-bottom: 5px;
            }

            .rate-value {
                font-size: 40px;
                font-weight: 700;
                color: #2980b9;
                line-height: 1.2;
            }

            .rate-unit {
                font-size: 14px;
                color: #777;
                margin-top: 4px;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .rate-value { font-size: 32px; }
            }

            @media (max-width: 480px) {
                .rate-value { font-size: 26px; }
                
                .rate-unit { font-size: 12px; }
                
            }



        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
                .result-feedback {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 18px 20px;
    border-left: 4px solid #3498db;
    text-align: left;
    max-width: 800px; /* keeps it readable on large screens */
    margin: 0 auto;   /* centers it */
}

.feedback-title {
    font-weight: 600;
    margin-bottom: 8px;
    color: #2c3e50;
    font-size: 18px;
}

.feedback-content { 
    color: #34495e; 
    font-size: 16px;
    line-height: 1.5;
}

/* Responsive breakpoints */
@media (max-width: 768px) {
    .result-feedback {
        padding: 15px;
        font-size: 15px;
    }

    .feedback-title {
        font-size: 16px;
    }

    .feedback-content {
        font-size: 14px;
    }
}

@media (max-width: 480px) {
    .result-feedback {
        padding: 12px;
        border-left-width: 3px;
    }

    .feedback-title {
        font-size: 15px;
    }

    .feedback-content {
        font-size: 13px;
    }
}

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Warning message style */
        .result-warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            color: #856404;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .warning-icon {
            font-size: 36px;
            flex-shrink: 0;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

    <div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <div class="calculator-header">
        <h1>Vapor Pressure Calculator</h1>
        <p>Calculate the <strong>Vapor Pressure (P)</strong> using the Antoine Equation for chemical safety and process design applications.</p>
    </div>

    <div class="calc-content">
        <!-- Calculator -->
        <div class="calc-card">
            <h2>Enter Data</h2>

        <div class="input-row">
            <div class="form-group">
                <label for="A">Antoine Constant A</label>
                <input type="number" id="A" class="form-input" step="any" placeholder="e.g., 8.07131">
            </div>

            <div class="form-group">
                <label for="B">Antoine Constant B</label>
                <input type="number" id="B" class="form-input" step="any" placeholder="e.g., 1730.63">
            </div>
            </div>

        <div class="input-row">
            <div class="form-group">
                <label for="C">Antoine Constant C</label>
                <input type="number" id="C" class="form-input" step="any" placeholder="e.g., 233.426">
            </div>

            <div class="form-group">
                <label for="T">Temperature (T, °C)</label>
                <input type="number" id="T" class="form-input" step="any" placeholder="e.g., 25">
            </div>
            </div>
            
            <button class="calculate-btn" onclick="calculateVaporPressure()">Calculate Vapor Pressure</button>
        </div>

        <!-- Result Section -->
        <div class="result-card">
            <div class="result-placeholder" id="placeholder">
                <img src="/static/images/mlc_environment_result.png" alt="Vapor pressure illustration">
                <p>This tool will calculate the <strong>Vapor Pressure (P)</strong> using the Antoine Equation.</p>
            </div>
            
            <div class="result-error hidden" id="resultError" role="alert" aria-live="polite">
                <div class="error-icon">❌</div>
                <div class="error-message" id="errorMessage"></div>
            </div>
            
            <!-- Warning message container -->
            <div class="result-warning hidden" id="resultWarning" role="alert" aria-live="polite">
                <div class="warning-icon">⚠️</div>
                <div class="warning-message" id="warningMessage"></div>
            </div>
             
            <div class="result-value hidden" id="resultValue" aria-live="polite">
                <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                    <h2>Calculated Vapor Pressure</h2>
                </div>

                <div class="rate-display" style="gap:12px; align-items:center; justify-content:center;">
                    <div class="rate-value" id="rateValue">0.0000</div>
                    <div class="rate-unit" style="font-size:16px; color: #2980b9;">mmHg</div>
                </div>

                <div class="result-feedback">
                    <div class="feedback-title">Assessment</div>
                    <div class="feedback-content" id="feedbackContent"></div>
                </div>
                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notes Section -->
<div class="note-section">

    <div class="note-card">
        <h3>📘 About This Calculator</h3>
        <p>
            The <strong>Vapor Pressure Calculator</strong> uses the Antoine Equation to estimate the vapor pressure of pure substances at a given temperature. Vapor pressure is a critical property in chemical safety assessments, process design, and environmental impact evaluations.
        </p>
    </div>

    <div class="note-card">
        <h3>📐 Parameters Used</h3>
        <ul class="note-list">
            <li><strong>A, B, C (Antoine Constants)</strong> → Substance-specific constants used in vapor pressure calculation.</li>
            <li><strong>T (Temperature, °C)</strong> → Must be above -273.15°C (absolute zero).</li>
            <li><strong>P (Vapor Pressure, mmHg)</strong> → Calculated output using Antoine Equation.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>⚠️ Input Validation Rules</h3>
        <ul class="note-list">
            <li>✔️ <strong>Temperature (T)</strong> must be above absolute zero (-273.15°C)</li>
            <li>✔️ <strong>Temperature + Constant C</strong> must not equal zero to avoid division by zero</li>
            <li>✔️ <strong>Antoine Constants (A, B, C)</strong> must be appropriate for the substance and temperature range</li>
            <li>❌ Zero, negative, or non-numeric inputs are invalid</li>
            <li>⚠️ Temperature values approaching the substance's critical point may yield inaccurate results</li>
            <li>⚠️ Constants A, B, and C are substance-specific and temperature-range dependent</li>
            <li>⚠️ Extrapolation beyond the validated temperature range may produce unreliable results</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>📊 Output Validations</h3>
        <ul class="note-list">
            <li>Vapor Pressure &lt; 10 mmHg</span> ✅ Low volatility → This substance has low vapor pressure at the given temperature, indicating relatively safe handling conditions with minimal evaporation risk.</li>
            <li>10 mmHg ≤ Vapor Pressure ≤ 760 mmHg</span> ⚠️ Moderate volatility → This substance has moderate vapor pressure. Ensure proper ventilation and consider appropriate containment measures to prevent excessive vapor accumulation.</li>
            <li>Vapor Pressure &gt; 760 mmHg</span> 🔴 High volatility → This substance has high vapor pressure at the given temperature, indicating significant evaporation risk. Specialized containment and safety measures are required.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>📏 Governing Principle</h3>
        <p>
            A <strong>Vapor Pressure Calculator</strong> isn't governed by a single overarching standard but instead utilizes various established methods and equations, such as the Clausius-Clapeyron equation, Antoine equation, or Tetens equation, depending on the substance and the specific application being modeled. Different standards exist for specific applications, like the ASTM D2889 standard for calculating true vapor pressures of petroleum distillate fuels.
        </p>
        <ul class="note-list">
            <li><strong>General Principles and Equations:</strong>
                <ul>
                    <li>SI Units: Vapor pressure is measured in standard SI units, primarily pascal (Pa).</li>
                    <li>Thermodynamic Principles: Relates vapor pressure, temperature, and heat of vaporization (Clausius-Clapeyron equation).</li>
                    <li>Empirical Equations: Tetens equation for water vapor pressure above/below freezing.</li>
                </ul>
            </li>
            <li><strong>Application-Specific Standards:</strong>
                <ul>
                    <li>Petroleum Industry: ASTM D2889 for true vapor pressures of petroleum distillates.</li>
                    <li>Chemical & Environmental Testing: OECD standards for chemical vapor pressure measurement.</li>
                    <li>Environmental Applications (VPD): Tetens equation combined with relative humidity for actual vapor pressure.</li>
                </ul>
            </li>
            <li><strong>Key Takeaway:</strong> The "standard" depends on context and material; scientific and industry-specific methods are applied rather than a single universal standard.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>✅ Conclusion</h3>
        <p>
            The <strong>Vapor Pressure Calculator</strong> provides a safe and reliable method to estimate vapor pressure using the Antoine Equation. 
            It helps in <b>chemical safety assessments, process design, environmental evaluations, and hazard analysis</b>.  
            Always confirm results against <b>application-specific standards, substance safety data sheets (SDS),</b> and <b>regulatory limits</b> before practical implementation.
        </p>
    </div>

</div>


<script>
    function calculateVaporPressure() {
        // Get input values
        const A = parseFloat(document.getElementById('A').value);
        const B = parseFloat(document.getElementById('B').value);
        const C = parseFloat(document.getElementById('C').value);
        const T = parseFloat(document.getElementById('T').value);
        
        // Get result elements
        const placeholder = document.getElementById('placeholder');
        const resultError = document.getElementById('resultError');
        const resultWarning = document.getElementById('resultWarning');
        const resultValue = document.getElementById('resultValue');
        const rateValue = document.getElementById('rateValue');
        const feedbackContent = document.getElementById('feedbackContent');
        const errorMessage = document.getElementById('errorMessage');
        const warningMessage = document.getElementById('warningMessage');
        
        // Hide all result sections initially
        placeholder.classList.add('hidden');
        resultError.classList.add('hidden');
        resultWarning.classList.add('hidden');
        resultValue.classList.add('hidden');
        
        // Input validation
        if (isNaN(A) || isNaN(B) || isNaN(C) || isNaN(T)) {
            errorMessage.textContent = "⚠️ Please enter valid numeric values for all fields.";
            resultError.classList.remove('hidden');
            return;
        }
        
        // Validate temperature is above absolute zero
        if (T <= -273.15) {
            errorMessage.textContent = "❌ Temperature (T) must be above absolute zero (-273.15°C).";
            resultError.classList.remove('hidden');
            return;
        }
        
        // Validate denominator (T + C) is not zero
        if (T + C === 0) {
            errorMessage.textContent = "❌ Invalid calculation: (T + C) results in division by zero. Please ensure (T + C) is not equal to zero.";
            resultError.classList.remove('hidden');
            return;
        }
        
        // Check for warnings (these won't prevent calculation)
        let hasWarning = false;
        let warningText = "";
        
        if (A < 0 || A > 20) {
            warningText += "⚠️ Constant A is outside the typical range (0-20). Results may be inaccurate.<br>";
            hasWarning = true;
        }
        
        if (B < 0 || B > 5000) {
            warningText += "⚠️ Constant B is outside the typical range (0-5000). Results may be inaccurate.<br>";
            hasWarning = true;
        }
        
        if (C < -273.15 || C > 500) {
            warningText += "⚠️ Constant C is outside the typical range (-273.15 to 500). Results may be inaccurate.<br>";
            hasWarning = true;
        }
        
        // Show warnings if any
        if (hasWarning) {
            warningMessage.innerHTML = warningText;
            resultWarning.classList.remove('hidden');
        }
        
        // Calculate vapor pressure using the Antoine equation
        const logP = A - (B / (T + C));
        const vaporPressure = Math.pow(10, logP);
        
        // Display result
        rateValue.textContent = vaporPressure.toFixed(4);
        
        // Provide feedback based on vapor pressure value
        if (vaporPressure < 10) {
            feedbackContent.innerHTML = "<span class='good'>✅ LOW VOLATILITY</span><br>This substance has low vapor pressure at the given temperature, indicating relatively safe handling conditions with minimal evaporation risk.";
        } else if (vaporPressure >= 10 && vaporPressure <= 760) {
            feedbackContent.innerHTML = "<span class='average'>⚠️ MODERATE VOLATILITY</span><br>This substance has moderate vapor pressure. Ensure proper ventilation and consider appropriate containment measures to prevent excessive vapor accumulation.";
        } else {
            feedbackContent.innerHTML = "<span class='bad'>🔴 HIGH VOLATILITY</span><br>This substance has high vapor pressure at the given temperature, indicating significant evaporation risk. Specialized containment and safety measures are required.";
        }
        
        // Show result
        resultValue.classList.remove('hidden');
    }
    
    function printReport() {
        window.print();
    }
</script>

  <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--

Formula Implementation: 
Correctly implemented the Antoine Equation: P = 10^(A - (B / (T + C)))
-------------------------------------------------------------------------------------------
Input Validations:

All fields must contain numeric values

Temperature must be above absolute zero (-273.15°C)

Denominator (T + C) must not equal zero

Constants validated against typical ranges with warnings
------------------------------------------------------------------------------
Output Validation:

Results displayed in mmHg with 4 decimal places

Safety assessment based on vapor pressure value

Clear error messages with specific guidance

-------------------------------------------------------------------------
Edge Cases:

Temperature at absolute zero

Division by zero scenarios

Extremely high/low constant values

Non-numeric inputs
-->