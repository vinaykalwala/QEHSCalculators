{% extends 'base.html' %}
{% block title %}Energy Consumption Per Hours Worked Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Consumption Per Hours Worked Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
      

        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
      .btn-wrapper {
    text-align: center; /* centers inline-block buttons */
    margin-top: 20px;
  }

   .btn-wrapper {
    text-align: center; /* centers the button */
    margin-top: 20px;
  }

  .print-btn {
    display: inline-block;
    background:linear-gradient(#1560bd,#000040);
    color: white;
    padding: 8px 18px;   /* control button size */
    border: none;
    border-radius: 6px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    width: auto !important; /* prevent full width */
  }

  .print-btn:hover {
    background: #1560bd;
  }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center; 
        }
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

       
    </style>
</head>
<body>

    <div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>
<div class="calculator-container printable" id="printArea">


  {% include "includes/print_header_footer.html" %}

<div class="calculator-header">
  <h1>Air Flow Rate & Mass Flow Calculator</h1>
  <p>Calculate the airflow moving through a given area using velocity and cross-sectional area.</p>
</div>

<div class="calc-content">
  <!-- Calculator -->
  <div class="calc-card">
    <h2>Enter Data</h2>
    <div class="form-group">
      <label for="velocity">Velocity (m/s)</label>
      <input type="number" id="velocity" class="form-input" min="0" step="0.01" placeholder="e.g., 5">
    </div>
    <div class="form-group">
      <label for="area">Cross-Sectional Area (m²)</label>
      <input type="number" id="area" class="form-input" min="0" step="0.01" placeholder="e.g., 2">
    </div>
    <div class="form-group">
      <label for="airDensity">Air Density (kg/m³) <small>(optional)</small></label>
      <input type="number" id="airDensity" class="form-input" min="0" step="0.001" placeholder="default = 1.20">
    </div>
    <button class="calculate-btn" onclick="calculateAirFlowRate()">Calculate Flow Rate</button>
  </div>

  <!-- Result Section -->
  <div class="result-card">
    <!-- Placeholder -->
    <div class="result-placeholder" id="placeholder">
      <img src="/static/images/mlc_environment_result.png" alt="Air Flow illustration">
      <p>This tool will calculate the <strong>Air Flow Rate</strong>. Enter your data to see results here.</p>
    </div>

    <!-- Error Box -->
    <div class="result-error hidden" id="resultError">
      <div class="error-icon">❌</div>
      <div class="error-message" id="errorMessage"></div>
    </div>

    <!-- Result Output -->
    <div class="result-value hidden" id="resultValue">
      <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
        <h2>Flow Rate</h2>
      </div>

      <div class="rate-display">
        <div class="rate-value" id="rateValue">0.00</div>
        <div class="rate-label" style="color:#2980b9; font-size:18px; font-weight:bold;">m³/s</div>
      </div>

      <div class="result-feedback">
        <div class="feedback-title">Assessment</div>
        <div class="feedback-content" id="feedbackContent"></div>
      </div>

      <div class="btn-wrapper">
        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
      </div>
    </div>
  </div>
</div>

<!-- Notes Section -->
<div class="note-section">
  <div class="note-card">
    <h3>📘 About This Calculator</h3>
    <p>
      The <strong>Air Flow Rate Calculator</strong> determines the volumetric and mass flow of air through a given cross-sectional area.
      This is essential for designing, monitoring, and optimizing ventilation systems in HVAC, industrial, and environmental applications.
    </p>
  </div>

  <div class="note-card">
    <h3>⚙️ Parameters Used</h3>
    <ul class="note-list">
      <li><strong>Velocity (m/s):</strong> Speed of air moving through the duct or space.</li>
      <li><strong>Cross-Sectional Area (m²):</strong> Area through which air flows.</li>
      <li><strong>Air Density (kg/m³):</strong> Used to calculate mass flow rate, default is 1.20 at ~20°C.</li>
    </ul>
  </div>

  <div class="note-card">
    <h3>✅ Input Validation Rules</h3>
    <ul class="note-list">
      <li>Velocity (m/s) must be between 0 and 343 (speed of sound, sanity check).</li>
      <li>Cross-sectional Area must be &gt; 0 and ≤ 10,000 m².</li>
      <li>Air Density must be between 0.8 and 1.4 kg/m³; defaults to 1.20 if not provided.</li>
      <li>No negative values allowed for any parameter.</li>
      <li>Decimal precision: Velocity (2), Area (2), Density (3) decimals.</li>
      <li>If Velocity = 0 → Flow = 0 (warning).</li>
      <li>If Area = 0 → Calculation not possible (error).</li>
    </ul>
  </div>

<div class="note-card">
  <h3>📤 Output Validations</h3>
  <ul class="note-list">
    <li>Volumetric Flow Rate (Q) = 0 → ❗ No airflow detected. Flow is zero due to lack of velocity.</li>
    <li>Volumetric Flow Rate (Q) &lt; 5 m³/s → ⚠️ Low airflow. May be insufficient for larger spaces or equipment cooling.</li>
    <li>5 ≤ Volumetric Flow Rate (Q) ≤ 20 m³/s → ✅ Moderate airflow. Typical for many ventilation applications.</li>
    <li>Volumetric Flow Rate (Q) &gt; 20 m³/s → 🌟 High airflow. Strong ventilation capacity for large systems or industrial needs.</li>
  </ul>
</div>

<div class="note-card">
  <h3>📐 Governing Principle</h3>
  <p>
    Air flow rate (mass flow) calculators are based on standards such as <strong>ISO 5167</strong> and <strong>ASME MFC-14M</strong> for flow measurement using differential pressure devices, <strong>ISO 8778</strong> for defining reference atmospheric conditions, SEMI standards for mass flow instrument specifications, and CAGI/ASME standards for SCFM (Standard Cubic Feet per Minute) calculations. The specific standard used depends on the application, the type of measurement device, and the desired reference conditions for the flow rate.
  </p>
</div>



  <div class="note-card">
    <h3>🔚 Conclusion</h3>
    <p>
      This calculator provides reliable volumetric and mass flow rates based on international standards.  
      By assessing airflow as low, moderate, or high, it helps engineers ensure proper ventilation, compliance with industrial guidelines, and safe operational conditions for HVAC, process, and environmental systems.
    </p>
  </div>
</div>


<script>
function calculateAirFlowRate() {
  const velocityRaw = document.getElementById('velocity')?.value.trim() ?? "";
  const areaRaw     = document.getElementById('area')?.value.trim() ?? "";
  const densityRaw  = document.getElementById('airDensity')?.value.trim() ?? "";

  const errorBox = document.getElementById('resultError');
  const errorMessage = document.getElementById('errorMessage');
  const placeholder = document.getElementById('placeholder');
  const resultValue = document.getElementById('resultValue');
  const rateEl = document.getElementById('rateValue');
  const feedbackEl = document.getElementById('feedbackContent');

  if (errorBox) errorBox.classList.add('hidden');
  if (errorMessage) errorMessage.innerHTML = "";
  if (feedbackEl) feedbackEl.innerHTML = "";

  const errors = [];
  const warnings = [];

  // Required input check
  if (velocityRaw === "") errors.push("👉 Please enter the velocity (m/s).");
  if (areaRaw === "") errors.push("👉 Please enter the cross-sectional area (m²).");

  if (errors.length > 0) {
    errorMessage.innerHTML = errors.join("<br>");
    errorBox.classList.remove('hidden');
    placeholder.classList.add('hidden');
    resultValue.classList.add('hidden');
    return;
  }

  const velocity = parseFloat(velocityRaw);
  const area = parseFloat(areaRaw);

  if (!Number.isFinite(velocity) || !Number.isFinite(area)) {
    errorMessage.innerHTML = "⚠️ Invalid numeric values.";
    errorBox.classList.remove('hidden');
    placeholder.classList.add('hidden');
    resultValue.classList.add('hidden');
    return;
  }

  // Real-world validation ranges
  if (velocity < 0) errors.push("👉 Velocity cannot be negative.");
  if (velocity > 343) warnings.push("⚠️ Velocity exceeds the speed of sound — check units.");
  if (area <= 0) errors.push("👉 Area must be greater than zero.");
  if (area > 10000) warnings.push("⚠️ Unusually large area — verify units.");

  let density = 1.20;
  if (densityRaw !== "") {
    const d = parseFloat(densityRaw);
    if (!Number.isFinite(d) || d <= 0) {
      warnings.push("⚠️ Invalid density entered, using default 1.20 kg/m³.");
    } else if (d < 0.8 || d > 1.4) {
      warnings.push("⚠️ Density outside typical atmospheric range (0.8–1.4).");
      density = d;
    } else {
      density = d;
    }
  }

  if (errors.length > 0) {
    errorMessage.innerHTML = errors.join("<br>");
    errorBox.classList.remove('hidden');
    placeholder.classList.add('hidden');
    resultValue.classList.add('hidden');
    return;
  }

  // Calculations
  const volumetricFlow = velocity * area;
  const massFlow = volumetricFlow * density;

  // Output
  rateEl.textContent = volumetricFlow.toFixed(3);

  let feedback = "";
  if (volumetricFlow === 0) feedback = "❗ No airflow detected.";
  else if (volumetricFlow < 5) feedback = "⚠️ Low airflow. May be insufficient for larger spaces.";
  else if (volumetricFlow <= 20) feedback = "✅ Moderate airflow. Typical for many ventilation applications.";
  else feedback = "🌟 High airflow. Strong ventilation capacity.";

  let details = `<div style="margin-top:6px;">Volumetric flow: <b>${volumetricFlow.toFixed(3)} m³/s</b><br>`;
  details += `Mass flow (ρ=${density.toFixed(3)} kg/m³): <b>${massFlow.toFixed(3)} kg/s</b></div>`;

  if (warnings.length) details += `<div style="margin-top:6px; font-size:0.9em; color:#b35d00;">Note: ${warnings.join(" | ")}</div>`;

  feedbackEl.innerHTML = `<div>${feedback}</div>${details}`;

  placeholder.classList.add('hidden');
  resultValue.classList.remove('hidden');
  errorBox.classList.add('hidden');
}

function printReport() {
  const el = document.getElementById('printDate');
  if (el) {
    const now = new Date();
    const options = { year: 'numeric', month: 'long', day: 'numeric' };
    el.textContent = now.toLocaleDateString('en-IN', options);
  }
  window.print();
}
</script>

        <script src="{% static 'js/print.js' %}"></script>



<!-- Font Awesome -->
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
{% endblock %}


 