{% extends 'base.html' %}
{% block title %}Mean Steam Consumption  Of a Flow-Type Application caluculator (2){% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mean Steam Consumption  Of a Flow-Type Application caluculator (2)</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .back-btn {
            background: linear-gradient(#1560bd, #000040);
            color: #ffffff;
            border: 2px solid #1560bd;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd;
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05);
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }

        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd, #000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center;
            flex-wrap: wrap;
        }

        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
            line-height: 1.1;
        }

        .rate-label { 
            color: #7f8c8d;
            font-size: 20px;
            font-weight: bold;
        }

        /* Responsive styles */
        @media (max-width: 1200px) {
            .rate-value {
                font-size: 38px;
            }
            .rate-label {
                font-size: 18px;
            }
        }
        
        @media (max-width: 992px) {
            .rate-value {
                font-size: 34px;
            }
            .rate-label {
                font-size: 17px;
            }
        }
        
        @media (max-width: 768px) {
            .rate-value {
                font-size: 30px;
                margin-bottom: 8px;
            }
            .rate-label {
                font-size: 16px;
            }
        }
        
        @media (max-width: 576px) {
            .rate-value {
                font-size: 28px;
                margin-bottom: 6px;
            }
            .rate-label {
                font-size: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .rate-display {
                flex-direction: column;
                gap: 2px;
                text-align: center;
            }
            .rate-value {
                font-size: 24px;
                margin-bottom: 4px;
            }
            .rate-label {
                font-size: 14px;
            }
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

    <div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>


<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}


<div class="calculator-header">
    <h1>Mean Steam Consumption  Of a Flow-Type Application caluculator (2)</h1>
    <p>Calculate the <strong>Mean Steam Consumption Rate (kg/s)</strong> required to supply a given heat transfer duty.</p>
</div>

<div class="calc-content">
    <!-- Calculator -->
    <div class="calc-card">
        <h2>Enter Data</h2>

        <div class="form-group">
            <label for="heatTransfer">Mean Heat Transfer Rate (Q) — <em>kW</em></label>
            <input type="number" id="heatTransfer" class="form-input" step="any" min="0.0001" placeholder="e.g., 100">
        </div>

        <div class="form-group">
            <label for="enthalpy">Specific Enthalpy of Evaporation (h<sub>fg</sub>) — <em>kJ/kg</em></label>
            <input type="number" id="enthalpy" class="form-input" step="any" min="0.01" placeholder="e.g., 2257">
        </div>

        <button class="calculate-btn" onclick="calculateSteamConsumption()">Calculate Mean Steam Consumption</button>
    </div>

    <!-- Result Section -->
    <div class="result-card">
        <div class="result-placeholder" id="placeholder">
            <img src="/static/images/mlc_environment_result.png" alt="steam illustration">
            <p>This tool will calculate the <strong>mean steam consumption rate (kg/s)</strong> for your duty.</p>
        </div>

        <div class="result-error hidden" id="resultError">
            <div class="error-icon">❌</div>
            <div class="error-message" id="errorMessage"></div>
        </div>

        <div class="result-value hidden" id="resultValue">
            <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                <h2>Calculated Mean Steam Consumption</h2>
            </div>

            <div class="rate-display">
                <div class="rate-value" id="rateValue">0.0000</div>
                <div class="rate-label" style="color:#2980b9; font-size:20px; font-weight:bold;">kg/s</div>
            </div>

            <div style="margin-top:8px;">
                <div><strong>Equivalent:</strong> <span id="ratePerHour">0.00</span> kg/hr</div>
            </div>

            <div class="result-feedback">
                <div class="feedback-title">Assessment</div>
                <div class="feedback-content" id="feedbackContent"></div>
            </div>

            <div class="btn-wrapper">
                <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
            </div>
        </div>
    </div>
</div>

<div class="note-section">

  <div class="note-card">
    <h3>📘 About This Calculator</h3>
    <p>
      This calculator estimates the <strong>mean steam consumption rate</strong>, i.e., the steam mass flow required to achieve a specified heat transfer rate. 
      It is designed for use with consistent SI units: <strong>Heat Transfer Rate (Q) in kW (equivalent to kJ/s)</strong> and 
      <strong>Specific Enthalpy of Evaporation (h<sub>fg</sub>) in kJ/kg</strong>.
    </p>
  </div>

  <div class="note-card">
    <h3>⚙ Parameters Used</h3>
    <ul class="note-list">
      <li><strong>Q</strong>: Mean Heat Transfer Rate [kW = kJ/s]</li>
      <li><strong>h<sub>fg</sub></strong>: Specific Enthalpy of Evaporation [kJ/kg]</li>
      <li><strong>ṁ<sub>s</sub></strong>: Steam Consumption [kg/s]</li>
      <li><strong>ṁ<sub>s</sub> per hour</strong>: Steam Consumption [kg/hr]</li>
      <li><strong>Formula</strong>: ṁ<sub>s</sub> = Q / h<sub>fg</sub></li>
    </ul>
  </div>

  <div class="note-card">
    <h3>✅ Input Validation Rules</h3>
    <ul class="note-list">
      <li><strong>Q (kW)</strong>: required, positive. Typical range 1 – 1000. Allowed range 0.01 – 10,000.</li>
      <li><strong>h<sub>fg</sub> (kJ/kg)</strong>: required, positive. Typical ~2000–2500. Allowed range 100 – 10,000.</li>
      <li>Precision: ≤4 decimal places recommended, higher precision triggers a warning.</li>
      <li>Units: Q must be in kW (kJ/s), h<sub>fg</sub> in kJ/kg. Wrong units will give unrealistic results.</li>
      <li>Cross-check: very low h<sub>fg</sub> (&lt;500) often means you entered J/kg instead of kJ/kg.</li>
    </ul>
  </div>

  <div class="note-card">
    <h3>🔎 Output & Validation</h3>
    <ul class="note-list">
      <li>Computed <strong>ṁ<sub>s</sub> (kg/s)</strong> and <strong>ṁ<sub>s</sub> (kg/hr)</strong> are displayed.</li>
      <li>Plausibility checks:
        <ul>
          <li>ṁ<sub>s</sub> &lt; 0.0001 → ⚠️ Extremely small, possible unit mismatch.</li>
          <li>ṁ<sub>s</sub> &gt; 10 → ⚠️ Very high steam demand — review boiler capacity.</li>
          <li>ṁ<sub>s</sub> &gt; 1000 → ❌ Implausible, usually wrong units.</li>
        </ul>
      </li>
      <li><strong>Assessment / Feedback</strong> shown along with result:
        <ul>
          <li>ṁ<sub>s</sub> &lt; 0.01 → 🔎 Small system duty — lab/pilot-scale or unit mismatch.</li>
          <li>0.01 ≤ ṁ<sub>s</sub> ≤ 10 → ✅ Typical industrial heating duty.</li>
          <li>ṁ<sub>s</sub> &gt; 10 → ⚠️ Very large duty — ensure boiler and safety systems are adequate.</li>
        </ul>
      </li>
      <li>Warnings shown if Q, h<sub>fg</sub>, or computed values fall outside typical ranges.</li>
    </ul>
  </div>

  <div class="note-card">
    <h3>📐 Governing Principle</h3>
    <p>
      There isn't a single, universal "standard" for calculating the mean steam consumption of a flow-type application calculator; instead, it relies on industry-specific engineering principles and practices, such as those provided by Spirax Sarco's guidelines for calculating steam consumption in heat exchangers. 
      The calculation method involves applying heat transfer equations based on the thermal output of the plant or device, with typical flow-type applications including shell and tube heat exchangers and plate heat exchangers.
    </p>
    <p><strong>Key principles and factors:</strong></p>
    <ul class="note-list">
      <li><strong>Heat Transfer Equations:</strong> Calculations use heat transfer principles to determine the thermal load of equipment.</li>
      <li><strong>Full Load Basis:</strong> Heat exchangers are often sized on full running load, sometimes with safety factors.</li>
      <li><strong>Typical Applications:</strong> Shell & tube and plate heat exchangers.</li>
      <li><strong>Ignores Start-up Load:</strong> Start-up duty may be omitted if rare or non-critical.</li>
      <li><strong>Measurement:</strong> Direct steam flowmeter readings on an operating unit can also be used.</li>
    </ul>
    <p>
      In essence, you'd use recognized engineering principles for the specific type of flow-type application to estimate its steam demand.
    </p>
  </div>

  <div class="note-card">
    <h3>📝 Conclusion</h3>
    <p>
      This steam consumption calculator helps determine mean steam demand for flow-type heating duties. 
      By ensuring correct inputs, reviewing warnings, and interpreting the assessment/feedback provided with the results, engineers can validate steam supply capacity, design efficient systems, and maintain QEHS compliance.
    </p>
  </div>

</div>


<script>
/* Show error messages - keeps UI behavior consistent */
function showErrors(errors) {
  const errorBox = document.getElementById("resultError");
  const errorMessage = document.getElementById("errorMessage");
  const placeholder = document.getElementById("placeholder");
  const resultValue = document.getElementById("resultValue");
  errorMessage.innerHTML = errors.join("<br>");
  errorBox.classList.remove("hidden");
  placeholder.classList.add("hidden");
  resultValue.classList.add("hidden");
}

/* Main calculation + validations */
function calculateSteamConsumption() {
  const Qraw = (document.getElementById("heatTransfer").value || "").trim();
  const hfgraw = (document.getElementById("enthalpy").value || "").trim();

  const placeholder = document.getElementById("placeholder");
  const errorBox = document.getElementById("resultError");
  const errorMessage = document.getElementById("errorMessage");
  const resultValue = document.getElementById("resultValue");
  const rateEl = document.getElementById("rateValue");
  const rateHourEl = document.getElementById("ratePerHour");
  const feedbackEl = document.getElementById("feedbackContent");

  // Reset UI
  errorBox.classList.add("hidden");
  errorMessage.innerHTML = "";
  feedbackEl.innerHTML = "";

  const errors = [];
  const warnings = [];

  // Required checks
  if (Qraw === "") errors.push("👉 Please enter the Mean Heat Transfer Rate (Q) in kW.");
  if (hfgraw === "") errors.push("👉 Please enter the Specific Enthalpy of Evaporation (h\u209bfg) in kJ/kg.");
  if (errors.length) return showErrors(errors);

  // Parse numbers
  const Q = parseFloat(Qraw);
  const hfg = parseFloat(hfgraw);

  // Basic numeric validation
  if (!Number.isFinite(Q) || Q <= 0) errors.push("👉 Q must be a positive number (kW). Example: 100");
  if (!Number.isFinite(hfg) || hfg <= 0) errors.push("👉 h\u209bfg must be a positive number (kJ/kg). Example: 2257");
  if (errors.length) return showErrors(errors);

  // Friendly range checks (hard limits + typical ranges)
  if (Q < 0.01 || Q > 10000) {
    errors.push("👉 Q appears outside expected operational bounds. Enter Q between 0.01 and 10,000 kW (typical: 1–1000 kW).");
  }
  if (hfg < 100 || hfg > 10000) {
    errors.push("👉 h\u209bfg appears outside expected bounds. Enter h\u209bfg between 100 and 10,000 kJ/kg (typical steam values ≈ 2000–2500 kJ/kg).");
  }
  if (errors.length) return showErrors(errors);

  // Decimal precision warning
  const decimals = s => ((String(s).split('.')[1] || '').length);
  if (decimals(Q) > 4 || decimals(hfg) > 4) {
    warnings.push("⚠️ High input precision detected — round to ≤4 decimals for reporting consistency.");
  }

  // Cross-field logical checks
  if (hfg < 500) {
    warnings.push("⚠️ h\u209bfg is unusually small — check units: did you enter J/kg instead of kJ/kg?");
  }
  if (Q > 1000) {
    warnings.push("⚠️ Large Q — ensure system and boiler capacity are adequate and safety devices (pressure relief, traps) are in place.");
  }

  // Calculation (1 kW = 1 kJ/s)
  // ṁ_s (kg/s) = Q (kJ/s) / h_fg (kJ/kg)
  const ms = Q / hfg;

  if (!Number.isFinite(ms) || ms <= 0) {
    return showErrors(["⚠️ Computed steam consumption is invalid. Re-check input values and units (Q in kW, h\u209bfg in kJ/kg)."]);
  }

  // Plausibility checks on the result
  if (ms > 1000) {
    return showErrors([
      "⚠️ Computed steam consumption is implausibly large for typical systems.",
      "👉 Double-check units: Q should be in kW (kJ/s) and h\u209bfg in kJ/kg. Large results often mean units mismatch."
    ]);
  }
  if (ms > 10) warnings.push("⚠️ High steam demand (>10 kg/s) — review boiler capacity, condensate return and pressure/relief arrangements.");
  if (ms < 0.0001) warnings.push("⚠️ Extremely small steam demand (<0.0001 kg/s) — may indicate negligible duty or input unit mismatch.");

  // Assessment text
  let status = "";
  if (ms < 0.01) status = "🔎 Small system duty — lab/pilot-scale or check units.";
  else if (ms < 10) status = "✅ Typical industrial heating duty.";
  else status = "⚠️ Very large duty — ensure boiler and safety systems are adequate.";

  // Prepare details and display
  const msPerHour = ms * 3600;
  rateEl.textContent = ms.toFixed(4);
  rateHourEl.textContent = msPerHour.toFixed(2);

  let details = `<div>Mean steam consumption (ṁₛ): <b>${ms.toFixed(4)}</b> kg/s</div>`;
  if (warnings.length) {
    details += `<div style="margin-top:6px; color:#b35d00; font-size:0.95em;">${warnings.join(" | ")}</div>`;
  }

  feedbackEl.innerHTML = `<div>${status}</div>${details}`;
  placeholder.classList.add("hidden");
  resultValue.classList.remove("hidden");
  errorBox.classList.add("hidden");
}

/* Print helper - kept for parity with design */
function printReport() {
  const el = document.getElementById('printDate');
  if (el) {
    el.textContent = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
  }
  window.print();
}
</script>

    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- /*
===========================================
Steam Consumption from Heat Transfer Calculator (2)
===========================================

📌 Formula:
    ṁₛ = Q / hfg

    where:
      Q    = Mean Heat Transfer Rate (kW = kJ/s)
      hfg  = Specific Enthalpy of Evaporation (kJ/kg)
      ṁₛ   = Steam Consumption (kg/s)

    ⚡ Note: 1 kW = 1 kJ/s

-------------------------------------------
✅ Input Requirements & Validations:

1. Required inputs:
   - Heat Transfer Rate (Q, kW)  
   - Latent Heat of Steam (hfg, kJ/kg)  

2. Basic validation:
   - Both Q and hfg must be > 0.  
   - If empty or invalid → error shown.  

3. Hard range checks:
   - Q: must be between 0.01 and 10,000 kW  
     (typical: 1 – 1000 kW)  
   - hfg: must be between 100 and 10,000 kJ/kg  
     (typical steam ≈ 2000 – 2500 kJ/kg)  

4. Precision check:
   - Warn if input has > 4 decimals.  

-------------------------------------------
⚠️ Warnings / Plausibility Checks:

- hfg < 500 → likely entered in J/kg instead of kJ/kg.  
- Q > 1000 → very large duty, ensure boiler/system capacity.  
- Result > 1000 kg/s → implausible, usually unit mismatch.  
- Result > 10 kg/s → warn about high steam demand.  
- Result < 0.0001 kg/s → warn about negligible duty / mismatch.  

-------------------------------------------
📊 Output:

- Steam Consumption (kg/s)  
- Equivalent Steam Consumption (kg/hr)  
- Input summary (Q, hfg)  
- Warning messages (if applicable)  
- System assessment:

    • < 0.01 → 🔎 Small system duty (lab/pilot scale or unit error)  
    • 0.01 – 10 → ✅ Typical industrial heating duty  
    • > 10 → ⚠️ Very large duty (check boiler capacity & safety)  

-------------------------------------------
*/ -->
