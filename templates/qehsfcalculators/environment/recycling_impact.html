{% extends 'base.html' %}
{% block title %}Recycling impact calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recycling impact calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
<style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
             /* display: flex;  */
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
            /* overflow-y: auto;  */
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Input rows for better organization */
        .input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-row .form-group {
            flex: 1;
        }
        
        @media (max-width: 600px) {
            .input-row {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }

                .rate-display {
                display: flex;
                gap: 20px;
                justify-content: center;
                align-items: center;
                flex-wrap: wrap; /* responsive */
                text-align: center;
            }

            .rate-block {
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 120px; /* keeps blocks same width */
            }

            .rate-label {
                font-weight: bold;
                font-size: 16px;
                color: #444;
                margin-bottom: 5px;
            }

            .rate-value {
                font-size: 40px;
                font-weight: 700;
                color: #2980b9;
                line-height: 1.2;
            }

            .rate-unit {
                font-size: 14px;
                color: #777;
                margin-top: 4px;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .rate-value { font-size: 32px; }
            }

            @media (max-width: 480px) {
                .rate-value { font-size: 26px; }
                
                .rate-unit { font-size: 12px; }
                
            }



        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
                .result-feedback {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 18px 20px;
    border-left: 4px solid #3498db;
    text-align: left;
    max-width: 800px; /* keeps it readable on large screens */
    margin: 0 auto;   /* centers it */
}

.feedback-title {
    font-weight: 600;
    margin-bottom: 8px;
    color: #2c3e50;
    font-size: 18px;
}

.feedback-content { 
    color: #34495e; 
    font-size: 16px;
    line-height: 1.5;
}

/* Responsive breakpoints */
@media (max-width: 768px) {
    .result-feedback {
        padding: 15px;
        font-size: 15px;
    }

    .feedback-title {
        font-size: 16px;
    }

    .feedback-content {
        font-size: 14px;
    }
}

@media (max-width: 480px) {
    .result-feedback {
        padding: 12px;
        border-left-width: 3px;
    }

    .feedback-title {
        font-size: 15px;
    }

    .feedback-content {
        font-size: 13px;
    }
}

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

<div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>
<div class="calculator-container printable" id="printArea">


{% include "includes/print_header_footer.html" %}

<div class="calculator-header">
    <h1>Recycling Impact Calculator</h1>
    <p>Calculate environmental impact (energy saved, CO₂ saved, water saved, trees saved) based on the weight of materials recycled using industry-standard impact factors.</p>
</div>

<div class="calc-content">
    <div class="calc-card">
        <h2>Enter Material Weights</h2>
        <div class="input-row">
            <div class="form-group">
                <label for="mixedPaper">Mixed Paper (lbs)</label>
                <input type="number" id="mixedPaper" class="form-input" step="any" min="0" placeholder="e.g., 100">
            </div>
            <div class="form-group">
                <label for="plastic">Plastic (lbs)</label>
                <input type="number" id="plastic" class="form-input" step="any" min="0" placeholder="e.g., 50">
            </div>
        </div>

        <div class="input-row">
            <div class="form-group">
                <label for="glass">Glass (lbs)</label>
                <input type="number" id="glass" class="form-input" step="any" min="0" placeholder="e.g., 75">
            </div>
            <div class="form-group">
                <label for="aluminum">Aluminum (lbs)</label>
                <input type="number" id="aluminum" class="form-input" step="any" min="0" placeholder="e.g., 20">
            </div>
        </div>

        <button class="calculate-btn" onclick="calculateImpact()">Calculate Total Environmental Impact</button>
    </div>

    <div class="result-card">
        <div class="result-placeholder" id="placeholder">
            <img src="/static/images/mlc_environment_result.png" alt="recycling impact">
            <p>This tool calculates total environmental impact</p>
        </div>

        <div class="result-error hidden" id="resultError" role="alert" aria-live="polite">
            <div class="error-icon">❌</div>
            <div class="error-message" id="errorMessage"></div>
        </div>

        <div class="result-value hidden" id="resultValue" aria-live="polite">
            <div class="calculation-type">
                <h2>Total Environmental Impact</h2>
            </div>
            <div class="rate-display">
                <div class="rate-value" id="totalImpact">0.00</div>
                <div class="rate-label">units (weighted impact)</div>
            </div>
            <div class="result-feedback">
                <div class="feedback-title">Impact Breakdown</div>
                <div class="feedback-content" id="feedbackContent"></div>
            </div>

            <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
            </div>
        </div>
    </div>
</div>

<div class="note-section">

    <!-- About This Calculator -->
    <div class="note-card">
        <h3>📘 About This Calculator</h3>
        <p>
            This calculator estimates the environmental impact of recycling various materials. 
            It considers the weight of each material and standard impact factors to calculate the total positive effect on the environment, including CO₂ reduction, energy savings, and other key metrics.
        </p>
        <p>The results provide a cumulative assessment across all entered materials.</p>
    </div>

    <!-- Parameters Used -->
    <div class="note-card">
        <h3>⚙ Parameters Used</h3>
        <ul class="note-list">
            <li><b>Material:</b> Type of recyclable material (Mixed Paper, Plastic, Glass, Aluminum)</li>
            <li><b>Weight:</b> Mass of each material (lbs)</li>
            <li><b>Impact Factor:</b> Material-specific coefficient to calculate environmental contribution</li>
        </ul>
    </div>

    <!-- Input Validation Rules -->
    <div class="note-card">
        <h3>✅ Input Validation Rules</h3>
        <ul class="note-list">
            <li>Weight of each material must be numeric, ≥ 0, and ≤ 100,000 lbs</li>
            <li>Decimals allowed up to 2 places</li>
            <li>Zero weight is valid but does not contribute to total impact</li>
            <li>Missing or negative values trigger error messages</li>
        </ul>
    </div>

    <!-- Output Validations -->
    <div class="note-card">
    <h3>📊 Output Validations</h3>
    <ul class="note-list">
        <li>Total Impact: displayed to 2 decimal places</li>
        <li>Breakdown: shows each material’s contribution to the total impact</li>
        <li>Assessment/Feedback: displayed along with results based on total impact:
            <ul>
                <li>(0 – 50 units)Low environmental impact – small quantities recycled </li>
                <li>(50 – 200 units) Moderate environmental impact – good recycling effort. </li>
                <li>(200 – 500 units) High environmental impact – significant positive contribution </li>
                <li>Extreme environmental impact – very large quantities recycled, check inputs (&gt;500 units)</li>
            </ul>
        </li>
        <li>Warnings: displayed for extreme input values (e.g., any material weight &gt;50,000 lbs)</li>
        <li>Ensures inputs are validated and correct feedback is shown for errors or extreme values</li>
    </ul>
</div>


    <!-- Governing Principle -->
    <div class="note-card">
        <h3>📐 Governing Principle</h3>
        <p>
            There is no single "standard" for recycling impact calculators; instead, various tools adhere to established methodologies like 
            <b>Life Cycle Assessment (LCA) standards</b> (ISO 14040/14044), <b>Greenhouse Gas (GHG) Protocol</b>, and other industry-specific guidelines 
            to quantify environmental benefits such as reduced greenhouse gas emissions, water usage, and resource conservation. 
        </p>
        <p><b>Common Methodologies and Standards:</b></p>
        <ul class="note-list">
            <li><b>LCA Standards (ISO 14040/14044):</b> Evaluate environmental impacts of products/processes throughout their life cycle.</li>
            <li><b>GHG Protocol:</b> Framework for calculating carbon footprints and water impacts.</li>
            <li><b>ISO 14021:</b> Defines how environmental claims and labels should be documented.</li>
            <li><b>Product/Corporate LCAs:</b> Used to measure specific impacts like carbon emissions or water use at product or facility level.</li>
            <li><b>Regional/Program-Specific Methods:</b> Some calculators use their own methodologies based on local data and averages.</li>
        </ul>
        <p><b>Factors Influencing Standard Used:</b></p>
        <ul class="note-list">
            <li>Type of Waste (electronic, office, food waste, etc.)</li>
            <li>Scope of Impact (carbon, water, resource recovery)</li>
            <li>Target Audience (business, consumer, government programs)</li>
        </ul>
    </div>

    <!-- Conclusion -->
    <div class="note-card">
        <h3>🔎 Conclusion</h3>
        <p>
            This calculator provides a cumulative environmental impact for the entered materials, displaying the total and a breakdown 
            for each material. Assessment and feedback are included, along with warnings for extreme weights. 
            The results help users understand the environmental benefits of recycling and support sustainability tracking.
        </p>
    </div>

</div>


<script>
function showErrors(errors) {
    const errorBox = document.getElementById("resultError");
    const errorMessage = document.getElementById("errorMessage");
    const placeholder = document.getElementById("placeholder");
    const resultValue = document.getElementById("resultValue");

    errorMessage.innerHTML = errors.join("<br>");
    errorBox.classList.remove("hidden");
    placeholder.classList.add("hidden");
    resultValue.classList.add("hidden");
}

function calculateImpact() {
    // Read input values
    const weights = {
        mixedPaper: parseFloat(document.getElementById("mixedPaper").value.trim()) || 0,
        plastic: parseFloat(document.getElementById("plastic").value.trim()) || 0,
        glass: parseFloat(document.getElementById("glass").value.trim()) || 0,
        aluminum: parseFloat(document.getElementById("aluminum").value.trim()) || 0
    };

    // Impact factors per lb (example values)
    const factors = {
        mixedPaper: { impact: 0.05, co2: 0.03, energy: 0.10, water: 0.05, trees: 0.002 },
        plastic:    { impact: 0.10, co2: 0.07, energy: 0.20, water: 0.03, trees: 0 },
        glass:      { impact: 0.07, co2: 0.04, energy: 0.12, water: 0.02, trees: 0 },
        aluminum:   { impact: 0.12, co2: 0.09, energy: 0.25, water: 0.01, trees: 0 }
    };

    const errors = [];
    const warnings = [];

    // Validation & Warnings
    for (const [material, value] of Object.entries(weights)) {
        if (!Number.isFinite(value)) errors.push(`👉 ${material} must be numeric.`);
        if (value < 0) errors.push(`👉 ${material} must be ≥ 0.`);
        if (value > 50000) warnings.push(`⚠️ ${material} is very high; verify input accuracy.`);
        if (value > 100000) errors.push(`👉 ${material} exceeds maximum realistic value.`);
    }

    if (errors.length) return showErrors(errors);

    // Calculate total impact and breakdown
    let totalImpact = 0, totalCO2 = 0, totalEnergy = 0, totalWater = 0, totalTrees = 0;
    let breakdown = "";

    for (const material in weights) {
        const w = weights[material];
        const f = factors[material];
        const impact = w * f.impact;
        const co2 = w * f.co2;
        const energy = w * f.energy;
        const water = w * f.water;
        const trees = w * f.trees;

        totalImpact += impact;
        totalCO2 += co2;
        totalEnergy += energy;
        totalWater += water;
        totalTrees += trees;

        breakdown += `<div><b>${material}</b>: Impact=${impact.toFixed(2)}, CO₂=${co2.toFixed(2)}, Energy=${energy.toFixed(2)}, Water=${water.toFixed(2)}, Trees=${trees.toFixed(3)}</div>`;
    }

    // Assessment message
    let assessment = "";
    if (totalImpact === 0) assessment = "⚠️ No impact detected – enter weights for materials.";
    else if (totalImpact < 50) assessment = "✅ Low environmental impact – small quantities recycled.";
    else if (totalImpact <= 200) assessment = "✅ Moderate environmental impact – good recycling effort.";
    else assessment = "✅ High environmental impact – significant positive contribution.";

    // Combine feedback
    let feedbackHTML = `<div>${breakdown}</div>`;
    feedbackHTML += `<div style="margin-top:6px; font-weight:bold;">${assessment}</div>`;
    if (warnings.length) feedbackHTML += `<div style="margin-top:6px; color:#b35d00; font-size:0.95em;">${warnings.join(" | ")}</div>`;

    // Display results
    document.getElementById("totalImpact").textContent = totalImpact.toFixed(2);
    document.getElementById("feedbackContent").innerHTML = feedbackHTML;
    document.getElementById("placeholder").classList.add("hidden");
    document.getElementById("resultValue").classList.remove("hidden");
    document.getElementById("resultError").classList.add("hidden");
}

function printReport() {
    const el = document.getElementById('printDate');
    if (el) {
        el.textContent = new Date().toLocaleDateString('en-US', { year:'numeric', month:'long', day:'numeric' });
    }
    window.print();
}
</script>
>


<script src="{% static 'js/print.js' %}"></script>

</body>
</html>
{% endblock %}



<!-- 
📌 Environmental Impact Calculator Notes

🔹 Formula Used:
    Impact per material = Weight × Factor
    Total Impact = Σ (Weight × Factor)
    where:
      Weight  = mass of material (kg)
      Factor  = material-specific impact coefficient
        - Mixed Paper: 0.05
        - Plastic: 0.10
        - Glass: 0.07
        - Aluminum: 0.12

🔹 Input Validations:
    • Each material weight:
        - Must be numeric
        - Must be ≥ 0
        - Warning/Error if > 100,000 kg (unrealistic)
    • Missing values default to 0

🔹 Output Notes:
    • Total Impact = sum of individual material impacts
    • Breakdown shows each material’s contribution to the total
    • Display formatted to two decimal places
-->
