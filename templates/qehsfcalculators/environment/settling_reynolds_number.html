{% extends 'base.html' %}
{% block title %}Settling Reynolds Number Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settling Reynolds Number Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
             /* display: flex;  */
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
            /* overflow-y: auto;  */
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Input rows for better organization */
        .input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-row .form-group {
            flex: 1;
        }
        
        @media (max-width: 600px) {
            .input-row {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }

                .rate-display {
                display: flex;
                gap: 20px;
                justify-content: center;
                align-items: center;
                flex-wrap: wrap; /* responsive */
                text-align: center;
            }

            .rate-block {
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 120px; /* keeps blocks same width */
            }

            .rate-label {
                font-weight: bold;
                font-size: 16px;
                color: #444;
                margin-bottom: 5px;
            }

            .rate-value {
                font-size: 40px;
                font-weight: 700;
                color: #2980b9;
                line-height: 1.2;
            }

            .rate-unit {
                font-size: 14px;
                color: #777;
                margin-top: 4px;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .rate-value { font-size: 32px; }
            }

            @media (max-width: 480px) {
                .rate-value { font-size: 26px; }
                
                .rate-unit { font-size: 12px; }
                
            }



        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
                .result-feedback {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 18px 20px;
    border-left: 4px solid #3498db;
    text-align: left;
    max-width: 800px; /* keeps it readable on large screens */
    margin: 0 auto;   /* centers it */
}

.feedback-title {
    font-weight: 600;
    margin-bottom: 8px;
    color: #2c3e50;
    font-size: 18px;
}

.feedback-content { 
    color: #34495e; 
    font-size: 16px;
    line-height: 1.5;
}

/* Responsive breakpoints */
@media (max-width: 768px) {
    .result-feedback {
        padding: 15px;
        font-size: 15px;
    }

    .feedback-title {
        font-size: 16px;
    }

    .feedback-content {
        font-size: 14px;
    }
}

@media (max-width: 480px) {
    .result-feedback {
        padding: 12px;
        border-left-width: 3px;
    }

    .feedback-title {
        font-size: 15px;
    }

    .feedback-content {
        font-size: 13px;
    }
}

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

<div class="btn-container">
    <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
</div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <div class="calculator-header">
        <h1>Settling Reynolds Number Calculator</h1>
        <p>Calculate the Reynolds Number (Re) to determine fluid flow regime (laminar, transitional, or turbulent).</p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Parameters</h2>

            <div class="input-row">
                <div class="form-group">
                    <label for="density">Density (ρ, kg/m³)</label>
                    <input type="number" id="density" class="form-input" step="any" min="0" placeholder="e.g., 1000 (water)">
                </div>
                <div class="form-group">
                    <label for="velocity">Velocity (v, m/s)</label>
                    <input type="number" id="velocity" class="form-input" step="any" min="0" placeholder="e.g., 1.5">
                </div>
            </div>

            <div class="input-row">
                <div class="form-group">
                    <label for="diameter">Diameter (d, m)</label>
                    <input type="number" id="diameter" class="form-input" step="any" min="0" placeholder="e.g., 0.1">
                </div>
                <div class="form-group">
                    <label for="viscosity">Dynamic Viscosity (μ, Pa·s)</label>
                    <input type="number" id="viscosity" class="form-input" step="any" min="0" placeholder="e.g., 0.001 (water)">
                </div>
            </div>

            <button class="calculate-btn" onclick="calculateReynolds()">Calculate Reynolds Number</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <div class="result-placeholder" id="placeholder">
                <img src="/static/images/mlc_environment_result.png" alt="Fluid flow illustration">
                <p>This tool evaluates fluid flow regime for engineering and safety applications.</p>
            </div>

            <div class="result-error hidden" id="resultError">
                <div class="error-icon">❌</div>
                <div class="error-message" id="errorMessage"></div>
            </div>

            <div class="result-value hidden" id="resultValue">
                <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                    <h2>Reynolds Number (Re)</h2>
                </div>

                <div class="rate-display">
                    <div class="rate-value" id="reynoldsValue">0</div>
                    <div class="rate-label">(dimensionless)</div>
                </div>

                <div class="result-feedback">
                    <div class="feedback-title"> Assessment</div>
                    <div class="feedback-content" id="feedbackContent"></div>
                </div>

                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notes -->
    <div class="note-section">

    <div class="note-card">
        <h3>📘 About This Calculator</h3>
        <p>
            The <strong>Settling Reynolds Number Calculator</strong> determines the flow regime of a fluid in a pipe or duct, 
            which is essential for predicting flow behavior, pressure drop, and mixing efficiency.  
            The Reynolds number is a dimensionless quantity that indicates whether flow is laminar, transitional, or turbulent.
        </p>
    </div>


    <div class="note-card">
        <h3>⚙ Parameters Used</h3>
        <ul class="note-list">
            <li><strong>ρ (Density):</strong> Mass per unit volume of the fluid (kg/m³).</li>
            <li><strong>v (Velocity):</strong> Average flow velocity of the fluid (m/s).</li>
            <li><strong>d (Diameter):</strong> Characteristic length (for pipes, the internal diameter) in meters.</li>
            <li><strong>μ (Dynamic Viscosity):</strong> Measure of a fluid's resistance to flow (Pa·s).</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>✅ Input Validation Rules</h3>
        <ul class="note-list">
            <li><strong>All values:</strong> Must be positive numbers greater than zero.</li>
            <li><strong>Density (ρ):</strong> Typical range 0.1-20000 kg/m³ (air ~1.2, water ~1000, mercury ~13500).</li>
            <li><strong>Velocity (v):</strong> Typical range 0.001-100 m/s for most engineering applications.</li>
            <li><strong>Diameter (d):</strong> Typical range 0.001-10 m (1mm to 10m pipes).</li>
            <li><strong>Viscosity (μ):</strong> Typical range 0.00001-10 Pa·s (air ~0.000018, water ~0.001, honey ~10).</li>
            <li><strong>Division by zero:</strong> Viscosity cannot be zero.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>🔎 Output Validations Rules</h3>
        <ul class="note-list">
            <li><strong>Re &lt; 2300:</strong> ✅ Laminar flow (smooth, orderly flow with parallel streamlines.)</li>
            <li><strong>2300 ≤ Re ≤ 4000:</strong> ⚠️ Transitional flow (unpredictable behavior between laminar and turbulent.)</li>
            <li><strong>Re &gt; 4000:</strong> ❌ Turbulent flow (chaotic, mixed flow with eddies and vortices.)</li>
            <li><strong>Re &gt; 10,000:</strong> 🌪️ Fully developed turbulence</li>
            <li><strong>Re &gt; 1,000,000:</strong> ⚠️ Extreme turbulence - check input values</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>📏 Standards & compliance</h3>
        <ul class="note-list">
            <li>✔️ Used in pipe flow calculations per <strong>ASME, API, and ISO standards</strong></li>
            <li>✔️ Critical for <strong>HVAC system design</strong> and pump selection</li>
            <li>✔️ Essential in <strong>chemical process engineering</strong> for reactor design</li>
            <li>✔️ Determines <strong>heat transfer coefficients</strong> in thermal systems</li>
            <li>✔️ Used in <strong>fire safety engineering</strong> for sprinkler system design</li>
            <li>✔️ Important for <strong>environmental engineering</strong> in water treatment</li>
        </ul>
    </div>
<div class="note-card">
    <h3>📝 Conclusion</h3>
    <p>
        The <strong> Settling Reynolds Number (Re)</strong> is a key parameter in fluid mechanics to 
        identify the flow regime. It helps engineers and designers ensure safe, 
        efficient, and optimized system performance in applications such as 
        pipelines, HVAC, reactors, and environmental processes. 
        Accurate estimation of <b>Re</b> supports better design decisions, 
        energy efficiency, and safety compliance.
    </p>
</div>

</div>
<script>
function showErrors(errors) {
    const errorBox = document.getElementById("resultError");
    const errorMessage = document.getElementById("errorMessage");
    const placeholder = document.getElementById("placeholder");
    const resultValue = document.getElementById("resultValue");

    errorMessage.innerHTML = errors.join("<br>");
    errorBox.classList.remove("hidden");
    placeholder.classList.add("hidden");
    resultValue.classList.add("hidden");
}

function calculateReynolds() {
    // Read values
    const density = parseFloat(document.getElementById("density").value);
    const velocity = parseFloat(document.getElementById("velocity").value);
    const diameter = parseFloat(document.getElementById("diameter").value);
    const viscosity = parseFloat(document.getElementById("viscosity").value);

    const reynoldsEl = document.getElementById("reynoldsValue");
    const feedbackEl = document.getElementById("feedbackContent");
    document.getElementById("resultError").classList.add("hidden");
    feedbackEl.innerHTML = "";

    const errors = [];
    const warnings = [];

    // Validation
    if (![density, velocity, diameter, viscosity].every(Number.isFinite)) {
        return showErrors(["👉 Please enter all values (numeric)."]);
    }
    
    if (density <= 0) errors.push("👉 Density must be greater than zero.");
    if (velocity <= 0) errors.push("👉 Velocity must be greater than zero.");
    if (diameter <= 0) errors.push("👉 Diameter must be greater than zero.");
    if (viscosity <= 0) errors.push("👉 Viscosity must be greater than zero.");
    
    // Range validation with warnings
    if (density < 0.1 || density > 20000) warnings.push("⚠️ Density outside typical range (0.1-20000 kg/m³).");
    if (velocity < 0.001 || velocity > 100) warnings.push("⚠️ Velocity outside typical range (0.001-100 m/s).");
    if (diameter < 0.001 || diameter > 10) warnings.push("⚠️ Diameter outside typical range (0.001-10 m).");
    if (viscosity < 0.00001 || viscosity > 10) warnings.push("⚠️ Viscosity outside typical range (0.00001-10 Pa·s).");

    if (errors.length) return showErrors(errors);

    // Formula: Re = (ρ × v × d) / μ
    const Re = (density * velocity * diameter) / viscosity;

    if (!Number.isFinite(Re)) {
        return showErrors(["⚠️ Computed Reynolds number is invalid."]);
    }

    // Classification
    let classification, suggestion, color;
    if (Re < 2300) {
        classification = "Laminar Flow";
        suggestion = "✅ Smooth, orderly flow with parallel streamlines.";
        color = "#2e7d32";
    } else if (Re >= 2300 && Re <= 4000) {
        classification = "Transitional Flow";
        suggestion = "⚠️ Unpredictable behavior between laminar and turbulent.";
        color = "#f9a825";
    } else {
        classification = "Turbulent Flow";
        suggestion = "❌ Chaotic, mixed flow with eddies and vortices.";
        color = "#c62828";
    }

    // Additional classification for extreme values
    if (Re > 10000) {
        classification += " (Fully Developed Turbulence)";
    }
    if (Re > 1000000) {
        warnings.push("⚠️ Extremely high Reynolds number - verify input values.");
    }

    // Display result
    reynoldsEl.textContent = Re.toFixed(0);
    feedbackEl.innerHTML = `
        <div>Re = <b>${Re.toFixed(0)}</b> (dimensionless)</div>
        <div>Flow Regime: <b style="color:${color};">${classification}</b></div>
        <div style="margin-top:6px;">${suggestion}</div>
        ${warnings.length ? `<div style="margin-top:8px; color:#b35d00;">${warnings.join(" | ")}</div>` : ""}
    `;

    document.getElementById("placeholder").classList.add("hidden");
    document.getElementById("resultValue").classList.remove("hidden");
}

function printReport() {
    const el = document.getElementById('printDate');
    if (el) el.textContent = new Date().toLocaleDateString();
    window.print();
}
</script>
<script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--
Input Validations:
All inputs must be positive numbers > 0

Density: 0.1-20000 kg/m³ (typical range)

Velocity: 0.001-100 m/s (typical range)

Diameter: 0.001-10 m (typical range)

Viscosity: 0.00001-10 Pa·s (typical range)

Division by zero protection for viscosity
--------------------------------------------------------------------------------------------
Output Validations:
Reynolds number must be finite

Classification based on standard ranges:

Re < 2300: Laminar flow

2300 ≤ Re ≤ 4000: Transitional flow

Re > 4000: Turbulent flow

Warnings for extreme values (Re > 1,000,000)

--------------------------------------------------------------------------------
Edge Cases:
Zero viscosity → Error (division by zero)

Extremely high Reynolds numbers → Warning

Values outside typical ranges → Warnings

Negative values → Error

Non-numeric inputs → Error
------------------------------------------------------------------------------------
FAORMULA:
Re = (ρ × v × d) / μ


Where:

Re = Reynolds Number (dimensionless)

ρ = Density of the fluid (kg/m³)

v = Velocity of the fluid (m/s)

d = Characteristic diameter (m)

μ = Dynamic viscosity (Pa·s)


-->