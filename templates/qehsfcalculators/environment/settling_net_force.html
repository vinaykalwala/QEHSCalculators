{% extends 'base.html' %}
{% block title %}Settling Net Force Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settling Net Force Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        
/* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
             /* display: flex;  */
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
            /* overflow-y: auto;  */
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Input rows for better organization */
        .input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-row .form-group {
            flex: 1;
        }
        
        @media (max-width: 600px) {
            .input-row {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }

                .rate-display {
                display: flex;
                gap: 20px;
                justify-content: center;
                align-items: center;
                flex-wrap: wrap; /* responsive */
                text-align: center;
            }

            .rate-block {
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 120px; /* keeps blocks same width */
            }

            .rate-label {
                font-weight: bold;
                font-size: 16px;
                color: #444;
                margin-bottom: 5px;
            }

            .rate-value {
                font-size: 40px;
                font-weight: 700;
                color: #2980b9;
                line-height: 1.2;
            }

            .rate-unit {
                font-size: 14px;
                color: #777;
                margin-top: 4px;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .rate-value { font-size: 32px; }
            }

            @media (max-width: 480px) {
                .rate-value { font-size: 26px; }
                
                .rate-unit { font-size: 12px; }
                
            }



        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
                .result-feedback {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 18px 20px;
    border-left: 4px solid #3498db;
    text-align: left;
    max-width: 800px; /* keeps it readable on large screens */
    margin: 0 auto;   /* centers it */
}

.feedback-title {
    font-weight: 600;
    margin-bottom: 8px;
    color: #2c3e50;
    font-size: 18px;
}

.feedback-content { 
    color: #34495e; 
    font-size: 16px;
    line-height: 1.5;
}

/* Responsive breakpoints */
@media (max-width: 768px) {
    .result-feedback {
        padding: 15px;
        font-size: 15px;
    }

    .feedback-title {
        font-size: 16px;
    }

    .feedback-content {
        font-size: 14px;
    }
}

@media (max-width: 480px) {
    .result-feedback {
        padding: 12px;
        border-left-width: 3px;
    }

    .feedback-title {
        font-size: 15px;
    }

    .feedback-content {
        font-size: 13px;
    }
}

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

<div class="btn-container">
    <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
</div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <div class="calculator-header">
        <h1>Settling Net Force Calculator</h1>
        <p>Calculate the net force acting on a particle in a fluid for environmental and industrial applications.</p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Parameters</h2>
             <div class="input-row">
            <div class="form-group">
                <label for="particleDensity">Particle Density (ρₚ, kg/m³)</label>
                <input type="number" id="particleDensity" class="form-input" step="any" min="0" placeholder="e.g., 2650">
            </div>

            <div class="form-group">
                <label for="fluidDensity">Fluid Density (ρ, kg/m³)</label>
                <input type="number" id="fluidDensity" class="form-input" step="any" min="0" placeholder="e.g., 1000">
            </div>
                  </div>
                  <div class="input-row">
            <div class="form-group">
                <label for="gravity">Gravity (g, m/s²)</label>
                <input type="number" id="gravity" class="form-input" step="any" min="0" value="9.81" placeholder="e.g., 9.81">
            </div>

            <div class="form-group">
                <label for="volume">Particle Volume (Vₚ, m³)</label>
                <input type="number" id="volume" class="form-input" step="any" min="0" placeholder="e.g., 0.000001">
            </div>
                 </div>
            <button class="calculate-btn" onclick="calculateNetForce()">Calculate Net Force</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <div class="result-placeholder" id="placeholder">
                <img src="/static/images/mlc_environment_result.png" alt="Net force illustration">
                <p>This tool calculates net force for particle settling in fluid applications.</p>
            </div>

            <div class="result-error hidden" id="resultError">
                <div class="error-icon">❌</div>
                <div class="error-message" id="errorMessage"></div>
            </div>

            <div class="result-value hidden" id="resultValue">
                <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                    <h2>Net Force (F<sub>net</sub>)</h2>
                </div>

                <div class="rate-display">
                    <div class="rate-value" id="forceValue">0.000</div>
                    <div class="rate-unit">N</div>
                </div>

                <div class="result-feedback">
                    <div class="feedback-title"> Assessment</div>
                    <div class="feedback-content" id="feedbackContent"></div>
                </div>

                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

<!-- Notes -->
<div class="note-section">

    <div class="note-card">
        <h3>📘 About This Calculator</h3>
        <p>
            The <strong>Settling Net Force Calculator</strong> determines the net force acting on a particle in a fluid. 
            This is essential for understanding particle behavior in environmental engineering, water treatment, 
            industrial separation processes, and sedimentation studies. By using particle and fluid properties, 
            it helps predict whether particles will sink, rise, or remain suspended.
        </p>
    </div>

    <div class="note-card">
        <h3>⚙️ Parameters Used</h3>
        <ul class="note-list">
            <li><strong>ρₚ (Particle Density):</strong> Density of the particle in kg/m³.</li>
            <li><strong>ρ (Fluid Density):</strong> Density of the surrounding fluid in kg/m³.</li>
            <li><strong>g (Gravitational Acceleration):</strong> Acceleration due to gravity in m/s² (default: 9.81 m/s²).</li>
            <li><strong>Vₚ (Particle Volume):</strong> Volume of the particle in m³.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>✅ Input Validation Rules</h3>
        <ul class="note-list">
            <li><strong>Particle Density (ρₚ):</strong> Must be > 0 kg/m³ (typical range: 500-8000 kg/m³).</li>
            <li><strong>Fluid Density (ρ):</strong> Must be > 0 kg/m³ (typical range: 1.2-1200 kg/m³ for air/water).</li>
            <li><strong>Gravity (g):</strong> Must be > 0 m/s² (Earth: ~9.81 m/s²).</li>
            <li><strong>Particle Volume (Vₚ):</strong> Must be > 0 m³ (typical range: 1e-18 to 1e-3 m³).</li>
            <li><strong>Extreme Values:</strong> Values outside typical ranges trigger warnings but not errors.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>🔎 Output Validations</h3>
        <ul class="note-list">
            <li><strong>Net force (F<sub>net</sub>) must be finite:</strong> If result is NaN or Infinity → ❌ Invalid result, check inputs.</li>
            <li><strong>Net force (F<sub>net</sub>)> 0:</strong> ✅ The particle is denser than the fluid and will sink. (Assessment: Downward Net Force)</li>
            <li><strong>Net force (F<sub>net</sub>) < 0:</strong> ✅ The particle is less dense than the fluid and will rise. (Assessment: Upward Net Force / Buoyant)</li>
            <li><strong>Net force (F<sub>net</sub>) = 0:</strong> ⚖️ Neutral buoyancy → The particle has the same density as the fluid and will remain suspended. (Assessment: Neutral Buoyancy)</li>
            <li><strong>|Net force (F<sub>net</sub>)| > 100 N:</strong> ⚠️ Very high force magnitude. Check input values for accuracy.</li>
            <li><strong>|Net force (F<sub>net</sub>)| < 1e-9 N:</strong> ⚠️ Very low force magnitude. May be negligible in many applications.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>📏 Governing Principle</h3>
        <p>
            A <strong>Settling Net Force Calculator</strong> does not belong to a single, specific standard like ISO or ASTM; it uses principles of classical mechanics, 
            particularly Newton's Second Law of Motion (F = ma), to calculate net forces. These calculations may be applied within various engineering disciplines such as wastewater treatment, sedimentation, and fluid dynamics.
        </p>
        <p>
            <strong style="color: #1976d2;">Key Points:</strong>
            <ul>
                <li><strong>No Specific Standard:</strong> The calculation is based on general physics, not a single standard.</li>
                <li><strong>Newtonian Physics:</strong> The net force on a particle is the product of mass (or effective volume × density difference) and acceleration (gravity).</li>
                <li><strong>Engineering Applications:</strong> 
                    <ul>
                        <li>Wastewater Treatment: Used to design sedimentation tanks and separation processes.</li>
                        <li>Fluid Dynamics: Helps analyze particle movement and settling behavior.</li>
                    </ul>
                </li>
            </ul>
        </p>
        <p>
            By following these fundamental principles, this calculator helps engineers and scientists predict particle behavior, ensure safety, 
            and optimize industrial and environmental processes.
        </p>
    </div>

    <div class="note-card">
        <h3>📝 Conclusion</h3>
        <p>
            The <strong>Settling Net Force Calculator</strong> provides an accurate estimate of net forces acting on particles in fluids. 
            It assists in determining whether particles will sink, rise, or remain suspended, while providing safety warnings and assessment feedback. 
            This supports design decisions in environmental engineering, industrial separation, and fluid dynamics applications.
        </p>
    </div>

</div>

<script>
function showErrors(errors) {
    const errorBox = document.getElementById("resultError");
    const errorMessage = document.getElementById("errorMessage");
    const placeholder = document.getElementById("placeholder");
    const resultValue = document.getElementById("resultValue");

    errorMessage.innerHTML = errors.join("<br>");
    errorBox.classList.remove("hidden");
    placeholder.classList.add("hidden");
    resultValue.classList.add("hidden");
}

function calculateNetForce() {
    // Read values
    const particleDensity = parseFloat(document.getElementById("particleDensity").value);
    const fluidDensity = parseFloat(document.getElementById("fluidDensity").value);
    const gravity = parseFloat(document.getElementById("gravity").value);
    const volume = parseFloat(document.getElementById("volume").value);

    const forceValueEl = document.getElementById("forceValue");
    const feedbackEl = document.getElementById("feedbackContent");
    document.getElementById("resultError").classList.add("hidden");
    feedbackEl.innerHTML = "";

    const errors = [];
    const warnings = [];

    // Validation
    if (![particleDensity, fluidDensity, gravity, volume].every(Number.isFinite)) {
        return showErrors(["👉 Please enter all values (numeric)."]);
    }
    
    if (particleDensity <= 0) errors.push("👉 Particle density must be > 0 kg/m³.");
    if (fluidDensity <= 0) errors.push("👉 Fluid density must be > 0 kg/m³.");
    if (gravity <= 0) errors.push("👉 Gravity must be > 0 m/s².");
    if (volume <= 0) errors.push("👉 Particle volume must be > 0 m³.");
    
    // Warning for unusual values
    if (particleDensity > 8000) warnings.push("⚠️ Particle density unusually high (>8000 kg/m³).");
    if (particleDensity < 500) warnings.push("⚠️ Particle density unusually low (<500 kg/m³).");
    if (fluidDensity > 1200) warnings.push("⚠️ Fluid density unusually high (>1200 kg/m³).");
    if (fluidDensity < 1) warnings.push("⚠️ Fluid density unusually low (<1 kg/m³).");
    if (gravity > 10) warnings.push("⚠️ Gravity value unusually high (>10 m/s²).");
    if (gravity < 9.7) warnings.push("⚠️ Gravity value unusually low (<9.7 m/s²).");
    if (volume > 0.001) warnings.push("⚠️ Particle volume unusually large (>0.001 m³).");
    if (volume < 1e-18) warnings.push("⚠️ Particle volume unusually small (<1e-18 m³).");

    if (errors.length) return showErrors(errors);

    // Formula: F_net = (ρₚ - ρ) × g × Vₚ
    const netForce = (particleDensity - fluidDensity) * gravity * volume;

    if (!Number.isFinite(netForce)) {
        return showErrors(["⚠️ Computed net force is invalid (possible calculation error)."]);
    }

    // Classification
    let classification, suggestion, color, behavior;
    const absForce = Math.abs(netForce);
    
    if (netForce > 0) {
        behavior = "sinking";
        classification = "Downward Net Force";
        suggestion = "✅ The particle is denser than the fluid and will sink.";
        color = "#2e7d32";
    } else if (netForce < 0) {
        behavior = "rising";
        classification = "Upward Net Force (Buoyant)";
        suggestion = "✅ The particle is less dense than the fluid and will rise.";
        color = "#1560bd";
    } else {
        behavior = "neutral";
        classification = "Neutral Buoyancy";
        suggestion = "⚖️ The particle has the same density as the fluid and will remain suspended.";
        color = "#f9a825";
    }
    
    // Force magnitude classification
    let magnitudeNote = "";
    if (absForce > 100) {
        magnitudeNote = "⚠️ Very high force magnitude. Check input values for accuracy.";
    } else if (absForce < 1e-9) {
        magnitudeNote = "⚠️ Very low force magnitude. May be negligible in many applications.";
    }

    // Format the force for display
    let displayValue;
    if ((absForce < 0.01 && absForce > 0) || absForce > 1e6) {
        displayValue = netForce.toExponential(4);
    } else {
        displayValue = netForce.toFixed(6);
    }

    // Display result
    forceValueEl.textContent = displayValue;
    feedbackEl.innerHTML = `
        <div>Net force (F<sub>net</sub>) = <b>${displayValue}</b> N</div>
        <div>Behavior: <b style="color:${color};">${classification}</b></div>
        <div style="margin-top:6px;">${suggestion}</div>
        ${magnitudeNote ? `<div style="margin-top:8px; color:#b35d00;">${magnitudeNote}</div>` : ""}
        ${warnings.length ? `<div style="margin-top:8px; color:#b35d00;">${warnings.join(" | ")}</div>` : ""}
    `;

    document.getElementById("placeholder").classList.add("hidden");
    document.getElementById("resultValue").classList.remove("hidden");
}

function printReport() {
    const el = document.getElementById('printDate');
    if (el) el.textContent = new Date().toLocaleDateString();
    window.print();
}
</script>
<script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--

Input Validations:

All values must be numeric and positive

Particle density: >0 kg/m³ (typical 500-8000 kg/m³)

Fluid density: >0 kg/m³ (typical 1.2-1200 kg/m³)

Gravity: >0 m/s² (Earth: ~9.81 m/s²)

Particle volume: >0 m³ (typical 1e-18 to 1e-3 m³)
----------------------------------------------------------------------
Output Validations:

F<sub>net</sub> > 0: Particle sinks

F<sub>net</sub> < 0: Particle rises

F<sub>net</sub> = 0: Neutral buoyancy

|F<sub>net</sub>| > 100 N: Very high force warning

|F<sub>net</sub>| < 1e-9 N: Very low force warning
--------------------------------------------------------------------------
The formula used in the calculator is:

F<sub>net</sub> = (ρₚ - ρ) × g × Vₚ

Where:

F<sub>net</sub> = Net force acting on the particle (in Newtons, N)

ρₚ = Density of the particle (in kg/m³)

ρ = Density of the fluid (in kg/m³)

g = Gravitational acceleration (in m/s²)

Vₚ = Volume of the particle (in m³)






-->