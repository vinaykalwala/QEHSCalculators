{% extends 'base.html' %}
{% block title %}Overburden Pressure Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overburden Pressure Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
<style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
             /* display: flex;  */
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
            /* overflow-y: auto;  */
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Input rows for better organization */
        .input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-row .form-group {
            flex: 1;
        }
        
        @media (max-width: 600px) {
            .input-row {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }

                .rate-display {
                display: flex;
                gap: 20px;
                justify-content: center;
                align-items: center;
                flex-wrap: wrap; /* responsive */
                text-align: center;
            }

            .rate-block {
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 120px; /* keeps blocks same width */
            }

            .rate-label {
                font-weight: bold;
                font-size: 16px;
                color: #444;
                margin-bottom: 5px;
            }

            .rate-value {
                font-size: 40px;
                font-weight: 700;
                color: #2980b9;
                line-height: 1.2;
            }

            .rate-unit {
                font-size: 14px;
                color: #777;
                margin-top: 4px;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .rate-value { font-size: 32px; }
            }

            @media (max-width: 480px) {
                .rate-value { font-size: 26px; }
                
                .rate-unit { font-size: 12px; }
                
            }



        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
                .result-feedback {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 18px 20px;
    border-left: 4px solid #3498db;
    text-align: left;
    max-width: 800px; /* keeps it readable on large screens */
    margin: 0 auto;   /* centers it */
}

.feedback-title {
    font-weight: 600;
    margin-bottom: 8px;
    color: #2c3e50;
    font-size: 18px;
}

.feedback-content { 
    color: #34495e; 
    font-size: 16px;
    line-height: 1.5;
}

/* Responsive breakpoints */
@media (max-width: 768px) {
    .result-feedback {
        padding: 15px;
        font-size: 15px;
    }

    .feedback-title {
        font-size: 16px;
    }

    .feedback-content {
        font-size: 14px;
    }
}

@media (max-width: 480px) {
    .result-feedback {
        padding: 12px;
        border-left-width: 3px;
    }

    .feedback-title {
        font-size: 15px;
    }

    .feedback-content {
        font-size: 13px;
    }
}

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

<div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>
<div class="calculator-container printable" id="printArea">


{% include "includes/print_header_footer.html" %}

<div class="calculator-header">
    <h1>Overburden Pressure Calculator</h1>
    <p>Calculate the adjusted specific weight of waste/material under applied overburden pressure.
</div>

<div class="calc-content">
    <div class="calc-card">
        <h2>Enter Parameters</h2>

        <div class="input-row">
            <div class="form-group">
                <label for="SWi">Initial Specific Weight (SWᵢ) [lb/yd³]</label>
                <input type="number" id="SWi" class="form-input" step="any" min="0" placeholder="e.g., 1800">
            </div>

            <div class="form-group">
                <label for="p">Overburden Pressure (p) [lb/in²]</label>
                <input type="number" id="p" class="form-input" step="any" min="0" placeholder="e.g., 10">
            </div>
        </div>

        <div class="input-row">
            <div class="form-group">
                <label for="a">Empirical Constant a [yd³/in²]</label>
                <input type="number" id="a" class="form-input" step="any" min="0" placeholder="e.g., 5">
            </div>

            <div class="form-group">
                <label for="b">Empirical Constant b [yd³/lb]</label>
                <input type="number" id="b" class="form-input" step="any" min="0" placeholder="e.g., 0.1">
            </div>
        </div>

        <button class="calculate-btn" onclick="calculateSWp()">Calculate SWₚ</button>
    </div>

    <!-- Result Section -->
    <div class="result-card">
        <div class="result-placeholder" id="placeholder">
            <img src="/static/images/mlc_environment_result.png" alt="Microbial growth illustration">
            <p>This tool calculates the specific weight of waste/material under overburden pressure.</p>
        </div>

        <div class="result-error hidden" id="resultError" role="alert" aria-live="polite">
            <div class="error-icon">❌</div>
            <div class="error-message" id="errorMessage"></div>
        </div>

        <div class="result-value hidden" id="resultValue" aria-live="polite">
            <div class="calculation-type">
                <h2>Specific Weight at Pressure (SWₚ)</h2>
            </div>
            <div class="rate-display" style="gap:12px; align-items:center; justify-content:center;">
                <div class="rate-value" id="SWp">0.00</div>
                <div class="rate-label" style="font-size:16px; color: #2980b9;">lb/yd³</div>
            </div>

            <div class="result-feedback">
                <div class="feedback-title">Assessment</div>
                <div class="feedback-content" id="feedbackContent"></div>
            </div>

            <div class="btn-wrapper">
                <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
            </div>
        </div>
    </div>
</div>

<!-- Notes Section -->
<div class="note-section">
    <div class="note-card">
        <h3>📘 About This Calculator</h3>
        <p>
            This calculator determines the adjusted specific weight <strong>SWₚ</strong> of a material under applied overburden pressure using an empirical formula.
            It is useful for geotechnical assessments, landfill compaction, and environmental engineering applications.
        </p>
    </div>

    <div class="note-card">
        <h3>⚙ Parameters Used</h3>
        <ul class="note-list">
            <li>Initial soil weight (SWᵢ) [lb/yd³]</li>
            <li>Overburden pressure (p) [consistent units]</li>
            <li>Empirical constant a</li>
            <li>Empirical constant b</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>✅ Input Validation Rules</h3>
        <ul class="note-list">
            <li>All inputs must be numeric.</li>
            <li>SWᵢ > 0; typical range: 1,750–2,150 lb/yd³.</li>
            <li>p ≥ 0; realistic range: 0–100 lb/in².</li>
            <li>a > 0; typical: 0.1–10 yd³/in².</li>
            <li>b > 0; typical: 0.01–1 yd³/lb.</li>
            <li>Denominator check: a + b·p > 0 to avoid division by zero.</li>
            <li>Cross-field consistency: ensure p, a, and b yield SWₚ within realistic material density limits.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>✅ Output Validations & Assessment</h3>
        <ul class="note-list">
            <li>SWₚ within 1,750–2,150 → ✅ Normal density .</li>
            <li>SWₚ < 1,750 → ⚠️ Under-compacted material Monitor compaction process.</li>
            <li>SWₚ > 2,150 → ⚠️ Over-compacted material;  Verify structural safety.</li>
            <li>Warnings for values outside typical range are displayed along with SWₚ.</li>
        </ul>
    </div>

    <div class="note-card">
        <h3>📚 Governing Principle</h3>
        <p>
            An overburden pressure calculator does not strictly follow a single universal standard, but is based on principles of soil mechanics and fluid dynamics, 
            often referencing works by Terzaghi, Peck, and Mesri. In some applications, such as the Standard Penetration Test (SPT), correction factors 
            are derived from national standards like the Indian Standard Code IS: 2131-1981.
        </p>
        <p>
            <strong>Key Concepts:</strong>
            <ul>
                <li>General Principles: Integrates density and depth to determine pressure using soil mechanics and physics concepts.</li>
                <li>Industry Standards: SPT and geotechnical engineering codes ensure normalized, comparable pressure readings across locations and depths.</li>
                <li>Purpose: Overburden pressure correction normalizes data to a reference pressure to allow consistent interpretation.</li>
            </ul>
        </p>
    </div>

    <div class="note-card">
        <h3>🏁 Conclusion</h3>
        <p>
            The SWₚ calculator provides reliable assessment of material compaction under overburden pressure. 
            It helps engineers evaluate soil stability, landfill compaction quality, and structural integrity in geotechnical and environmental applications.
        </p>
    </div>
</div>


<script>
function showErrors(errors) {
    const errorBox = document.getElementById("resultError");
    const errorMessage = document.getElementById("errorMessage");
    const placeholder = document.getElementById("placeholder");
    const resultValue = document.getElementById("resultValue");

    errorMessage.innerHTML = errors.join("<br>");
    errorBox.classList.remove("hidden");
    placeholder.classList.add("hidden");
    resultValue.classList.add("hidden");
}

function calculateSWp() {
    const SWi = parseFloat(document.getElementById("SWi").value);
    const p = parseFloat(document.getElementById("p").value);
    const a = parseFloat(document.getElementById("a").value);
    const b = parseFloat(document.getElementById("b").value);

    const SWpEl = document.getElementById("SWp");
    const feedbackEl = document.getElementById("feedbackContent");
    const errors = [];
    const warnings = [];

    // Numeric validations
    if (![SWi, p, a, b].every(Number.isFinite)) errors.push("👉 All inputs are required and must be numeric.");
    if (SWi <= 0) errors.push("👉 SWᵢ must be greater than 0.");
    if (p < 0) errors.push("👉 Overburden pressure (p) cannot be negative.");
    if (a <= 0) errors.push("👉 Empirical constant a must be greater than 0.");
    if (b <= 0) errors.push("👉 Empirical constant b must be greater than 0.");
    if (a + b * p <= 0) errors.push("👉 Denominator (a + b·p) must be greater than 0.");
    if (errors.length) return showErrors(errors);

    // Compute SWp
    const SWp = SWi + p / (a + b * p);

    // Warnings for outliers / QEHS check
    if (SWp < 1750) warnings.push("⚠️ SWₚ below typical range; material may be under-compacted.");
    if (SWp > 2150) warnings.push("⚠️ SWₚ above typical range; check structural integrity.");

    // Display
    SWpEl.textContent = SWp.toFixed(2);
    let feedback = `<div>SWₚ = <b>${SWp.toFixed(2)}</b> lb/yd³</div>`;

    if (SWp >= 1750 && SWp <= 2150) {
        feedback += `<div style="color:green; margin-top:6px;">✅ Material within normal density range.</div>`;
    } else if (SWp < 1750) {
        feedback += `<div style="color:orange; margin-top:6px;">⚠️ Material under-compacted. Monitor compaction process.</div>`;
    } else {
        feedback += `<div style="color:red; margin-top:6px;">⚠️ Material over-compacted. Verify structural safety.</div>`;
    }

    if (warnings.length) feedback += `<div style="margin-top:6px; color:#b35d00;">${warnings.join(" | ")}</div>`;

    feedbackEl.innerHTML = feedback;

    document.getElementById("placeholder").classList.add("hidden");
    document.getElementById("resultValue").classList.remove("hidden");
    document.getElementById("resultError").classList.add("hidden");
}

function printReport() {
  const el = document.getElementById('printDate');
  if (el) {
    const now = new Date();
    el.textContent = now.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
  }
  window.print();
}
</script>


<script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}

<!--
  🔹 SWₚ (Compact Soil Density) Calculator - Formulas & Validations

  1️⃣ Inputs:
     - Initial soil weight (SWi) [lb/yd³]
     - Overburden pressure (p) [kPa or consistent unit]
     - Empirical constant a
     - Empirical constant b

  2️⃣ Input Validations:
     - All inputs required and numeric
     - SWi > 0
     - p ≥ 0
     - a > 0
     - b > 0
     - Denominator (a + b * p) > 0
     - Optional warnings:
         • Computed SWp < 1750 → possible under-compaction
         • Computed SWp > 2150 → possible over-compaction

  3️⃣ Formula Calculation:
     - SWp = SWi + p / (a + b * p)

  4️⃣ Output Validations & Assessment:
     - SWp must be finite
     - Classification:
         • 1750 ≤ SWp ≤ 2150 → Normal density
         • SWp < 1750 → Under-compacted
         • SWp > 2150 → Over-compacted
     - Display SWp to 2 decimal places
     - Include warnings if outside typical range

  5️⃣ Output:
     - Numeric SWp
     - Feedback with color-coded assessment (green/orange/red)
-->
