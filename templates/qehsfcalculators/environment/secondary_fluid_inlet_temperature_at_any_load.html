{% extends 'base.html' %}
{% block title %}Secondary Fluid Inlet Temperature At Any Load Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secondary Fluid Inlet Temperature At Any Load Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .back-btn {
            background: linear-gradient(#1560bd, #000040);
            color: #ffffff;
            border: 2px solid #1560bd;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd;
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05);
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }

        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd, #000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center;
            flex-wrap: wrap;
        }

        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
            line-height: 1.1;
        }

        .rate-label { 
            color: #7f8c8d;
            font-size: 20px;
            font-weight: bold;
        }

        /* Responsive styles */
        @media (max-width: 1200px) {
            .rate-value {
                font-size: 38px;
            }
            .rate-label {
                font-size: 18px;
            }
        }
        
        @media (max-width: 992px) {
            .rate-value {
                font-size: 34px;
            }
            .rate-label {
                font-size: 17px;
            }
        }
        
        @media (max-width: 768px) {
            .rate-value {
                font-size: 30px;
                margin-bottom: 8px;
            }
            .rate-label {
                font-size: 16px;
            }
        }
        
        @media (max-width: 576px) {
            .rate-value {
                font-size: 28px;
                margin-bottom: 6px;
            }
            .rate-label {
                font-size: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .rate-display {
                flex-direction: column;
                gap: 2px;
                text-align: center;
            }
            .rate-value {
                font-size: 24px;
                margin-bottom: 4px;
            }
            .rate-label {
                font-size: 14px;
            }
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

    <div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>


<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}


<div class="calculator-header">
  <h1>Secondary Fluid Inlet Temperature At Any Load Calculator</h1>
  <p>Calculate the secondary fluid inlet temperature (<strong>T‚ÇÅ</strong>) in a heat exchanger at any load. All inputs are in ¬∞C, except TDC (dimensionless).</p>
</div>

<div class="calc-content">
  <div class="calc-card">
    <h2>Enter Data</h2>

    <div class="form-group">
      <label for="Ts">Steam Temperature (Ts in ¬∞C)</label>
      <input type="number" id="Ts" class="form-input" min="1" step="any" placeholder="e.g., 250">
    </div>

    <div class="form-group">
      <label for="TDC">Temperature Design Constant (TDC)</label>
      <input type="number" id="TDC" class="form-input" min="1.01" step="any" placeholder="e.g., 1.2">
    </div>

    <div class="form-group">
      <label for="T2">Secondary Fluid Outlet Temperature (T2 in ¬∞C)</label>
      <input type="number" id="T2" class="form-input" min="1" step="any" placeholder="e.g., 80">
    </div>

    <button class="calculate-btn" onclick="calculateT1()">Calculate T‚ÇÅ</button>
  </div>

  <div class="result-card">
    <div class="result-placeholder" id="placeholder">
        <img src="/static/images/mlc_environment_result.png" alt="secondary fluid">
      <p>Enter the inputs to calculate the secondary fluid inlet temperature (T‚ÇÅ).</p>
    </div>

    <div class="result-error hidden" id="resultError">
      <div class="error-icon">‚ùå</div>
      <div class="error-message" id="errorMessage"></div>
    </div>

    <div class="result-value hidden" id="resultValue">
        <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
        <h2>Secondary Fluid Inlet Temperature</h2>
      </div>
      <div class="rate-display">
        <div class="rate-value" id="rateValue">0</div>
        <div class="rate-label">¬∞C (T‚ÇÅ)</div>
      </div>
      <div class="result-feedback" id="feedbackContent"></div>

      <div class="btn-wrapper">
        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
      </div>
    </div>
  </div>
</div>

<div class="note-section">
  <div class="note-card">
    <h3>üìò About This Calculator</h3>
    <p>This calculator computes the secondary fluid inlet temperature (T‚ÇÅ) to maintain safe and efficient heat transfer in heat exchangers. It is critical for boilers, HVAC systems, and industrial thermal systems to ensure operational safety, energy efficiency, and compliance with QEHS standards.</p>
  </div>

  <div class="note-card">
    <h3>‚öô Parameters Used</h3>
    <ul class="note-list">
      <li><strong>T‚Çõ:</strong> Steam temperature inside the heat exchanger (¬∞C).</li>
      <li><strong>T‚ÇÇ:</strong> Secondary fluid outlet temperature (¬∞C).</li>
      <li><strong>TDC:</strong> Temperature Design Constant (dimensionless, >1).</li>
      <li><strong>T‚ÇÅ:</strong> Calculated secondary fluid inlet temperature (¬∞C).</li>
    </ul>
  </div>

  <div class="note-card">
    <h3>‚úÖ Input Validation Rules</h3>
    <ul class="note-list">
      <li>All inputs are required, numeric, and positive.</li>
      <li>TDC must be greater than 1.</li>
      <li>T‚ÇÇ cannot exceed Ts (Ts ‚â• T‚ÇÇ).</li>
      <li>Steam temperature Ts ‚â§ 600¬∞C (typical boiler safety limit).</li>
      <li>T‚ÇÇ ‚â• 0 and ‚â§ Ts.</li>
      <li>Non-integer values are allowed; results rounded to 2 decimals.</li>
      <li>Extreme inputs trigger warnings: Ts > 500¬∞C or TDC > 10.</li>
    </ul>
  </div>

  <div class="note-card">
    <h3>‚öô Output Validations / Assessment</h3>
    <ul class="note-list">
      <li>The calculated T‚ÇÅ is displayed in ¬∞C with 2 decimal places.</li>
      <li>Assessment and feedback are displayed along with the result:</li>
      <ul>
        <li>‚úÖ Inputs within normal operating range ‚Üí system is safe and efficient.</li>
        <li>‚ö†Ô∏è T‚ÇÅ < 0¬∞C ‚Üí Inputs may be invalid or unsafe.</li>
        <li>‚ö†Ô∏è T‚ÇÅ > Ts ‚Üí Physically impossible; check inputs.</li>
        <li>‚ö†Ô∏è Warnings for Ts > 500¬∞C or TDC > 10 alert the operator to verify system safety.</li>
      </ul>
    </ul>
  </div>

  <div class="note-card">
    <h3>üìè Standards / Safety Reference</h3>
    <p>References include ISO 8501 for industrial heat exchanger safety, ISO 50001 for energy efficiency management, and QEHS thermal safety protocols for boiler and heat exchanger operations.</p>
  </div>

  <div class="note-card">
    <h3>üìù Conclusion</h3>
    <ul class="note-list">
      <li>Providing accurate inputs ensures T‚ÇÅ remains within safe operational range.</li>
      <li>Following validation rules and heeding warnings prevents unsafe conditions and enhances system efficiency.</li>
      <li>This calculator supports QEHS compliance, thermal performance optimization, and audit readiness.</li>
    </ul>
  </div>
</div>



<script>
function showErrors(errors) {
  const errorBox = document.getElementById("resultError");
  const errorMessage = document.getElementById("errorMessage");
  const placeholder = document.getElementById("placeholder");
  const resultValue = document.getElementById("resultValue");

  errorMessage.innerHTML = errors.join("<br>");
  errorBox.classList.remove("hidden");
  placeholder.classList.add("hidden");
  resultValue.classList.add("hidden");
}

function calculateT1() {
  const TsRaw = document.getElementById("Ts").value.trim();
  const TDCRaw = document.getElementById("TDC").value.trim();
  const T2Raw = document.getElementById("T2").value.trim();

  const errorBox = document.getElementById("resultError");
  const errorMessage = document.getElementById("errorMessage");
  const placeholder = document.getElementById("placeholder");
  const resultValue = document.getElementById("resultValue");
  const rateEl = document.getElementById("rateValue");
  const feedbackEl = document.getElementById("feedbackContent");

  errorBox.classList.add("hidden");
  errorMessage.innerHTML = "";
  feedbackEl.innerHTML = "";

  const errors = [];
  const warnings = [];

  if (!TsRaw) errors.push("Enter Steam Temperature (Ts).");
  if (!TDCRaw) errors.push("Enter Temperature Design Constant (TDC).");
  if (!T2Raw) errors.push("Enter Secondary Fluid Outlet Temperature (T‚ÇÇ).");
  if (errors.length) return showErrors(errors);

  const Ts = parseFloat(TsRaw);
  const TDC = parseFloat(TDCRaw);
  const T2 = parseFloat(T2Raw);

  if (!Number.isFinite(Ts) || Ts <= 0 || Ts > 600) errors.push("Ts must be > 0¬∞C and ‚â§ 600¬∞C.");
  if (!Number.isFinite(TDC) || TDC <= 1) errors.push("TDC must be > 1.");
  if (!Number.isFinite(T2) || T2 < 0 || T2 > Ts) errors.push("T‚ÇÇ must be ‚â•0¬∞C and ‚â§ Ts.");
  if (errors.length) return showErrors(errors);

  // Edge case warnings
  if (Ts > 500) warnings.push("‚ö†Ô∏è Steam temperature is very high (>500¬∞C), check system safety.");
  if (TDC > 10) warnings.push("‚ö†Ô∏è TDC unusually high (>10), verify design assumptions.");

  const T1_raw = Ts - TDC * (Ts - T2);
  const T1 = parseFloat(T1_raw.toFixed(2));

  let feedback = "";
  if (T1 < 0) feedback += "‚ö†Ô∏è T‚ÇÅ < 0¬∞C: Inputs may be invalid or unsafe.\n";
  if (T1 > Ts) feedback += "‚ö†Ô∏è T‚ÇÅ > Ts: Check inputs; this is physically impossible.\n";
  if (warnings.length) feedback += warnings.join(" | ");

  rateEl.textContent = T1.toLocaleString();
  feedbackEl.textContent = feedback || "‚úÖ Inputs are within normal operating range.";

  placeholder.classList.add("hidden");
  resultValue.classList.remove("hidden");
  errorBox.classList.add("hidden");
}

function printReport() {
  const el = document.getElementById('printDate');
  if (el) {
    el.textContent = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
  }
  window.print();
}
</script>


    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- 
üìå Steam Temperature at Any Load / T1 Calculator

üîπ Formula (internal, not displayed):
    ‚Ä¢ T1 = Ts - TDC √ó (Ts ‚àí T2)
      - T1   = Calculated Secondary Fluid Inlet Temperature [¬∞C]
      - Ts   = Steam Temperature [¬∞C]
      - TDC  = Temperature Design Constant
      - T2   = Secondary Fluid Outlet Temperature [¬∞C]

üîπ Input Validations:
    ‚Ä¢ Ts (Steam Temperature):
        - Required, numeric
        - Range: >0¬∞C and ‚â§600¬∞C
    ‚Ä¢ TDC (Temperature Design Constant):
        - Required, numeric
        - Range: >1
    ‚Ä¢ T2 (Secondary Fluid Outlet Temperature):
        - Required, numeric
        - Range: ‚â•0¬∞C and ‚â§Ts

üîπ Warnings / Edge Cases:
    ‚Ä¢ Ts > 500¬∞C ‚Üí ‚ö†Ô∏è Very high steam temperature; check system safety
    ‚Ä¢ TDC > 10 ‚Üí ‚ö†Ô∏è Unusually high TDC; verify design assumptions
    ‚Ä¢ Computed T1 < 0 ‚Üí ‚ö†Ô∏è Possible invalid/unsafe inputs
    ‚Ä¢ Computed T1 > Ts ‚Üí ‚ö†Ô∏è Physically impossible; check inputs

üîπ Output & Feedback:
    ‚Ä¢ T1 displayed with 2 decimals
    ‚Ä¢ Assessment message:
        - ‚úÖ Inputs within normal operating range (if no warnings)
        - ‚ö†Ô∏è Warnings displayed inline with result
-->
