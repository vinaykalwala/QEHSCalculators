{% extends 'base.html' %}
{% block title %}Secondary Fluid Inlet Temperature At Any Load Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secondary Fluid Inlet Temperature At Any Load Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .back-btn {
            background: linear-gradient(#1560bd, #000040);
            color: #ffffff;
            border: 2px solid #1560bd;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd;
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05);
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }

        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd, #000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center;
            flex-wrap: wrap;
        }

        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
            line-height: 1.1;
        }

        .rate-label { 
            color: #7f8c8d;
            font-size: 20px;
            font-weight: bold;
        }

        /* Responsive styles */
        @media (max-width: 1200px) {
            .rate-value {
                font-size: 38px;
            }
            .rate-label {
                font-size: 18px;
            }
        }
        
        @media (max-width: 992px) {
            .rate-value {
                font-size: 34px;
            }
            .rate-label {
                font-size: 17px;
            }
        }
        
        @media (max-width: 768px) {
            .rate-value {
                font-size: 30px;
                margin-bottom: 8px;
            }
            .rate-label {
                font-size: 16px;
            }
        }
        
        @media (max-width: 576px) {
            .rate-value {
                font-size: 28px;
                margin-bottom: 6px;
            }
            .rate-label {
                font-size: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .rate-display {
                flex-direction: column;
                gap: 2px;
                text-align: center;
            }
            .rate-value {
                font-size: 24px;
                margin-bottom: 4px;
            }
            .rate-label {
                font-size: 14px;
            }
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

    <div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>


<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}


<div class="calculator-header">
  <h1>Secondary Fluid Inlet Temperature At Any Load Calculator</h1>
  <p>Calculate the secondary fluid inlet temperature (<strong>T₁</strong>) in a heat exchanger at any load. All inputs are in °C, except TDC (dimensionless).</p>
</div>

<div class="calc-content">
  <div class="calc-card">
    <h2>Enter Data</h2>

    <div class="form-group">
      <label for="Ts">Steam Temperature (Ts in °C)</label>
      <input type="number" id="Ts" class="form-input" min="1" step="any" placeholder="e.g., 250">
    </div>

    <div class="form-group">
      <label for="TDC">Temperature Design Constant (TDC)</label>
      <input type="number" id="TDC" class="form-input" min="1.01" step="any" placeholder="e.g., 1.2">
    </div>

    <div class="form-group">
      <label for="T2">Secondary Fluid Outlet Temperature (T2 in °C)</label>
      <input type="number" id="T2" class="form-input" min="1" step="any" placeholder="e.g., 80">
    </div>

    <button class="calculate-btn" onclick="calculateT1()">Calculate T₁</button>
  </div>

  <div class="result-card">
    <div class="result-placeholder" id="placeholder">
        <img src="/static/images/mlc_environment_result.png" alt="secondary fluid">
      <p>Enter the inputs to calculate the secondary fluid inlet temperature (T₁).</p>
    </div>

    <div class="result-error hidden" id="resultError">
      <div class="error-icon">❌</div>
      <div class="error-message" id="errorMessage"></div>
    </div>

    <div class="result-value hidden" id="resultValue">
        <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
        <h2>Secondary Fluid Inlet Temperature</h2>
      </div>
      <div class="rate-display">
        <div class="rate-value" id="rateValue">0</div>
        <div class="rate-label">°C (T₁)</div>
      </div>
      <div class="result-feedback" id="feedbackContent"></div>

      <div class="btn-wrapper">
        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
      </div>
    </div>
  </div>
</div>

<div class="note-section">
  <div class="note-card">
    <h3>📘 About This Calculator</h3>
    <p>
      This calculator computes the secondary fluid inlet temperature (T<sub>1</sub>) to maintain safe and efficient heat transfer in heat exchangers. It is critical for boilers, HVAC systems, and industrial thermal systems to ensure operational safety, energy efficiency, and compliance with QEHS standards.
    </p>
  </div>

  <div class="note-card">
    <h3>⚙ Parameters Used</h3>
    <ul class="note-list">
      <li><strong>T<sub>s</sub> (°C):</strong> Steam temperature inside the heat exchanger.</li>
      <li><strong>T<sub>2</sub> (°C):</strong> Secondary fluid outlet temperature.</li>
      <li><strong>TDC (dimensionless):</strong> Temperature Design Constant, >1.</li>
      <li><strong>T<sub>1</sub> (°C):</strong> Calculated secondary fluid inlet temperature.</li>
    </ul>
  </div>

  <div class="note-card">
    <h3>✅ Input Validation Rules</h3>
    <ul class="note-list">
      <li><strong>T<sub>s</sub>:</strong> Required, numeric, 0 < T<sub>s</sub> ≤ 600°C.</li>
      <li><strong>T<sub>2</sub>:</strong> Required, numeric, 0 ≤ T<sub>2</sub> ≤ T<sub>s</sub>.</li>
      <li><strong>TDC:</strong> Required, numeric, 1 < TDC ≤ 10.</li>
      <li><strong>Advisories:</strong> Warnings for T<sub>s</sub> > 500°C or TDC > 10.</li>
      <li><strong>Constraints:</strong> All inputs must be numeric, positive (except T<sub>2</sub> ≥ 0), and non-empty.</li>
      <li>Non-integer values allowed; results rounded to 2 decimal places.</li>
    </ul>
  </div>

  <div class="note-card">
    <h3>📊 Output Validations / Assessment</h3>
    <ul class="note-list">
      <li><strong>T<sub>1</sub>:</strong> Displayed in °C, rounded to 2 decimal places, must be finite.</li>
      <li><strong>Assessment:</strong>
        <ul>
          <li>Inputs within normal operating range: System is safe and efficient.</li>
          <li>T<sub>1</sub> < 0°C: Inputs may be invalid or unsafe.</li>
          <li>T<sub>1</sub> > T<sub>s</sub>: Physically impossible; check inputs.</li>
          <li>Warnings for T<sub>s</sub> > 500°C or TDC > 10: Verify system safety.</li>
        </ul>
      </li>
      <li>Warnings triggered for: non-finite results, T<sub>1</sub> < 0°C, T<sub>1</sub> > T<sub>s</sub>, or extreme inputs.</li>
    </ul>
  </div>

  <div class="note-card">
    <h3>📖 Governing Principle</h3>
    <p>
      A "Secondary Fluid Inlet Temperature At Any Load Calculator" is not tied to a single specific standard but is rather a tool used in heat exchanger design and performance analysis, often employing principles and formulas found in standards like ASME Section VIII (for pressure vessel and heat exchanger design) or general heat transfer principles like those outlined by the Bureau of Energy Efficiency (BEE) and used in various textbooks and technical publications. The calculation would follow established heat transfer principles for a given heat exchanger type to determine performance under varying load conditions.
    </p>
    <p><b>Key Standards and Principles Involved:</b></p>
    <p><b>ASME Section VIII:</b> This is a primary standard for the design of pressure vessels and, by extension, heat exchangers. It provides rules for determining structural integrity and material selection, which are crucial for a heat exchanger to operate safely and efficiently.</p>
    <p><b>Heat Transfer Principles:</b> At its core, the calculator uses fundamental heat transfer equations, such as:</p>
    <p>Q = m * C<sub>p</sub> * ΔT (Heat transfer = mass flow rate * specific heat * temperature difference).</p>
    <p>Q = U * A * LMTD (Heat transfer = overall heat transfer coefficient * area * log mean temperature difference).</p>
    <p>These principles are universally applied in heat exchanger design.</p>
    <p><b>Bureau of Energy Efficiency (BEE) Guidelines:</b> In India, the BEE provides guidelines and literature that incorporate heat transfer principles for energy-efficient equipment, including heat exchangers.</p>
    <p><b>How it Works:</b></p>
    <p><b>Determine Load:</b> The calculator accounts for varying "load," which refers to the rate of heat transfer required or the flow rate of the fluids.</p>
    <p><b>Apply Heat Transfer Equations:</b> It uses the heat transfer equations mentioned above to relate the inlet temperature of the secondary fluid to other variables like outlet temperatures, heat transfer rate, and fluid properties.</p>
    <p><b>Consider Design Constraints:</b> Factors like pressure drop, available surface area, and the overall heat transfer coefficient (U) are considered based on the heat exchanger's design and materials.</p>
    <p><b>Standard Approvals:</b> The calculation would be performed in a manner consistent with the chosen standard (e.g., ASME) for the particular application to ensure the heat exchanger's performance is accurately predicted for different operating conditions.</p>
  </div>

  <div class="note-card">
    <h3>🔚 Conclusion</h3>
    <p>
      This calculator provides reliable estimates of secondary fluid inlet temperature, supporting <strong>energy efficiency</strong>, <strong>thermal system performance</strong>, and <strong>QEHS compliance</strong>. Ensure input values (T<sub>s</sub>, T<sub>2</sub>, TDC) are accurate and validate with standards like ASME Section VIII, BEE guidelines, or field measurements for critical applications to ensure safe and efficient heat exchanger performance.
    </p>
  </div>
</div>


    <script>
    function showErrors(errors) {
    const errorBox = document.getElementById("resultError");
    const errorMessage = document.getElementById("errorMessage");
    const placeholder = document.getElementById("placeholder");
    const resultValue = document.getElementById("resultValue");

    errorMessage.innerHTML = errors.join("<br>");
    errorBox.classList.remove("hidden");
    placeholder.classList.add("hidden");
    resultValue.classList.add("hidden");
    }

    function calculateT1() {
    const TsRaw = document.getElementById("Ts").value.trim();
    const TDCRaw = document.getElementById("TDC").value.trim();
    const T2Raw = document.getElementById("T2").value.trim();

    const errorBox = document.getElementById("resultError");
    const errorMessage = document.getElementById("errorMessage");
    const placeholder = document.getElementById("placeholder");
    const resultValue = document.getElementById("resultValue");
    const rateEl = document.getElementById("rateValue");
    const feedbackEl = document.getElementById("feedbackContent");

    errorBox.classList.add("hidden");
    errorMessage.innerHTML = "";
    feedbackEl.innerHTML = "";

    const errors = [];
    const warnings = [];

    if (!TsRaw) errors.push("Enter Steam Temperature (Ts).");
    if (!TDCRaw) errors.push("Enter Temperature Design Constant (TDC).");
    if (!T2Raw) errors.push("Enter Secondary Fluid Outlet Temperature (T₂).");
    if (errors.length) return showErrors(errors);

    const Ts = parseFloat(TsRaw);
    const TDC = parseFloat(TDCRaw);
    const T2 = parseFloat(T2Raw);

    if (!Number.isFinite(Ts) || Ts <= 0 || Ts > 600) errors.push("Ts must be > 0°C and ≤ 600°C.");
    if (!Number.isFinite(TDC) || TDC <= 1) errors.push("TDC must be > 1.");
    if (!Number.isFinite(T2) || T2 < 0 || T2 > Ts) errors.push("T₂ must be ≥0°C and ≤ Ts.");
    if (errors.length) return showErrors(errors);

    // Edge case warnings
    if (Ts > 500) warnings.push("⚠️ Steam temperature is very high (>500°C), check system safety.");
    if (TDC > 10) warnings.push("⚠️ TDC unusually high (>10), verify design assumptions.");

    const T1_raw = Ts - TDC * (Ts - T2);
    const T1 = parseFloat(T1_raw.toFixed(2));

    let feedback = "";
    if (T1 < 0) feedback += "⚠️ T₁ < 0°C: Inputs may be invalid or unsafe.\n";
    if (T1 > Ts) feedback += "⚠️ T₁ > Ts: Check inputs; this is physically impossible.\n";
    if (warnings.length) feedback += warnings.join(" | ");

    rateEl.textContent = T1.toLocaleString();
    feedbackEl.textContent = feedback || "✅ Inputs are within normal operating range.";

    placeholder.classList.add("hidden");
    resultValue.classList.remove("hidden");
    errorBox.classList.add("hidden");
    }

    function printReport() {
    const el = document.getElementById('printDate');
    if (el) {
        el.textContent = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
    }
    window.print();
    }
    </script>


    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- 
📌 Steam Temperature at Any Load / T1 Calculator

🔹 Formula (internal, not displayed):
    • T1 = Ts - TDC × (Ts − T2)
      - T1   = Calculated Secondary Fluid Inlet Temperature [°C]
      - Ts   = Steam Temperature [°C]
      - TDC  = Temperature Design Constant
      - T2   = Secondary Fluid Outlet Temperature [°C]

🔹 Input Validations:
    • Ts (Steam Temperature):
        - Required, numeric
        - Range: >0°C and ≤600°C
    • TDC (Temperature Design Constant):
        - Required, numeric
        - Range: >1
    • T2 (Secondary Fluid Outlet Temperature):
        - Required, numeric
        - Range: ≥0°C and ≤Ts

🔹 Warnings / Edge Cases:
    • Ts > 500°C → ⚠️ Very high steam temperature; check system safety
    • TDC > 10 → ⚠️ Unusually high TDC; verify design assumptions
    • Computed T1 < 0 → ⚠️ Possible invalid/unsafe inputs
    • Computed T1 > Ts → ⚠️ Physically impossible; check inputs

🔹 Output & Feedback:
    • T1 displayed with 2 decimals
    • Assessment message:
        - ✅ Inputs within normal operating range (if no warnings)
        - ⚠️ Warnings displayed inline with result
-->
