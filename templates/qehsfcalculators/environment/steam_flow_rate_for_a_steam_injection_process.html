{% extends 'base.html' %}
{% block title %}Steam Flow Rate For A Steam Injection Process Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steam Flow Rate For A Steam Injection Process Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
<style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
             /* display: flex;  */
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
            /* overflow-y: auto;  */
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Input rows for better organization */
        .input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-row .form-group {
            flex: 1;
        }
        
        @media (max-width: 600px) {
            .input-row {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }

                .rate-display {
                display: flex;
                gap: 20px;
                justify-content: center;
                align-items: center;
                flex-wrap: wrap; /* responsive */
                text-align: center;
            }

            .rate-block {
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 120px; /* keeps blocks same width */
            }

            .rate-label {
                font-weight: bold;
                font-size: 16px;
                color: #444;
                margin-bottom: 5px;
            }

            .rate-value {
                font-size: 40px;
                font-weight: 700;
                color: #2980b9;
                line-height: 1.2;
            }

            .rate-unit {
                font-size: 14px;
                color: #777;
                margin-top: 4px;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .rate-value { font-size: 32px; }
            }

            @media (max-width: 480px) {
                .rate-value { font-size: 26px; }
                
                .rate-unit { font-size: 12px; }
                
            }



        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
                .result-feedback {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 18px 20px;
    border-left: 4px solid #3498db;
    text-align: left;
    max-width: 800px; /* keeps it readable on large screens */
    margin: 0 auto;   /* centers it */
}

.feedback-title {
    font-weight: 600;
    margin-bottom: 8px;
    color: #2c3e50;
    font-size: 18px;
}

.feedback-content { 
    color: #34495e; 
    font-size: 16px;
    line-height: 1.5;
}

/* Responsive breakpoints */
@media (max-width: 768px) {
    .result-feedback {
        padding: 15px;
        font-size: 15px;
    }

    .feedback-title {
        font-size: 16px;
    }

    .feedback-content {
        font-size: 14px;
    }
}

@media (max-width: 480px) {
    .result-feedback {
        padding: 12px;
        border-left-width: 3px;
    }

    .feedback-title {
        font-size: 15px;
    }

    .feedback-content {
        font-size: 13px;
    }
}

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

<div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>
<div class="calculator-container printable" id="printArea">


{% include "includes/print_header_footer.html" %}

<div class="calculator-header">
    <h1>Steam Consumption of a Flow-Type Application Calculator</h1>
    <p>Calculate the required steam flow rate (kg/s) for heating applications based on heat transfer principles.</p>
</div>

<div class="calc-content">
    <!-- Calculator -->
    <div class="calc-card">
        <h2>Enter Parameters</h2>

        <div class="input-row">
            <div class="form-group">
                <label for="Q">Heat Transfer Rate (Q, kW)</label>
                <input type="number" id="Q" class="form-input" step="any" min="0" placeholder="e.g., 500">
            </div>

            <div class="form-group">
                <label for="h_fg">Steam Enthalpy (h<sub>fg</sub>, kJ/kg)</label>
                <input type="number" id="h_fg" class="form-input" step="any" min="0" placeholder="e.g., 2257">
            </div>
        </div>

        <div class="input-row">
            <div class="form-group">
                <label for="T">Final Water Temperature (T, °C)</label>
                <input type="number" id="T" class="form-input" step="any" min="0" placeholder="e.g., 60">
            </div>

            <div class="form-group">
                <label for="Cp">Specific Heat Capacity (C<sub>p</sub>, kJ/kg·°C)</label>
                <input type="number" id="Cp" class="form-input" step="any" min="0" value="4.18" placeholder="e.g., 4.18">
            </div>
        </div>

        <button class="calculate-btn" onclick="calculateSteamFlow()">Calculate Steam Flow</button>
    </div>

    <!-- Result Section -->
    <div class="result-card">
        <div class="result-placeholder" id="placeholder">
            <img src="/static/images/mlc_environment_result.png" alt="Steam process illustration">
            <p>This tool calculates steam consumption for flow-type heating applications.</p>
        </div>

        <div class="result-error hidden" id="resultError" role="alert" aria-live="polite">
            <div class="error-icon">❌</div>
            <div class="error-message" id="errorMessage"></div>
        </div>

        <div class="result-value hidden" id="resultValue" aria-live="polite">
            <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                <h2>Steam Flow Rate</h2>
            </div>

            <div class="rate-display" style="gap:12px; align-items:center; justify-content:center;">
                <div class="rate-value" id="steamFlow">0.0000</div>
                <div class="rate-label" style="font-size:16px; color: #2980b9;">kg/s</div>
            </div>

            <div class="result-feedback">
                <div class="feedback-title">Performance Assessment</div>
                <div class="feedback-content" id="feedbackContent"></div>
            </div>

            <div class="btn-wrapper">
                <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
            </div>
        </div>
    </div>
</div>

<!-- Notes Section -->
<div class="note-section">
  <div class="note-card">
    <h3>📘 About This Calculator</h3>
    <p>
      This calculator determines the <strong>steam flow rate (kg/s)</strong> required for flow-type heating applications such as boilers, food processing, and fire safety systems. It supports energy optimization, QEHS compliance, and operational safety audits.
    </p>
  </div>

  <div class="note-card">
    <h3>⚙ Parameters Used</h3>
    <ul class="note-list">
      <li><strong>Q (kW):</strong> Heat transfer rate.</li>
      <li><strong>h<sub>fg</sub> (kJ/kg):</strong> Steam enthalpy (latent heat).</li>
      <li><strong>T (°C):</strong> Final water temperature.</li>
      <li><strong>C<sub>p</sub> (kJ/kg·°C):</strong> Specific heat capacity of water.</li>
      <li><strong>ṁ<sub>s</sub> (kg/s):</strong> Steam flow rate (calculated).</li>
    </ul>
  </div>

  <div class="note-card">
    <h3>✅ Input Validation Rules</h3>
    <ul class="note-list">
      <li><strong>Q:</strong> Required, > 0, ≤ 5,000 kW (typical industrial range).</li>
      <li><strong>h<sub>fg</sub>:</strong> Required, 1,900 ≤ h<sub>fg</sub> ≤ 2,800 kJ/kg (depends on pressure).</li>
      <li><strong>T:</strong> Required, 0 ≤ T ≤ 99 °C (below boiling point).</li>
      <li><strong>C<sub>p</sub>:</strong> Required, > 0, typically 4.0–4.3 kJ/kg·°C for water.</li>
      <li><strong>Constraints:</strong> h<sub>fg</sub> − T·C<sub>p</sub> must be > 0 to avoid division by zero or negative flow.</li>
      <li><strong>Advisories:</strong> Warnings for extreme inputs (e.g., C<sub>p</sub> outside 4.0–4.3) or unrealistic combinations.</li>
    </ul>
  </div>

  <div class="note-card">
    <h3>📏 Output Validations</h3>
    <ul class="note-list">
      <li><strong>Steam Flow Rate (ṁ<sub>s</sub>):</strong> Displayed in kg/s with 4 decimals.</li>
      <li><strong>Assessment:</strong>
        <ul>
          <li>ṁ<sub>s</sub> ≤ 0.01 kg/s: Very low demand — Steam requirement is minimal; verify process load.</li>
          <li>0.01 < ṁ<sub>s</sub> ≤ 5 kg/s: Normal demand — System steam demand is within expected range for industrial heating.</li>
          <li>ṁ<sub>s</sub> > 5 kg/s: High demand — Unusually high steam consumption; check insulation, heat losses, or sizing errors.</li>
        </ul>
      </li>
      <li>Warnings triggered for: ṁ<sub>s</sub> ≤ 0, non-finite results, or extreme values.</li>
    </ul>
  </div>

  <div class="note-card">
    <h3>📖 Governing Principle</h3>
    <p>
      There is no single, universal standard that dictates steam flow rate calculations for injection processes, but rather a combination of engineering standards and principles. The ASME B31 series of codes, such as ASME B31.1 for power piping and ASME B31.3 for process piping, are common frameworks used in the design of steam systems and calculators, often referencing standards like the IAPWS R7-97 Steam Table for property data.
    </p>
    <p><b>Key Standards and Principles</b></p>
    <p><b>ASME B31 Codes:</b> These codes provide guidelines for the design, construction, and maintenance of piping systems, including those for steam. They help ensure safety and proper function, which are critical for steam injection.</p>
    <p><b>IAPWS Steam Tables:</b> The International Association for the Properties of Water and Steam (IAPWS) publishes steam tables (such as R7-97) that provide the thermophysical properties of water and steam. These are essential for calculating mass flow rate and other parameters in engineering applications.</p>
    <p><b>Continuity Equation:</b> A fundamental principle of fluid mechanics, the continuity equation states that the mass flow rate is the product of density, velocity, and cross-sectional area (ṁ = ρvA). This forms the basis for many flow rate calculations.</p>
    <p><b>Specific Standards for Components:</b> Depending on the specific application, other standards might apply, such as those for orifice meters or specific types of valves, notes Forbes Marshall.</p>
    <p><b>What This Means for a Calculator</b></p>
    <p><b>Utilize Steam Tables:</b> The calculator would use data from IAPWS or similar steam property data to determine steam properties at various temperatures and pressures.</p>
    <p><b>Apply the Continuity Equation:</b> It would use the continuity equation (ṁ = ρvA) to calculate flow rates based on input parameters for pipe dimensions and steam conditions.</p>
    <p><b>Consider Pressure Drop:</b> Calculators may also factor in pressure drop, as described in Bureau of Energy Efficiency (BEE) guidelines, to ensure the steam reaches its destination at the correct pressure.</p>
    <p><b>Incorporate Piping Codes:</b> The design parameters and velocity recommendations within the calculator will likely align with the requirements of the ASME B31 codes to ensure system integrity and safety.</p>
  </div>

  <div class="note-card">
    <h3>🔚 Conclusion</h3>
    <p>
      This calculator provides reliable estimates of steam flow rate for injection processes, supporting <strong>energy optimization</strong>, <strong>QEHS compliance</strong>, and <strong>safe operations</strong>. Ensure input values (Q, h<sub>fg</sub>, T, C<sub>p</sub>) are accurate and validate with standards like ASME B31, IAPWS R7-97, or field data for critical applications to ensure efficient and safe steam system performance.
    </p>
  </div>
</div>

<script>
function showErrors(errors) {
  const errorBox = document.getElementById("resultError");
  const errorMessage = document.getElementById("errorMessage");
  const placeholder = document.getElementById("placeholder");
  const resultValue = document.getElementById("resultValue");

  errorMessage.innerHTML = errors.join("<br>");
  errorBox.classList.remove("hidden");
  placeholder.classList.add("hidden");
  resultValue.classList.add("hidden");
}

function calculateSteamFlow() {
  const Q = parseFloat(document.getElementById("Q")?.value.trim());
  const h_fg = parseFloat(document.getElementById("h_fg")?.value.trim());
  const T = parseFloat(document.getElementById("T")?.value.trim());
  const Cp = parseFloat(document.getElementById("Cp")?.value.trim());

  const steamFlowEl = document.getElementById("steamFlow");
  const feedbackEl = document.getElementById("feedbackContent");
  document.getElementById("resultError").classList.add("hidden");
  feedbackEl.innerHTML = "";

  const errors = [];
  const warnings = [];

  // ✅ Numeric validation
  if (![Q, h_fg, T, Cp].every(Number.isFinite)) {
    return showErrors(["👉 All inputs are required and must be numeric."]);
  }

  // ✅ Threshold validations
  if (Q <= 0 || Q > 5000) errors.push("👉 Heat Load (Q) must be >0 and ≤5000 kW.");
  if (h_fg < 1900 || h_fg > 2800) errors.push("👉 Latent Heat (h_fg) must be between 1900–2800 kJ/kg.");
  if (T < 0 || T >= 100) errors.push("👉 Temperature (T) must be between 0–99 °C.");
  if (Cp <= 0) errors.push("👉 Specific Heat (Cp) must be >0.");
  if (Cp < 4.0 || Cp > 4.3) warnings.push("⚠️ Cp is outside the typical water range (4.0–4.3 kJ/kg·°C).");

  // ✅ Denominator validation
  const denominator = h_fg - (T * Cp);
  if (denominator <= 0) errors.push("👉 Invalid combination: h_fg − (T·Cp) must be >0.");

  if (errors.length) return showErrors(errors);

  // ✅ Steam flow calculation
  const m_s = Q / denominator;
  if (m_s <= 0 || !Number.isFinite(m_s)) {
    return showErrors(["⚠️ Computed steam flow is invalid. Please check inputs."]);
  }

  // ✅ Output classification
  let feedback;
  if (m_s <= 0.01) {
    feedback = "⚠️ Very Low Demand: Steam requirement is minimal; verify process load.";
  } else if (m_s <= 5) {
    feedback = "✅ Normal Demand: System steam demand is within expected range for industrial heating.";
  } else {
    feedback = "❌ High Demand: Unusually high steam consumption; check insulation, heat losses, or sizing errors.";
  }

  // ✅ Result details
  let details = `<div>Steam Flow Rate = <b>${m_s.toFixed(4)}</b> kg/s</div>`;
  details += `<div style="margin-top:6px;">${feedback}</div>`;
  if (warnings.length) {
    details += `<div style="margin-top:8px; color:#b35d00;">${warnings.join(" | ")}</div>`;
  }

  steamFlowEl.textContent = m_s.toFixed(4);
  feedbackEl.innerHTML = details;

  // ✅ Switch UI states
  document.getElementById("placeholder").classList.add("hidden");
  document.getElementById("resultValue").classList.remove("hidden");
  document.getElementById("resultError").classList.add("hidden");
}

function printReport() {
  const el = document.getElementById('printDate');
  if (el) {
    const now = new Date();
    el.textContent = now.toLocaleDateString('en-US', {
      year: 'numeric', month: 'long', day: 'numeric'
    });
  }
  window.print();
}
</script>
<script src="{% static 'js/print.js' %}"></script>

</body>
</html>
{% endblock %}



<!-- 
📌 Steam Flow Calculator (Essentials)

🔹 Formula:
    • Steam Flow Rate (ṁₛ) = Q / [h_fg − (T × Cp)]
      - Q   = Heat Load (kW)
      - h_fg = Latent Heat of Vaporization (kJ/kg)
      - T   = Feedwater Temperature (°C)
      - Cp  = Specific Heat of Water (kJ/kg·°C)

🔹 Input Validations:
    • Heat Load (Q):
        - Required, numeric
        - Must be > 0 and ≤ 5000 kW
    • Latent Heat (h_fg):
        - Required, numeric
        - Must be between 1900–2800 kJ/kg
    • Temperature (T):
        - Required, numeric
        - Must be between 0–99 °C
    • Specific Heat (Cp):
        - Required, numeric
        - Must be > 0
        - Warning if outside 4.0–4.3 kJ/kg·°C (typical water range)
    • Denominator check:
        - h_fg − (T × Cp) must be > 0 (else invalid combination)

🔹 Output Validations:
    • Steam Flow (ṁₛ):
        - Must be finite and > 0
        - If invalid → show error
    • Classification:
        - ṁₛ ≤ 0.01 kg/s → ⚠️ Very Low Demand (minimal load, verify process)
        - 0.01 < ṁₛ ≤ 5 kg/s → ✅ Normal Demand (typical industrial heating)
        - ṁₛ > 5 kg/s → ❌ High Demand (check insulation, losses, or sizing)
    • Warnings:
        - Cp outside 4.0–4.3 → unusual, verify water property inputs
-->
