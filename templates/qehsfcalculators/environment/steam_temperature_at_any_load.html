{% extends 'base.html' %}
{% block title %}Steam Temperature At Any Load Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steam Temperature At Any Load Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0px 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .back-btn {
            background: linear-gradient(#1560bd, #000040);
            color: #ffffff;
            border: 2px solid #1560bd;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd;
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05);
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }

        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd, #000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center;
            flex-wrap: wrap;
        }

        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
            line-height: 1.1;
        }

        .rate-label { 
            color: #7f8c8d;
            font-size: 20px;
            font-weight: bold;
        }

        /* Responsive styles */
        @media (max-width: 1200px) {
            .rate-value {
                font-size: 38px;
            }
            .rate-label {
                font-size: 18px;
            }
        }
        
        @media (max-width: 992px) {
            .rate-value {
                font-size: 34px;
            }
            .rate-label {
                font-size: 17px;
            }
        }
        
        @media (max-width: 768px) {
            .rate-value {
                font-size: 30px;
                margin-bottom: 8px;
            }
            .rate-label {
                font-size: 16px;
            }
        }
        
        @media (max-width: 576px) {
            .rate-value {
                font-size: 28px;
                margin-bottom: 6px;
            }
            .rate-label {
                font-size: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .rate-display {
                flex-direction: column;
                gap: 2px;
                text-align: center;
            }
            .rate-value {
                font-size: 24px;
                margin-bottom: 4px;
            }
            .rate-label {
                font-size: 14px;
            }
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>

    <div class="btn-container">
        <a href="{% url 'environmentcategory_calculators' %}" class="back-btn">Back To Environment Calculators</a>
    </div>


<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}


<div class="calculator-header">
  <h1>Steam Temperature at Any Load Calculator</h1>
  <p>Estimate the steam temperature (Ts) in a heat exchanger based on secondary fluid temperatures and the system design constant. All temperatures are in ¬∞C.</p>
</div>

<div class="calc-content">
  <div class="calc-card">
    <h2>Enter Parameters</h2>

    <div class="form-group">
      <label for="TDC">Temperature Design Constant (TDC)</label>
      <input type="number" id="TDC" class="form-input" step="any" placeholder="e.g., 1.5">
    </div>

    <div class="form-group">
      <label for="T1">Secondary Fluid Inlet Temperature (T1 in ¬∞C)</label>
      <input type="number" id="T1" class="form-input" step="any" placeholder="e.g., 80">
    </div>

    <div class="form-group">
      <label for="T2">Secondary Fluid Outlet Temperature (T2 in ¬∞C)</label>
      <input type="number" id="T2" class="form-input" step="any" placeholder="e.g., 150">
    </div>

    <button class="calculate-btn" onclick="calculateSteamTemperature()">Calculate Steam Temperature</button>
  </div>

  <div class="result-card">
    <div class="result-placeholder" id="placeholder">
      <img src="/static/images/mlc_environment_result.png" alt="Steam system illustration">
      <p>This tool calculates the <strong>Steam Temperature (Ts)</strong> and provides safety assessment feedback.</p>
    </div>

    <div class="result-error hidden" id="resultError">
      <div class="error-icon">‚ùå</div>
      <div class="error-message" id="errorMessage"></div>
    </div>

    <div class="result-value hidden" id="resultValue">
      <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
        <h2>Result</h2>
      </div>

      <div class="rate-display">
        <div class="rate-value" id="steamTemp">0</div>
        <div class="rate-label" style="color:#2980b9; font-size:16px; font-weight:bold;">¬∞C (Ts)</div>
      </div>

      <div class="result-feedback">
        <div class="feedback-title">Assessment</div>
        <div class="feedback-content" id="feedbackContent"></div>
      </div>

      <div class="btn-wrapper">
        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
      </div>
    </div>
  </div>
</div>

<div class="note-section">

  <!-- About This Calculator -->
  <div class="note-card">
    <h3>üìò About This Calculator</h3>
    <p>Estimate the steam temperature (Ts) in a heat exchanger based on secondary fluid temperatures and the temperature design constant. Useful for thermal system efficiency, boiler and heat exchanger monitoring, and fire safety management.</p>
  </div>

  <!-- Parameters Used -->
  <div class="note-card">
    <h3>‚öô Parameters Used</h3>
    <ul class="note-list">
      <li><strong>TDC:</strong> Temperature Design Constant (dimensionless, >1)</li>
      <li><strong>T1:</strong> Secondary fluid inlet temperature (¬∞C)</li>
      <li><strong>T2:</strong> Secondary fluid outlet temperature (¬∞C)</li>
    </ul>
  </div>

  <!-- Input Validation Rules -->
  <div class="note-card">
    <h3>‚úÖ Input Validation Rules</h3>
    <ul class="note-list">
      <li>All inputs must be numeric.</li>
      <li>TDC must be >1 and ‚â§10 (prevent division by zero or negative denominator).</li>
      <li>T1 & T2 must be >0¬∞C (temperatures cannot be negative in real thermal systems).</li>
      <li>Reasonable upper limits: T1 & T2 ‚â§ 500¬∞C; TDC ‚â§ 10 for typical industrial systems.</li>
      <li>Warnings shown if decimal inputs are provided (rounded to 2 decimals).</li>
    </ul>
  </div>

  <!-- Output Validation / Assessment -->
  <div class="note-card">
    <h3>üìä Output Validation</h3>
    <ul class="note-list">
      <li>Steam temperature Ts displayed in ¬∞C with 2 decimals.</li>
      <li>Assessment messages based on Ts value (feedback displayed along with result):</li>
      <ul>
        <li>Ts &lt; 50¬∞C ‚Üí ‚ö†Ô∏è Too low ‚Äì may cause condensation and corrosion.</li>
        <li>50¬∞C ‚â§ Ts ‚â§ 300¬∞C ‚Üí ‚úÖ Safe operating temperature.</li>
        <li>Ts &gt; 300¬∞C ‚Üí ‚ùå High temperature ‚Äì risk of overheating, fire, or system damage.</li>
      </ul>
    </ul>
  </div>

  <!-- Standards / Safety Reference -->
<div class="note-card">
  <h3>üìè Standards / Safety References</h3>
  <p>This calculator follows relevant safety and quality standards including ASME Boiler and Pressure Vessel Code for thermal equipment, ISO 45001 for occupational health and safety, ISO 9001 for quality management of industrial heat exchangers, ISO 14001 for environmental compliance, ISO 4126-1 for pressure relief and safety devices, and TEMA guidelines for shell-and-tube heat exchanger design, alongside internal QEHS thermal safety protocols to ensure safe operation and monitoring of steam and fluid systems.</p>
</div>


  <!-- Conclusion -->
  <div class="note-card">
    <h3>‚úÖ Conclusion</h3>
    <ul>
      <li>Ensures proper steam temperature for energy efficiency and safe operation.</li>
      <li>Accurate inputs prevent equipment damage, overheating, or underperformance.</li>
      <li>Assessment feedback provides guidance for operational and safety measures.</li>
    </ul>
  </div>

</div>


<script>
function showErrors(errors) {
  const errorBox = document.getElementById("resultError");
  const errorMessage = document.getElementById("errorMessage");
  const placeholder = document.getElementById("placeholder");
  const resultValue = document.getElementById("resultValue");
  errorMessage.innerHTML = errors.join("<br>");
  errorBox.classList.remove("hidden");
  placeholder.classList.add("hidden");
  resultValue.classList.add("hidden");
}

function calculateSteamTemperature() {
  const TDC = parseFloat(document.getElementById("TDC").value);
  const T1 = parseFloat(document.getElementById("T1").value);
  const T2 = parseFloat(document.getElementById("T2").value);

  const errors = [];
  const warnings = [];
  const steamEl = document.getElementById("steamTemp");
  const feedbackEl = document.getElementById("feedbackContent");

  steamEl.textContent = "";
  feedbackEl.innerHTML = "";

  // Validations
  if (isNaN(TDC) || TDC <= 1 || TDC > 10) errors.push("TDC must be >1 and ‚â§10.");
  if (isNaN(T1) || T1 <= 0 || T1 > 500) errors.push("T1 must be >0¬∞C and ‚â§500¬∞C.");
  if (isNaN(T2) || T2 <= 0 || T2 > 500) errors.push("T2 must be >0¬∞C and ‚â§500¬∞C.");
  if (errors.length) return showErrors(errors);

  // Compute Ts
  const Ts = ((T2 * TDC) - T1) / (TDC - 1);

  // Assessment
  let assessment = "";
  if (Ts < 50) assessment = "‚ö†Ô∏è Too low ‚Äì may cause condensation and corrosion.";
  else if (Ts <= 300) assessment = "‚úÖ Safe operating temperature.";
  else assessment = "‚ùå High temperature ‚Äì risk of overheating or system damage.";

  // Display results
  steamEl.textContent = Ts.toFixed(2);
  feedbackEl.innerHTML = `<div>${assessment}</div>${warnings.length ? `<div style="color:#b35d00;">${warnings.join(" | ")}</div>` : ""}`;

  document.getElementById("placeholder").classList.add("hidden");
  document.getElementById("resultValue").classList.remove("hidden");
  document.getElementById("resultError").classList.add("hidden");
}

function printReport() {
  const el = document.getElementById('printDate');
  if (el) {
    el.textContent = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
  }
  window.print();
}
</script>


    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- 
üìå Steam Temperature Calculator

üîπ Formula (internal, not displayed):
    ‚Ä¢ Ts = ((T2 √ó TDC) ‚àí T1) / (TDC ‚àí 1)
      - Ts   = Calculated Steam Temperature [¬∞C]
      - TDC  = Temperature Difference Coefficient
      - T1   = Lower temperature [¬∞C]
      - T2   = Higher temperature [¬∞C]

üîπ Input Validations:
    ‚Ä¢ TDC (Temperature Difference Coefficient):
        - Required, numeric
        - Range: >1 and ‚â§10
    ‚Ä¢ T1 (Temperature 1):
        - Required, numeric
        - Range: >0¬∞C and ‚â§500¬∞C
    ‚Ä¢ T2 (Temperature 2):
        - Required, numeric
        - Range: >0¬∞C and ‚â§500¬∞C

üîπ Warnings / Edge Cases:
    ‚Ä¢ None in this implementation (only assessment messages)

üîπ Output & Feedback:
    ‚Ä¢ Ts displayed with 2 decimals
    ‚Ä¢ Status / Assessment:
        - Ts < 50 ‚Üí ‚ö†Ô∏è Too low ‚Äì may cause condensation and corrosion
        - Ts 50‚Äì300 ‚Üí ‚úÖ Safe operating temperature
        - Ts > 300 ‚Üí ‚ùå High temperature ‚Äì risk of overheating or system damage
    ‚Ä¢ Warnings displayed inline if triggered
-->
