{% extends 'base.html' %}
{% block title %}Lifting Force per Anchor Calculator - Precast Factory{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lifting Force per Anchor Calculator - Precast Factory</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding:0 20px;
            border-radius: 12px;
        }
        
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }
        
        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
        
        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }
        
        /* Layout */
        .calc-content {
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }
        
        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }
        
        /* Input rows for better organization */
        .ad-input-row {
            display: flex;
            gap: 15px;
        }
        
        .ad-input-row .form-group {
            flex: 1;
        }
        
        @media (max-width: 600px) {
            .ad-input-row {
                flex-direction: column;
                gap: 10px;
            }
        }
        
        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }
        
        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }
        
        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }
        
        .print-btn:hover {
            background: #1560bd;
        }
        
        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center; 
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }
        
        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }
        
        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }
        
        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }
        
        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }
        
        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
    
    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}
        
        <div class="calculator-header">
            <h1>Lifting Force per Anchor at Precast Factory</h1>
            <p>Calculate the lifting force per anchor for precast concrete elements</p>
        </div>
        
        <div class="calc-content">
            <!-- Calculator -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                
                <div class="ad-input-row">
                    <div class="form-group">
                        <label for="G">Weight of the slab (G) [kN]</label>
                        <input type="number" id="G" class="form-input" step="any" min="0.0001" placeholder="e.g., 50">
                    </div>
                    <div class="form-group">
                        <label for="Hq">Formwork adhesion force (Hq) [kN]</label>
                        <input type="number" id="Hq" class="form-input" step="any" min="0.0001" placeholder="e.g., 5">
                    </div>
                </div>
                
                <div class="ad-input-row">
                    <div class="form-group">
                        <label for="f">Lifting load factor (f)</label>
                        <input type="number" id="f" class="form-input" step="any" min="0.0001" value="1.3" placeholder="e.g., 1.3">
                    </div>
                    <div class="form-group">
                        <label for="z">Cable angle factor (z)</label>
                        <input type="number" id="z" class="form-input" step="any" min="0.0001" value="1.04" placeholder="e.g., 1.04">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="n">Number of anchors (n)</label>
                    <input type="number" id="n" class="form-input" step="any" min="2" value="4" placeholder="e.g., 4">
                </div>
                
                <button class="calculate-btn" onclick="calculateLiftingForce()">Calculate Lifting Force</button>
            </div>
            
            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Safety illustration">
                    <p>This tool will calculate the <strong>Lifting Force per Anchor</strong>. Enter your data to see results and insights here.</p>
                </div>
                
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">❌</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                
                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Lifting Force per Anchor</h2>
                    </div>
                    <div class="rate-display">
                        <div class="rate-value" id="rateValue">0.00</div>
                        <div class="rate-label" style="color:#2980b9; font-size:20px; font-weight:bold;">kN</div>
                    </div>
                    
                    <div class="result-feedback">
                        <div class="feedback-title">Assessment</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Notes Section -->
<div class="note-section">

  <!-- 📘 ABOUT -->
  <div class="note-card">
    <h3>📘 About This Calculator</h3>
    <p>
      This calculator determines the <strong>lifting force per anchor</strong> for precast concrete elements in factory settings. 
      It ensures safe lifting operations by calculating the force exerted on each anchor point.
    </p>
  </div>

  <!-- ⚙️ PARAMETERS USED -->
  <div class="note-card">
    <h3>⚙️ Parameters Used</h3>
    <ul class="note-list">
      <li><strong>Weight of the slab (G):</strong> Total weight of the precast slab in kilonewtons (kN).</li>
      <li><strong>Formwork adhesion force (Hq):</strong> Additional force due to adhesion between formwork and concrete (kN).</li>
      <li><strong>Lifting load factor (f):</strong> Safety factor accounting for dynamic effects during lifting (typically 1.3).</li>
      <li><strong>Cable angle factor (z):</strong> Factor accounting for cable orientation (typically 1.04 for vertical lifts).</li>
      <li><strong>Number of anchors (n):</strong> Number of lifting points supporting the load (minimum 2 for stability).</li>
    </ul>
  </div>

  <!-- ✅ INPUT VALIDATION RULES -->
  <div class="note-card">
    <h3>✅ Input Validation Rules</h3>
    <ul class="note-list">
      <li>Weight of slab (G): 1 – 5000 kN (must be >0)</li>
      <li>Formwork adhesion force (Hq): 0 – 50 kN, cannot exceed 50% of G</li>
      <li>Lifting load factor (f): 1.0 – 2.0 (typical 1.2–1.5)</li>
      <li>Cable angle factor (z): 1.0 – 2.0 (typical 1.0–1.2)</li>
      <li>Number of anchors (n): Integer, 2 – 20 (minimum 2 for stability)</li>
      <li>❌ Negative, zero, unrealistic, or illogical inputs are rejected.</li>
      <li>⚠️ Division by zero prevented.</li>
    </ul>
  </div>

  <!-- 🧾 OUTPUT VALIDATIONS -->
  <div class="note-card">
    <h3>🧾 Output Validations</h3>
    <ul class="note-list">
      <li>The calculated lifting force per anchor is displayed along with feedback to interpret safety.</li>
      <li><b>Assessment / Feedback Messages:</b></li>
      <ul class="note-sublist">
        <li>✅ Safe. Each anchor carries low force (below 25 kN).</li>
        <li>⚠️ Caution. Each anchor carries 25–50 kN. Verify anchor rating.</li>
        <li>❌ Unsafe. Each anchor carries above 50 kN. Increase anchors or upgrade anchors.</li>
      </ul>
      <li>Feedback messages appear alongside the result to guide safe lifting decisions.</li>
    </ul>
  </div>

  <!-- ⚖️ GOVERNING PRINCIPLE -->
  <div class="note-card">
    <h3>⚖️ Governing Principle</h3>
    <p>
      Lifting force calculations for precast factory anchors are not based on a single global standard but on various national and regional building codes, design guides, and manufacturer specifications. These sources account for factors specific to a project's location and the manufacturer's own products.
    </p>
    <ul class="note-list">
      <li><strong>European Standards (Eurocodes):</strong> EN 1992 (Eurocode 2) and EN 1992-1-1 provide guidance for structural design, concrete strength, and embedded component behavior relevant to lifting.</li>
      <li><strong>North American Standards:</strong> PCI Design Handbook (Precast/Prestressed Concrete Institute) and CSA A23.3 cover lifting, handling, and anchorage requirements.</li>
      <li><strong>Australian Standards:</strong> AS 3850 (Tilt-up concrete construction) guides lifting and handling practices.</li>
      <li><strong>General Design Considerations:</strong> Dynamic loading, element self-weight, concrete strength at lift, formwork adhesion, and rigging configuration affect the force on each anchor.</li>
      <li>Reputable precast manufacturers provide their own methods aligned with relevant national standards and product testing.</li>
    </ul>
  </div>

  <!-- 🏁 CONCLUSION -->
  <div class="note-card">
    <h3>🏁 Conclusion</h3>
    <p>
      This calculator provides lifting force per anchor along with clear feedback messages that reflect safety assessments. 
      By interpreting results according to the displayed assessments, users can plan safe lifting operations, prevent anchor overload, and comply with relevant national and regional standards.
    </p>
  </div>

</div>

    
    <script>
        // Set current date for print header
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
        });
        
        function calculateLiftingForce() {
    const G = parseFloat(document.getElementById('G').value.trim());
    const Hq = parseFloat(document.getElementById('Hq').value.trim());
    const f = parseFloat(document.getElementById('f').value.trim());
    const z = parseFloat(document.getElementById('z').value.trim());
    const n = parseFloat(document.getElementById('n').value.trim());

    // Get elements
    const placeholder = document.getElementById('placeholder');
    const resultError = document.getElementById('resultError');
    const resultValue = document.getElementById('resultValue');
    const errorMessage = document.getElementById('errorMessage');
    const rateValue = document.getElementById('rateValue');
    const feedbackContent = document.getElementById('feedbackContent');

    // Reset UI
    placeholder.classList.add('hidden');
    resultError.classList.add('hidden');
    resultValue.classList.add('hidden');

    let errorMsg = '';

    // Validation checks
    if (isNaN(G) || G < 1 || G > 5000) {
        errorMsg = '⚠️ Weight of the slab (G) must be between 1 and 5000 kN.';
    } else if (isNaN(Hq) || Hq < 0 || Hq > 50) {
        errorMsg = '⚠️ Formwork adhesion force (Hq) must be between 0 and 50 kN.';
    } else if (Hq > 0.5 * G) {
        errorMsg = '⚠️ Formwork adhesion force (Hq) cannot exceed 50% of slab weight (G).';
    } else if (isNaN(f) || f < 1.0 || f > 2.0) {
        errorMsg = '⚠️ Lifting load factor (f) must be between 1.0 and 2.0.';
    } else if (isNaN(z) || z < 1.0 || z > 2.0) {
        errorMsg = '⚠️ Cable angle factor (z) must be between 1.0 and 2.0.';
    } else if (isNaN(n) || n % 1 !== 0 || n < 2 || n > 20) {
        errorMsg = '⚠️ Number of anchors (n) must be an integer between 2 and 20.';
    }

    if (errorMsg) {
        errorMessage.textContent = errorMsg;
        resultError.classList.remove('hidden');
        return;
    }

    // Calculate lifting force per anchor
    const liftingForce = ((G + Hq) * f * z) / n;
    rateValue.textContent = liftingForce.toFixed(2);

    // Feedback
    if (liftingForce < 25) {
        feedbackContent.innerHTML = `
            <span class="good">✅ Safe.</span><br>
            Each anchor carries ${liftingForce.toFixed(2)} kN (low risk).
        `;
    } else if (liftingForce <= 50) {
        feedbackContent.innerHTML = `
            <span class="average">⚠️ Caution.</span><br>
            Each anchor carries ${liftingForce.toFixed(2)} kN. Verify anchor rating.
        `;
    } else {
        feedbackContent.innerHTML = `
            <span class="bad">❌ Unsafe!</span><br>
            Each anchor carries ${liftingForce.toFixed(2)} kN. Increase anchors or upgrade anchors.
        `;
    }

    resultValue.classList.remove('hidden');
}
        
        function printReport() {
            window.print();
        }
    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}

{% comment %} 

/*
Formula:
F_anchor = ((G + Hq) * f * z) / n

Validation Rules:
- G (Weight of slab): 1 – 5000 kN
- Hq (Formwork adhesion): 0 – 50 kN, must not exceed 50% of G
- f (Lifting load factor): 1.0 – 2.0
- z (Cable angle factor): 1.0 – 2.0
- n (Number of anchors): integer, 2 – 20
*/

1. Formula Used

The formula applied is:

Lifting Force per Anchor (F_anchor) = ((G + Hq) × f × z) ÷ n


Where:

G = Weight of slab [kN]

Hq = Formwork adhesion force [kN]

f = Lifting load factor (safety/dynamic effect, typically 1.2–1.5)

z = Cable angle factor (accounts for non-vertical lifting, typically 1.0–1.2)

n = Number of anchors (≥2 required for stability)

✅ This formula is consistent with industry practices in precast lifting safety engineering, where EN 1991-1-6 (Actions during execution) and OSHA/NFPA lifting safety guidelines emphasize factoring dynamic loads and sling geometry.

2. Detailed Input Validation Rules

Here are compliance-based validation ranges (with justification):

(a) Weight of the slab (G) [kN]

Min: 1 kN (≈100 kg slab minimum practical for lifting anchors).

Max: 5,000 kN (≈500 tonnes, practical upper bound for precast factory lifts).

Decimals: Allowed (step = 0.01).

Rule: Must be positive.

➡ Justification: Negative/zero weight is non-physical. Over 5,000 kN should trigger a warning (too high for normal precast).

(b) Formwork adhesion force (Hq) [kN]

Min: 0 (can be negligible in some cases).

Max: 50 kN (based on concrete adhesion forces in precast factories).

Decimals: Allowed (step = 0.01).

Rule: Must not exceed 50% of G (adhesion > weight is illogical).

➡ Justification: Adhesion is additional resistance but cannot surpass slab weight.

(c) Lifting load factor (f)

Min: 1.0 (static lift, no dynamic factor).

Max: 2.0 (covers shock loads, per EN 1991-1-6 & ISO 12480 lifting guidelines).

Default: 1.3.

Rule: Must not be <1.0.

➡ Justification: Factor <1.0 would reduce the load artificially, which is unsafe.

(d) Cable angle factor (z)

Min: 1.0 (vertical lift, safest).

Max: 2.0 (extreme shallow sling angles ~30°).

Default: 1.04.

Rule: Must not be <1.0.

➡ Justification: Factor <1.0 implies force reduction due to angle, which is false. Very shallow sling angles significantly amplify anchor forces.

(e) Number of anchors (n)

Min: 2 (minimum stability).

Max: 20 (practical precast lifting limit).

Decimals: Not allowed (must be integer).

➡ Justification: Single anchor lifting is unstable. Excessive anchors (>20) is unrealistic and unsafe.

3. Output Validation & Thresholds

Current thresholds are good but let’s refine:

Safe (Low): <25 kN per anchor
→ Standard lifting anchors can handle this load.

Moderate (Caution): 25–50 kN per anchor
→ Verify anchor manufacturer’s SWL (Safe Working Load).

High (Unsafe): >50 kN per anchor
→ Requires engineering review, more anchors, or stronger anchors.

➡ Justification: Thresholds align with standard precast anchor capacities (commonly 25–50 kN per unit). {% endcomment %}