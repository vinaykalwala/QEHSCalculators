{% extends 'base.html' %}
{% block title %}Ladder Length Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ladder Length Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding:0 20px;
            border-radius: 12px;
        }
        
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 380px;
            overflow-y: auto;
            justify-content: center;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd, #000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            height: 380px;
            overflow-y:auto;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .result-item {
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            text-align: left;
        }
        
        .result-label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .result-data {
            font-size: 18px;
            color: #2980b9;
            font-weight: 600;
        }

        /* Note Section */
        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
    
    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Ladder Length Calculator</h1>
            <p>Calculate the ideal ladder length needed for a given vertical height</p>
        </div>

        <div class="calc-content">
            <!-- Calculator -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="verticalHeight">Vertical Height (VH) (m)</label>
                    <input type="number" id="verticalHeight" class="form-input" step="0.01" min="0.1" placeholder="e.g., 5.5">
                </div>
                
                <button class="calculate-btn" onclick="calculateLadderLength()">Calculate Ladder Length</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Safety illustration">
                    <p>This tool will calculate the <strong>Ladder Length</strong>. Enter your data to see results here.</p>
                </div>
                
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                 
                <div class="result-value hidden" id="resultValue">
                    <h2 style="color: #1560bd; margin-bottom: 20px; margin-top:30px;">Calculated Ladder Length</h2>
                    
                    <div class="result-item">
                        <div class="result-label">Base Distance</div>
                        <div class="result-data" id="baseDistance">0.00 meters</div>
                    </div>
                    
                    <div class="result-item">
                        <div class="result-label">Ladder Length (without safety margin)</div>
                        <div class="result-data" id="ladderLength">0.00 meters</div>
                    </div>
                    
                    <div class="result-item">
                        <div class="result-label">Total Ladder Length (with safety margin)</div>
                        <div class="result-data" id="totalLadderLength">0.00 meters</div>
                    </div>
                    
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
<div class="note-section">

  <!-- üìò ABOUT -->
  <div class="note-card">
    <h3>üìò About This Calculator</h3>
    <p>
      The <strong>Ladder Length Calculator</strong> helps determine the ideal ladder length needed for a given vertical height 
      while maintaining the recommended setup angle for safety and compliance. It applies the <b>4:1 rule</b> 
      (for every 4 meters of height, 1 meter of base distance) and adds a 1-meter safety margin above the support point 
      as per international safety standards.
    </p>
  </div>

  <!-- ‚öôÔ∏è PARAMETERS USED -->
  <div class="note-card">
    <h3>‚öôÔ∏è Parameters Used</h3>
    <ul class="note-list">
      <li><strong>Vertical Height (VH):</strong> Height from ground to support point (in meters).</li>
      <li><strong>Base Distance (BD):</strong> Calculated using the 4:1 ladder rule.</li>
      <li><strong>Ladder Length (L):</strong> Computed length of the ladder considering geometry and safety margin.</li>
      <li><strong>Safety Margin:</strong> Additional 1 meter above support point for safe access.</li>
    </ul>
  </div>

  <!-- ‚úÖ INPUT VALIDATION RULES -->
  <div class="note-card">
    <h3>‚úÖ Input Validation Rules</h3>
    <ul class="note-list">
      <li><b>Vertical Height:</b> Must be between <b>0.1 m</b> and <b>6 m</b>.</li>
      <li><b>Decimal Precision:</b> Up to <b>two decimal places</b> allowed.</li>
      <li><b>Base Distance:</b> Automatically calculated using 4:1 rule.</li>
      <li><b>Safety Margin:</b> 1 meter automatically added for proper support clearance.</li>
      <li><b>Warning Limit:</b> If the total ladder length exceeds 6 m ‚Üí scaffolding or aerial lift recommended.</li>
      <li><b>Compliance:</b> OSHA 1926.1053, ANSI A14.2, ISO 14122-4 standards are followed.</li>
    </ul>
  </div>

  <!-- üßæ OUTPUT VALIDATIONS -->
  <div class="note-card">
    <h3>üßæ Output Validations</h3>
    <ul class="note-list">
      <li>The calculated ladder length and base distance are validated against safety and usability standards.</li>
      <li>Outputs are rounded to two decimals and expressed in meters for accuracy.</li>
      <li><b>Assessment Messages (Feedback):</b></li>
      <ul class="note-sublist">
        <li>‚úÖ <b>Safe Setup:</b> If total ladder length ‚â§ 6 m ‚Üí setup angle and safety margin are acceptable.</li>
        <li>‚ö†Ô∏è <b>Advisory Warning:</b> If total ladder length > 6 m ‚Üí scaffolding or aerial lifts should be used instead of portable ladders.</li>
      </ul>
      <li>All outputs are checked for physical feasibility and compliance with OSHA and ANSI standards.</li>
      <li>Invalid or unrealistic inputs automatically trigger warnings before calculation results are shown.</li>
    </ul>
  </div>

  <!-- ‚öñÔ∏è GOVERNING PRINCIPLE -->
  <div class="note-card">
    <h3>‚öñÔ∏è Governing Principle</h3>
    <p>
        <strong>Ladder length calculation</strong> standards depend on geographic location and specific use cases. Common standards include the European EN131 standards, North American OSHA and ANSI standards, and Indian Standards (IS codes) such as IS 3696 for safety and IS 4571 for aluminum extension ladders. 
        These standards provide guidance on minimum safety requirements, material specifications, and dimensions for various types of portable and fixed ladders.
    </p>

    <h4>International & Regional Standards</h4>
    <ul class="note-list">
        <li><strong>EN131 (European Union):</strong> Covers portable step and ladder safety, including ladders made from materials like metal and fiberglass.</li>
        <li><strong>OSHA & ANSI (North America):</strong> OSHA regulations 1910.23 and 1926.1053 define safe ladder design and use, while ANSI standards such as ANSI A14.5 provide additional guidance for multi-position and platform ladders.</li>
        <li><strong>Indian Standards (IS codes):</strong> IS 3696-2 specifies safety codes for scaffolds and ladders, and IS 4571 covers aluminum extension ladders, often for firefighting or specialized applications.</li>
    </ul>

    <h4>Factors Influencing Calculation</h4>
    <ul class="note-list">
        <li><strong>Ladder Type:</strong> Standards differ for portable step ladders, multi-position ladders, fixed ladders, or telescopic ladders.</li>
        <li><strong>Intended Use:</strong> Some standards are application-specific (e.g., IS 4571 for fire fighting), while others like OSHA are general workplace safety standards.</li>
        <li><strong>Material:</strong> The material affects the standard applied‚Äîmetal ladders follow EN131, aluminum extension ladders follow IS 4571, etc.</li>
    </ul>

    <p>
        In essence, ladder length calculations adhere to regional and international safety standards to ensure stability, user safety, and compliance with local regulations.
    </p>
</div>


  <!-- üèÅ CONCLUSION -->
  <div class="note-card">
    <h3>üèÅ Conclusion</h3>
    <p>
      The Ladder Length Calculator ensures safe ladder selection and setup by adhering to global safety standards 
      and practical engineering principles. It guides users to maintain the correct setup angle, incorporate the necessary 
      safety margin, and avoid unsafe ladder usage beyond permissible height limits.
    </p>
  </div>

</div>


    <script>
        // Set current date for print header
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
        });

        function calculateLadderLength() {
    const verticalHeightInput = document.getElementById('verticalHeight').value.trim();
    const verticalHeight = parseFloat(verticalHeightInput);

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');

    let errors = [];
    let warnings = [];

    // ‚úÖ Input Validations
    if (verticalHeightInput === "" || isNaN(verticalHeight)) {
        errors.push("üëâ Please enter the vertical height in meters.");
    } else if (verticalHeight <= 0) {
        errors.push("üëâ Vertical height must be greater than 0.");
    } else if (verticalHeight < 0.1) {
        errors.push("üëâ Vertical height must be at least 0.1 meters.");
    } else if (verticalHeight > 6) {
        errors.push("üëâ Vertical height cannot exceed 6 meters. Use scaffolding or aerial lift.");
    } else if (!/^\d+(\.\d{1,2})?$/.test(verticalHeightInput)) {
        errors.push("üëâ Please enter a valid number with up to two decimal places.");
    }

    // ‚ùå Error Handling
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    // ‚úÖ Calculations
    const baseDistance = verticalHeight / 4;
    const ladderLength = Math.sqrt(Math.pow(verticalHeight, 2) + Math.pow(baseDistance, 2));
    const totalLadderLength = ladderLength + 1;

    // ‚ö†Ô∏è Warning if ladder impractically long
    if (totalLadderLength > 6) {
        errors.push("‚ö†Ô∏è Total ladder length exceeds 6m. Consider scaffolding or aerial lifts instead of a portable ladder.");
    }

    // Display results
    document.getElementById('baseDistance').textContent = baseDistance.toFixed(2) + " meters";
    document.getElementById('ladderLength').textContent = ladderLength.toFixed(2) + " meters";
    document.getElementById('totalLadderLength').textContent = totalLadderLength.toFixed(2) + " meters";

    placeholder.classList.add('hidden');
    resultValue.classList.remove('hidden');

    // Show warnings in result section (optional)
    if (warnings.length > 0) {
        alert(warnings.join("\n"));
    }
}

        function printReport() {
            // Update date just before printing
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
            
            window.print();
        }
    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


{% comment %} 
1Ô∏è‚É£ Input Validation Rules (QEHS/Fire Safety Perspective)

Field: Vertical Height (VH) (m)

‚úî Unit: Meters only (SI standard, universally used in safety compliance).
‚úî Range:

Min: 0.1 m (anything less is negligible, impractical, or unsafe to climb).

Max: 100 m (OSHA & ANSI ladders are not practical above this; beyond ~15 m, scaffolds or lifts are required).
‚úî Precision: Up to 2 decimals (0.01 m resolution is more than sufficient).
‚úî Logical Consistency:

VH must be numeric.

Cannot be negative, zero, or blank.

Must not exceed maximum rated ladder use (‚âà100 m).

2Ô∏è‚É£ Output Validation Rules & Thresholds

Base Distance (BD): VH √∑ 4 (4:1 safety ratio). Must be ‚â•0.25 m for practical ladder placement.

Ladder Length (LL): ‚àö(VH¬≤ + BD¬≤). Always > VH.

Total Ladder Length (TLL): LL + 1 m (safety margin). Must not exceed commercially available ladders (usually ‚â§15‚Äì20 m for portable ladders).

‚û°Ô∏è If TLL > 20 m ‚Üí Show a warning message: ‚Äú‚ö†Ô∏è Consider scaffolding or aerial lift. Portable ladders may not be safe at this height.‚Äù

3Ô∏è‚É£ Edge Case Validations

Blank input / Non-numeric ‚Üí Error: ‚ÄúPlease enter a numeric value.‚Äù

Zero or Negative VH ‚Üí Error: ‚ÄúVertical height must be greater than 0.‚Äù

VH > 100 m ‚Üí Error: ‚ÄúVertical height cannot exceed 100 m. Use scaffolding/lift.‚Äù

Too many decimals (>2) ‚Üí Error: ‚ÄúPlease enter up to two decimal places.‚Äù

Unrealistic combos ‚Üí If calculated ladder length > 20 m ‚Üí Warning instead of error.

4Ô∏è‚É£ Compliance Justification

OSHA 1926.1053(b)(5)(i): Ladders must extend ‚â•1 m (3 ft) above support point.

ANSI A14.2: Portable ladders max angle ‚âà 75.5¬∞ (4:1 ratio).

ISO 14122-4: Requires permanent access above certain heights instead of ladders.

Practical fire safety: ladders over 15 m introduce instability; scaffolds or lifts are recommended.

5Ô∏è‚É£ Corrected JavaScript Validation Function
/*
 FORMULAS USED:
 Base Distance (BD) = Vertical Height (VH) √∑ 4   // 4:1 rule
 Ladder Length (LL) = ‚àö(VH¬≤ + BD¬≤)               // Pythagoras theorem
 Total Ladder Length (TLL) = LL + 1              // 1m OSHA/ANSI safety margin

 VALIDATIONS:
 - VH must be numeric, > 0, ‚â§ 100 (m)
 - VH min: 0.1m (practical minimum)
 - VH max: 100m (beyond this ‚Üí scaffold/lift required)
 - Decimals: max 2 places
 - Outputs: if TLL > 20m ‚Üí show warning about portable ladder limits
*/ {% endcomment %}