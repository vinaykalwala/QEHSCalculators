{% extends 'base.html' %}
{% block title %}Leading Safety Indicators Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leading Safety Indicators Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
         /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding:0 20px;
            border-radius: 12px;
        }
                .btn-container {
    display: flex;
    justify-content: center; /* Horizontally center */
    margin: 30px 0;
}

.back-btn {
    background:linear-gradient(#1560bd,#000040); /* Dark navy background */
    color: #ffffff; /* White text */
    border: 2px solid #1560bd; /* Highlight border */
    padding: 10px 20px;
    font-size: 14px;
    font-weight: 600;
    border-radius: 8px;
    text-decoration: none; /* Remove underline for link */
    transition: all 0.3s ease;
    cursor: pointer;
}

.back-btn:hover {
    background-color: #1560bd; /* Highlight on hover */
    color: #ffffff;
    border-color: #000040;
    transform: scale(1.05); /* Subtle hover effect */
}

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            {% comment %} max-width: 700px; {% endcomment %}
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            {% comment %} display: flex; {% endcomment %}
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
            {% comment %} overflow-y: auto; {% endcomment %}
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }
        /* Input rows for side-by-side fields */
         .input-row {
            display: flex;
            flex-direction: column;
            gap: 15px;
            {% comment %} margin-bottom: 15px; {% endcomment %}
        }
        
        @media (min-width: 480px) {
            .input-row {
                flex-direction: row;
            }
        }
        
        .input-row .form-group {
            flex: 1;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center; 
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
       
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
    
    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Leading Safety Indicators Calculator</h1>
            <p>Measure proactive safety performance with leading safety indicators</p>
        </div>

        <div class="calc-content">
            <!-- Calculator -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="input-row">
                <div class="form-group">
                    <label for="indicatorType">Select Indicator Type:</label>
                    <select id="indicatorType" class="form-select" onchange="updateFields()">
                        <option value="inspections">Inspections</option>
                        <option value="trainings">Trainings</option>
                        <option value="hazardReports">Hazard Reports</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label id="numActionsLabel" for="numActions">Number of Actions:</label>
                    <input type="number" id="numActions" class="form-input" placeholder="Enter number of actions" min="0">
                </div></div>
                
                <div class="input-row">
                <div class="form-group">
                    <label for="timeUnit">Select Time Period:</label>
                    <select id="timeUnit" class="form-select" onchange="updatePlaceholder()">
                        <option value="days">Days</option>
                        <option value="months">Months</option>
                        <option value="years">Years</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label id="timeLabel" for="timePeriod">Time Period (days):</label>
                    <input type="number" id="timePeriod" class="form-input" placeholder="Enter time period" min="1">
                </div></div>
                
                <button class="calculate-btn" onclick="calculateSafetyRate()">Calculate Safety Rate</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Safety illustration">
                    <p>This tool will calculate the <strong>Proactive Safety Rate</strong> based on your leading safety indicators. Enter your data to see results and insights here.</p>
                </div>
                
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">❌</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                 
                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Proactive Safety Rate</h2>
                    </div>
                    <div class="rate-display">
                        <div class="rate-value" id="rateValue">0.00</div>
                        <div class="rate-label" style="color:#2980b9; font-size:20px; font-weight:bold;">actions per day</div>
                    </div>

                    <div class="safety-meter">
                        <div class="meter-fill" id="meterFill"></div>
                    </div>
                    <div class="meter-labels">
                        <span>Low</span><span>Moderate</span><span>Good</span><span>Excellent</span><span>Outstanding</span>
                    </div>

                    <div class="result-feedback">
                        <div class="feedback-title">Performance Assessment</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
<div class="note-section">

  <!-- 📘 ABOUT -->
  <div class="note-card">
    <h3>📘 About This Calculator</h3>
    <p>
      This tool calculates the <strong>Proactive Safety Rate (PSR)</strong> based on leading safety indicators, 
      which are preventive measures that help identify and mitigate potential hazards before incidents occur.
    </p>
  </div>

  <!-- ⚙️ PARAMETERS USED -->
  <div class="note-card">
    <h3>⚙️ Parameters Used</h3>
    <ul class="note-list">
      <li><strong>Indicator Type:</strong> Category of safety activity (inspections, trainings, or hazard reports)</li>
      <li><strong>Number of Actions:</strong> Total count of safety-related activities performed during the selected period</li>
      <li><strong>Time Period:</strong> Duration over which activities were performed (days, months, or years)</li>
    </ul>
  </div>

  <!-- ✅ INPUT VALIDATION RULES -->
  <div class="note-card">
    <h3>✅ Input Validation Rules</h3>
    <ul class="note-list">
      <li><b>Number of Actions:</b> ≥ 0, must be a whole number, realistic maximum 10,000</li>
      <li><b>Time Period:</b> > 0, must be whole number, ranges:
        <ul>
          <li>Days: 1–365</li>
          <li>Months: 1–120</li>
          <li>Years: 1–10</li>
        </ul>
      </li>
      <li><b>Time Unit:</b> Must be one of "days", "months", or "years"</li>
      <li><b>Indicator Type:</b> Must be one of "inspections", "trainings", or "hazardReports"</li>
      <li><b>Edge Cases:</b> Prevent division by zero, negative values, or unrealistic ratios (>100 actions/day)</li>
    </ul>
  </div>

  <!-- 🧾 OUTPUT VALIDATIONS -->
  <div class="note-card">
    <h3>🧾 Output Validations</h3>
    <ul class="note-list">
      <li>The calculated PSR is displayed along with the indicator type and time period.</li>
      <li><b>Assessment / Feedback Messages:</b></li>
      <ul class="note-sublist">
        <li>&lt; 0.1 actions/day → ✅ Low engagement in safety activities. Consider increasing the frequency of your activities to improve workplace safety.</li>
        <li>0.1–0.5 actions/day → ⚠️ Moderate engagement in safety activities. Room for improvement to strengthen safety culture.</li>
        <li>0.5–2.0 actions/day → ✅ Good safety culture. Maintain proactive safety measures.</li>
        <li>2.0–5.0 actions/day → ✅ Excellent proactive safety performance. Strong commitment to preventing incidents.</li>
        <li>&gt; 5.0 actions/day → ✅ Outstanding proactive safety rate. Sets a benchmark for excellence in safety management.</li>
      </ul>
      <li>Feedback messages appear alongside calculated results to guide improvement and safety decision-making.</li>
    </ul>
  </div>

  <!-- ⚖️ GOVERNING PRINCIPLE -->
  <div class="note-card">
    <h3>⚖️ Governing Principle</h3>
    <p>
      Leading safety indicators are not a single "standard" but a concept encouraged by major organizations like OSHA 
      and standards bodies such as ISO and ANSI, who provide guidance on their use and integration into management systems.
      OSHA's recommended practices emphasize both leading and lagging indicators, while ISO 45001 provides guidelines for 
      incorporating leading indicators into broader health and safety systems.
    </p>
    <ul class="note-list">
      <li><strong>OSHA:</strong> Defines leading indicators as proactive measures to identify and address hazards before incidents occur, and encourages their use to prevent injuries and improve performance.</li>
      <li><strong>ISO 45001:</strong> Provides guidance on integrating leading indicators into an organization's occupational health and safety management system.</li>
      <li><strong>ANSI Z16.1:</strong> Historical framework for safety metrics, including leading indicators.</li>
      <li><strong>Industry Best Practices:</strong> Various industries adopt leading indicators as part of best practices for managing safety.</li>
      <li><strong>Summary:</strong> No singular "standard," but widely recognized by regulatory bodies, standards organizations, and industry groups.</li>
    </ul>
  </div>

  <!-- 🏁 CONCLUSION -->
  <div class="note-card">
    <h3>🏁 Conclusion</h3>
    <p>
      This calculator provides an accurate proactive safety rate, offering feedback that reflects engagement levels in safety 
      activities. By interpreting the results according to recognized feedback messages, organizations can monitor, improve, 
      and benchmark their proactive safety performance effectively.
    </p>
  </div>

</div>


    <script>
         // Set current date for print header
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
        });
        function updateFields() {
            const indicatorType = document.getElementById('indicatorType').value;
            const numActionsLabel = document.getElementById('numActionsLabel');

            switch (indicatorType) {
                case "inspections":
                    numActionsLabel.innerText = "Number of Inspections:";
                    break;
                case "trainings":
                    numActionsLabel.innerText = "Number of Trainings:";
                    break;
                case "hazardReports":
                    numActionsLabel.innerText = "Number of Hazard Reports:";
                    break;
                default:
                    numActionsLabel.innerText = "Number of Actions:";
            }
        }

        function updatePlaceholder() {
            const timeUnit = document.getElementById('timeUnit').value;
            const timeLabel = document.getElementById('timeLabel');
            const timePeriodInput = document.getElementById('timePeriod');

            switch (timeUnit) {
                case "days":
                    timeLabel.innerText = "Time Period (days):";
                    timePeriodInput.placeholder = "Enter number of days";
                    break;
                case "months":
                    timeLabel.innerText = "Time Period (months):";
                    timePeriodInput.placeholder = "Enter number of months";
                    break;
                case "years":
                    timeLabel.innerText = "Time Period (years):";
                    timePeriodInput.placeholder = "Enter number of years";
                    break;
                default:
                    timeLabel.innerText = "Time Period (days):";
                    timePeriodInput.placeholder = "Enter time period";
            }
        }

        function calculateSafetyRate() {
    const actionsInput = document.getElementById('numActions').value;
    const timeInput = document.getElementById('timePeriod').value;
    const timeUnit = document.getElementById('timeUnit').value;
    const indicatorType = document.getElementById('indicatorType').value;

    let actions = parseFloat(actionsInput);
    let time = parseFloat(timeInput);

    // --- VALIDATION ---

    // Check if inputs are numbers
    if (isNaN(actions) || isNaN(time)) {
        showError("Please enter valid numeric values for both actions and time period.");
        return;
    }

    // Validate Actions
    if (actions < 0) {
        showError("Number of actions cannot be negative.");
        return;
    }
    if (!Number.isInteger(actions)) {
        showError("Number of actions must be a whole number.");
        return;
    }
    if (actions > 10000) {
        showError("Number of actions exceeds the realistic maximum (10,000). Please recheck your input.");
        return;
    }

    // Validate Time Period
    if (time <= 0) {
        showError("Time period must be greater than zero.");
        return;
    }
    if (!Number.isInteger(time)) {
        showError("Time period must be a whole number.");
        return;
    }

    // Range checks based on unit
    switch (timeUnit) {
        case "days":
            if (time > 365) {
                showError("Days cannot exceed 365. For longer periods, use months or years.");
                return;
            }
            break;
        case "months":
            if (time > 120) {
                showError("Months cannot exceed 120 (10 years).");
                return;
            }
            time *= 30;
            break;
        case "years":
            if (time > 10) {
                showError("Years cannot exceed 10 for practical reporting.");
                return;
            }
            time *= 365;
            break;
        default:
            showError("Invalid time unit selected.");
            return;
    }

    // Validate Indicator Type
    const validTypes = ["inspections", "trainings", "hazardReports"];
    if (!validTypes.includes(indicatorType)) {
        showError("Invalid indicator type selected.");
        return;
    }

    // --- CALCULATION ---
    const safetyRate = actions / time;

    // Outlier check
    if (safetyRate > 100) {
        showError("Calculated rate exceeds 100 actions/day, which is unrealistic. Please verify inputs.");
        return;
    }

    // --- DISPLAY RESULT ---
    displayResult(safetyRate, indicatorType);
}

        function displayResult(rate, indicatorType) {
            // Hide placeholder and error, show result
            document.getElementById('placeholder').classList.add('hidden');
            document.getElementById('resultError').classList.add('hidden');
            document.getElementById('resultValue').classList.remove('hidden');
            
            // Update rate value
            document.getElementById('rateValue').textContent = rate.toFixed(2);
            
            // Set meter fill based on rate (scaled for display)
            const meterFill = document.getElementById('meterFill');
            let fillPercentage = Math.min(rate * 10, 100); // Scale for display
            meterFill.style.width = fillPercentage + '%';
            
            // Set meter color based on rate
            if (rate < 0.1) {
                meterFill.style.background = 'linear-gradient(to right, #e74c3c, #c0392b)';
            } else if (rate < 0.5) {
                meterFill.style.background = 'linear-gradient(to right, #f39c12, #e67e22)';
            } else if (rate < 2.0) {
                meterFill.style.background = 'linear-gradient(to right, #3498db, #2980b9)';
            } else if (rate < 5.0) {
                meterFill.style.background = 'linear-gradient(to right, #2ecc71, #27ae60)';
            } else {
                meterFill.style.background = 'linear-gradient(to right, #1abc9c, #16a085)';
            }
            
            // Generate feedback based on rate
            let feedback = '';
            let indicatorName = '';
            
            switch (indicatorType) {
                case "inspections":
                    indicatorName = "inspections";
                    break;
                case "trainings":
                    indicatorName = "trainings";
                    break;
                case "hazardReports":
                    indicatorName = "hazard reports";
                    break;
                default:
                    indicatorName = "actions";
            }
            
            if (rate < 0.1) {
                feedback = `Your proactive safety rate of ${rate.toFixed(2)} ${indicatorName} per day indicates <strong>low engagement</strong> in safety activities. Consider increasing the frequency of your ${indicatorName} to improve workplace safety.`;
            } else if (rate < 0.5) {
                feedback = `Your proactive safety rate of ${rate.toFixed(2)} ${indicatorName} per day shows <strong>moderate engagement</strong> in safety activities. There is room for improvement to achieve a stronger safety culture.`;
            } else if (rate < 2.0) {
                feedback = `Your proactive safety rate of ${rate.toFixed(2)} ${indicatorName} per day demonstrates a <strong>good safety culture</strong>. Continue maintaining these proactive safety measures.`;
            } else if (rate < 5.0) {
                feedback = `Your proactive safety rate of ${rate.toFixed(2)} ${indicatorName} per day reflects <strong>excellent proactive safety performance</strong>. Your organization shows strong commitment to preventing incidents.`;
            } else {
                feedback = `Your proactive safety rate of ${rate.toFixed(2)} ${indicatorName} per day is <strong>outstanding</strong>. This level of engagement in safety activities sets a benchmark for excellence in proactive safety management.`;
            }
            
            document.getElementById('feedbackContent').innerHTML = feedback;
        }

        function showError(message) {
            // Hide placeholder and result, show error
            document.getElementById('placeholder').classList.add('hidden');
            document.getElementById('resultValue').classList.add('hidden');
            document.getElementById('resultError').classList.remove('hidden');
            
            // Set error message
            document.getElementById('errorMessage').textContent = message;
        }

        function printReport() {
            window.print();
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateFields();
            updatePlaceholder();
        });
    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
{% comment %} 
✅ 1. Formula Used

The Proactive Safety Rate (PSR) is calculated as:

PSR = Number of Actions ÷ Time Period (in days)


Where:

Number of Actions = inspections conducted, trainings delivered, or hazard reports submitted.

Time Period = converted into days (1 month = 30 days, 1 year = 365 days).

This formula is compliant with how leading indicators are typically normalized in QEHS reporting — giving a per day rate for comparability across different reporting periods.

✅ 2. Input Validation Rules (Real-World QEHS / Fire Safety)
Number of Actions (numActions):

Must be ≥ 0 (cannot be negative).

Maximum reasonable cap: 10,000 (beyond this is unrealistic for a single site or department in the given timeframe).

Decimals: Not allowed — only whole numbers make sense (you can’t have “0.5 inspections”).

Units: Counts of actions.

Time Period (timePeriod):

Must be > 0 (no zero or negative values).

Minimum: 1 day.

Maximum recommended range:

Days: 1–365

Months: 1–120 (10 years)

Years: 1–10

Decimals: Not allowed (time periods should be whole days, months, or years).

Time Unit (timeUnit):

Must be one of: "days", "months", "years".

Any other value = invalid.

Indicator Type (indicatorType):

Must be one of: "inspections", "trainings", "hazardReports".

Any other value = invalid.

✅ 3. Output Validation & Thresholds

Output: Proactive Safety Rate (actions/day)

Thresholds (aligned with your notes, and consistent with ISO 45001 continual improvement goals):

< 0.1 → Low engagement → unsafe culture risk.

0.1 – 0.5 → Moderate → compliance-driven, not culture-driven.

0.5 – 2.0 → Good → proactive culture visible.

2.0 – 5.0 → Excellent → strong prevention in place.

> 5.0 → Outstanding → benchmark practice, but check for “over-reporting” or inflated data.

✅ 4. Edge Case Validations

Division by Zero: Prevented by disallowing timePeriod ≤ 0.

Huge Actions with Small Time (e.g., 10,000 actions in 1 day → 10,000/day) → flag as unrealistic outlier.

Zero Actions with Positive Time → Valid but yields 0 rate, should display as “no engagement.”

Fractional input → reject for both actions and time (integers only).

Negative inputs → reject.

Invalid unit/type → reject.

✅ 5. Corrected JavaScript Validation Function

Here’s a cleaned-up validation section with comments for compliance:
/*
---------------------------------------------------------
 Formula:
   Proactive Safety Rate (PSR) = Actions / Time (in days)

 Validation Rules (QEHS / Fire Safety best practice):
   - Actions (numActions):
       * Must be ≥ 0
       * Must be integer (no decimals)
       * Max realistic cap: 10,000
   - Time Period (timePeriod):
       * Must be > 0
       * Must be integer (no decimals)
       * Days: 1–365, Months: 1–120, Years: 1–10
   - Time Unit (timeUnit):
       * Must be "days", "months", or "years"
   - Indicator Type (indicatorType):
       * Must be "inspections", "trainings", or "hazardReports"
   - Edge Cases:
       * Prevent division by zero
       * Prevent negative inputs
       * Flag unrealistic ratios (> 100 actions/day as outlier)
---------------------------------------------------------
*/ {% endcomment %}