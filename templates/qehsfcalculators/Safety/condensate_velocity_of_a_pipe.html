{% extends 'base.html' %}
{% block title %}Condensate Velocity Of a Pipe Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Condensate Velocity Of a Pipe Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            {% comment %} max-width: 700px; {% endcomment %}
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        .cost-breakdown {
            width: 100%;
            margin: 20px 0;
            text-align: left;
        }
        
        .cost-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .cost-item:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 1.2em;
            margin-top: 10px;
            padding-top: 15px;
            color: #1560bd;
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
    
    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}
    
        <div class="calculator-header">
            <h1>Condensate Velocity Of a Pipe Calculator</h1>
            <p>Calculate the velocity of condensate in a pipeline to ensure efficient steam system operation</p>
        </div>

        <div class="calc-content">
            <!-- Calculator -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="flowrate">Condensate Flowrate (kg/h)</label>
                    <input type="number" id="flowrate" class="form-input" min="0" step="0.001" placeholder="e.g., 1000">
                </div>
                <div class="form-group">
                    <label for="specificVolume">Condensate Specific Volume (m³/kg)</label>
                    <input type="number" id="specificVolume" class="form-input" min="0" step="0.0001" placeholder="e.g., 0.001">
                </div>
                <div class="form-group">
                    <label for="pipeBore">Pipe Bore (mm)</label>
                    <input type="number" id="pipeBore" class="form-input" min="0" step="0.1" placeholder="e.g., 50">
                </div>
                
                <button class="calculate-btn" onclick="calculateVelocity()">Calculate Velocity</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                   <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Safety illustration">

                    <p>This tool will calculate the <strong>Condensate Velocity</strong>. Enter your data to see results and insights here.</p>
                </div>
                
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">❌</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                 
                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                    <h2>Condensate Velocity</h2></div>
                    <div class="rate-value" id="velocityValue">0 m/s</div>
                    
                    <div class="result-feedback">
                        <div class="feedback-title">Velocity Assessment</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">
            <div class="note-card">
                <h3>📘 About This Calculator</h3>
                <p>
                    The <strong>Condensate Velocity Calculator</strong> determines the velocity of condensate in a pipeline, ensuring efficient steam system operation and proper pipe sizing to prevent issues like erosion, water hammer, and pressure drop.
                </p>
                                <p>Condensate velocity is the speed at which condensate flows through a pipe. It's a critical parameter in steam systems where proper velocity ensures efficient operation while preventing damage to piping components.</p>

            </div>
            
            <div class="note-card">
                <h3>⚙️ Parameters Used</h3>
                <ul class="note-list">
                    <li><strong>Condensate Flowrate:</strong> The mass flow of condensate through the pipe, measured in kg/h.</li>
                    <li><strong>Specific Volume:</strong> The volume occupied by each kg of condensate, measured in m³/kg.</li>
                    <li><strong>Pipe Bore:</strong> The internal diameter of the pipe carrying condensate, measured in mm.</li>
                </ul>
            </div>
            
          
            
           
            
          
         <div class="note-card">
    <h3>✅ Input Validation Rules (Industry-Based)</h3>
    <p>The following input ranges and rules ensure safe, accurate, and standards-compliant condensate velocity calculations:</p>
    
    <h3>Condensate Flowrate (kg/h)</h3>
    <ul class="note-list">
        <li><strong>Min:</strong> 1 kg/h – below this is negligible flow and invalid for system design.</li>
        <li><strong>Max:</strong> 50,000 kg/h – practical upper range for industrial condensate return.</li>
        <li><strong>Decimals:</strong> Up to 3 allowed.</li>
        <li><strong>Unit Consistency:</strong> Must be in kg/h, not L/h or kg/s.</li>
        <li><strong>QEHS Relevance:</strong> Too low → stagnant condensate (corrosion risk). Too high → mis-sized piping, risk of water hammer.</li>
    </ul><br>
    
    <h3>Specific Volume (m³/kg)</h3>
    <ul class="note-list">
        <li><strong>Min:</strong> 0.0001 – approx. density of hot condensate near saturation.</li>
        <li><strong>Max:</strong> 0.1 – represents very low-density near-steam mix; beyond this indicates likely input error.</li>
        <li><strong>Decimals:</strong> Up to 4 allowed.</li>
        <li><strong>QEHS Relevance:</strong> Prevents using values intended for steam, not condensate. Wrong values → velocity calculation errors, unsafe design.</li>
    </ul><br>
    
    <h3>Pipe Bore (mm)</h3>
    <ul class="note-list">
        <li><strong>Min:</strong> 10 mm – smaller pipes are impractical for condensate return.</li>
        <li><strong>Max:</strong> 500 mm – larger pipes are considered industrial main headers, rarely used for condensate.</li>
        <li><strong>Decimals:</strong> Up to 1 allowed.</li>
        <li><strong>QEHS Relevance:</strong> Too small → velocity too high, erosion risk. Too large → low velocity, stagnant condensate, microbiological growth, corrosion.</li>
    </ul>
    
    <p>⚠️ These input rules comply with <strong>ISO 45001, OSHA, NFPA, and ILO</strong> standards for condensate/steam piping design. Always include safety factors in engineering calculations.</p>
</div>

 <div class="note-card">
    <h3>📊 Output Validations</h3>
    <p>The condensate velocity is assessed against industry benchmarks to ensure safe and efficient operation. The following ranges are used to evaluate the results and guide engineering decisions:</p>
    <ul class="note-list">
        <li>Below 0.1 m/s → ❌ Extremely low velocity: Likely invalid inputs</li>
        <li>0.1 – 5 m/s → ✅ Low velocity: May indicate oversized piping or low flowrate</li>
        <li>5 – 30 m/s → 🛠️ Optimal velocity: Within recommended range for efficient condensate return</li>
        <li>30 – 100 m/s → 🚨 High velocity: Risk of pipe erosion, noise, and water hammer</li>
        <li>Above 100 m/s → ❌ Unrealistic velocity: Please review your input values</li>
    </ul>
</div>
<div class="note-card">
    <h3>📏 Governing Principle</h3>
    <p>
        A condensate velocity pipe calculator is not tied to a single standard but is used across various industrial contexts. Guidelines from organizations such as the <strong>European Committee for Standardization (CEN)</strong> (EN) and the <strong>Steam and Condensate Specialist Company (TLV)</strong> are commonly referenced for condensate recovery lines. Application-specific standards like <strong>ASHRAE 90.1</strong> or industry guidelines from companies such as <strong>Spirax Sarco</strong> and <strong>Forbes Marshall</strong> determine acceptable velocity ranges for different scenarios.
    </p>
    <h3>Common Standards and Guidelines:</h3>
    <ul class="note-list">
        <li><strong>European Standards (EN):</strong> Manufacturers like TLV use EN or DIN 2448 pipe grades for sizing condensate recovery lines.</li>
        <li><strong>ASHRAE:</strong> For energy compliance (ASHRAE 90.1), specific criteria for pipe sizing and velocity are followed.</li>
        <li><strong>Industry-Specific Standards:</strong> Spirax Sarco recommends maximum velocities (e.g., ≤1.5 m/s for drains &lt;10m, ≤1 m/s for longer lines) to prevent flooding and water hammer. Forbes Marshall provides formulas and guidance for condensate return line sizing.</li>
        <li><strong>Engineering Guides:</strong> Resources like The Engineering ToolBox offer charts and tables for recommended velocities and pipe sizing factors for different applications.</li>
    </ul><br>
    <h3>How it Works:</h3>
    <p>
        Condensate velocity calculations involve determining the condensate flow rate and volume. Using the desired velocity (provided by standards or manufacturer recommendations), the required pipe diameter is calculated. The goal is to achieve efficient drainage without excessive pressure drop or condensate carry-over.
    </p>
</div>
<div class="note-card">
    <h3>📝 Conclusion</h3>
    <p>
        The <strong>Condensate Velocity Pipe Calculator</strong> helps engineers determine the velocity of condensate in pipelines to ensure safe and efficient operation. Proper velocity selection prevents issues such as erosion, water hammer, and pipe damage, while optimizing system efficiency. 
    </p>
    <p>
        By following the input and output validation rules, and assessing velocity against industry benchmarks, engineers can make informed decisions on pipe sizing and system design.
    </p>
</div>
        </div>
    </div>

    <script>
        // Set current date for print header
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
        });

        function calculateVelocity() {
    const flowrateInput = parseFloat(document.getElementById('flowrate').value.trim());
    const specificVolumeInput = parseFloat(document.getElementById('specificVolume').value.trim());
    const pipeBoreInput = parseFloat(document.getElementById('pipeBore').value.trim());

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');

    let errors = [];

    // ============================
    // INPUT VALIDATIONS (Industry Based)
    // ============================

    // Flowrate validation
    if (isNaN(flowrateInput) || flowrateInput < 1 || flowrateInput > 50000) {
        errors.push("👉 Condensate flowrate must be between 1 and 50,000 kg/h.");
    }

    // Specific Volume validation
    if (isNaN(specificVolumeInput) || specificVolumeInput < 0.0001 || specificVolumeInput > 0.1) {
        errors.push("👉 Condensate Specific volume must be between 0.0001 and 0.1 m³/kg.");
    }

    // Pipe Bore validation
    if (isNaN(pipeBoreInput) || pipeBoreInput < 10 || pipeBoreInput > 500) {
        errors.push("👉 Pipe bore must be between 10 and 500 mm.");
    }

    // Cross-field dependency: prevent division by zero
    if (pipeBoreInput === 0) {
        errors.push("👉 Pipe bore cannot be zero.");
    }

    // If errors found, show them
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    // ============================
    // CALCULATION
    // ============================
    const velocity = (flowrateInput * specificVolumeInput) / ((pipeBoreInput ** 2) * 0.002827);

    if (!isFinite(velocity) || velocity <= 0) {
        errorMessage.innerHTML = "❌ Calculation error: invalid result. Please check inputs.";
        errorBox.classList.remove("hidden");
        return;
    }

    const formattedVelocity = velocity.toLocaleString('en-US', {
        maximumFractionDigits: 2,
        minimumFractionDigits: 2
    });

    document.getElementById('velocityValue').textContent = `${formattedVelocity} m/s`;

    // ============================
    // OUTPUT ASSESSMENT
    // ============================
    let feedback = "";
    if (velocity < 0.1) {
        feedback = "❌ Extremely low velocity: Likely invalid inputs.";
    } else if (velocity < 5) {
        feedback = "✅ Low velocity: May indicate oversized piping or low flowrate.";
    } else if (velocity < 30) {
        feedback = "🛠️ Optimal velocity: Within recommended range for efficient condensate return.";
    } else if (velocity < 100) {
        feedback = "🚨 High velocity: Risk of pipe erosion, noise, and water hammer.";
    } else {
        feedback = "❌ Unrealistic velocity: Please review your input values.";
    }

    document.getElementById('feedbackContent').innerHTML = feedback;

    placeholder.classList.add('hidden');
    resultValue.classList.remove('hidden');
}


        function printReport() {
            // Update date just before printing
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
            
            window.print();
        }
    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}

{% comment %} 

1. Formula (for reference in your code comments)
𝑉
=
𝑚
˙
⋅
𝑣
𝐴
V=
A
m
˙
⋅v
	​


Where:

𝑉
V = Condensate velocity (m/s)

𝑚
˙
m
˙
 = Condensate mass flowrate (kg/h → convert to kg/s)

𝑣
v = Specific volume of condensate (m³/kg)

𝐴
A = Cross-sectional area of pipe (m²)

In your calculator this is implemented as:

// Velocity formula (consistent with fluid mechanics):
// velocity = (flowrate * specificVolume) / (pipeBore^2 * 0.002827)
// where 0.002827 is a derived constant for unit conversion from (kg/h, mm) to (m/s).

2. Input Validation Rules (Industry-Based)
Condensate Flowrate (kg/h)

Min: 1 kg/h (below this = negligible flow, invalid for system design).

Max: 50,000 kg/h (practical upper range for condensate return in industrial systems).

Decimals: up to 3 allowed.

Unit Consistency: Must be in kg/h, not L/h or kg/s.

QEHS Relevance: Too low → stagnant condensate (corrosion risk). Too high → mis-sized piping, safety hazard from water hammer.

Specific Volume (m³/kg)

Min: 0.0001 (approx. density of hot condensate near saturation).

Max: 0.1 (represents very low-density near-steam mix; beyond this = likely input error).

Decimals: up to 4 allowed.

QEHS Relevance: Prevents using values intended for steam, not condensate. Wrong SV values → velocity calculation errors, unsafe design.

Pipe Bore (mm)

Min: 10 mm (anything smaller = impractical for condensate return).

Max: 500 mm (beyond this → considered industrial main headers, rarely used for condensate).

Decimals: up to 1 allowed.

QEHS Relevance: Too small → velocity too high (erosion risk). Too large → low velocity → stagnant condensate, microbiological growth, corrosion.

3. Output Validation Rules

< 0.1 m/s → Invalid (likely wrong inputs, condensate cannot flow this slowly in practice).

0.1 – 5 m/s → Low velocity (oversized pipe or very low load). Acceptable but inefficient.

5 – 30 m/s → Optimal velocity (industry benchmark, minimizes erosion & water hammer).

30 – 100 m/s → High velocity → risk of erosion, vibration, noise, water hammer.

> 100 m/s → Unrealistic → input error or wrong units. {% endcomment %}