{% extends 'base.html' %}
{% block title %}Total Dead Load Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Total Dead Load Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding:0 20px;
            border-radius: 12px;
        }
        
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }
        
        /* Input rows for side-by-side fields */
        .input-row {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        @media (min-width: 480px) {
            .input-row {
                flex-direction: row;
            }
        }
        
        .input-row .form-group {
            flex: 1;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center; 
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
        
        .side-by-side {
            display: flex;
            gap: 15px;
        }
        
        .side-by-side input {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
    
    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Total Dead Load Calculator</h1>
            <p>Calculate the total dead load of scaffold components</p>
        </div>

        <div class="calc-content">
            <!-- Calculator -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                
                <div class="form-group">
                    <label for="standards">Standards (kg each):</label>
                    <div class="side-by-side">
                        <input type="number" id="standards" class="form-input" min="0" placeholder="Weight per standard">
                        <input type="number" id="standardsQty" class="form-input" min="0" placeholder="Quantity">
                    </div>
                </div>

                <div class="form-group">
                    <label for="ledgers">Ledgers (kg each):</label>
                    <div class="side-by-side">
                        <input type="number" id="ledgers" class="form-input" min="0" placeholder="Weight per ledger">
                        <input type="number" id="ledgersQty" class="form-input" min="0" placeholder="Quantity">
                    </div>
                </div>

                <div class="form-group">
                    <label for="transoms">Transoms (kg each):</label>
                    <div class="side-by-side">
                        <input type="number" id="transoms" class="form-input" min="0" placeholder="Weight per transom">
                        <input type="number" id="transomsQty" class="form-input" min="0" placeholder="Quantity">
                    </div>
                </div>

                <div class="form-group">
                    <label for="platforms">Platforms (kg each):</label>
                    <div class="side-by-side">
                        <input type="number" id="platforms" class="form-input" min="0" placeholder="Weight per platform">
                        <input type="number" id="platformsQty" class="form-input" min="0" placeholder="Quantity">
                    </div>
                </div>

                <div class="form-group">
                    <label for="accessories">Accessories (kg each):</label>
                    <div class="side-by-side">
                        <input type="number" id="accessories" class="form-input" min="0" placeholder="Weight per accessory">
                        <input type="number" id="accessoriesQty" class="form-input" min="0" placeholder="Quantity">
                    </div>
                </div>
                
                <button class="calculate-btn" onclick="calculateDeadLoad()">Calculate Total Dead Load</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Safety illustration">
                    <p>This tool will calculate the <strong>Total Dead Load</strong> of scaffold components. Enter your data to see results here.</p>
                </div>
                
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                 
                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Total Dead Load</h2>
                    </div>
                    <div class="rate-display">
                        <div class="rate-value" id="rateValue">0.00</div>
                        <div class="rate-label" style="color:#2980b9; font-size:20px; font-weight:bold;">kg</div>
                    </div>

                    <div class="result-feedback">
                        <div class="feedback-title">Load Assessment</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">
            <div class="note-card">
                <h3>üìò About This Calculator</h3>
                <p>
                    This tool calculates the <strong>Total Dead Load</strong> of scaffold components, 
                    ensuring the scaffold structure is safe and can support additional loads.
                </p>
                  <p>
        The Total Intended Load (TIL) calculator is primarily used to ensure scaffold safety by verifying that scaffolds can safely support additional loads, including workers, tools, and materials. 
        It also helps maintain structural integrity by preventing overloading and potential failures. Additionally, TIL calculations support engineering design by providing essential data for designing safe and compliant scaffold structures.
    </p>
            </div>

            <div class="note-card">
                <h3>‚öôÔ∏è Parameters Used</h3>
                <ul class="note-list">
                    <li><strong>Standards:</strong> Vertical pipes that bear the main load. These are typically made of steel or aluminum pipes.</li>
                    <li><strong>Ledgers:</strong> Horizontal members connecting the standards. These are usually made of steel, aluminum, or wooden beams.</li>
                    <li><strong>Transoms:</strong> Cross beams supporting platforms. Transoms are typically made of steel, aluminum, or sometimes wood.</li>
                    <li><strong>Platforms:</strong> Wooden planks or metal decks where workers stand.</li>
                    <li><strong>Accessories:</strong> Brackets, clamps, guardrails, and other components.</li>
                </ul>
            </div>
          <div class="note-card">
    <h3>‚ö†Ô∏è Input Validation Rules</h3>
    <ul class="note-list">
        <li><strong>Standards (vertical tubes):</strong> Weight 5‚Äì25 kg each, Quantity 1‚Äì500 pieces. Quantity > 0 requires weight > 0.</li>
        <li><strong>Ledgers (horizontal beams):</strong> Weight 3‚Äì15 kg each, Quantity 1‚Äì1000 pieces. Quantity > 0 requires weight > 0.</li>
        <li><strong>Transoms (cross beams):</strong> Weight 3‚Äì12 kg each, Quantity 1‚Äì1000 pieces. Quantity > 0 requires weight > 0.</li>
        <li><strong>Platforms (decks/planks):</strong> Weight 8‚Äì25 kg each, Quantity 1‚Äì500 pieces. Quantity > 0 requires weight > 0.</li>
        <li><strong>Accessories (clamps, guardrails, brackets, ties):</strong> Weight 0.2‚Äì5 kg each, Quantity 0‚Äì2000 pieces. Quantity > 0 requires weight > 0.</li>
        <li><strong>At least one component:</strong> Quantity must be greater than zero.</li>
        <li><strong>Total Dead Load:</strong> 10‚Äì100,000 kg (realistic engineering bounds).</li>
        <li><strong>Decimals:</strong> Allowed only for weight (max 2), not for quantity.</li>
        <li><strong>Cross-check:</strong> If quantity > 0, weight must also be > 0.</li>
    </ul>
</div>     
           <div class="note-card">
    <h3>üìä Output Validations</h3>
    <p><b>Total Dead Load Guidelines:</b></p>
    <ul class="note-list">
        <li>Below 500 kg: This is a light scaffold structure. Suitable for basic access and light-duty work.</li>
        <li>500‚Äì2000 kg: This is a medium scaffold structure. Appropriate for general construction work.</li>
        <li>Above 2000 kg: This is a heavy scaffold structure. Requires careful engineering consideration.</li>
    </ul>
</div>

            
     <div class="note-card">
    <h3>üìè Governing Principle</h3>
    <p>
        The standard for total dead load calculation varies by location and the governing building codes, 
        but in India, it is defined by <strong>IS 875 (Part 1): 1987</strong>, which provides the design dead loads 
        (unit weights of building materials and stored materials) for buildings and structures. Other regions 
        use different codes, such as the American Society of Civil Engineers (ASCE) standards or the International 
        Building Code (IBC) in the United States.
    </p>
    <p>
        <h3>In India:</h3>
        <ul class="note-list">
            <li><strong>IS 875 (Part 1): 1987:</strong> Specifically for dead loads, provides unit weights of various building materials and components.</li>
            <li><strong>IS 875 (Part 2): 1987:</strong> Deals with imposed (live) loads.</li>
            <li><strong>Other Parts of IS 875:</strong> Covers wind loads, snow loads, and load combinations.</li>
        </ul>
    </p>
    <p>
        Key elements of dead load considered include:
        <ul class="note-list">
            <li>Self-weight of structural members like beams, columns, and slabs.</li>
            <li>Weight of permanent fixtures, such as fixed partition walls and permanently installed equipment.</li>
            <li>Weight of finished materials of the structure.</li>
        </ul>
    </p>
    <p>
        <h3>Other regions:</h3> 
        <ul class="note-list">
            <li><strong>ASCE/SEI 7:</strong> Common standard in the United States for structural loads, including dead loads.</li>
            <li><strong>International Building Code (IBC):</strong> Sets standards for load calculations, including snow loads, which can indirectly influence dead load assessments for roofs.</li>
        </ul>
    </p>
</div>
  
            
      <div class="note-card">
    <h3>üìù Conclusion</h3>
    <p>
        The Total Dead Load Calculator provides a reliable assessment of scaffold components‚Äô dead load, 
        ensuring structural safety and compliance with engineering standards. By entering realistic 
        weights and quantities for standards, ledgers, transoms, platforms, and accessories, users 
        can determine whether the scaffold is light, medium, or heavy. Proper use of this tool supports 
        safe construction practices, prevents overloading, and facilitates informed engineering decisions.
    </p>
</div>     

        </div>
    </div>

    <script>
        // Set current date for print header
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
        });

        function calculateDeadLoad() {
    // Collect inputs
    const inputs = {
        standards: { w: parseFloat(document.getElementById('standards').value.trim()), q: parseInt(document.getElementById('standardsQty').value.trim()) },
        ledgers: { w: parseFloat(document.getElementById('ledgers').value.trim()), q: parseInt(document.getElementById('ledgersQty').value.trim()) },
        transoms: { w: parseFloat(document.getElementById('transoms').value.trim()), q: parseInt(document.getElementById('transomsQty').value.trim()) },
        platforms: { w: parseFloat(document.getElementById('platforms').value.trim()), q: parseInt(document.getElementById('platformsQty').value.trim()) },
        accessories: { w: parseFloat(document.getElementById('accessories').value.trim()), q: parseInt(document.getElementById('accessoriesQty').value.trim()) }
    };

    // Component-specific ranges
    const ranges = {
        standards: { wMin: 5, wMax: 25, qMin: 1, qMax: 500 },
        ledgers: { wMin: 3, wMax: 15, qMin: 1, qMax: 1000 },
        transoms: { wMin: 3, wMax: 12, qMin: 1, qMax: 1000 },
        platforms: { wMin: 8, wMax: 25, qMin: 1, qMax: 500 },
        accessories: { wMin: 0.2, wMax: 5, qMin: 0, qMax: 2000 }
    };

    // Validation loop
    let atLeastOne = false;
    for (let comp in inputs) {
        let { w, q } = inputs[comp];
        let { wMin, wMax, qMin, qMax } = ranges[comp];

        // Empty / NaN check
        if (isNaN(w) || isNaN(q)) {
            showError(`Please enter both weight and quantity for ${comp}.`);
            return;
        }

        // Negative values
        if (w < 0 || q < 0) {
            showError(`${comp}: values cannot be negative.`);
            return;
        }

        // If quantity > 0 then weight must be > 0
        if (q > 0 && w === 0) {
            showError(`${comp}: weight must be greater than 0 if quantity is specified.`);
            return;
        }

        // Range checks
        if (q > 0) {
            if (w < wMin || w > wMax) {
                showError(`${comp}: weight per item must be between ${wMin} and ${wMax} kg.`);
                return;
            }
            if (q < qMin || q > qMax) {
                showError(`${comp}: quantity must be between ${qMin} and ${qMax}.`);
                return;
            }
            atLeastOne = true;
        }
    }

    if (!atLeastOne) {
        showError("At least one component must have a quantity greater than zero.");
        return;
    }

    // Calculate total dead load
    const totalDeadLoad = (inputs.standards.w * inputs.standards.q) +
                          (inputs.ledgers.w * inputs.ledgers.q) +
                          (inputs.transoms.w * inputs.transoms.q) +
                          (inputs.platforms.w * inputs.platforms.q) +
                          (inputs.accessories.w * inputs.accessories.q);

    // Check realistic bounds
    if (totalDeadLoad < 10 || totalDeadLoad > 100000) {
        showError("Calculated total dead load is outside realistic engineering limits (10‚Äì100,000 kg).");
        return;
    }

    // Show result
    showResult(totalDeadLoad);
}

        function showResult(totalDeadLoad) {
            // Hide placeholder and error, show result
            document.getElementById('placeholder').classList.add('hidden');
            document.getElementById('resultError').classList.add('hidden');
            document.getElementById('resultValue').classList.remove('hidden');
            
            // Format the result with 2 decimal places
            document.getElementById('rateValue').textContent = totalDeadLoad.toFixed(2);
            
            // Provide feedback based on the total dead load
            let feedback = '';
            if (totalDeadLoad < 500) {
                feedback = 'This is a light scaffold structure. Suitable for basic access and light-duty work.';
            } else if (totalDeadLoad >= 500 && totalDeadLoad <= 2000) {
                feedback = 'This is a medium scaffold structure. Appropriate for general construction work.';
            } else {
                feedback = 'This is a heavy scaffold structure. Requires careful engineering consideration.';
            }
            
            document.getElementById('feedbackContent').textContent = feedback;
        }

        function showError(message) {
            // Hide placeholder and result, show error
            document.getElementById('placeholder').classList.add('hidden');
            document.getElementById('resultValue').classList.add('hidden');
            document.getElementById('resultError').classList.remove('hidden');
            
            document.getElementById('errorMessage').textContent = message;
        }

        function printReport() {
            // Update date just before printing
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
            
            window.print();
        }
    </script>
</body>
</html>
{% endblock %}


{% comment %} 
1. Input Validation Rules (QEHS/Fire Safety Standards)

Scaffold components have well-established engineering and safety ranges. Validation must prevent unrealistic or unsafe inputs:

General Rules

Units: All weights must be in kilograms (kg), all quantities as whole numbers.

Decimals: Allowed for weight only (max 2 decimal places). Quantities must be integers.

Zero vs. Positive: Weight can be zero (to allow optional components), but quantity >0 requires weight >0.

Component-Specific Validation
Standards (Vertical pipes)

Weight range: 5‚Äì25 kg each (steel/aluminum tubes ~48.3mm OD, 2.5‚Äì4 mm thick).

Quantity range: 1‚Äì500 pieces (depending on scaffold size).

Ledgers (Horizontals)

Weight range: 3‚Äì15 kg each.

Quantity range: 1‚Äì1000 pieces.

Transoms (Cross beams)

Weight range: 3‚Äì12 kg each.

Quantity range: 1‚Äì1000 pieces.

Platforms (Decks/Planks)

Weight range: 8‚Äì25 kg each (metal deck/wooden plank).

Quantity range: 1‚Äì500 pieces.

Accessories (Clamps, guardrails, brackets, ties, etc.)

Weight range: 0.2‚Äì5 kg each.

Quantity range: 0‚Äì2000 pieces.

Cross-Field Dependencies

If quantity > 0 ‚Üí weight must also be > 0.

If weight > 0 but quantity = 0 ‚Üí allowed (unused component).

At least one component must have a positive quantity.

Total Dead Load realistic range: 10 kg ‚Üí 100,000 kg (upper bound ensures no absurd results).

2. Output Validation Logic & Thresholds

You already have categories:

<500 kg ‚Üí Light scaffold (basic access, painting, inspection).

500‚Äì2000 kg ‚Üí Medium scaffold (general construction).

>2000 kg ‚Üí Heavy scaffold (industrial, multi-storey, requires engineering review).

‚úÖ I recommend adding a ‚ÄúVery Heavy Load‚Äù alert if >20,000 kg ‚Üí ‚ÄúEngineering review & third-party certification required.‚Äù This aligns with OSHA 1926 Subpart L & ISO 1808 Scaffold Safety guidelines.

3. Corrected JavaScript Code with Validations

Here‚Äôs your function updated with validations + comments for formula and safety checks:

/*
Formula for Total Dead Load (TDL):
TDL = Œ£ (Weight_per_item √ó Quantity)

Where:
- Standards, Ledgers, Transoms, Platforms, Accessories are scaffold components
- Weight in kg, Quantity in whole numbers
- Validation ensures realistic engineering limits (per OSHA, ISO, NFPA)

Validation Rules:
1. Weight >= 0 (kg), up to 2 decimals
2. Quantity >= 0 (integer only)
3. If Quantity > 0 ‚Üí Weight must be > 0
4. At least one component quantity > 0
5. Component-specific ranges (kg each):
   - Standards: 5‚Äì25 kg, Qty: 1‚Äì500
   - Ledgers: 3‚Äì15 kg, Qty: 1‚Äì1000
   - Transoms: 3‚Äì12 kg, Qty: 1‚Äì1000
   - Platforms: 8‚Äì25 kg, Qty: 1‚Äì500
   - Accessories: 0.2‚Äì5 kg, Qty: 0‚Äì2000
6. Total Dead Load realistic range: 10‚Äì100,000 kg
*/ {% endcomment %}