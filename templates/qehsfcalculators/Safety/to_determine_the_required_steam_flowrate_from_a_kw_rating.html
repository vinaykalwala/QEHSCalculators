{% extends 'base.html' %}
{% block title %}To Determine The Required Steam Flowrate From A kW Rating Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To Determine The Required Steam Flowrate From A kW Rating Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }
        
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }

        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background:linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }
        
        /* Result Card */
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }
        
        /* Feedback & Warnings */
        .result-feedback, .result-warning {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            text-align: left;
            margin-top: 15px;
        }
        .result-feedback {
             border-left: 4px solid #3498db;
        }
        .result-warning {
            border-left: 4px solid #f1c40f; /* Yellow border for warnings */
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        /* Note Section */
        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }

        /* Error Box */
        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
    <div class="calculator-container printable" id="printArea">

        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>To Determine The Required Steam Flowrate From A kW Rating Calculator</h1>
            <p>Determine the required steam flowrate (kg/h) from a known power load (kW) and the properties of the steam.</p>
        </div>

        <div class="calc-content">
            <div class="calc-card">
                <h2>Enter System Parameters</h2>
                <div class="form-group">
                    <label for="load">Power Load (kW)</label>
                    <input type="number" id="load" class="form-input" placeholder="e.g., 500">
                </div>
                <div class="form-group">
                    <label for="hfg">Latent Heat of Vaporization ($h_{fg}$) [kJ/kg]</label>
                    <input type="number" id="hfg" class="form-input" placeholder="e.g., 2047 at 10 bar.g">
                </div>
                <button class="calculate-btn" onclick="calculateSteamFlow()">Calculate Flowrate</button>
            </div>

            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Steam boiler illustration">
                    <p>Enter your system's load and steam properties to calculate the required steam flowrate for boiler sizing and energy audits.</p>
                </div>
                
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                    
                <div class="result-value hidden" id="resultValue">
                    <div class="rate-value" id="rateValue">0.00</div>
                    <div class="rate-label" id="rateLabel">Required Steam Flowrate (kg/h)</div>
                    
                    <div class="result-warning hidden" id="resultWarning">
                        <div class="feedback-title">‚ö†Ô∏è Input Warning</div>
                        <div class="feedback-content" id="warningMessage"></div>
                    </div>

                    <div class="result-feedback">
                        <div class="feedback-title">Operational Scale</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>

                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="note-section">
    <!-- About This Calculator -->
    <div class="note-card">
        <h3>üìò About This Calculator</h3>
        <p>
            This tool calculates the mass flowrate of steam required to deliver a specific amount of power (heat energy).
            It's fundamental for sizing boilers, steam lines, and control valves in industrial processes, HVAC systems, and power generation.
            Accurate flowrate calculation ensures system efficiency, energy savings, and safe operation.
        </p>
    </div>

    <!-- Parameters Used -->
    <div class="note-card">
        <h3>‚öôÔ∏è Parameters Used</h3>
        <ul class="note-list">
            <li><strong>Power Load (kW):</strong> Heat or power requirement of the system.</li>
            <li><strong>Latent Heat of Vaporization (h<sub>fg</sub>) [kJ/kg]:</strong> Energy required to convert water to steam.</li>
            <li><strong>Formula:</strong> Steam Flowrate (kg/h) = (Power Load √ó 3600) / h<sub>fg</sub></li>
        </ul>
    </div>

    <!-- Input Validation Rules -->
    <div class="note-card">
        <h3>üìù Input Validation Rules</h3>
        <ul class="note-list">
            <li><strong>Power Load (kW):</strong> Must be a positive number (> 0). Typical range: 10‚Äì5000 kW. Blank, non-numeric, or negative inputs ‚Üí ‚ùå Error. ‚ö†Ô∏è Warning if outside typical range.</li>
            <li><strong>Latent Heat of Vaporization (h<sub>fg</sub>) [kJ/kg]:</strong> Must be > 0. Typical range: 1800‚Äì2800 kJ/kg. Blank, non-numeric, or negative inputs ‚Üí ‚ùå Error. ‚ö†Ô∏è Warning if outside typical range.</li>
        </ul>
    </div>

    <!-- Output Validations -->
    <div class="note-card">
        <h3>üìä Output Validations</h3>
        <ul class="note-list">
            <li>Steam Flowrate displayed with <strong>2 decimal places</strong>.</li>
            <li>If calculation produces NaN or infinite ‚Üí ‚ùå "Calculation resulted in an invalid number. Please check your inputs."</li>
            <li>Operational Scale Feedback based on Load:
                <ul class="note-list">
                    <li><strong>Small-scale:</strong> ‚úÖ Laboratory, pilot plant, or small commercial use.</li>
                    <li><strong>Medium-scale:</strong> üü¢ Small industrial process or large commercial building.</li>
                    <li><strong>Large-scale:</strong> üü° Significant industrial manufacturing or processing operations.</li>
                    <li><strong>Very large-scale:</strong> üî¥ Power generation or major chemical plant.</li>
                </ul>
            </li>
            <li>Warnings for unusual inputs:
                <ul class="note-list">
                    <li>Load &lt;10 or &gt;5000 kW ‚Üí ‚ö†Ô∏è Check if realistic for system.</li>
                    <li>h<sub>fg</sub> &lt;1800 or &gt;2800 kJ/kg ‚Üí ‚ö†Ô∏è Verify using steam tables.</li>
                </ul>
            </li>
        </ul>
    </div>

    <!-- Governing Principle -->
    <div class="note-card">
        <h3>üìè Governing Principle</h3>
        <p>
            There isn't a single, specific "standard" that defines the relationship between kW rating and steam flow rate, but rather a universally applied formula based on thermodynamic principles and the specific enthalpy of the steam. You can determine the required steam flow rate using the formula: Steam flow rate (kg/h) = (kW rating * 3600) / specific enthalpy of evaporation (kJ/kg). This calculation requires knowing the power load in kW and the specific enthalpy of steam at the operating pressure. 
        </p>
        <ul class="note-list">
            <li><strong>kW rating (P):</strong> Heat load or power demand of the equipment requiring steam.</li>
            <li><strong>Specific Enthalpy of Evaporation (h<sub>e</sub>):</strong> Energy required to convert 1 kg water at boiling point to steam at same temperature and pressure. Value depends on operating pressure (from steam tables).</li>
            <li><strong>3600:</strong> Conversion factor to get kg/h from kW √ó seconds.</li>
            <li><strong>Steps:</strong> Determine load ‚Üí Find h<sub>e</sub> ‚Üí Apply formula ‚Üí Obtain Steam Flowrate.</li>
            <li><strong>Example:</strong> Load = 100 kW, h<sub>e</sub> = 2500 kJ/kg ‚Üí Steam Flowrate = (100 √ó 3600)/2500 = 144 kg/h.</li>
        </ul>
    </div>

    <!-- Conclusion -->
    <div class="note-card">
        <h3>‚úÖ Conclusion</h3>
        <p>
            Calculating the required steam flowrate ensures appropriate boiler and system sizing, safe operation, and energy efficiency. Proper validation of inputs avoids errors and operational risks in industrial steam applications.
        </p>
    </div>
</div>
    </div>

   <script>
    document.addEventListener('DOMContentLoaded', function () {
        const now = new Date();
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
    });

    function calculateSteamFlow() {
        const load_val = document.getElementById('load').value.trim();
        const hfg_val = document.getElementById('hfg').value.trim();

        const errorBox = document.getElementById('resultError');
        const errorMessage = document.getElementById('errorMessage');
        const warningBox = document.getElementById('resultWarning');
        const warningMessage = document.getElementById('warningMessage');
        const placeholder = document.getElementById('placeholder');
        const resultValue = document.getElementById('resultValue');
        const feedbackContent = document.getElementById('feedbackContent');

        let errors = [];
        let warnings = [];

        // --- PARSE INPUTS ---
        const load = parseFloat(load_val);
        const hfg = parseFloat(hfg_val);

        // --- INPUT VALIDATION ---
        if (load_val === '' || isNaN(load) || load <= 0) {
            errors.push("‚ùå Power Load (kW) must be a positive number (> 0).");
        }
        if (hfg_val === '' || isNaN(hfg) || hfg <= 0) {
            errors.push("‚ùå Latent Heat of Vaporization (h‚Ççfg‚Çé) [kJ/kg] must be a positive number (> 0).");
        }

        // --- ERROR HANDLING ---
        if (errors.length > 0) {
            errorMessage.innerHTML = errors.join("<br>");
            errorBox.classList.remove("hidden");
            placeholder.classList.add("hidden");
            resultValue.classList.add("hidden");
            warningBox.classList.add("hidden");
            return;
        } else {
            errorBox.classList.add("hidden");
        }

        // --- WARNING CHECKS (Typical Industrial Ranges) ---
        if (load < 10 || load > 5000) {
            warnings.push("‚ö†Ô∏è Load (kW) is outside the typical industrial range of 10‚Äì5000 kW. Check if realistic for system.");
        }
        if (hfg < 1800 || hfg > 2800) {
            warnings.push("‚ö†Ô∏è Latent Heat (h‚Ççfg‚Çé) is outside the typical range for saturated steam (1800‚Äì2800 kJ/kg). Verify using steam tables.");
        }

        if (warnings.length > 0) {
            warningMessage.innerHTML = warnings.join("<br>");
            warningBox.classList.remove("hidden");
        } else {
            warningBox.classList.add("hidden");
        }

        // --- CALCULATION ---
        const steamFlowRate = (load * 3600) / hfg;

        if (!isFinite(steamFlowRate)) {
            errorMessage.innerHTML = "‚ùå Calculation resulted in an invalid number. Please check your inputs.";
            errorBox.classList.remove("hidden");
            resultValue.classList.add("hidden");
            return;
        }

        document.getElementById('rateValue').textContent = steamFlowRate.toFixed(2);

        // --- OPERATIONAL SCALE FEEDBACK ---
        let feedback;
        if (load < 100) {
            feedback = "‚úÖ Small-scale: Laboratory, pilot plant, or small commercial use.";
        } else if (load >= 100 && load < 500) {
            feedback = "üü¢ Medium-scale: Small industrial process or large commercial building.";
        } else if (load >= 500 && load < 2000) {
            feedback = "üü° Large-scale: Significant industrial manufacturing or processing operations.";
        } else {
            feedback = "üî¥ Very large-scale: Power generation or major chemical plant.";
        }

        feedbackContent.textContent = feedback;

        placeholder.classList.add("hidden");
        resultValue.classList.remove("hidden");
    }

    function printReport() {
        const now = new Date();
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
        window.print();
    }
</script>


    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}

<!-- 
1Ô∏è‚É£ Input Validation Rules (QEHS Perspective)
Input	Rules	Rationale
Power Load (kW)	- Must be a positive number > 0.
- Recommended industrial range: 10 ‚Äì 5000 kW.
- Accept decimals (up to 2 places).	Prevents unrealistic or negative boiler loads; ensures safe boiler sizing.
Latent Heat of Vaporization (h<sub>fg</sub>, kJ/kg)	- Must be positive > 0.
- Recommended range: 1800 ‚Äì 2800 kJ/kg for typical pressures 5‚Äì15 bar.g.
- Accept decimals (up to 2 places).	Ensures the energy calculation aligns with real steam tables; avoids negative or zero energy inputs.
Cross-field logic	- Steam flowrate should be physically feasible.
- Load should not produce a flowrate > maximum boiler capacity (user-defined limits).	Prevents unrealistic combinations (e.g., small h<sub>fg</sub> with very high load).
2Ô∏è‚É£ Edge Case Validations

Division by zero: h<sub>fg</sub> = 0 ‚Üí Must be prevented.

Unrealistic extremes: Load <10 kW or >5000 kW ‚Üí show warning.

h<sub>fg</sub> extreme: <1800 or >2800 kJ/kg ‚Üí show warning.

Negative or blank inputs ‚Üí show error.

Decimal precision check ‚Üí round to 2 decimal places for display.

3Ô∏è‚É£ Output Validation & Thresholds

Formula:

Steam¬†Flowrate¬†(kg/h)
=
Load¬†(kW)
√ó
3600
‚Ñé
ùëì
ùëî
¬†(kJ/kg)
Steam¬†Flowrate¬†(kg/h)=
h
fg
	‚Äã

¬†(kJ/kg)
Load¬†(kW)√ó3600
	‚Äã


Display flowrate with 2 decimal places.

Threshold/Operational Scale (for QEHS perspective):

Steam Flowrate	Operational Scale	Feedback
<50 kg/h	Very Low	Minimal boiler capacity; suitable for small lab setups.
50 ‚Äì 500 kg/h	Low	Small-scale industrial operations.
500 ‚Äì 2000 kg/h	Medium	Typical plant or process operation.
>2000 kg/h	High	Large-scale operations; review boiler capacity and safety systems.

If calculation is NaN or Infinity ‚Üí display ‚ùå Calculation resulted in an invalid number. Please check your inputs.
-->