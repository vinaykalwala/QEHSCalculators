{% extends 'base.html' %}
{% block title %}Steam Consumption by Injection into a Tank caluculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accident Rate Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
          @media screen and (max-width: 768px) {
    .calculator-header h1 {
        font-size: 1.5rem; /* smaller font for mobile */
        margin-bottom: 8px;
        text-align: center; /* optional: center the heading on mobile */
    }
}
        .result-placeholder img {
            max-width: 250px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
      
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 20px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
          @media (max-width: 768px) {
    .rate-value {
        font-size: 28px; /* smaller font for tablets/mobiles */
    }
}

@media (max-width: 480px) {
    .rate-value {
        font-size: 24px; /* even smaller for phones */
    }
}
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
    
  <div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <div class="calculator-header">
        <h1>Steam Consumption By Injection Into A Tank Calculator</h1>
        <p>Estimate the steam required to heat water in a tank efficiently and safely.</p>
    </div>

    <div class="calc-content">
        <!-- Calculator -->
        <div class="calc-card">
            <h2>Enter Data</h2>
            <div class="form-group">
                <label for="m">Initial Mass of Water in Tank (ṁ) (kg)</label>
                <input type="number" id="m" class="form-input" min="0" placeholder="e.g., 1000">
            </div>
            <div class="form-group">
                <label for="h1">Initial Heat in Water (h₁) (kJ/kg)</label>
                <input type="number" id="h1" class="form-input" placeholder="e.g., 200">
            </div>
            <div class="form-group">
                <label for="h2">Final Heat in Water (h₂) (kJ/kg)</label>
                <input type="number" id="h2" class="form-input" placeholder="e.g., 400">
            </div>
            <div class="form-group">
                <label for="hg">Total Enthalpy of Steam (h_g) (kJ/kg)</label>
                <input type="number" id="hg" class="form-input" placeholder="e.g., 2800">
            </div>
            <button class="calculate-btn" onclick="calculateSteamConsumption()">Calculate Steam Consumption</button>
        </div>

        <!-- Result Section -->
        <div class="result-card">
            <div class="result-placeholder" id="placeholder">
                <img src="{% static 'images/resultimage.png' %}" alt="Steam illustration">
                <p>This tool will calculate <strong>Steam Consumption</strong>. Enter your data to see results and insights here.</p>
            </div>
            
            <div class="result-error hidden" id="resultError">
                <div class="error-icon">❌</div>
                <div class="error-message" id="errorMessage"></div>
            </div>
            
            <div class="result-value hidden" id="resultValue">
                <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                    <h2>Steam Consumption Result</h2>
                </div>
                <div class="rate-value" id="steamValue">0</div>
                <div class="rate-label" style="color:#2980b9; font-size:16px; font-weight:bold;">
                    Kilograms of Steam (kg)
                </div>

                <div class="result-feedback">
                    <div class="feedback-title">Assessment</div>
                    <div class="feedback-content" id="feedbackContent"></div>
                </div>
                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notes Section -->
<div class="note-section">

    <!-- 1. About This Calculator -->
    <div class="note-card">
        <h3>📘 About This Calculator</h3>
        <p>
            The <strong>Steam Consumption Calculator</strong> helps engineers and operators estimate the amount of steam required to heat water in a tank. This ensures energy-efficient heating and maintains safe operational conditions.
        </p>
    </div>

    <!-- 2. Parameters Used -->
    <div class="note-card">
        <h3>⚙️ Parameters Used</h3>
        <ul class="note-list">
            <li><strong>Initial Mass of Water in Tank (ṁ):</strong> Mass of water before steam injection, in kg.</li>
            <li><strong>Initial Heat in Water (h₁):</strong> Specific enthalpy of water before steam injection, in kJ/kg.</li>
            <li><strong>Final Heat in Water (h₂):</strong> Specific enthalpy of water after steam injection, in kJ/kg.</li>
            <li><strong>Total Enthalpy of Steam (h_g):</strong> Specific enthalpy of injected steam, in kJ/kg.</li>
        </ul>
    </div>

    <!-- 3. Input Validation Rules -->
    <div class="note-card">
        <h3>✅ Input Validation Rules</h3>
        <ul class="note-list">
            <li>All inputs must be numeric and positive.</li>
            <li><strong>Mass of water (ṁ):</strong> 10 – 10,000 kg; decimal precision: 1.</li>
            <li><strong>Initial heat h₁:</strong> 0 – 4200 kJ/kg; must be less than h₂.</li>
            <li><strong>Final heat h₂:</strong> 0 – 4200 kJ/kg; must be greater than h₁ and less than h_g.</li>
            <li><strong>Total steam enthalpy h_g:</strong> 2000 – 2800 kJ/kg; must be greater than h₂.</li>
            <li><strong>Logical consistency:</strong> ṁs = m*(h₂-h₁)/(h_g-h₂) must be plausible; warning if ṁs > 50% of water mass.</li>
            <li><strong>Mandatory fields:</strong> All four inputs are required; blank, zero, or non-numeric entries are invalid.</li>
        </ul>
    </div>

    <!-- 4. Output Validations -->
    <div class="note-card">
        <h3>📊 Output Validations</h3>
        <ul class="note-list">
            <li><span class="good">Positive Steam Consumption (ṁs > 0 and ≤ 50% of tank mass):</span> ✅ Steam is being consumed effectively.</li>
            <li><span class="warning">High Steam Consumption (ṁs > 50% of tank mass):</span> ⚠️ High steam consumption; may exceed safe injection rate (50% of tank mass).</li>
            <li><span class="average">Zero Steam Consumption (ṁs = 0):</span> ⚠️ No steam consumption; system is in equilibrium.</li>
            <li><span class="bad">Negative Steam Consumption (ṁs < 0):</span> ❌ Steam is condensing or energy is being lost; check system efficiency.</li>
        </ul>
    </div>

<div class="note-card">
    <h3>📋 Governing Principle</h3>
    <p>
        There is no specific, singular international standard for a "Steam Consumption by Injection into a Tank" calculator. The calculation is based on standard thermodynamic principles of heat and mass balance, referencing universally accepted steam property tables. 
    </p>
    <p>
        The methodology for this type of calculator is founded on these core principles, rather than being governed by a single standard:
    </p>
    <p>
        <strong style="color: #1976d2;">Mass and Energy Balance:</strong> The calculator determines the steam required by establishing a mass and energy balance equation. The energy input from the injected steam is equated to the energy absorbed by the liquid in the tank. This accounts for the mass of steam injected, the specific heat capacity and mass of the liquid, and the change in the liquid's temperature.
    </p>
    <p>
        <strong style="color: #1976d2;">Thermodynamic Principles:</strong> The calculation relies on fundamental thermodynamic properties of steam and water, which are documented in standard steam tables. These properties include:
        <ul>
            <li>Enthalpy: The total energy content of the steam, typically measured in kJ/kg.</li>
            <li>Specific Heat Capacity: The heat required to raise the temperature of the liquid (e.g., water) by one degree, in kJ/kg °C.</li>
            <li>Enthalpy of Evaporation (Latent Heat): The energy released when the steam condenses into liquid water. This is a major factor in direct steam injection's high efficiency.</li>
        </ul>
    </p>
    <p>
        <strong style="color: #1976d2;">Industry Best Practices:</strong> While not a formal standard, manufacturers and engineering resources like Spirax Sarco and The Engineering ToolBox provide calculation examples and guidelines based on these established principles. These resources help engineers apply the formulas correctly in industrial settings.
    </p>
    <p>
        Therefore, any calculator for steam injection consumption is a practical application of standard, universally recognized thermodynamic principles, not a product of a specific governing standard.
    </p>
</div>



    <!-- 6. Conclusion -->
    <div class="note-card">
        <h3>🏁 Conclusion</h3>
        <p>
            Use this calculator to plan steam injection efficiently, ensuring safe operation and minimizing energy loss. Accurate inputs yield reliable results for industrial process optimization. Output assessments give immediate guidance on operational safety and efficiency.
        </p>
    </div>

</div>


<script>
function calculateSteamConsumption() {
    const m = parseFloat(document.getElementById('m').value);
    const h1 = parseFloat(document.getElementById('h1').value);
    const h2 = parseFloat(document.getElementById('h2').value);
    const hg = parseFloat(document.getElementById('hg').value);

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');
    const feedbackContent = document.getElementById('feedbackContent');
    const steamValue = document.getElementById('steamValue');

    let errors = [];

    // Numeric & Non-zero validation
    if (isNaN(m) || m <= 0) errors.push("👉 Mass of water (ṁ) must be > 0 kg (10–10,000 kg recommended).");
    if (isNaN(h1) || h1 < 0 || h1 > 4200) errors.push("👉 Initial heat (h₁) must be 0–4200 kJ/kg.");
    if (isNaN(h2) || h2 < 0 || h2 > 4200) errors.push("👉 Final heat (h₂) must be 0–4200 kJ/kg.");
    if (isNaN(hg) || hg < 2000 || hg > 2800) errors.push("👉 Steam enthalpy (h_g) must be 2000–2800 kJ/kg.");

    // Logical consistency
    if (h2 <= h1) errors.push("⚠️ Final heat (h₂) must be greater than initial heat (h₁).");
    if (hg <= h2) errors.push("⚠️ Steam enthalpy (h_g) must be greater than final heat (h₂).");
    if (hg === h2) errors.push("⚠️ Steam enthalpy cannot equal final heat to avoid division by zero.");

    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    // Calculation
    const ms = (m * (h2 - h1)) / (hg - h2);
    steamValue.textContent = ms.toFixed(2);

    // Feedback
    let feedback = "";
    let color = "";

    if (ms > 0 && ms <= m * 0.5) {
    feedback = "✅ Steam is being consumed effectively.";
    color = "green";
} else if (ms > m * 0.5) {
    feedback = "⚠️ High steam consumption; may exceed safe injection rate (50% of tank mass).";
    color = "orange";
} else if (ms === 0) {
    feedback = "⚠️ No steam consumption; system is in equilibrium.";
    color = "orange";
} else { // ms < 0
    feedback = "❌ Steam is condensing or energy is being lost; check system efficiency.";
    color = "red";
}


    feedbackContent.innerHTML = `<strong style="color:${color}">${feedback}</strong>`;
    placeholder.classList.add('hidden');
    resultValue.classList.remove('hidden');
}

</script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- 1️⃣ Real-World Analysis

The formula used:

𝑚
˙
𝑠
=
𝑚
⋅
(
ℎ
2
−
ℎ
1
)
ℎ
𝑔
−
ℎ
2
m
˙
s
	​

=
h
g
	​

−h
2
	​

m⋅(h
2
	​

−h
1
	​

)
	​


Where:

m = mass of water (kg)

h1 = initial specific enthalpy of water (kJ/kg)

h2 = final specific enthalpy of water (kJ/kg)

hg = specific enthalpy of injected steam (kJ/kg)

ṁs = mass of steam injected (kg)

From a QEHS standpoint:

Steam injection must avoid overheating tanks or exceeding pressure design limits.

Inputs must be realistic per boiler, tank, and industrial process limits.

Outputs must be plausible, as audits often check against expected consumption KPIs.

2️⃣ Recommended Input Validation Rules
Input	Unit	Acceptable Range	Decimal Precision	Logical Constraints	QEHS Rationale
m (Mass of water)	kg	10 – 10,000	1 decimal	Must be >0	Ensures realistic tank capacity; prevents division by zero
h1 (Initial enthalpy)	kJ/kg	0 – 4200	1 decimal	Must be < h2	h1 cannot exceed h2; prevents illogical negative energy requirement
h2 (Final enthalpy)	kJ/kg	0 – 4200	1 decimal	Must > h1 & < hg	Prevents overheat and avoids denominator ≤0
hg (Steam enthalpy)	kJ/kg	2000 – 2800	1 decimal	Must > h2	Prevents division by zero; ensures steam is above water enthalpy
Combined	—	—	—	Resulting ṁs ≤ 50% of tank mass in one injection (recommended)	Avoids overpressure and safety hazards

Additional Checks:

Inputs must be numeric, non-empty.

Warn if ṁs exceeds 50% of water mass—industry guideline to avoid thermal shock.

Warn if ṁs < 0 → indicates condensation or energy loss.

3️⃣ Output Validation Logic

Positive ṁs: ✅ Steam is being used effectively; normal operation.

Zero ṁs: ⚠️ System is in equilibrium; no steam required.

Negative ṁs: ❌ Steam condensation or system heat loss; indicates inefficiency or unsafe input.

Excessively high ṁs: ⚠️ Could indicate incorrect inputs or unsafe rapid injection.

4️⃣ Edge Case Handling
Edge Case	Handling
hg = h2	Division by zero → error message
h1 ≥ h2	Illogical energy increase → error message
Negative or zero mass	Invalid → error message
Extremely high or low values outside practical ranges	Warn users; prevent unrealistic KPI outputs
Non-numeric / blank inputs	Reject and display error
Resulting ṁs > 50% of tank mass	Show warning: “Rapid injection may exceed safety limits”

Compliance Rationale:

OSHA & ISO 45001 require safe operating ranges for thermal systems.

NFPA/boiler safety guidelines discourage rapid injection or overpressure.

ILO standards emphasize risk mitigation for workers handling hot steam.

✅ Summary of Compliance Benefits of Validations:

Numeric & range checks prevent unrealistic operation (OSHA/ISO).

Logical consistency ensures steam flows as expected; avoids unsafe tank heating.

Extreme value warnings protect against overpressure and energy hazards.

Output checks provide meaningful KPI insights for audits and reports (NFPA/ILO).

Division by zero checks maintain calculation integrity and prevent app crashes. -->