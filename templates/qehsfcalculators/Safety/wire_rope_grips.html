{% extends 'base.html' %}
{% block title %}Wire Rope Grip (Bulldog Grip) Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wire Rope Grip (Bulldog Grip) Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
        
        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }
        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        @media (max-width: 900px) {
            .calc-content {
                flex-direction: column;
            }
        }
        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
            justify-content: center;
        }
        .calc-card:hover {
            transform: translateY(-5px);
        }
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }
        /* Inputs */
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        .form-input, .form-select {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }
        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }
        /* Result Card */
        .result-placeholder {
            text-align: center;
            margin: auto;
        }
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: baseline;
            justify-content: center;
        }
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
        }
        .rate-label {
            color: #2980b9;
            font-weight: bold;
            font-size: 20px;
        }
        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        .feedback-content {
            color: #34495e;
        }
        /* Notes Section */
        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }
        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        .note-list { margin: 0; padding-left: 18px; }
        .custom-table {
            border-collapse: collapse; width: 100%;
            margin: 20px 0; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .custom-table thead { background-color: #1560bd; color: white; }
        .custom-table th, .custom-table td {
            padding: 12px 16px; border: 1px solid #ddd; text-align: center;
        }
        .custom-table tr:nth-child(even) { background-color: #f9f9f9; }
        /* Error Message */
        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px; padding: 20px;
            text-align: left; gap: 12px; margin-top: 20px;
        }
        .error-icon { font-size: 76px; flex-shrink: 0; text-align: center; }
        .error-message { font-size: 24px; line-height: 1.6; }
        .hidden { display: none; }
        .btn-container { display: flex; justify-content: center; margin: 30px 0; }
        .back-btn {
            background: linear-gradient(#1560bd,#000040); color: #ffffff; border: 2px solid #1560bd;
            padding: 10px 20px; font-size: 14px; font-weight: 600; border-radius: 8px;
            text-decoration: none; transition: all 0.3s ease; cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>

    <div class="calculator-container printable" id="printArea">
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Wire Rope Grip (Bulldog Grip) Calculator</h1>
            <p>Determine the required number and spacing of grips for a wire rope termination.</p>
        </div>

        <div class="calc-content">
            <div class="calc-card">
                <h2>Wire Rope Specification</h2>
                <div class="form-group">
                    <label for="ropeSize">Size of Wire Rope (mm)</label>
                    <input type="number" id="ropeSize" class="form-input" placeholder="Enter rope diameter in mm">
                </div>
                <button class="calculate-btn" onclick="calculateAndDisplay()">Calculate</button>
            </div>

            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Safety illustration">
                    <p>Enter the wire rope diameter to determine the correct number and spacing of bulldog grips.</p>
                </div>
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                <div id="resultValue" class="hidden" style="text-align: center;">
                    <h2>Number of Grips Required</h2>
                    <div class="rate-display">
                        <div class="rate-value" id="rateValue">0</div>
                        <div class="rate-label">Grips</div>
                    </div>
                    <div class="result-feedback">
                        <div class="feedback-title">Spacing Recommendation</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                       <div class="btn-wrapper">
                            <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                        </div>
                </div>
            </div>
        </div>

        <div class="note-section">
            <div class="note-card">
                <h3>üìò About This Calculator</h3>
                <p>
                    The <strong>Wire Rope Grip (Bulldog Grip) Calculator</strong> is a safety tool used to determine the correct number of grips and their appropriate spacing when creating a termination loop in a wire rope. Using the right number and spacing of grips is critical for achieving the required termination efficiency and preventing the rope from slipping under load, which is essential for safe lifting and rigging operations.
                </p>
            </div>
            <div class="note-card">
                <h3>‚öôÔ∏è Parameters Used</h3>
                <ul class="note-list">
                    <li><strong>Size of Wire Rope (mm):</strong> The nominal diameter of the wire rope. This single parameter dictates both the number of grips required and their correct spacing.</li>
                </ul>
            </div>
            <div class="note-card">
                <h3>‚úÖ Input Validation Rules</h3>
                <ul class="note-list">
                    <li>The <strong>Wire Rope Diameter</strong> is a required field.</li>
                    <li>The input must be a positive, whole number (no decimals).</li>
                    <li>The allowed range for the rope diameter is between <strong>1 mm and 70 mm</strong> to align with common industry standards and ensure a valid calculation.</li>
                </ul>
            </div>
             <div class="note-card">
                <h3>Output Validations</h3>
                 <p>Based on the input rope size, the calculator provides a clear recommendation that includes a critical safety reminder:</p>
                <ul class="note-list">
                    <li><span class="good">For a <strong>[Rope Size] mm</strong> wire rope: <br>‚úÖ Recommended number of grips: <strong>[Number]</strong><br> ‚úÖ Recommended spacing between grips: <strong>[Spacing] mm</strong><br> ‚ö†Ô∏è Ensure U-bolt is on the dead end of the rope for maximum safety.</span></li>
                </ul>
            </div>
            <div class="note-card">
                <h3>Governing Principle</h3>
                <p>Multiple standards apply to wire rope grips, and the correct standard depends on the application, region, and type of grip being used. A calculator's design would typically follow these standards to determine specifications such as the number of grips required, spacing, and tightening torque.</p>
                <p><strong>Common standards for wire rope grips include:</strong></p>
                <ul class="note-list">
                    <li><strong>EN 13411-5:2021:</strong> The primary European standard for forged wire rope grips used for terminations.</li>
                    <li><strong>US Federal Specification FF-C-450D:</strong> A standard for forged wire rope clips, which are also referenced by U.S. safety agencies like OSHA.</li>
                    <li><strong>DIN 741 / DIN 1142:</strong> German standards for commercial and heavy-duty grips, respectively.</li>
                    <li><strong>Indian Standard (IS) 2361:2002:</strong> Specifies the requirements for "Bulldog Grips" for steel wire ropes.</li>
                    <li><strong>ASME B30.26:</strong> A U.S. standard that includes design factors and safety guidelines for rigging hardware, including clips.</li>
                </ul>
            </div>
            <div class="note-card">
                <h3>Conclusion</h3>
                <p>
                    Properly securing a wire rope termination with the correct number and spacing of grips is fundamental to lifting and rigging safety. This calculator provides guidance based on established industry practices. However, it is essential to always consult the specific manufacturer's instructions and the relevant safety standards (such as ASME B30.26 or EN 13411-5) for critical lifts and to ensure compliance.
                </p>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (document.getElementById('printDate')) {
                const now = new Date();
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
            }
        });

        function calculateAndDisplay() {
            const errorBox = document.getElementById('resultError');
            const errorMessage = document.getElementById('errorMessage');
            const placeholder = document.getElementById('placeholder');
            const resultValueBox = document.getElementById('resultValue');

            // Reset UI
            errorBox.classList.add('hidden');
            resultValueBox.classList.add('hidden');
            placeholder.classList.remove('hidden');

            let errors = [];

            // Input validation helper
            function getVal(id, label, opts = {}) {
                const el = document.getElementById(id);
                const raw = el.value?.toString().trim();

                if (!raw) {
                    errors.push(`üëâ ${label} is required.`);
                    return null;
                }

                const num = parseFloat(raw);

                if (isNaN(num)) {
                    errors.push(`üëâ ${label} must be a valid number.`);
                    return null;
                }

                if (!Number.isInteger(num)) {
                    errors.push(`üëâ ${label} must be a whole number (no decimals).`);
                    return null;
                }

                if (num <= 0) {
                    errors.push(`üëâ ${label} must be greater than 0.`);
                    return null;
                }

                if (opts.min !== undefined && num < opts.min) {
                    errors.push(`üëâ ${label} must be ‚â• ${opts.min}.`);
                }

                if (opts.max !== undefined && num > opts.max) {
                    errors.push(`üëâ ${label} must be ‚â§ ${opts.max}.`);
                }

                return num;
            }

            // Validate rope size (1‚Äì70 mm standard)
            const ropeSize = getVal('ropeSize', 'Wire Rope Diameter', { min: 1, max: 70 });

            if (errors.length > 0) {
                errorMessage.innerHTML = errors.join("<br>");
                errorBox.classList.remove("hidden");
                placeholder.classList.add('hidden');
                return;
            }

            // Determine number of grips based on wire rope size
            let numberOfGrips = 0;
            if (ropeSize <= 20) numberOfGrips = 3;
            else if (ropeSize <= 32) numberOfGrips = 4;
            else if (ropeSize <= 38) numberOfGrips = 5;
            else if (ropeSize <= 41) numberOfGrips = 6;
            else if (ropeSize <= 50) numberOfGrips = 7;
            else if (ropeSize <= 60) numberOfGrips = 8;
            else numberOfGrips = 9;

            // Recommended spacing (6 √ó rope diameter)
            const recommendedSpacing = ropeSize * 6;

            // Display results
            placeholder.classList.add('hidden');
            resultValueBox.classList.remove('hidden');

            document.getElementById('rateValue').textContent = numberOfGrips;
            document.getElementById('feedbackContent').innerHTML = `
            <span class="good">For a <strong>${ropeSize} mm</strong> wire rope:<br>
            ‚úÖ Recommended number of grips: <strong>${numberOfGrips}</strong><br>
            ‚úÖ Recommended spacing between grips: <strong>${recommendedSpacing} mm</strong><br>
            ‚ö†Ô∏è Ensure U-bolt is on the dead end of the rope for maximum safety.</span>
            `;
        }

        // Print report
        function printReport() {
            if (document.getElementById('printDate')) {
                const now = new Date();
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
            }
            window.print();
        }
    </script>

</body>
</html>
{% endblock %}

<!-- 
1Ô∏è‚É£ Input Validation Rules (Real-World QEHS Perspective)
Input	Unit	Acceptable Range	Decimal/Format	Notes / Safety Rationale
Wire Rope Size (ropeSize)	mm	1 ‚Äì 70	Integers only (no decimals)	Rope sizes beyond 70‚ÄØmm are uncommon and may require special lifting equipment. Input must be realistic to ensure correct grip count.
Required	‚Äì	Must not be empty	‚Äì	Missing input prevents safe calculation.

Cross-Field / Logical Validations:

Rope size ‚â§ 0 ‚Üí invalid (non-physical)

Rope size > 70 ‚Üí alert / error (beyond standard practice)

Ensure integer input; fractional mm values are not standard in grip calculation

Edge Case Handling:

Rope size = 1 ‚Üí minimum allowed grips = 3

Rope size = 70 ‚Üí maximum allowed grips = 9

Non-numeric input ‚Üí error message

Negative numbers ‚Üí error message

2Ô∏è‚É£ Output Validation Logic and Thresholds

Number of Grips: Calculated per standard safety tables (e.g., OSHA, API RP 9B, ASME lifting standards)

3‚Äì9 grips depending on rope diameter

Must always round up to nearest whole grip (cannot use fractional clips)

Recommended Spacing:

6 √ó rope diameter (mm) ‚Üí ensures safe load distribution and avoids rope slippage

Safety-critical: incorrect spacing can cause grip failure

Outputs should always be non-zero positive integers
-->