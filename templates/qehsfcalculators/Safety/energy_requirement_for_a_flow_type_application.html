{% extends 'base.html' %}
{% block title %}Energy Requirement for a Flow-Type Application Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Requirement for a Flow-Type Application Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding:0 20px;
            border-radius: 12px;
        }
              .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            {% comment %} max-width: 700px; {% endcomment %}
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 480px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        .heating { color: #e74c3c; font-weight: 600; }
        .cooling { color: #3498db; font-weight: 600; }
        .neutral { color: #7f8c8d; font-weight: 600; }
    </style>
</head>
<body>
      <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
   <div class="calculator-container printable" id="printArea">

    <!-- Include header/footer for print -->
    {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Energy Requirement for a Flow-Type Application Calculator</h1>
            <p>Calculate heat transfer rate for industrial systems like heat exchangers, cooling systems, and power plants</p>
        </div>

        <div class="calc-content">
            <!-- Calculator -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="m_dot">Mean Secondary Fluid Flowrate (·πÅ) (kg/s)</label>
                    <input type="number" id="m_dot" class="form-input" step="any" placeholder="e.g., 2.5">
                </div>
                <div class="form-group">
                    <label for="cp">Specific Heat Capacity (c‚Çö) (kJ/kg¬∞C)</label>
                    <input type="number" id="cp" class="form-input" step="any" placeholder="e.g., 4.18">
                </div>
                <div class="form-group">
                    <label for="dT">Temperature Change (ŒîT) (¬∞C)</label>
                    <input type="number" id="dT" class="form-input" step="any" placeholder="e.g., 15">
                </div>
                
                <button class="calculate-btn" onclick="calculateEnergyRequirement()">Calculate Heat Transfer Rate</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                   <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Safety illustration">
                    <p>This tool will calculate the <strong>Heat Transfer Rate</strong>. Enter your data to see results and insights here.</p>
                </div>
                
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                 
                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                    <h2>Heat Transfer Rate</h2></div>
                    <div class="rate-value" id="rateValue">0.00</div>
                    <div class="rate-label" style="color:#2980b9; font-size:20px; font-weight:bold;">Kilowatts (kW)</div>

                    <div class="result-feedback">
                        <div class="feedback-title">Process Assessment</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

<!-- Notes Section -->
<div class="note-section">

  <!-- üìò About This Calculator -->
  <div class="note-card">
    <h3>üìò About This Calculator</h3>
    <p>
      The <strong>Energy Requirement for a Flow-Type Application Calculator</strong> determines the rate of heat transfer (QÃá) in industrial flow systems such as heat exchangers, condensers, and cooling units. 
      It helps engineers evaluate heating and cooling energy requirements to ensure thermal efficiency, safety, and compliance with design standards.
    </p>
  </div>

  <!-- ‚öô Parameters Used -->
  <div class="note-card">
    <h3>‚öô Parameters Used</h3>
    <ul class="note-list">
      <li><strong>·πÅ (Mean Secondary Fluid Flowrate):</strong> The mass flowrate of the fluid (kg/s).</li>
      <li><strong>c‚Çö (Specific Heat Capacity):</strong> The amount of heat required to raise 1 kg of the substance by 1¬∞C (kJ/kg¬∞C).</li>
      <li><strong>ŒîT (Temperature Change):</strong> The temperature difference of the fluid between inlet and outlet (¬∞C).</li>
      <li><strong>QÃá (Heat Transfer Rate):</strong> Calculated energy rate of heating or cooling in kilowatts (kW).</li>
    </ul>
  </div>

  <!-- ‚úÖ Input Validation Rules -->
  <div class="note-card">
    <h3>‚úÖ Input Validation Rules</h3>
    <ul class="note-list">
      <li><strong>·πÅ (Flowrate):</strong> Must be greater than 0, typical range 0.01‚Äì10,000 kg/s. Warnings shown if outside this range.</li>
      <li><strong>c‚Çö (Specific Heat Capacity):</strong> Must be greater than 0, typical range 0.5‚Äì10 kJ/kg¬∞C.</li>
      <li><strong>ŒîT (Temperature Change):</strong> Can be negative or positive; valid range -200¬∞C to 500¬∞C.</li>
      <li><strong>Blank or non-numeric values:</strong> Not accepted and will trigger error messages.</li>
      <li><strong>Safety Validation:</strong> If computed |QÃá| &gt; 100,000 kW, the system flags the result as extremely high, prompting process safety review.</li>
    </ul>
  </div>

  <!-- üßÆ Output Validations -->
  <div class="note-card">
    <h3>üßÆ Output Validations</h3>
    <ul class="note-list">
      <li><strong>QÃá (Heat Transfer Rate) &gt; 0 ‚Üí Heating Process:</strong> Energy is added to the fluid.</li>
      <li><strong>QÃá (Heat Transfer Rate) &lt; 0 ‚Üí Cooling Process:</strong> Energy is removed from the fluid.</li>
      <li><strong>QÃá (Heat Transfer Rate) = 0 ‚Üí Neutral Process:</strong> No heat transfer occurs.</li>
      <li><strong>Extremely High Values:</strong> If |QÃá| exceeds 100,000 kW, a warning message is displayed to verify design safety.</li>
    </ul>
    <p><strong>Assessment/Feedback:</strong> 
      ‚ÄúHeating process: Energy is being added to the fluid.‚Äù or 
      ‚ÄúCooling process: Energy is being removed from the fluid.‚Äù 
      or 
      ‚ÄúNo heat transfer: The fluid temperature remains unchanged.‚Äù  
      These exact sentences appear with the result and are replicated here for validation clarity.
    </p>
  </div>

  <!-- üìú Governing Principle -->
  <div class="note-card">
    <h3>üìú Governing Principle</h3>
    <p>
      For an energy requirements calculator used in flow-type applications, the standard applied depends on the specific industry, medium, and purpose. 
      There is no single universal standard, but instead, calculations are based on recognized principles and may conform to specific industry guidelines.
    </p>

    <p><strong>Heat Energy Calculations:</strong> 
      A common type of flow-type application involves heating or cooling a fluid. 
      Calculators for these applications are based on fundamental thermodynamic principles. 
      The heat energy transferred (Q) is calculated using the fluid's mass flow rate, specific heat capacity, and the change in temperature (ŒîT). 
      For example, manufacturers like Spirax Sarco detail how to calculate steam consumption for process heat exchangers and calorifiers using these physical principles. 
      Some commercial products, like the Siemens SITRANS FUE950 energy calculator, use this type of calculation and also adhere to relevant legal metrology requirements.
    </p>

    <p><strong>Energy Management Systems:</strong> 
      If a calculator is part of a larger energy management system, it may follow guidelines from standards like ISO 50001, 
      which deals with overall energy management for organizations. 
      This standard requires organizations to track, measure, and analyze significant energy uses to improve performance.
    </p>

    <p><strong style="color: #1976d2;">Specific Standards for Different Media:</strong></p>
    <ul class="note-list">
      <li><strong>Airflow in compressors:</strong> IS 10431:1994 addresses the measurement of airflow in compressors and exhausters.</li>
      <li><strong>HVAC systems:</strong> Airflow in buildings is often calculated using BTU = CFM √ó ŒîT √ó 1.08.</li>
      <li><strong>Gas flow:</strong> Standards for gas flow calculations are based on thermodynamics and require specifying reference conditions (pressure and temperature).</li>
    </ul>

    <p><strong style="color: #1976d2;">Software and Application-Specific Standards:</strong> 
      Some "flow-type application calculators" are software-based engineering tools. 
      Their ‚Äústandard‚Äù lies in the underlying physical or mathematical model used.
    </p>

    <ul class="note-list">
      <li><strong>Fluid dynamics:</strong> Tools from platforms like Omni Calculator or H2x Engineering rely on standard equations of continuity and energy balance.</li>
      <li><strong>Industrial instrumentation:</strong> Specialized tools such as the Contrec heat calculator comply with international metrology calibration standards.</li>
    </ul>

    <p>
      Therefore, to identify the applicable standard, one must define the specific purpose and context of the flow-type application calculator.
    </p>

    <p><strong style="color: #1976d2;">>Assessment/Feedback:</strong> 
      ‚ÄúHeating process: Energy is being added to the fluid.‚Äù or 
      ‚ÄúCooling process: Energy is being removed from the fluid.‚Äù 
      or 
      ‚ÄúNo heat transfer: The fluid temperature remains unchanged.‚Äù  
      These same sentences are included here for consistency with the displayed results.
    </p>
  </div>

  <!-- üèÅ Conclusion -->
  <div class="note-card">
    <h3>üèÅ Conclusion</h3>
    <ul class="note-list">
      <li>The calculator provides engineers a quick method to determine thermal load requirements for process systems.</li>
      <li>Following the input validation ensures accurate, safe, and realistic heat transfer assessments.</li>
      <li>Results and warnings align with process safety and performance management practices.</li>
      <li>Adhering to ISO 50001 and relevant thermodynamic standards promotes consistent energy management and efficiency improvement.</li>
    </ul>
  </div>

</div>


    <script>
        // Set current date for print header
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
        });

        function calculateEnergyRequirement() {
    const m_dot = document.getElementById('m_dot').value.trim();
    const cp = document.getElementById('cp').value.trim();
    const dT = document.getElementById('dT').value.trim();

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');

    let errors = [];

    /*
    ===============================
    Validation Rules (QEHS aligned)
    ===============================
    ·πÅ (Flowrate): >0, range 0.01‚Äì10,000 kg/s
    c‚Çö (Specific Heat Capacity): >0, realistic 0.5‚Äì10 kJ/kg¬∞C
    ŒîT (Temperature Change): numeric, range -200 to 500 ¬∞C
    */

    // Flowrate Validation
    if (m_dot === "") {
        errors.push("üëâ Please enter the mean secondary fluid flowrate (·πÅ).");
    } else {
        const num = parseFloat(m_dot);
        if (isNaN(num) || num <= 0) {
            errors.push("üëâ Flowrate (·πÅ) must be a number greater than 0.");
        } else if (num < 0.01 || num > 10000) {
            errors.push("‚ö†Ô∏è Flowrate is outside typical industrial range (0.01‚Äì10,000 kg/s). Please verify.");
        }
    }

    // Specific Heat Capacity Validation
    if (cp === "") {
        errors.push("üëâ Please enter the specific heat capacity (c‚Çö).");
    } else {
        const num = parseFloat(cp);
        if (isNaN(num) || num <= 0) {
            errors.push("üëâ Specific heat capacity must be a number greater than 0.");
        } else if (num < 0.5 || num > 10) {
            errors.push("‚ö†Ô∏è Specific heat capacity is outside realistic physical range (0.5‚Äì10 kJ/kg¬∞C). Please verify.");
        }
    }

    // Temperature Change Validation
    if (dT === "") {
        errors.push("üëâ Please enter the temperature change (ŒîT).");
    } else {
        const num = parseFloat(dT);
        if (isNaN(num)) {
            errors.push("üëâ Temperature change must be a valid number.");
        } else if (num < -200 || num > 500) {
            errors.push("‚ö†Ô∏è Temperature change is outside safe range (-200 to 500 ¬∞C). Please verify.");
        }
    }

    // Handle Errors
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    // Calculation
    const m = parseFloat(m_dot);
    const c = parseFloat(cp);
    const dt = parseFloat(dT);

    const Qdot = m * c * dt; // Units: kW

    if (!isFinite(Qdot)) {
        errorMessage.innerHTML = "‚ùå Invalid calculation result. Please check inputs.";
        errorBox.classList.remove("hidden");
        resultValue.classList.add("hidden");
        return;
    }

    document.getElementById('rateValue').textContent = Qdot.toFixed(4);

    // Process Assessment
    let feedback = "";
    if (Qdot > 0) {
        feedback = `<span class="heating">Heating process:</span> Energy is being added to the fluid.`;
        if (Qdot > 100000) {
            feedback += ` ‚ö†Ô∏è Extremely high heat transfer detected. Review process safety controls.`;
        }
    } else if (Qdot < 0) {
        feedback = `<span class="cooling">Cooling process:</span> Energy is being removed from the fluid.`;
        if (Math.abs(Qdot) > 100000) {
            feedback += ` ‚ö†Ô∏è Extremely high cooling load detected. Verify design limits.`;
        }
    } else {
        feedback = `<span class="neutral">No heat transfer:</span> The fluid temperature remains unchanged.`;
    }

    document.getElementById('feedbackContent').innerHTML = feedback;

    placeholder.classList.add("hidden");
    resultValue.classList.remove("hidden");
}


        function printReport() {
            // Update date just before printing
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
            
            window.print();
        }
    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}






{% comment %} 

1. Formula (to keep as a code comment)
/*
Formula:
QÃá = ·πÅ √ó c‚Çö √ó ŒîT

Where:
QÃá  = Heat Transfer Rate (kW)
·πÅ   = Mean Secondary Fluid Flowrate (kg/s)
c‚Çö  = Specific Heat Capacity (kJ/kg¬∞C)
ŒîT  = Temperature Change (¬∞C)

Notes:
- 1 kJ/s = 1 kW, so no further unit conversion is required.
*/

2. Detailed Input Validation Rules (QEHS/Fire Safety Perspective)

a. Flowrate (·πÅ, kg/s)

Must be > 0 (no negative or zero flow).

Typical range for industrial cooling/heating: 0.01 ‚Äì 10,000 kg/s.

Allowed decimals: up to 3 places.

Cross-check: If flowrate > 1000, warn user (‚ÄúValue is very high, verify process scale‚Äù).

Compliance: Unrealistic flowrate can cause design errors in heat exchanger sizing and emergency cooling systems.

b. Specific Heat Capacity (c‚Çö, kJ/kg¬∞C)

Must be > 0.

Physical limits: 0.5 ‚Äì 10 kJ/kg¬∞C.

Typical:

Water = 4.18

Oils = 1.5‚Äì3.0

Air = ~1.0

More than 10 ‚Üí flag as unrealistic.

Compliance: Wrong c‚Çö leads to under/overestimation of cooling loads, impacting fire suppression and process safety.

c. Temperature Change (ŒîT, ¬∞C)

Can be negative (cooling) or positive (heating).

Logical range: -200 ‚â§ ŒîT ‚â§ 500 ¬∞C.

ŒîT = 0 ‚Üí should return QÃá = 0 with a neutral process message.

Compliance: ŒîT beyond realistic thresholds may indicate sensor error, hazardous overheating, or cryogenic risk.

3. Output Validation & Thresholds

QÃá > 0 ‚Üí Heating process, must display warning if QÃá exceeds 100,000 kW (large power plant scale).

QÃá < 0 ‚Üí Cooling process, must flag if absolute value > 100,000 kW.

QÃá = 0 ‚Üí Neutral (no transfer).

Compliance: Very high heat transfer may require fire safety reviews (risk of runaway reactions or overheating). {% endcomment %}