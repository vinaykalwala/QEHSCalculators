{% extends 'base.html' %}
{% block title %}Cement Slurry Density Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cement Slurry Density Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding:0 20px;
            border-radius: 12px;
        }
               .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            {% comment %} max-width: 700px; {% endcomment %}
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd, #000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>
      <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
   <div class="calculator-container printable" id="printArea">

    <!-- Include header/footer for print -->
    {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Cement Slurry Density Calculator</h1>
            <p>Calculate cement slurry density based on weight of materials and total volume</p>
        </div>

        <div class="calc-content">
            <!-- Calculator -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="Wcement">Weight of Dry Cement (lbs)</label>
                    <input type="number" id="Wcement" class="form-input" min="0" placeholder="e.g., 1000">
                </div>
                <div class="form-group">
                    <label for="Wwater">Weight of Water (lbs)</label>
                    <input type="number" id="Wwater" class="form-input" min="0" placeholder="e.g., 500">
                </div>
                <div class="form-group">
                    <label for="Vslurry">Total Volume of Slurry (gallons)</label>
                    <input type="number" id="Vslurry" class="form-input" min="0.1" step="0.1" placeholder="e.g., 200">
                </div>
                
                <button class="calculate-btn" onclick="calculateDensity()">Calculate Density</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                     <img src="{% static 'images/resultimage.png' %}" alt="Safety illustration">
                    <p>This tool will calculate the <strong>Cement Slurry Density</strong>. Enter your data to see results and insights here.</p>
                </div>
                
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                 
                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Cement Slurry Density</h2>
                    </div>
                    <div class="rate-value" id="densityValue">0.00</div>
                    <div class="rate-label">Pounds per gallon (lbs/gal)</div>

                    <div class="result-feedback">
                        <div class="feedback-title"> Assessment</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">
            <div class="note-card">
                <h3>üìò About This Calculator</h3>
                <p>
                    The <strong>Cement Slurry Density Calculator</strong> helps determine the density of cement slurry, which is crucial in well cementing and construction applications.
                </p>
                                <p>Cement slurry density is a critical parameter that ensures the slurry has the appropriate density to provide well stability and prevent fluid migration.</p>
 <p>
        This cement volume calculator is useful in various fields such as oil and gas wells, geothermal drilling, construction and civil engineering, and water well drilling. It helps ensure proper well construction, maintain casing integrity in high-temperature conditions, support structural cement mixes, and prevent casing collapse or water contamination.
    </p>
            </div>
           
            <div class="note-card">
                <h3>‚öôÔ∏è Parameters Used</h3>
                <ul class="note-list">
                    <li><strong>Weight of Dry Cement (lbs):</strong> The total weight of the dry cement used in the slurry.</li>
                    <li><strong>Weight of Water (lbs):</strong> The total weight of the water mixed with the cement.</li>
                    <li><strong>Total Volume of Slurry (gallons):</strong> The final volume of the cement slurry after mixing.</li>
                </ul>
            </div>
            
          
            
           
           <div class="note-card">
    <h3>‚úÖ Input Validation Rules</h3>
    <ul class="note-list">
        <li><strong>Dry Cement Weight (Wcement):</strong> 500 ‚Äì 10,000 lbs  
            <br>üëâ Less than 500 lbs is not industrially relevant; above 10,000 lbs is impractical for a single batch.</li>
        <li><strong>Water Weight (Wwater):</strong> 100 ‚Äì 8,000 lbs  
            <br>üëâ Must be consistent with cement weight and realistic for proper mixing.</li>
        <li><strong>Total Slurry Volume (Vslurry):</strong> 10 ‚Äì 2,000 gallons  
            <br>üëâ Below 10 gallons is lab-scale only; above 2,000 gallons is impractical for field operations.</li>
        <li><strong>Water-to-Cement Ratio (W/C):</strong> 0.3 ‚Äì 0.8  
            <br>üëâ Ratio = Wwater / Wcement.  
            <br>üëâ 0.3 means 30 lbs of water for every 100 lbs of cement (too dry if lower).  
            <br>üëâ 0.8 means 80 lbs of water for every 100 lbs of cement (too diluted if higher).  
            <br>üëâ Ensures proper slurry consistency, pumpability, and strength.</li>
        <li><strong>Decimals & Accuracy:</strong> Allow up to 1 decimal place for volume; full integer for weights to reflect realistic input precision.</li>
    </ul>
    <p>‚ö†Ô∏è These validation ranges are based on API and industry cementing guidelines. Values outside these limits may result in unpumpable, weak, or unsafe slurry mixtures.</p>
</div>

<div class="note-card">
    <h3>üìä Output Validations</h3>
    <p>
        The following ranges indicate the typical assessment of cement slurry density (lbs/gal). 
        Each range corresponds to a specific density condition, helping you understand whether the slurry is too light, standard, or too heavy for safe and effective application.
    </p>
    <ul class="note-list">
        <li><strong>&lt; 8 or &gt; 25 lbs/gal:</strong> ‚ùå Unrealistic density. Please review your inputs.</li>
        <li><strong>8 ‚Äì 12 lbs/gal:</strong> ‚ö†Ô∏è Very lightweight slurry. May not provide sufficient hydrostatic pressure.</li>
        <li><strong>12 ‚Äì 14 lbs/gal:</strong> ‚úÖ Lightweight slurry suitable for fragile formations.</li>
        <li><strong>14 ‚Äì 16 lbs/gal:</strong> ‚úÖ Standard density slurry appropriate for most applications.</li>
        <li><strong>16 ‚Äì 18 lbs/gal:</strong> ‚ö†Ô∏è Heavyweight slurry. Ensure it can be properly mixed and pumped.</li>
        <li><strong>&gt; 18 lbs/gal:</strong> ‚ùå Very high-density slurry. Check if this is realistic for field mixing.</li>
    </ul>
</div>

<div class="note-card">
    <h3>üìè Governing Principle</h3>
    <p>
        A "cement slurry density calculator" does not inherently adhere to a single specific standard, as its design and purpose depend on the industry or application. 
        For well cementing, oil and gas standards such as those from the <strong>Oil Industry Safety Directorate (OISD)</strong> or organizations like <strong>SPE (Society of Petroleum Engineers)</strong> are relevant. 
        For general construction, calculators may align with <strong>ASTM standards</strong> for materials like Controlled Low-Strength Material (CLSM), or <strong>ISO standards</strong> for other cementitious materials.
    </p>

    <h3>How to determine the applicable standard:</h3>
   <ul class="note-list">
    <li><strong>Identify the application:</strong> Is it for oil and gas well cementing, general construction, or another specific field?</li>
    <li><strong>Check the tool's origin:</strong> If it's from a specific company or organization, look for references to their associated standards.</li>
    <li><strong>Look for explicit mentions:</strong> The tool's documentation or specifications will often state which standards it follows.</li>
</ul>

    <br>

    <h3>Examples of relevant standards and organizations:</h3>
    <ul class="note-list">
        <li><strong>Oil Industry Safety Directorate (OISD):</strong> In oil and gas, the OISD provides guidelines for cementing operations where slurry density is monitored.</li>
        <li><strong>ASTM International:</strong> For materials like CLSM, ASTM standards such as D6023 provide test methods for density and other properties.</li>
        <li><strong>ISO (International Organization for Standardization):</strong> ISO standards are relevant for measurements and properties of cementitious materials.</li>
        <li><strong>Society of Petroleum Engineers (SPE):</strong> SPE publishes resources and standards related to well construction and cementing.</li>
    </ul>
</div>
<div class="note-card">
<h3>üìå Conclusion</h3>
    <p>
        The <strong>Cement Slurry Density Calculator</strong> provides a quick and practical method to estimate the density of cement slurries based on the weight of dry cement, water, and total slurry volume. 
        Correct density ensures well stability, appropriate hydrostatic pressure, and structural integrity in construction or drilling applications. 
        Always validate inputs within recommended ranges to avoid unpumpable, weak, or unsafe slurries. 
        Use the feedback provided by the calculator to assess whether your slurry is lightweight, standard, or heavyweight, and adjust your formulation accordingly.
    </p>
        </div>
</div>
    </div>

    <script>
        // Set current date for print header
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
        });

       function calculateDensity() {
    const Wcement = parseFloat(document.getElementById('Wcement').value.trim());
    const Wwater = parseFloat(document.getElementById('Wwater').value.trim());
    const Vslurry = parseFloat(document.getElementById('Vslurry').value.trim());

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');

    let errors = [];

    // ============================
    // VALIDATION RULES
    // ============================

    if (isNaN(Wcement) || Wcement < 500 || Wcement > 10000) {
        errors.push("üëâ Weight of cement must be between 500 and 10,000 lbs.");
    }

    if (isNaN(Wwater) || Wwater < 100 || Wwater > 8000) {
        errors.push("üëâ Weight of water must be between 100 and 8,000 lbs.");
    }

    if (isNaN(Vslurry) || Vslurry < 10 || Vslurry > 2000) {
        errors.push("üëâ Total slurry volume must be between 10 and 2000 gallons.");
    }

    // Cross-field validation: Water-to-Cement ratio
    if (!isNaN(Wcement) && !isNaN(Wwater) && Wcement > 0) {
        const wcRatio = Wwater / Wcement;
        if (wcRatio < 0.3 || wcRatio > 0.8) {
            errors.push(`üëâ Water-to-cement ratio must be between 0.3 and 0.8. 
            Your current ratio is ${(wcRatio).toFixed(2)}.`);
        }
    }

    // Show errors
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    // ============================
    // CALCULATION
    // ============================
    const density = (Wcement + Wwater) / Vslurry;

    if (!isFinite(density) || density <= 0) {
        errorMessage.innerHTML = "‚ùå Invalid result: please check inputs.";
        errorBox.classList.remove("hidden");
        return;
    }

    // Output density
    document.getElementById('densityValue').textContent = density.toFixed(2);

    // ============================
    // OUTPUT FEEDBACK
    // ============================
    let feedback;
    if (density < 8 || density > 25) {
        feedback = '‚ùå Unrealistic density. Please review your inputs.';
    } else if (density < 12) {
        feedback = '‚ö†Ô∏è Very lightweight slurry. May not provide sufficient hydrostatic pressure.';
    } else if (density < 14) {
        feedback = '‚úÖ Lightweight slurry suitable for fragile formations.';
    } else if (density < 16) {
        feedback = '‚úÖ Standard density slurry appropriate for most applications.';
    } else if (density < 18) {
        feedback = '‚ö†Ô∏è Heavyweight slurry. Ensure it can be properly mixed and pumped.';
    } else {
        feedback = '‚ùå Very high-density slurry. Check if this is realistic for field mixing.';
    }

    document.getElementById('feedbackContent').textContent = feedback;

    placeholder.classList.add('hidden');
    resultValue.classList.remove('hidden');
}

        function printReport() {
            // Update date just before printing
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
            
            window.print();
        }
    </script>
    <script src="{% static 'js/print.js' %}"></script>

</body>
</html>
{% endblock %}



{% comment %} 

1. Formula (to keep in your code as comment)
/*
Cement Slurry Density Formula:

Density (œÅ) = (Wcement + Wwater) / Vslurry

Where:
œÅ        = Slurry density (lbs/gal)
Wcement  = Weight of dry cement (lbs)
Wwater   = Weight of water (lbs)
Vslurry  = Total slurry volume (gallons)

Validation Rule (Water-to-Cement Ratio):
Water-to-Cement Ratio (W/C) = Wwater / Wcement

Typical acceptable range: 0.3 ‚Äì 0.8
- W/C < 0.3 ‚Üí Slurry too dry, cannot be mixed properly
- W/C > 0.8 ‚Üí Slurry too diluted, weak strength, risk of segregation

üëâ Example explanation for users:
0.3 ratio means 30 lbs of water for every 100 lbs of cement.
0.8 ratio means 80 lbs of water for every 100 lbs of cement.
*/

2. Input Validation Rules (Industry & QEHS Best Practice)
Parameter	Units	Acceptable Range	Why
Wcement	lbs	500 ‚Äì 10,000	Below 500 not industrially relevant, above 10k impractical for one batch
Wwater	lbs	100 ‚Äì 8,000	Needs to be consistent with cement weight and realistic mixability
Vslurry	gallons	10 ‚Äì 2000	Below 10 gallons ‚Üí lab-scale only, above 2000 impractical for one batch
Water-to-Cement Ratio (W/C)	‚Äì	0.3 ‚Äì 0.8	Standard cement slurry design per API / construction practice
Decimals	‚Äì	Allow up to 1 decimal place for volume, full integer for weights	Reflects real input accuracy
3. Output Validation & Thresholds
Density (lbs/gal)	Assessment
< 12	Too light ‚Üí insufficient hydrostatic pressure
12 ‚Äì 14	Lightweight slurry ‚Üí fragile formations
14 ‚Äì 16	Standard slurry ‚Üí most applications
16 ‚Äì 18	Heavy slurry ‚Üí special handling required
> 18	Very heavy ‚Üí impractical, check inputs {% endcomment %}