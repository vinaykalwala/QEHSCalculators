{% extends 'base.html' %}
{% block title %}Precast Lifting Safety Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Precast Lifting Safety Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding:0 20px;
            border-radius: 12px;
        }
        
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }
        
        /* Input rows for side-by-side fields */
        .input-row {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        @media (min-width: 480px) {
            .input-row {
                flex-direction: row;
            }
        }
        
        .input-row .form-group {
            flex: 1;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input, .form-select {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center; 
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
        .select-wrapper {
    position: relative;
    width: 100%;
}

.form-select {
    width: 100%;
    padding: 14px 16px;
    border: 1px solid #ddd;
    border-radius: 10px;
    background: #f9fbfd;
    font-size: 16px;
    transition: all 0.3s;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    cursor: pointer;
}

.select-wrapper::after {
    content: "▼";
    font-size: 0.9rem;
    color: #1560bd;
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
}

/* 🔹 Responsive adjustments for small screens */
@media screen and (max-width: 425px) {
    .form-select {
        padding: 10px 12px;
        font-size: 14px;
        border-radius: 8px;
    }

    .select-wrapper::after {
        font-size: 0.75rem;
        right: 10px;
    }
}

    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
    
    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Precast Lifting Safety Calculator</h1>
            <p>Calculate the weight of precast units for safe lifting operations</p>
        </div>

        <div class="calc-content">
            <!-- Calculator -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="input-row">
                    <div class="form-group">
                        <label for="length">Length (m)</label>
                        <input type="number" id="length" class="form-input" min="0" step="0.01" placeholder="e.g., 5.0">
                    </div>
                    <div class="form-group">
                        <label for="width">Width (m)</label>
                        <input type="number" id="width" class="form-input" min="0" step="0.01" placeholder="e.g., 2.5">
                    </div>
                </div>
                <div class="input-row">
                    <div class="form-group">
                        <label for="thickness">Thickness (m)</label>
                        <input type="number" id="thickness" class="form-input" min="0" step="0.01" placeholder="e.g., 0.3">
                    </div>
                    <div class="form-group">
                        <label for="density">Concrete Density (kN/m³)</label>
                        <input type="number" id="density" class="form-input" min="0" step="0.1" value="25" placeholder="e.g., 25">
                    </div>
                </div>
                <div class="form-group">
                    <label for="structureType">Select Special Case (Optional)</label>
                    <div class="select-wrapper">
                    <select id="structureType" class="form-select">
                        <option value="1">None (Standard Element)</option>
                        <option value="2">Double-T Slabs (2 × Weight)</option>
                        <option value="3">Ribbed Elements (3 × Weight)</option>
                        <option value="4">Coffered Elements (4 × Weight)</option>
                    </select>
                </div>
                </div>
                
                <button class="calculate-btn" onclick="calculateWeight()">Calculate Weight</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Safety illustration">
                    <p>This tool will calculate the <strong>Weight of Precast Units</strong> for safe lifting operations. Enter your data to see results and insights here.</p>
                </div>
                
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">❌</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                 
                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Precast Unit Weight</h2>
                    </div>
                    <div class="rate-display">
                        <div class="rate-value" id="rateValue">0.00</div>
                        <div class="rate-label" style="color:#2980b9; font-size:20px; font-weight:bold;">kN</div>
                    </div>

                    <div class="result-feedback">
                        <div class="feedback-title">Weight Assessment</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

<!-- Notes Section -->
<div class="note-section">
    <!-- About -->
    <div class="note-card">
        <h3>📘 About This Calculator</h3>
        <p>
            This tool calculates the <strong>Weight of Precast Units</strong> for safe lifting operations in construction,
            helping to prevent accidents and ensure proper equipment selection.
        </p>
    </div>

    <!-- Parameters Used -->
    <div class="note-card">
        <h3>⚙️ Parameters Used</h3>
        <ul class="note-list">
            <li><strong>Length:</strong> The length of the precast unit in meters (m).</li>
            <li><strong>Width:</strong> The width of the precast unit in meters (m).</li>
            <li><strong>Thickness:</strong> The thickness of the precast unit in meters (m).</li>
            <li><strong>Concrete Density:</strong> The density of concrete, typically 25 kN/m³.</li>
            <li><strong>Special Cases:</strong> Multipliers for structural types (Standard, Double-T, Ribbed, Coffered).</li>
        </ul>
    </div>

    <!-- Input Validation Rules -->
    <div class="note-card">
        <h3>✅ Input Validation Rules</h3>
        <ul class="note-list">
            <li><strong>Length:</strong> 0.5–30 m (2 decimals allowed)</li>
            <li><strong>Width:</strong> 0.3–10 m (2 decimals allowed)</li>
            <li><strong>Thickness:</strong> 0.05–1.5 m (2 decimals allowed)</li>
            <li><strong>Concrete Density:</strong> 23–26 kN/m³ (1 decimal allowed)</li>
            <li><strong>Special Case Factor:</strong> Integer between 1 and 4</li>
        </ul>
    </div>

   <div class="note-card">
    <h3>📊 Output Validations</h3>
    <p>
        The calculated weight of the precast element is evaluated against practical safety thresholds.
        Use the ranges below to assess lifting requirements and rigging precautions:
    </p>
    <ul class="note-list">
        <li><strong>&lt; 50 kN:</strong> Lightweight element → Standard lifting equipment is suitable.</li>
        <li><strong>50–200 kN:</strong> Medium weight element → Requires proper rigging planning.</li>
        <li><strong>200–500 kN:</strong> Heavy element → Specialized equipment and planning needed.</li>
        <li><strong>500–1000 kN:</strong> Very heavy element → Requires expert planning and heavy-lift equipment.</li>
        <li><strong>&gt; 1000 kN:</strong> ⚠️ Calculated weight exceeds typical safe lifting limits (1000 kN). Verify inputs and crane capacity.</li>
    </ul>
</div>
<div class="note-card">
    <h3>📏 Governing Principle</h3>
    <p>
        While there is no single international standard for a <strong>Precast Lifting Safety Calculator</strong>, such tools are based on multiple regulations and standards from different authorities. 
        The calculations are usually guided by standards for concrete design, lifting hardware, and overall construction safety.
    </p>

    <h3>Key Standards Influencing Precast Lifting Calculations</h3>
    
    <h3>International and European Standards</h3>
    <ul class="note-list">
        <li><strong>VDI/BV-BS 6205:</strong> German guideline for lifting inserts and systems for precast concrete elements; provides comprehensive design principles and is widely referenced.</li>
        <li><strong>Eurocode 2 (EN 1992-1-1):</strong> European standard for concrete structures; includes clauses for bond transfer and development lengths of reinforcing bars vital for lifting insert design.</li>
        <li><strong>EN 13369:</strong> Core European standard establishing common rules for precast concrete products, referenced by more specific product standards.</li>
    </ul>
<br>
    <h3>U.S. Standards and Regulations</h3>
    <ul class="note-list">
        <li><strong>OSHA 29 CFR 1926.704:</strong> Sets mandatory safety factors for lifting hardware in precast construction.
            <ul>
                <li>Lifting inserts for tilt-up members: must support ≥ 2× maximum intended load.</li>
                <li>Lifting inserts for other precast members: must support ≥ 4× maximum intended load.</li>
                <li>Lifting hardware: must support ≥ 5× maximum intended load.</li>
            </ul>
        </li>
        <li><strong>Prestressed Concrete Institute (PCI) Design Handbook:</strong> Provides design and calculation guidelines for precast and prestressed concrete members.</li>
    </ul>
<br>
    <h3>Other National Standards</h3>
    <ul class="note-list">
        <li><strong>British Standards (BS):</strong> UK regulations influenced by the Health and Safety at Work Act and HSE guidelines; Eurocodes also implemented.</li>
        <li><strong>Indian Standards (IS):</strong> Codes for design and erection of prefabricated concrete, e.g., IS 15916:2020.</li>
        <li><strong>Australian Standards (AS):</strong> Includes AS 3600 for concrete structures and AS 3850 for tilt-up construction.</li>
    </ul>
<br>
    <h3>Why There is No Single Standard</h3>
    <p>
        A Precast Lifting Safety Calculator is complex and combines multiple calculations based on:
    </p>
    <ul class="note-list">
        <li>The weight of the precast unit.</li>
        <li>Adhesion and friction during demolding.</li>
        <li>Dynamic forces during lifting.</li>
        <li>Number and arrangement of lifting anchors.</li>
        <li>Specific safety factors for inserts and hardware based on project location.</li>
    </ul>
    <p>
        Therefore, calculators must be configured to comply with the specific design codes and safety regulations of the country where the lifting operation is taking place.
    </p>
</div>

    <!-- Standards -->
    <div class="note-card">
    <h3>📝 Conclusion</h3>
    <p>
        The Precast Lifting Safety Calculator provides guidance on the weight of precast elements for safe lifting operations. 
        It helps determine whether standard, medium, heavy, or specialized lifting equipment is required. 
        Users should always verify extreme results, ensure compliance with local standards, crane capacity, 
        and project-specific safety requirements before performing lifts.
    </p>
</div>

</div>


    <script>
        // Set current date for print header
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
        });

        function calculateWeight() {
    const length = parseFloat(document.getElementById('length').value.trim());
    const width = parseFloat(document.getElementById('width').value.trim());
    const thickness = parseFloat(document.getElementById('thickness').value.trim());
    const density = parseFloat(document.getElementById('density').value.trim());
    const structureType = parseInt(document.getElementById('structureType').value);

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');

    let errors = [];
    let warnings = [];

    /* --- INPUT VALIDATIONS --- */
    // Length
    if (isNaN(length) || length <= 0.5 || length > 30) {
        errors.push("👉 Length must be between 0.5 m and 30 m.");
    }

    // Width
    if (isNaN(width) || width <= 0.3 || width > 10) {
        errors.push("👉 Width must be between 0.3 m and 10 m.");
    }

    // Thickness
    if (isNaN(thickness) || thickness <= 0.05 || thickness > 1.5) {
        errors.push("👉 Thickness must be between 0.05 m and 1.5 m.");
    }

    // Density
    if (isNaN(density) || density < 23 || density > 26) {
        errors.push("👉 Concrete density must be between 23 and 26 kN/m³.");
    }

    // Structure Factor
    if (![1,2,3,4].includes(structureType)) {
        errors.push("👉 Invalid structure type factor. Must be 1–4.");
    }

    // Stop if any errors
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    /* --- CALCULATION --- */
    const volume = length * width * thickness; // m³
    const standardWeight = volume * density;   // kN
    const finalWeight = standardWeight * structureType;

    if (!isFinite(finalWeight) || finalWeight <= 0) {
        errorMessage.innerHTML = "👉 Calculation error: check inputs.";
        errorBox.classList.remove("hidden");
        resultValue.classList.add("hidden");
        return;
    }

    /* --- OUTPUT VALIDATION --- */
    if (finalWeight > 1000) {
        warnings.push("⚠️ Calculated weight exceeds typical safe lifting limits (1000 kN). Verify inputs and crane capacity.");
    }

    document.getElementById('rateValue').textContent = finalWeight.toFixed(2);

    // Feedback messages
    const feedbackContent = document.getElementById('feedbackContent');
    let feedback = "";
    if (finalWeight < 50) {
        feedback = "Lightweight element. Standard lifting equipment is suitable.";
    } else if (finalWeight <= 200) {
        feedback = "Medium weight element. Requires proper rigging planning.";
    } else if (finalWeight <= 500) {
        feedback = "Heavy element. Specialized equipment and planning needed.";
    } else {
        feedback = "Very heavy element. Requires expert planning and heavy-lift equipment.";
    }

    feedbackContent.textContent = feedback + (warnings.length ? " " + warnings.join(" ") : "");

    placeholder.classList.add('hidden');
    resultValue.classList.remove('hidden');
}


        function printReport() {
            // Update date just before printing
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
            
            window.print();
        }
    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}

{% comment %} 
1. Formula Used in Calculator

We need to keep this in the code as a comment for clarity:

/* 
Formula for Precast Lifting Safety Calculator:
------------------------------------------------
Volume (m³) = Length (m) × Width (m) × Thickness (m)

Standard Weight (kN) = Volume (m³) × Concrete Density (kN/m³)

Final Weight (kN) = Standard Weight × Structure Type Factor

Where:
- Length (L) > 0
- Width (W) > 0
- Thickness (T) > 0
- Concrete Density (ρ) typically 23–26 kN/m³ (default = 25 kN/m³)
- Structure Type Factor = 1 (standard), 2 (double-T), 3 (ribbed), 4 (coffered)
*/

2. Detailed Input Validation Rules
Field	Units	Allowed Range (Practical)	Decimal Precision	Validation Rationale
Length (L)	m	> 0.5 and ≤ 30.0	2 decimals	Precast elements below 0.5 m unrealistic; >30 m impractical for standard lifting.
Width (W)	m	> 0.3 and ≤ 10.0	2 decimals	Narrower than 0.3 m = unsafe; >10 m usually segmented.
Thickness (T)	m	> 0.05 and ≤ 1.5	2 decimals	<0.05 m slab is fragile; >1.5 m thickness is uncommon.
Density (ρ)	kN/m³	≥ 23 and ≤ 26	1 decimal	Standard concrete density range (normal weight concrete).
Structure Type Factor	–	1–4 only (integer)	N/A	Ensures no invalid multipliers.
3. Output Validation Rules

Final Weight must be finite and > 0.

Thresholds for safe interpretation:

<50 kN → Lightweight, standard lifting OK.

50–200 kN → Medium weight, requires rigging plan.

200–500 kN → Heavy, needs specialized rigging & planning.

500 kN → Very heavy, expert supervision and specialized cranes.

1000 kN → Warning: “Unrealistically high, recheck inputs.”

These thresholds align with OSHA lifting requirements, NFPA construction rigging best practices, and ISO crane load chart use. {% endcomment %}