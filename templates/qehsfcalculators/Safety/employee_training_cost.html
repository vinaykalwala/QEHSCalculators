{% extends 'base.html' %}
{% block title %}Employee Training Cost Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Training Cost Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding:0 20px;
            border-radius: 12px;
        }
        
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            {% comment %} max-width: 700px; {% endcomment %}
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex; 
            flex-direction: column;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (min-width: 901px) {
            .calc-content { 
                flex-direction: row; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
            order: 2;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            min-height: 320px;
            {% comment %} order: 1; {% endcomment %}
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Input rows for side-by-side fields */
        .input-row {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        @media (min-width: 480px) {
            .input-row {
                flex-direction: row;
            }
        }
        
        .input-row .form-group {
            flex: 1;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            {% comment %} margin-top: 20px; {% endcomment %}
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .cost-display {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .cost-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }
        
        .cost-label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 18px;
        }
        
        .cost-amount {
            font-size: 22px;
            font-weight: 700;
            color: #2980b9;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        /* Mobile-specific adjustments */
        @media (max-width: 320px) {
            .calculator-container {
                padding: 10px;
            }
            
            .calculator-header h1 {
                font-size: 1.8rem;
            }
            
            .calculator-header p {
                font-size: 16px;
            }
            
            .calc-card, .result-card {
                padding: 20px 15px;
                border-radius: 12px;
            }
            
            .calc-card h2 {
                font-size: 1.4rem;
            }
            
            .form-input {
                padding: 12px 14px;
                font-size: 14px;
            }
            
            .calculate-btn {
                padding: 12px;
                font-size: 0.9rem;
            }
            
            .result-placeholder img {
                max-width: 180px;
            }
            
            .cost-amount {
                font-size: 18px;
            }
            
            .cost-label {
                font-size: 16px;
            }
            
            .note-card {
                padding: 15px 18px;
            }
            
            .note-card h3 {
                font-size: 16px;
            }
            
            .note-card p, .note-card li {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
    
    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Employee Training Cost Calculator</h1>
            <p>Calculate the total cost of training programs and cost per attendee</p>
        </div>

        <div class="calc-content">
            <!-- Calculator -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                
                <div class="form-group">
                    <label for="attendees">Number of Attendees</label>
                    <input type="number" id="attendees" class="form-input" min="1" placeholder="e.g., 25">
                </div>
                
                <div class="form-group">
                    <label for="sessions">Total Number of Sessions</label>
                    <input type="number" id="sessions" class="form-input" min="1" placeholder="e.g., 5">
                </div>
                
                <div class="form-group">
                    <label for="costPerSession">Cost per Session (in ₹)</label>
                    <input type="number" id="costPerSession" class="form-input" min="1" placeholder="e.g., 5000">
                </div>
                
                <button class="calculate-btn" onclick="calculateTrainingCost()">Calculate Training Cost</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Safety illustration">
                    <p>This tool will calculate the <strong>Employee Training Costs</strong>. Enter your data to see results and insights here.</p>
                </div>
                
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">❌</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                 
                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Training Cost Analysis</h2>
                    </div>
                    
                    <div class="cost-display">
                        <div class="cost-item">
                            <span class="cost-label">Total Training Cost:</span>
                            <span class="cost-amount" id="totalCost">₹0.00</span>
                        </div>
                        
                        <div class="cost-item">
                            <span class="cost-label">Cost per Attendee:</span>
                            <span class="cost-amount" id="costPerAttendee">₹0.00</span>
                        </div>
                    </div>

                    <div class="result-feedback">
                        <div class="feedback-title">Cost Efficiency Assessment</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                    
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
<!-- Notes Section -->
<div class="note-section">

  <!-- 📘 About This Calculator -->
  <div class="note-card">
    <h3>📘 About This Calculator</h3>
    <p>
      The <strong>Employee Training Cost Calculator</strong> helps organizations estimate the total cost of training programs and the cost per attendee. 
      It supports HR, finance, and quality teams in budgeting, compliance reporting, and efficiency tracking across workforce development programs.
    </p>
  </div>

  <!-- ⚙ Parameters Used -->
  <div class="note-card">
    <h3>⚙ Parameters Used</h3>
    <ul class="note-list">
      <li><strong>Number of Attendees:</strong> The total number of employees participating in the training.</li>
      <li><strong>Total Number of Sessions:</strong> The total training sessions planned for the program.</li>
      <li><strong>Cost per Session (₹):</strong> The direct cost incurred per training session, including trainer fees, materials, and venue charges.</li>
    </ul>
  </div>

  <!-- ✅ Input Validation Rules -->
  <div class="note-card">
    <h3>✅ Input Validation Rules</h3>
    <ul class="note-list">
      <li><strong>Number of Attendees:</strong> Must be a whole number between 1 and 10,000.</li>
      <li><strong>Total Number of Sessions:</strong> Must be a whole number between 1 and 1,000.</li>
      <li><strong>Cost per Session (₹):</strong> Must be between ₹100 and ₹1,000,000 (up to 2 decimals allowed).</li>
      <li><strong>No division by zero:</strong> Attendees cannot be zero.</li>
      <li><strong>Logical check:</strong> Too many sessions compared to attendees will be flagged as unrealistic.</li>
      <li><strong>No negative values:</strong> All inputs must be positive and realistic.</li>
      <li><strong>Cross-field consistency:</strong> Number of sessions should not exceed attendees × 10.</li>
    </ul>
  </div>

  <!-- 📊 Output Validations -->
  <div class="note-card">
    <h3>📊 Output Validations</h3>

    <p>
      Validation thresholds and feedback interpretation:
    </p>
    <ul class="note-list">
      <li><strong>Excellent cost efficiency:</strong> Cost per attendee ≤ 50% of session cost → <em>“👍 Excellent cost efficiency!”</em></li>
      <li><strong>Good cost efficiency:</strong> Cost per attendee between 50%–100% of session cost → <em>“✅ Good cost efficiency.”</em></li>
      <li><strong>Moderate cost efficiency:</strong> Cost per attendee between 100%–200% of session cost → <em>“⚠️ Moderate cost efficiency.”</em></li>
      <li><strong>Low cost efficiency:</strong> Cost per attendee > 200% of session cost → <em>“❌ Low cost efficiency. Consider revising training plan.”</em></li>
    </ul>

    <p><strong>Assessment/Feedback:</strong>  
      The exact same sentences used in result display are shown here for validation clarity:
      “👍 Excellent cost efficiency!”,  
      “✅ Good cost efficiency.”,  
      “⚠️ Moderate cost efficiency.”,  
      “❌ Low cost efficiency. Consider revising training plan.”  
    </p>
  </div>

  <!-- 📜 Governing Principle -->
  <div class="note-card">
    <h3>📜 Governing Principle</h3>
    <p>
      An <strong>Employee Training Cost Calculator</strong> does not adhere to a single universal standard but is a general term for tools that calculate training costs based on various methodologies and industry benchmarks. 
      The specific "standard" or calculation method depends on the tool's purpose, often including components like the total cost of training, the cost per employee, or using industry-specific averages as a benchmark for budget planning.
    </p>
    <p>Here are some common approaches used by these calculators:</p>
    <ul class="note-list">
      <li><strong>Per-Employee Cost:</strong> This method divides the total training expenses by the number of employees who received the training.</li>
      <li><strong>Budgeting based on Industry Standards:</strong> Some calculators use a percentage of the total salary budget (e.g., 1–3%) or compare a company’s per-employee training cost to industry averages for benchmarking.</li>
      <li><strong>Learning Outcomes:</strong> Calculators may base the budget on achieving specific, measurable learning outcomes.</li>
      <li><strong>Comprehensive Cost Breakdown:</strong> More detailed calculators include direct costs such as instructor fees, course materials, and technology, along with indirect costs like employee salaries during training and lost productivity.</li>
    </ul>
    <p>
      In essence, there isn’t one specific “standard” for an employee training cost calculator, but rather a set of common formulas and benchmarking practices that organizations use to understand and manage their training investments.
    </p>

  </div>

  <!-- 🏁 Conclusion -->
  <div class="note-card">
    <h3>🏁 Conclusion</h3>
    <ul class="note-list">
      <li>This calculator provides a structured way to evaluate training expenditure efficiency and cost allocation.</li>
      <li>Validation rules ensure realistic, auditable, and consistent input data for compliance reporting (e.g., ISO 45001, OSHA, NFPA).</li>
      <li>Output feedback helps organizations benchmark performance and optimize training investments.</li>
      <li>Aligns with best practices in HR analytics and financial planning for employee development programs.</li>
    </ul>
  </div>

</div>


    <script>
        // Set current date for print header
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
        });

        function calculateTrainingCost() {
    const attendees = document.getElementById('attendees').value.trim();
    const sessions = document.getElementById('sessions').value.trim();
    const costPerSession = document.getElementById('costPerSession').value.trim();

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');

    let errors = [];

    // --- VALIDATION RULES ---
    // Attendees: Integer, 1–10,000
    // Sessions: Integer, 1–1,000
    // Cost per Session: Decimal, 100–1,000,000
    // Formula:
    //   Total Training Cost = Sessions × Cost per Session
    //   Cost per Attendee = Total Training Cost ÷ Attendees

    const inputs = [
        { name: "Number of attendees", val: attendees, min: 1, max: 10000, integer: true },
        { name: "Number of sessions", val: sessions, min: 1, max: 1000, integer: true },
        { name: "Cost per session", val: costPerSession, min: 100, max: 1000000, integer: false }
    ];

    inputs.forEach(input => {
        if (input.val === "") {
            errors.push(`👉 Please enter ${input.name}.`);
        } else {
            const num = parseFloat(input.val);
            if (isNaN(num)) {
                errors.push(`👉 ${input.name} must be a number.`);
            } else if (input.integer && !Number.isInteger(num)) {
                errors.push(`👉 ${input.name} must be a whole number.`);
            } else if (num < input.min || num > input.max) {
                errors.push(`👉 ${input.name} must be between ${input.min.toLocaleString()} and ${input.max.toLocaleString()}.`);
            }
        }
    });

    // Cross-field logic checks
    const numAttendees = parseInt(attendees);
    const numSessions = parseInt(sessions);
    const sessionCost = parseFloat(costPerSession);

    if (!isNaN(numAttendees) && !isNaN(numSessions)) {
        if (numSessions > numAttendees * 10) {
            errors.push("👉 Unusual input: Too many sessions compared to attendees.");
        }
    }

    // Show errors
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    // --- CALCULATION ---
    const totalCost = numSessions * sessionCost;
    const costPerAttendee = totalCost / numAttendees;

    // Prevent division by zero safeguard
    if (numAttendees <= 0) {
        errorMessage.innerHTML = "👉 Division by zero error: Attendees must be at least 1.";
        errorBox.classList.remove("hidden");
        return;
    }

    // Display results
    document.getElementById('totalCost').textContent =
        `₹${totalCost.toLocaleString('en-IN', { maximumFractionDigits: 2 })}`;
    document.getElementById('costPerAttendee').textContent =
        `₹${costPerAttendee.toLocaleString('en-IN', { maximumFractionDigits: 2 })}`;

    // --- FEEDBACK ---
    let feedback = '';
    const costRatio = costPerAttendee / sessionCost;

    if (costRatio < 0.5) {
        feedback = '👍 Excellent cost efficiency!';
    } else if (costRatio < 1) {
        feedback = '✅ Good cost efficiency.';
    } else if (costRatio < 2) {
        feedback = '⚠️ Moderate cost efficiency.';
    } else {
        feedback = '❌ Low cost efficiency. Consider revising training plan.';
    }

    document.getElementById('feedbackContent').textContent = feedback;

    placeholder.classList.add('hidden');
    resultValue.classList.remove('hidden');
}


        function printReport() {
            // Update date just before printing
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
            
            window.print();
        }
    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


{% comment %} 
1. Real-world QEHS / Fire Safety Input Validation Rules

When training costs are calculated for compliance reporting (ISO 45001, OSHA, NFPA, ILO), input data must be realistic, auditable, and logically consistent. Below are validation rules:

Number of Attendees

Type: Integer only.

Range: 1 – 10,000

<1 → invalid (no zero or negative).

10,000 → unrealistic for a single training program (split into multiple programs).

Cross-field logic: Attendees must be ≥ sessions (it is illogical to have more sessions than attendees without any participants).

Number of Sessions

Type: Integer only.

Range: 1 – 1,000

<1 → invalid (no zero or negative).

1,000 → impractical for budgeting one training cycle.

Cross-field logic: Sessions should be reasonable relative to attendees (e.g., if attendees = 5 but sessions = 500 → flag unrealistic).

Cost per Session (₹)

Type: Positive number (decimal allowed).

Range: ₹100 – ₹1,000,000

<₹100 → training session costs cannot realistically be this low (materials, trainer, compliance overhead).

₹1,000,000 → exceptional case (executive-level or global programs only).

Decimals: Allow up to 2 decimals (currency).

2. Output Validation Rules & Thresholds

Formulae (include as code comments):

// Total Training Cost = Number of Sessions × Cost per Session
// Cost per Attendee = Total Training Cost ÷ Number of Attendees


Validation:

Division by zero (if attendees = 0) must be prevented.

Total cost must be ≤ sessions × max cost per session limit (audit safeguard).

Cost per attendee must be realistic (flag if > ₹100,000 per attendee — unusual for general workforce training).

Feedback thresholds (used for efficiency assessment):

Excellent: cost per attendee ≤ 50% of session cost.

Good: cost per attendee between 50–100% of session cost.

Moderate: cost per attendee between 100–200% of session cost.

Low: cost per attendee > 200% of session cost. {% endcomment %}