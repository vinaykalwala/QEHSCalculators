{% extends 'base.html' %}
{% block title %}Velocity of Steam Passing Through an Orifice Calculator(2){% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Velocity of Steam Passing Through an Orifice Calculator(2)</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }
        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        @media (max-width: 900px) {
            .calc-content {
                flex-direction: column;
            }
        }
        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
            min-height: 420px; /* Match calc-card */
        }
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
            justify-content: center;
        }
        .calc-card:hover {
            transform: translateY(-5px);
        }
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }
        /* Inputs */
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        .form-input, .form-select {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }
        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }
        /* Result Card */
        .result-placeholder {
            text-align: center;
            margin: auto;
        }
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: baseline;
            justify-content: center;
        }
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
        }
        .rate-label {
            color: #2980b9;
            font-weight: bold;
            font-size: 20px;
        }
        /* Meter */
        .safety-meter {
            width: 100%;
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0 10px;
            overflow: hidden;
        }
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out, background-color 1s ease-in-out;
            border-radius: 6px;
        }
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }
        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        .feedback-content {
            color: #34495e;
        }
        /* Notes Section */
        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }
        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        .note-list { margin: 0; padding-left: 18px; }
        /* Error Message */
        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px; padding: 20px;
            text-align: left; gap: 12px; margin-top: 20px;
        }
        .error-icon { font-size: 76px; flex-shrink: 0; text-align: center; }
        .error-message { font-size: 24px; line-height: 1.6; }
        .hidden { display: none; }
        .btn-container { display: flex; justify-content: center; margin: 30px 0; }
        .back-btn {
            background: linear-gradient(#1560bd,#000040); color: #ffffff; border: 2px solid #1560bd;
            padding: 10px 20px; font-size: 14px; font-weight: 600; border-radius: 8px;
            text-decoration: none; transition: all 0.3s ease; cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>

    <div class="calculator-container printable" id="printArea">
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Velocity of Steam Passing Through an Orifice Calculator(2)</h1>
            <p>Calculate steam velocity based on the heat drop per unit mass.</p>
        </div>

        <div class="calc-content">
            <div class="calc-card">
                <h2>System Parameter</h2>
                <div class="form-group">
                    <label for="heatDrop">Heat Drop per Unit Mass (h)</label>
                    <input type="number" id="heatDrop" class="form-input" placeholder="Enter heat drop in kJ/kg">
                </div>
                <button class="calculate-btn" onclick="calculateAndDisplay()">Calculate Velocity</button>
            </div>

            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Engineering illustration">
                    <p>Enter the heat drop of the steam to calculate its velocity through an orifice.</p>
                </div>
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                <div id="resultValue" class="hidden" style="text-align: center;">
                    <h2>Steam Velocity (u)</h2>
                    <div class="rate-display">
                        <div class="rate-value" id="rateValue">0.00</div>
                        <div class="rate-label">m/s</div>
                    </div>
                    <div class="safety-meter">
                        <div class="meter-fill" id="meterFill"></div>
                    </div>
                    <div class="meter-labels">
                        <span>Low</span>
                        <span>Optimal</span>
                        <span>High</span>
                    </div>
                    <div class="result-feedback">
                        <div class="feedback-title">Interpretation</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                     <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="note-section">
    <!-- About This Calculator -->
    <div class="note-card">
        <h3>üìò About This Calculator</h3>
        <p>
            This calculator determines the <strong>velocity of steam</strong> passing through an orifice or nozzle based on the
            <strong>enthalpy drop (heat drop)</strong> it experiences. It is a fundamental thermodynamic calculation used to optimize
            flow rates, system performance, and energy efficiency in steam systems.
        </p>
    </div>

    <!-- Parameters Used -->
    <div class="note-card">
        <h3>‚öôÔ∏è Parameters Used</h3>
        <ul class="note-list">
            <li><strong>Velocity of the Fluid (u) (m/s):</strong> Steam flow speed through the orifice or nozzle.</li>
            <li><strong>Heat Drop (h) (kJ/kg):</strong> Heat energy converted to kinetic energy per unit mass of steam.</li>
        </ul>
    </div>

    <!-- Input Validation Rules -->
    <div class="note-card">
        <h3>üìù Input Validation Rules</h3>
        <ul class="note-list">
            <li><strong>Heat Drop (h):</strong> Required. Must be a positive number; negative values are physically invalid.</li>
        </ul>
        <h3>üí° Allowed Decimals</h3>
        <ul class="note-list">
            <li>Heat Drop ‚Üí up to 2 decimal places for practical engineering accuracy.</li>
        </ul>
    </div>

    <!-- Output Validations -->
    <div class="note-card">
        <h3>üìä Output Validations</h3>
        <ul class="note-list">
            <li><strong>&lt; 10 m/s (Low Velocity):</strong> ‚úÖ Low velocity. Check steam pressure and system conditions.</li>
            <li><strong>10 ‚Äì 100 m/s (Optimal Velocity):</strong> ‚úÖ Optimal velocity. Steam is flowing efficiently.</li>
            <li><strong>&gt; 100 m/s (High Velocity):</strong> ‚ùå High velocity. Potential risk of excessive pressure loss and pipe erosion.</li>
        </ul>
    </div>

    <!-- Governing Principle -->
    <div class="note-card">
        <h3>üìè Governing Principle</h3>
        <p>
            When converting energy to velocity, the calculation is based on the principles of classical mechanics and is not
            regulated by a specific external standard. It uses the fundamental physics formula for kinetic energy, which defines
            the relationship between an object's mass, velocity, and energy. The standard system of units used is the
            International System of Units (SI).
        </p>
        <ul class="note-list">
            <li><strong>Physics Formula:</strong> Based on kinetic energy: <em>KE = ¬Ω mv¬≤</em>, where KE = energy (J), m = mass (kg), v = velocity (m/s).</li>
            <li><strong>Velocity Calculation:</strong> Rearranged: <em>v = ‚àö(2 KE / m)</em>.</li>
            <li><strong>Applicable Scenarios:</strong> Classical mechanics for low-speed objects; relativistic mechanics for speeds near light. Industry-specific limits may apply for fluid velocity in pipes.</li>
        </ul>
    </div>

    <!-- Conclusion -->
    <div class="note-card">
        <h3>‚úÖ Conclusion</h3>
        <p>
            Calculating steam velocity using the heat drop method ensures accurate flow estimation, optimizes energy use,
            and supports safe operation of steam systems. This tool is critical for engineers in power plants, turbines, and
            industrial steam applications.
        </p>
    </div>
</div>

    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        // Set the current date for the report
        const now = new Date();
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        const printDate = document.getElementById('printDate');
        if (printDate) {
            printDate.textContent = now.toLocaleDateString('en-US', options);
        }
    });

    function calculateHeatDropVelocity() {
        const errorBox = document.getElementById('resultError');
        const errorMessage = document.getElementById('errorMessage');
        const placeholder = document.getElementById('placeholder');
        const resultValueBox = document.getElementById('resultValue');

        // Reset UI
        errorBox.classList.add('hidden');
        resultValueBox.classList.add('hidden');
        placeholder.classList.remove('hidden');

        let errors = [];

        // Helper function to validate positive numeric inputs
        function getVal(id, label) {
            const el = document.getElementById(id);
            const raw = el.value?.toString().trim();
            if (!raw) {
                errors.push(`üëâ ${label} is required.`);
                return null;
            }
            const num = parseFloat(raw);
            if (isNaN(num) || num <= 0) {
                errors.push(`üëâ Enter a valid positive number for ${label}.`);
                return null;
            }
            return num;
        }

        // --- INPUTS ---
        const h = getVal('heatDrop', 'Heat Drop (h) [kJ/kg]');

        // Show errors if any
        if (errors.length > 0) {
            errorMessage.innerHTML = errors.join("<br>");
            errorBox.classList.remove("hidden");
            placeholder.classList.add('hidden');
            return;
        }

        // --- CALCULATION: u = 44.72 * ‚àöh ---
        const u = 44.72 * Math.sqrt(h);

        // --- DISPLAY RESULTS ---
        placeholder.classList.add('hidden');
        resultValueBox.classList.remove('hidden');
        document.getElementById('rateValue').textContent = u.toFixed(2);

        // --- VELOCITY METER & FEEDBACK ---
        const meterFill = document.getElementById('meterFill');
        const minV = 0;
        const maxV = 150; // maximum velocity scale
        let pct = ((u - minV) / (maxV - minV)) * 100;
        pct = Math.max(0, Math.min(100, pct));
        meterFill.style.width = pct + '%';

        let feedback;
        if (u < 10) {
            meterFill.style.backgroundColor = '#f39c12'; // Yellow
            feedback = "‚úÖ Low velocity. Check steam pressure and system conditions.";
        } else if (u <= 100) {
            meterFill.style.backgroundColor = '#2ecc71'; // Green
            feedback = "‚úÖ Optimal velocity. Steam is flowing efficiently.";
        } else {
            meterFill.style.backgroundColor = '#e74c3c'; // Red
            feedback = "‚ùå High velocity. Potential risk of excessive pressure loss and pipe erosion.";
        }

        document.getElementById('feedbackContent').innerHTML = feedback;
    }

    // --- PRINT FUNCTION ---
    function printReport() {
        const now = new Date();
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        const printDate = document.getElementById('printDate');
        if (printDate) {
            printDate.textContent = now.toLocaleDateString('en-US', options);
        }
        window.print();
    }
</script>

</body>
</html>
{% endblock %}