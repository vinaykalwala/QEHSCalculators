{% extends 'base.html' %}
{% block title %}Hydraulic Vertical Pressure Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hydraulic Vertical Pressure Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
           /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding:0 20px;
            border-radius: 12px;
        }
        
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }
        
        /* Input rows for side-by-side fields */
        .input-row {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        @media (min-width: 480px) {
            .input-row {
                flex-direction: row;
            }
        }
        
        .input-row .form-group {
            flex: 1;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            height: 420px;
            overflow-y: auto;
            text-align: center;
            {% comment %} margin-top: 20px; {% endcomment %}
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .rate-display {
            display: flex; 
            gap: 6px;
            align-items: center;  
            justify-content: center; 
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
        
        .error {
            color: #e74c3c;
            font-size: 14px;
            {% comment %} margin-top: 5px; {% endcomment %}
            display: block;
        }
        
        .success {
            color: #27ae60;
            font-size: 16px;
            margin-top: 15px;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
    
    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Hydraulic Vertical Pressure Calculator</h1>
            <p>Calculate vertical pressure at a given depth based on overburden density</p>
        </div>

        <div class="calc-content">
            <!-- Calculator -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                
                <div class="form-group">
                    <label for="density">Overburden Density (ppg)</label>
                    <input type="number" id="density" class="form-input" min="0" placeholder="e.g., 15">
                </div>
                
                <div class="form-group">
                    <label for="depth">Depth (ft)</label>
                    <input type="number" id="depth" class="form-input" min="0" placeholder="e.g., 50">
                </div>
                
                <button class="calculate-btn" onclick="calculateVerticalPressure()">Calculate Vertical Pressure</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                   <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Safety illustration">

                    <p>This tool will calculate the <strong>Vertical Pressure (œÉv)</strong>. Enter your data to see results and insights here.</p>
                </div>
                
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                 
                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Vertical Pressure</h2>
                    </div>
                    <div class="rate-display">
                        <div class="rate-value" id="rateValue">0.00</div>
                        <div class="rate-label" style="color:#2980b9; font-size:20px; font-weight:bold;">psi</div>
                    </div>

                    <div class="safety-meter">
                        <div class="meter-fill" id="meterFill"></div>
                    </div>
                    <div class="meter-labels">
                        <span>Low</span><span>Moderate</span><span>High</span><span>Very High</span><span>Extreme</span>
                    </div>

                    <div class="result-feedback">
                        <div class="feedback-title">Pressure Assessment</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">

    <!-- üìò ABOUT THIS CALCULATOR -->
    <div class="note-card">
        <h3>üìò About This Calculator</h3>
        <p>
            The <strong>Hydraulic Vertical Pressure Calculator</strong> determines the vertical pressure in a fluid or soil column based on density, gravitational acceleration, and depth. 
            It is used extensively in <strong>geotechnical engineering, hydraulic design, construction safety,</strong> and <strong>process vessel design</strong> to ensure systems 
            operate safely under expected stress and loading conditions.
        </p>
    </div>

    <!-- ‚öô PARAMETERS USED -->
    <div class="note-card">
        <h3>‚öô Parameters Used</h3>
        <ul class="note-list">
            <li><strong>Overburden Density (œÅ):</strong> Material density above the depth of interest, typically 10‚Äì22 ppg.</li>
            <li><strong>Acceleration due to Gravity (g):</strong> A constant 32.2 ft/s¬≤ (9.81 m/s¬≤).</li>
            <li><strong>Depth (D):</strong> Vertical distance below the surface at which pressure is calculated (in feet).</li>
        </ul>
    </div>

    <!-- ‚úÖ INPUT VALIDATION RULES -->
    <div class="note-card">
        <h3>‚úÖ Input Validation Rules</h3>
        <ul class="note-list">
            <li><strong>Overburden Density (œÅ):</strong> Must be between 10‚Äì22 ppg (up to 2 decimal places).</li>
            <li><strong>Depth (D):</strong> Must be between 0‚Äì30,000 ft (up to 1 decimal place).</li>
            <li><strong>No negatives:</strong> Both density and depth must be ‚â• 0.</li>
            <li><strong>Zero depth:</strong> Allowed (pressure = 0).</li>
            <li><strong>Unrealistic Results:</strong> Calculated pressure above 50,000 psi flagged as invalid.</li>
        </ul>
        <p><em>Validation criteria follow OSHA excavation standards, ISO 45001 structural integrity rules, and geotechnical design guidelines.</em></p>
    </div>

    <!-- üìä OUTPUT VALIDATIONS -->
    <div class="note-card">
        <h3>üìä Output Validations</h3>
        <ul class="note-list">
            <li><strong>&lt; 500 psi:</strong> Low pressure ‚Äì typical for shallow depths with loose sediments.</li>
            <li><strong>500 ‚Äì 3000 psi:</strong> Moderate pressure ‚Äì safe for mid-depth construction zones.</li>
            <li><strong>3000 ‚Äì 10000 psi:</strong> High pressure ‚Äì requires structural reinforcement or design checks.</li>
            <li><strong>&gt; 10000 psi:</strong> Extreme pressure ‚Äì specialized geotechnical solutions needed.</li>
        </ul>
        <p><em>The above feedback ranges are displayed beside the result meter for user guidance.</em></p>
    </div>

    <!-- üìê GOVERNING PRINCIPLE -->
    <div class="note-card">
        <h3>üìê Governing Principle</h3>
        <p>
            Calculating hydraulic vertical pressure primarily relies on the physical principles of fluid mechanics, such as Pascal's Law and the Hydrostatic Law, 
            rather than a single unifying standard. The appropriate standard for calculations depends on the specific application, industry, and the equipment involved.
        </p>
        <p>
            <strong>Common standards and principles for hydraulic pressure calculations:</strong><br><br>
            <b>For hydrostatic pressure calculations:</b> The fundamental principle for calculating vertical pressure in a stationary fluid is the Hydrostatic Law. 
            This principle applies in civil engineering for water towers, dams, and reservoirs.<br><br>

            <b>For pressure vessel design:</b> Specific design and testing standards ensure safety and integrity:<br>
            ‚Ä¢ <strong>ASME Boiler and Pressure Vessel Code (BPVC):</strong> Governs design, fabrication, inspection, and testing of boilers and pressure vessels.<br>
            ‚Ä¢ <strong>ASME Section VIII:</strong> Defines maximum allowable working pressure and hydrostatic test procedures.<br>
            ‚Ä¢ <strong>IS 2825 (India):</strong> Indian standard for unfired pressure vessels, covering design, fabrication, and certification.<br><br>

            <b>For fire protection and sprinkler systems:</b><br>
            ‚Ä¢ <strong>NFPA 13:</strong> US standard for installation and hydraulic calculation of sprinkler systems.<br>
            ‚Ä¢ <strong>EN 12845 (Europe):</strong> European standard for automatic sprinkler systems, including hydraulic design and maintenance.<br><br>

            <b>For general fluid power systems:</b><br>
            ‚Ä¢ <strong>ISO 4413:</strong> (Also IS 10481 in India) Standard for hydraulic fluid power ‚Äî covers system design, transmission, and safety.<br>
            ‚Ä¢ <strong>ASME B31 Pressure Piping Code:</strong> Provides standards for process piping; hydrostatic tests typically 1.5√ó design pressure.<br><br>

            <b>Summary:</b><br>
            ‚Ä¢ For static liquid columns ‚Äî governed by the Hydrostatic Law.<br>
            ‚Ä¢ For hydraulic machinery ‚Äî ISO 4413 and ASME standards apply.<br>
            ‚Ä¢ For pressure vessels ‚Äî ASME BPVC or IS 2825 are used.<br>
            ‚Ä¢ For fire systems ‚Äî NFPA 13 and EN 12845 define calculations.
        </p>
    </div>

    <!-- üß© CONCLUSION -->
    <div class="note-card">
        <h3>üß© Conclusion</h3>
        <p>
            The Hydraulic Vertical Pressure Calculator follows the physical laws of fluids and internationally recognized design standards to provide accurate 
            vertical pressure estimations. Whether for hydrostatic, vessel, or hydraulic system applications, it ensures that calculated pressures adhere to 
            recognized safety limits and engineering principles ‚Äî supporting design reliability and regulatory compliance.
        </p>
    </div>

</div>

    </div>

    <script>
        // Set current date for print header
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
        });

        function calculateVerticalPressure() {
    const density = document.getElementById('density').value.trim();
    const depth = document.getElementById('depth').value.trim();
    const gravity = 32.2; // Acceleration due to gravity in ft/s¬≤

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');

    let errors = [];

    // Validate Density
    if (density === "") {
        errors.push("üëâ Please enter Overburden Density.");
    } else {
        const densityVal = parseFloat(density);
        if (isNaN(densityVal)) {
            errors.push("üëâ Overburden Density must be a number.");
        } else if (densityVal <= 0) {
            errors.push("üëâ Overburden Density must be greater than 0.");
        } else if (densityVal < 10 || densityVal > 22) {
            errors.push("üëâ Overburden Density must be between 10 and 22 ppg.");
        } else if (!/^\d+(\.\d{1,2})?$/.test(density)) {
            errors.push("üëâ Overburden Density can have up to 2 decimal places.");
        }
    }

    // Validate Depth
    if (depth === "") {
        errors.push("üëâ Please enter Depth.");
    } else {
        const depthVal = parseFloat(depth);
        if (isNaN(depthVal)) {
            errors.push("üëâ Depth must be a number.");
        } else if (depthVal < 0) {
            errors.push("üëâ Depth cannot be negative.");
        } else if (depthVal > 30000) {
            errors.push("üëâ Depth must not exceed 30,000 ft.");
        } else if (!/^\d+(\.\d{1})?$/.test(depth)) {
            errors.push("üëâ Depth can have up to 1 decimal place.");
        }
    }

    // Show errors
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    // Calculation
    const densityVal = parseFloat(density);
    const depthVal = parseFloat(depth);

    // Formula: œÉv = œÅ √ó g √ó D
    const verticalPressure = densityVal * gravity * depthVal;

    // Edge case: Out-of-bounds result
    if (verticalPressure > 50000) {
        errorMessage.innerHTML = "‚ö†Ô∏è Calculated pressure exceeds realistic safety thresholds (>50,000 psi). Please recheck inputs.";
        errorBox.classList.remove("hidden");
        resultValue.classList.add("hidden");
        return;
    }

    document.getElementById('rateValue').textContent = verticalPressure.toFixed(2);

    // Performance Assessment
    const meterFill = document.getElementById('meterFill');
    let meterWidth, meterColor, feedback;

    if (verticalPressure < 500) {
        meterWidth = '10%';
        meterColor = '#27ae60';
        feedback = 'Low pressure - typical for shallow depths with loose sediments.';
    } else if (verticalPressure < 3000) {
        meterWidth = '40%';
        meterColor = '#2ecc71';
        feedback = 'Moderate pressure - safe but monitor soil compaction.';
    } else if (verticalPressure < 10000) {
        meterWidth = '70%';
        meterColor = '#f39c12';
        feedback = 'High pressure - reinforcement and safety planning required.';
    } else {
        meterWidth = '95%';
        meterColor = '#e74c3c';
        feedback = 'Extreme pressure - specialized geotechnical solutions required.';
    }

    meterFill.style.width = meterWidth;
    meterFill.style.backgroundColor = meterColor;
    document.getElementById('feedbackContent').textContent = feedback;

    placeholder.classList.add('hidden');
    resultValue.classList.remove('hidden');
}


        function printReport() {
            // Update date just before printing
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
            
            window.print();
        }
    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}

{% comment %} 

1Ô∏è‚É£ Formula (with comment for future reference)
// Formula used:
// Vertical Pressure (œÉv) = Density √ó Gravity √ó Depth
// Where:
// - Density (œÅ) = Overburden density in ppg (pounds per gallon)
// - Gravity (g) = 32.2 ft/s¬≤
// - Depth (D) = depth in feet
// Output: Vertical Pressure in psi (pounds per square inch)

2Ô∏è‚É£ Input Validation Rules (Industry-based)
Overburden Density (ppg)

Allowed range: 10 ‚Äì 22 ppg
(below 10 is unrealistic for soil/rock, above 22 is extremely rare in real formations)

Decimals: up to 2 decimal places allowed.

No negative or zero values.

Cross-field dependency: At very shallow depth (e.g., < 10 ft), density input should not exceed extreme ranges (> 20 ppg).

Depth (ft)

Allowed range: 0 ‚Äì 30,000 ft
(OSHA/ILO max depth for deep mining rarely exceeds 10,000‚Äì20,000 ft; 30,000 is safe engineering ceiling)

Decimals: allowed up to 1 decimal place (but whole numbers typical).

No negative numbers.

Zero depth: valid (œÉv = 0).

3Ô∏è‚É£ Output Validation Logic & Thresholds

From QEHS and NFPA safety reporting standards:

< 500 psi: Low pressure ‚Äî shallow ground, minimal hazard.

500 ‚Äì 3,000 psi: Moderate ‚Äî requires monitoring for soil compaction.

3,000 ‚Äì 10,000 psi: High ‚Äî stresses need reinforcement, potential structural hazards.

> 10,000 psi: Very High/Extreme ‚Äî specialized geotechnical and fire-safety considerations (e.g., methane release, subsidence risks). {% endcomment %}