{% extends 'base.html' %}
{% block title %}Lifting Force per Anchor Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lifting Force per Anchor Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding:0 20px;
            border-radius: 12px;
        }
        
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Input rows for better organization */
        .ad-input-row {
            display: flex;
            gap: 15px;
        }
        
        .ad-input-row .form-group {
            flex: 1;
        }
        
        @media (max-width: 600px) {
            .ad-input-row {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: auto;
            text-align: center;
            margin-top: 20px;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .rate-display {
            display: flex;
            gap: 6px;
            align-items: center;  
            justify-content: center; 
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'safetycategory_calculators' %}" class="back-btn">Back To Safety Calculators</a>
    </div>
    
    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Lifting Force per Anchor at Building Site</h1>
            <p>Calculate the force exerted on each anchor when lifting heavy slabs</p>
        </div>

        <div class="calc-content">
            <!-- Calculator -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                
                <div class="ad-input-row">
                    <div class="form-group">
                        <label for="weight">Total Weight (G) [kN]</label>
                        <input type="number" id="weight" class="form-input" step="any" min="0.01" placeholder="e.g., 100">
                    </div>
                    <div class="form-group">
                        <label for="angleFactor">Cable Angle Factor (z)</label>
                        <input type="number" id="angleFactor" class="form-input" step="any" min="0.01" placeholder="e.g., 1.2">
                    </div>
                </div>
                
                <div class="ad-input-row">
                    <div class="form-group">
                        <label for="loadFactor">Lifting Load Factor (f)</label>
                        <input type="number" id="loadFactor" class="form-input" step="any" min="0.01" placeholder="e.g., 1.5">
                    </div>
                    <div class="form-group">
                        <label for="anchors">Number of Anchors (n)</label>
                        <input type="number" id="anchors" class="form-input" step="1" min="1" placeholder="e.g., 4">
                    </div>
                </div>
                
                <button class="calculate-btn" onclick="calculateLiftingForce()">Calculate Lifting Force</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Lifting illustration">
                    <p>This tool will calculate the <strong>Lifting Force per Anchor</strong>. Enter your data to see results and insights here.</p>
                </div>
                
                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">❌</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>
                 
                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Lifting Force per Anchor</h2>
                    </div>
                    <div class="rate-display">
                        <div class="rate-value" id="rateValue">0.00</div>
                        <div class="rate-label" style="color:#2980b9; font-size:20px; font-weight:bold;">kN</div>
                    </div>

                    <div class="safety-meter">
                        <div class="meter-fill" id="meterFill"></div>
                    </div>
                    <div class="meter-labels">
                        <span>Low</span><span>Moderate</span><span>High</span><span>Very High</span><span>Critical</span>
                    </div>

                    <div class="result-feedback">
                        <div class="feedback-title">Assessment</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
<div class="note-section">

  <!-- 📘 ABOUT -->
  <div class="note-card">
    <h3>📘 About This Calculator</h3>
    <p>
      This calculator determines the <strong>lifting force per anchor (F)</strong> required when lifting heavy slabs at construction sites. 
      It ensures that lifting operations are performed safely by accounting for total weight, cable angle, safety factors, and anchor distribution.
    </p>
  </div>

  <!-- ⚙️ PARAMETERS USED -->
  <div class="note-card">
    <h3>⚙️ Parameters Used</h3>
    <ul class="note-list">
      <li><strong>Total Weight (G):</strong> The total weight of the object being lifted, measured in kilonewtons (kN).</li>
      <li><strong>Cable Angle Factor (z):</strong> Accounts for the angle of cables during lifting, which increases the force on anchors.</li>
      <li><strong>Lifting Load Factor (f):</strong> Safety factor that considers dynamic effects during lifting operations.</li>
      <li><strong>Number of Anchors (n):</strong> The quantity of anchors sharing the load during the lifting operation.</li>
    </ul>
  </div>

  <!-- ✅ INPUT VALIDATION RULES -->
  <div class="note-card">
    <h3>✅ Input Validation Rules</h3>
    <ul class="note-list">
      <li>Total Weight (G): 0.01 – 10,000 kN</li>
      <li>Cable Angle Factor (z): 1.0 – 3.0 (typical range for cable angles)</li>
      <li>Lifting Load Factor (f): 1.0 – 3.0 (safety factors)</li>
      <li>Number of Anchors (n): 1 – 20 anchors</li>
      <li>All fields mandatory. Division by zero and negative values prevented.</li>
    </ul>
    <p>⚠️ These rules ensure compliance with engineering best practices and safety standards.</p>
  </div>

  <!-- 🧾 OUTPUT VALIDATIONS -->
  <div class="note-card">
    <h3>🧾 Output Validations</h3>
    <ul class="note-list">
      <li>The calculated lifting force per anchor is displayed along with feedback to interpret safety.</li>
      <li><b>Assessment / Feedback Messages:</b></li>
      <ul class="note-sublist">
        <li>✅ Low force per anchor. Safe configuration.</li>
        <li>⚠️ Moderate force per anchor. Verify anchors & rigging setup.</li>
        <li>⚠️ High force per anchor. Certified anchors required.</li>
        <li>🔴 Very high force per anchor. Engineer assessment required.</li>
        <li>🚨 Critical force per anchor. Unsafe without structural engineer approval.</li>
      </ul>
      <li>Feedback messages appear alongside the result to guide safe lifting decisions.</li>
    </ul>
  </div>

  <!-- ⚖️ GOVERNING PRINCIPLE -->
  <div class="note-card">
    <h3>⚖️ Governing Principle</h3>
    <p>
      The standards governing the calculation of lifting force per anchor depend on the specific construction method, location, and application. 
      For tilt-up and precast concrete construction, the primary standards are the Australian Standard AS 3850 in Australia and the American Concrete Institute (ACI) ACI 551 series in the U.S. and other regions.
    </p>
    <ul class="note-list">
      <li><strong>For tilt-up and precast concrete:</strong> Specific guidance for calculating anchor loads when lifting panels.</li>
      <li><strong>Australian Standard AS 3850:</strong> Provides requirements for planning, design, casting, transport, and erection of tilt-up panels, including safety factors and concrete strength requirements.</li>
      <li><strong>ACI 551:</strong> Guides the design of concrete panels, anchor loads during lifting, and related construction techniques.</li>
      <li><strong>General Anchor Design:</strong> Eurocodes (EN 1997-1) and ASTM standards define design, corrosion protection, and material properties.</li>
      <li><strong>Calculation Principles:</strong> Dynamic factor, load distribution, adhesion force, and safety factors ensure safe anchor capacity.</li>
      <li><strong>Safety Regulations:</strong> OSHA sets rules for lifting and rigging operations; critical lifts require detailed lift plans based on accurate force calculations.</li>
    </ul>
  </div>

  <!-- 🏁 CONCLUSION -->
  <div class="note-card">
    <h3>🏁 Conclusion</h3>
    <p>
      This calculator provides safe lifting guidance with corresponding feedback messages that reflect the load per anchor and potential risks. 
      By interpreting results according to the assessments, users can plan safe lifting operations, avoid anchor overload, and ensure compliance with relevant construction and safety standards.
    </p>
  </div>

</div>

    <script>
        // Set current date for print header
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('printDate').textContent = now.toLocaleDateString('en-US', options);
        });

        function calculateLiftingForce() {
    const weight = parseFloat(document.getElementById('weight').value.trim());
    const angleFactor = parseFloat(document.getElementById('angleFactor').value.trim());
    const loadFactor = parseFloat(document.getElementById('loadFactor').value.trim());
    const anchors = parseInt(document.getElementById('anchors').value.trim());

    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');
    const resultError = document.getElementById('resultError');
    const rateValue = document.getElementById('rateValue');
    const feedbackContent = document.getElementById('feedbackContent');
    const meterFill = document.getElementById('meterFill');

    // Reset display
    placeholder.classList.add('hidden');
    resultValue.classList.add('hidden');
    resultError.classList.add('hidden');

    // ✅ Input Validations
    if (isNaN(weight) || weight < 0.01 || weight > 10000) {
        showError("Total Weight (G) must be between 0.01 and 10,000 kN.");
        return;
    }
    if (isNaN(angleFactor) || angleFactor < 1 || angleFactor > 3) {
        showError("Cable Angle Factor (z) must be between 1.0 and 3.0.");
        return;
    }
    if (isNaN(loadFactor) || loadFactor < 1 || loadFactor > 3) {
        showError("Lifting Load Factor (f) must be between 1.0 and 3.0.");
        return;
    }
    if (isNaN(anchors) || anchors < 1 || anchors > 20 || !Number.isInteger(anchors)) {
        showError("Number of Anchors (n) must be an integer between 1 and 20.");
        return;
    }

    // ✅ Calculation
    const liftingForce = (weight * angleFactor * loadFactor) / anchors;
    rateValue.textContent = liftingForce.toFixed(2);

    // ✅ Output Assessment
    let meterPercentage = 0;
    let feedback = "";

    if (liftingForce < 10) {
        meterPercentage = 20;
        feedback = "✅ Low force per anchor. Safe configuration.";
    } else if (liftingForce < 25) {
        meterPercentage = 40;
        feedback = "⚠️ Moderate force per anchor. Verify anchors & rigging setup.";
    } else if (liftingForce < 50) {
        meterPercentage = 60;
        feedback = "⚠️ High force per anchor. Certified anchors required.";
    } else if (liftingForce < 100) {
        meterPercentage = 80;
        feedback = "🔴 Very high force per anchor. Engineer assessment required.";
    } else {
        meterPercentage = 100;
        feedback = "🚨 Critical force per anchor. Unsafe without structural engineer approval.";
    }

    meterFill.style.width = meterPercentage + '%';

    // Color mapping
    if (liftingForce < 10) meterFill.style.background = 'linear-gradient(to right, #2ecc71, #27ae60)';
    else if (liftingForce < 25) meterFill.style.background = 'linear-gradient(to right, #f1c40f, #f39c12)';
    else if (liftingForce < 50) meterFill.style.background = 'linear-gradient(to right, #e67e22, #d35400)';
    else if (liftingForce < 100) meterFill.style.background = 'linear-gradient(to right, #e74c3c, #c0392b)';
    else meterFill.style.background = 'linear-gradient(to right, #8e44ad, #6c3483)';

    feedbackContent.textContent = feedback;
    resultValue.classList.remove('hidden');
}

function showError(message) {
    const resultError = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');

    placeholder.classList.add('hidden');
    errorMessage.textContent = message;
    resultError.classList.remove('hidden');
}
        
        function showError(message) {
            const resultError = document.getElementById('resultError');
            const errorMessage = document.getElementById('errorMessage');
            const placeholder = document.getElementById('placeholder');
            
            placeholder.classList.add('hidden');
            errorMessage.textContent = message;
            resultError.classList.remove('hidden');
        }
        
        function printReport() {
            window.print();
        }
    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


{% comment %} 


/*
 Formula Used:
   F = (G × z × f) / n

 Validation Rules:
   - Total Weight (G): 0.01 – 10,000 kN (2 decimals allowed)
   - Cable Angle Factor (z): 1.0 – 3.0
   - Lifting Load Factor (f): 1.0 – 3.0
   - Number of Anchors (n): 1 – 20 (integer only)
   - Division by zero, negatives, decimals for anchors not allowed
   - Cross-check: Output F > 100 kN = Critical unsafe condition
*/



🔹 1. Formula Used

The calculator is based on this formula:

F = ( G × z × f ) / n


Where:

F = Lifting force per anchor (kN)

G = Total load/weight (kN)

z = Cable angle factor (dimensionless, ≥1.0)

f = Lifting load factor (safety/dynamic factor, ≥1.0)

n = Number of anchors (integer)

🔹 2. Detailed Input Validation Rules
✅ Total Weight (G) [kN]

Range: 0.01 – 10,000 kN

Below 0.01 kN unrealistic (too small).

Above 10,000 kN → impractical for construction lifting anchors (requires cranes, engineered rigging).

Decimals: Up to 2 decimals allowed.

Unit: kN (must not be entered in tons or kg).

Cross-validation: Ensure weight is greater than the calculated minimum safe anchor capacity × number of anchors.

✅ Cable Angle Factor (z)

Range: 1.0 – 3.0

1.0 = Vertical lift (ideal).

3.0 not acceptable (cables too shallow, unsafe rigging).

Decimals: Up to 2 decimals.

Logic: If z < 1 → reject (not physically possible).

✅ Lifting Load Factor (f)

Range: 1.0 – 3.0

1.0 = Static lift (no dynamics).

Typical: 1.3–1.5 (normal safety margin).

3.0 = excessive/unrealistic.

Decimals: Up to 2 decimals.

✅ Number of Anchors (n)

Range: 1 – 20

Below 1 → not valid.

20 → rare in practice (would indicate distributed rigging beyond normal building site practice).

Must be integer only.

Cross-validation:

(weight × z × f) / n must not exceed safe working load of typical anchors (check output validation below).

🔹 3. Output Validation Logic

The output Lifting Force per Anchor (F) must be classified into risk bands for compliance auditing:

Force per Anchor (kN)	Risk Category	Safety Note
< 10	✅ Low	Safe configuration; minimal stress.
10 – 25	⚠️ Moderate	Verify anchors & rigging hardware.
25 – 50	⚠️ High	Requires certified anchors & supervision.
50 – 100	🔴 Very High	Engineering check required.
> 100	🚨 Critical	Unsafe; structural engineer approval mandatory. {% endcomment %}