{% extends 'base.html' %}
{% block title %}BMI Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BMI Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
      

        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            border-radius: 12px;
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
      .btn-wrapper {
    text-align: center; /* centers inline-block buttons */
    margin-top: 20px;
  }

   .btn-wrapper {
    text-align: center; /* centers the button */
    margin-top: 20px;
  }

  .print-btn {
    display: inline-block;
    background:linear-gradient(#1560bd,#000040);
    color: white;
    padding: 8px 18px;   /* control button size */
    border: none;
    border-radius: 6px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    width: auto !important; /* prevent full width */
  }

  .print-btn:hover {
    background: #1560bd;
  }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        /* Table styles */
        .custom-table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .custom-table thead {
            background-color: #1560bd;
            color: white;
        }
        .custom-table th, .custom-table td {
            padding: 12px 16px;
            border: 1px solid #ddd;
            text-align: center;
        }
        .custom-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
       
    </style>
</head>
<body>
<div class="calculator-container printable" id="printArea">

    {% include "includes/print_header_footer.html" with report_title="Body Mass Index (BMI) Report" %}

    <div class="calculator-header">
        <h1>BMI Calculator</h1>
        <p>Assess your body weight status and associated health risks using the Body Mass Index.</p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Your Details</h2>
            <div class="form-group"><label for="age">Age (years)</label><input type="number" id="age" class="form-input" placeholder="e.g., 30" min="2"></div>
            <div class="form-group"><label for="gender">Gender</label><select id="gender" class="form-input"><option value="male">Male</option><option value="female">Female</option></select></div>
            <div class="form-group"><label for="weight">Weight (kg)</label><input type="number" id="weight" class="form-input" placeholder="e.g., 70" min="1"></div>
            <div class="form-group"><label for="height">Height (cm)</label><input type="number" id="height" class="form-input" placeholder="e.g., 175" min="1"></div>
            <button class="calculate-btn" onclick="calculateBMI()">Calculate BMI</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <div class="result-placeholder" id="placeholder"><img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Health status icon"><p>Your BMI result and weight category will be displayed here.</p></div>
            <div class="result-error hidden" id="resultError"><div class="error-message" id="errorMessage"></div></div>
            <div class="result-value hidden" id="resultValue">
                <div class="safety-meter"><div class="meter-fill" id="meterFill"></div></div>
                <div class="meter-labels"><span>Severe Thinness</span><span>Normal</span><span>Overweight</span><span>Obese Class III</span></div>
                <div class="result-feedback">
                    <div class="feedback-content" id="resultContent"></div>
                </div>
                <div class="btn-wrapper"><button class="calculate-btn print-btn" onclick="printReport()">Print Report</button></div>
            </div>
        </div>
    </div>

    <!-- Notes Section -->
    <div class="note-section">
        <div class="note-card"><h3>What is BMI?</h3><p>Body Mass Index (BMI) is a measure of body fat based on a person's weight in relation to their height. It serves as a general indicator of whether a person is at a healthy weight and helps healthcare providers evaluate risks associated with obesity or being underweight.</p></div>
        <div class="note-card"><h3>Why is the BMI Calculator Used?</h3><p>The BMI calculator is a simple and widely used tool to assess whether a person is underweight, normal weight, overweight, or obese. It helps identify potential health risks and determine if further evaluation is necessary. However, BMI does not distinguish between muscle mass and fat, so it is not a perfect measure of health. Itâ€™s important to consider other factors like body composition and lifestyle.</p></div>
        <div class="note-card"><h3>BMI Categories for Adults</h3><table class="custom-table"><thead><tr><th>Classification</th><th>BMI</th><th>BMI Prime</th></tr></thead><tbody><tr><td>Severe Thinness</td><td>&lt; 16</td><td>&lt; 0.64</td></tr><tr><td>Moderate Thinness</td><td>16 - 17</td><td>0.64 - 0.68</td></tr><tr><td>Mild Thinness</td><td>17 - 18.5</td><td>0.68 - 0.74</td></tr><tr><td>Normal</td><td>18.5 - 25</td><td>0.74 - 1</td></tr><tr><td>Overweight</td><td>25 - 30</td><td>1 - 1.2</td></tr><tr><td>Obese Class I</td><td>30 - 35</td><td>1.2 - 1.4</td></tr><tr><td>Obese Class II</td><td>35 - 40</td><td>1.4 - 1.6</td></tr><tr><td>Obese Class III</td><td>&gt; 40</td><td>&gt; 1.6</td></tr></tbody></table></div>
        <div class="note-card"><h3>What is Obesity?</h3><p>Obesity is a medical condition with excessive body fat, classified by BMI. <strong>Class I</strong> (BMI 30-34.9) is mild, <strong>Class II</strong> (BMI 35-39.9) is moderate, and <strong>Class III</strong> (BMI â‰¥40) is severe. It increases the risk of heart disease, diabetes, and high blood pressure.</p></div>
        <div class="note-card"><h3>BMI Categories for Children and Teens (Age 2-20)</h3><table class="custom-table"><thead><tr><th>Category</th><th>Percentile Range</th></tr></thead><tbody><tr><td>Underweight</td><td>&lt; 5%</td></tr><tr><td>Healthy weight</td><td>5% - 85%</td></tr><tr><td>At risk of overweight</td><td>85% - 95%</td></tr><tr><td>Overweight</td><td>&gt; 95%</td></tr></tbody></table></div>
        <div class="note-card"><h3>Risks Associated with Being Overweight</h3><p>Elevated BMI is linked to numerous health problems, including Type II diabetes, coronary heart disease, stroke, sleep apnea, and an increased risk of certain cancers.</p></div>
        <div class="note-card"><h3>Risks Associated with Being Underweight</h3><p>Being underweight can be associated with malnutrition, vitamin deficiencies, anemia, osteoporosis, a decreased immune function, and potential complications from surgery.</p></div>
        <div class="note-card"><h3>BMI Prime</h3><p>BMI prime is the ratio of a person's measured BMI to the upper limit of what is considered "normal" (25 kg/mÂ²). A value between 0.74 and 1 is classified as normal. It allows for a quick assessment of how much a person's BMI differs from this upper limit.</p></div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() { /* ... */ const printDateEl = document.getElementById('printDate'); if (printDateEl) { const now = new Date(); const options = { year: 'numeric', month: 'long', day: 'numeric' }; printDateEl.textContent = now.toLocaleDateString('en-US', options); } });

    function calculateBMI() {
        const errorBox = document.getElementById('resultError'), errorMessage = document.getElementById('errorMessage'), placeholder = document.getElementById('placeholder'), resultValueDiv = document.getElementById('resultValue');
        const age = parseFloat(document.getElementById('age').value), weight = parseFloat(document.getElementById('weight').value), heightCm = parseFloat(document.getElementById('height').value);
        
        let errors = [];
        if (isNaN(age) || age < 2) errors.push("ðŸ‘‰ Please enter a valid age (2 or older).");
        if (isNaN(weight) || weight <= 0) errors.push("ðŸ‘‰ Please enter a valid weight.");
        if (isNaN(heightCm) || heightCm <= 0) errors.push("ðŸ‘‰ Please enter a valid height.");

        if (errors.length > 0) {
            errorMessage.innerHTML = errors.join("<br>");
            errorBox.classList.remove("hidden");
            placeholder.classList.remove("hidden");
            resultValueDiv.classList.add("hidden");
            return;
        } else {
            errorBox.classList.add("hidden");
        }

        const heightM = heightCm / 100;
        const bmi = weight / (heightM * heightM);
        const bmiPrime = bmi / 25;
        
        // **** CORRECTED: Using the detailed category logic you provided ****
        let category = '', meter = {};
        if (bmi < 16) { category = 'Severe Thinness'; meter = { width: '10%', color: '#3498db' }; } 
        else if (bmi < 17) { category = 'Moderate Thinness'; meter = { width: '15%', color: '#3498db' }; } 
        else if (bmi < 18.5) { category = 'Mild Thinness'; meter = { width: '20%', color: '#3498db' }; } 
        else if (bmi < 25) { category = 'Normal'; meter = { width: '40%', color: '#2ecc71' }; } 
        else if (bmi < 30) { category = 'Overweight'; meter = { width: '65%', color: '#f39c12' }; } 
        else if (bmi < 35) { category = 'Obese Class I'; meter = { width: '80%', color: '#e74c3c' }; } 
        else if (bmi < 40) { category = 'Obese Class II'; meter = { width: '90%', color: '#e74c3c' }; } 
        else { category = 'Obese Class III'; meter = { width: '100%', color: '#c0392b' }; }
        
        // **** CORRECTED: Using the original result format ****
        const resultHTML = `
            <p>Your BMI: ${bmi.toFixed(2)}kg/mÂ²</p>
            <p>Category: ${category}</p>
            <p>BMI Prime: ${bmiPrime.toFixed(2)}</p>
        `;
        document.getElementById('resultContent').innerHTML = resultHTML;
        
        const meterFill = document.getElementById('meterFill');
        meterFill.style.width = meter.width;
        meterFill.style.backgroundColor = meter.color;

        placeholder.classList.add('hidden');
        resultValueDiv.classList.remove('hidden');
    }

    function printReport() { /* ... */ const printDateEl = document.getElementById('printDate'); if (printDateEl) { const now = new Date(); const options = { year: 'numeric', month: 'long', day: 'numeric' }; printDateEl.textContent = now.toLocaleDateString('en-US', options); } window.print(); }
</script>

</body>
</html>
{% endblock %}