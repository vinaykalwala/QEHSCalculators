{% extends 'base.html' %}
{% block title %}BMI Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BMI Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
      

        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding:0 20px;
            border-radius: 12px;
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
      .btn-wrapper {
    text-align: center; /* centers inline-block buttons */
    margin-top: 20px;
  }

   .btn-wrapper {
    text-align: center; /* centers the button */
    margin-top: 20px;
  }

  .print-btn {
    display: inline-block;
    background:linear-gradient(#1560bd,#000040);
    color: white;
    padding: 8px 18px;   /* control button size */
    border: none;
    border-radius: 6px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    width: auto !important; /* prevent full width */
  }

  .print-btn:hover {
    background: #1560bd;
  }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Meter */
        .safety-meter {
            width: 100%; 
            height: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            border-radius: 6px;
        }
        
        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        /* Table styles */
        .custom-table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .custom-table thead {
            background-color: #1560bd;
            color: white;
        }
        .custom-table th, .custom-table td {
            padding: 12px 16px;
            border: 1px solid #ddd;
            text-align: center;
        }
        .custom-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .btn-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }
        .back-btn {
            background: linear-gradient(#1560bd,#000040);
            color: #ffffff;
            border: 2px solid #1560bd;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .back-btn:hover {
            background-color: #1560bd;
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'healthcategory_calculators'%}" class="back-btn">Back To Health Calculators</a>
    </div>
<div class="calculator-container printable" id="printArea">

    {% include "includes/print_header_footer.html" with report_title="Body Mass Index (BMI) Report" %}

    <div class="calculator-header">
        <h1>BMI Calculator</h1>
        <p>Assess your body weight status and associated health risks using the Body Mass Index.</p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Your Details</h2>
            <div class="form-group"><label for="age">Age (years)</label><input type="number" id="age" class="form-input" placeholder="e.g., 30" min="2"></div>
            <div class="form-group"><label for="gender">Gender</label><select id="gender" class="form-input"><option value="male">Male</option><option value="female">Female</option></select></div>
            <div class="form-group"><label for="weight">Weight (kg)</label><input type="number" id="weight" class="form-input" placeholder="e.g., 70" min="1"></div>
            <div class="form-group"><label for="height">Height (cm)</label><input type="number" id="height" class="form-input" placeholder="e.g., 175" min="1"></div>
            <button class="calculate-btn" onclick="calculateBMI()">Calculate BMI</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <!-- Placeholder when no result yet -->
            <div class="result-placeholder" id="placeholder">
                <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Health status icon">
                <p>Your BMI result and weight category will be displayed here.</p>
            </div>

            <!-- Error display -->
            <div class="result-error hidden" id="resultError">
                <div class="error-message" id="errorMessage"></div>
            </div>

            <!-- Actual result display -->
            <div class="result-value hidden" id="resultValue">
                <div class="rate-value" id="bmiValue"></div>
                <div class="rate-label" id="bmiCategory"></div>
                <div class="rate-label">BMI Prime: <span id="bmiPrime"></span></div>

                <!-- Meter -->
                <div class="safety-meter">
                    <div class="meter-fill" id="meterFill"></div>
                </div>
                <div class="meter-labels">
                    <span>Severe Thinness</span>
                    <span>Normal</span>
                    <span>Overweight</span>
                    <span>Obese Class III</span>
                </div>

                <!-- Feedback -->
                <div class="result-feedback">
                    <div class="feedback-content" id="resultContent"></div>
                </div>

                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>

    </div>

    <!-- Notes Section -->
    <div class="note-section">
        <!-- What is BMI -->
        <div class="note-card">
            <h3>What is BMI?</h3>
            <p>Body Mass Index (BMI) is a measure of body fat based on a person's weight in relation to their height. It serves as a general indicator of whether a person is at a healthy weight and helps healthcare providers evaluate risks associated with obesity or being underweight.</p>
        </div>

        <!-- Why is BMI used -->
        <div class="note-card">
            <h3>About this Calculator</h3>
            <p>The BMI calculator is a simple and widely used tool to assess whether a person is underweight, normal weight, overweight, or obese. It helps identify potential health risks and determine if further evaluation is necessary. However, BMI does not distinguish between muscle mass and fat, so it is not a perfect measure of health. It‚Äôs important to consider other factors like body composition, lifestyle, and family history.</p>
        </div>

        <!-- BMI Categories for Adults -->
        <div class="note-card">
            <h3>BMI Categories for Adults</h3>
            <table class="custom-table">
                <thead>
                    <tr>
                        <th>Classification</th>
                        <th>BMI</th>
                        <th>BMI Prime</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Severe Thinness</td><td>&lt; 16</td><td>&lt; 0.64</td></tr>
                    <tr><td>Moderate Thinness</td><td>16 - 17</td><td>0.64 - 0.68</td></tr>
                    <tr><td>Mild Thinness</td><td>17 - 18.5</td><td>0.68 - 0.74</td></tr>
                    <tr><td>Normal</td><td>18.5 - 25</td><td>0.74 - 1</td></tr>
                    <tr><td>Overweight</td><td>25 - 30</td><td>1 - 1.2</td></tr>
                    <tr><td>Obese Class I</td><td>30 - 35</td><td>1.2 - 1.4</td></tr>
                    <tr><td>Obese Class II</td><td>35 - 40</td><td>1.4 - 1.6</td></tr>
                    <tr><td>Obese Class III</td><td>&gt; 40</td><td>&gt; 1.6</td></tr>
                </tbody>
            </table>
        </div>

        <!-- What is Obesity -->
        <div class="note-card">
            <h3>What is Obesity?</h3>
            <p>Obesity is a medical condition where a person has an excessive amount of body fat. It is classified into different categories based on BMI:
                <ul>
                    <li><strong>Obese Class I</strong> (BMI 30-34.9) - Mild obesity, where lifestyle changes and weight management may help.</li>
                    <li><strong>Obese Class II</strong> (BMI 35-39.9) - Moderate obesity, which may require medical intervention.</li>
                    <li><strong>Obese Class III</strong> (BMI ‚â•40) - Severe obesity, often referred to as morbid obesity, which poses significant health risks and may require surgical intervention.</li>
                </ul>
                Obesity increases the risk of numerous health problems, such as heart disease, diabetes, and high blood pressure. Early identification and intervention are crucial to managing these risks.
            </p>
        </div>

        <!-- BMI Categories for Children and Teens -->
        <div class="note-card">
            <h3>BMI Categories for Children and Teens (Age 2-20)</h3>
            <table class="custom-table">
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Percentile Range</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Underweight</td><td>&lt; 5%</td></tr>
                    <tr><td>Healthy weight</td><td>5% - 85%</td></tr>
                    <tr><td>At risk of overweight</td><td>85% - 95%</td></tr>
                    <tr><td>Overweight</td><td>&gt; 95%</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Risks associated with BMI -->
        <div class="note-card">
            <h3>Risks Associated with Being Overweight</h3>
            <ul>
                <li>High blood pressure</li>
                <li>Higher levels of LDL cholesterol and lower levels of HDL cholesterol</li>
                <li>Type II diabetes</li>
                <li>Coronary heart disease</li>
                <li>Stroke</li>
                <li>Gallbladder disease</li>
                <li>Osteoarthritis</li>
                <li>Sleep apnea and breathing problems</li>
                <li>Certain cancers (endometrial, breast, colon, kidney, gallbladder, liver)</li>
                <li>Low quality of life</li>
                <li>Mental illnesses such as clinical depression, anxiety, and others</li>
                <li>Body pains and difficulty with certain physical functions</li>
                <li>Increased risk of mortality</li>
            </ul>
        </div>

        <div class="note-card">
            <h3>Risks Associated with Being Underweight</h3>
            <ul>
                <li>Malnutrition, vitamin deficiencies, anemia</li>
                <li>Osteoporosis</li>
                <li>Decreased immune function</li>
                <li>Growth and development issues</li>
                <li>Possible reproductive issues for women</li>
                <li>Potential complications from surgery</li>
                <li>Increased risk of mortality</li>
                <li>Possible underlying conditions such as anorexia nervosa</li>
            </ul>
        </div>

        <!-- BMI Prime -->
        <div class="note-card">
            <h3>BMI Prime</h3>
            <p>BMI prime is the ratio of a person's measured BMI to the upper limit of BMI that is considered "normal" (25 kg/m¬≤). 
            Since BMI prime is a ratio of two BMI values, it is dimensionless:
                <ul>
                    <li>Less than 0.74 ‚Üí Underweight</li>
                    <li>0.74 - 1 ‚Üí Normal</li>
                    <li>Greater than 1 ‚Üí Overweight</li>
                    <li>Greater than 1.2 ‚Üí Obese</li>
                </ul>
            This allows for a quick assessment of how much a person's BMI differs from the upper normal limit and helps compare populations with different BMI standards.
            </p>
            <table class="custom-table">
                <thead>
                    <tr>
                        <th>Classification</th>
                        <th>BMI</th>
                        <th>BMI Prime</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Severe Thinness</td><td>&lt; 16</td><td>&lt; 0.64</td></tr>
                    <tr><td>Moderate Thinness</td><td>16 - 17</td><td>0.64 - 0.68</td></tr>
                    <tr><td>Mild Thinness</td><td>17 - 18.5</td><td>0.68 - 0.74</td></tr>
                    <tr><td>Normal</td><td>18.5 - 25</td><td>0.74 - 1</td></tr>
                    <tr><td>Overweight</td><td>25 - 30</td><td>1 - 1.2</td></tr>
                    <tr><td>Obese Class I</td><td>30 - 35</td><td>1.2 - 1.4</td></tr>
                    <tr><td>Obese Class II</td><td>35 - 40</td><td>1.4 - 1.6</td></tr>
                    <tr><td>Obese Class III</td><td>&gt; 40</td><td>&gt; 1.6</td></tr>
                </tbody>
            </table>
        </div>
        <div class="note-card">
            <div class="note-container">
                <h3>‚úÖ Input Validation Rules</h3>
                <p>To get accurate BMI results, please follow these guidelines when entering your details:</p>
                <ul>
                    <li><strong>Age:</strong> Enter your age in years. Acceptable range is <strong>2 to 120</strong>. Only whole numbers are allowed.</li>
                    <li><strong>Gender:</strong> Select your gender (Male or Female). This helps provide more accurate percentile assessments.</li>
                    <li><strong>Weight:</strong> Enter your weight in kilograms. Acceptable range is <strong>2 kg to 300 kg</strong>. Only positive numbers are allowed.</li>
                    <li><strong>Height:</strong> Enter your height in centimeters. Acceptable range is <strong>50 cm to 250 cm</strong>. Only positive numbers are allowed.</li>
                </ul>
                <p><strong>Important Notes:</strong></p>
                <ul>
                    <li>Do not leave any field blank, as all inputs are required for calculation.</li>
                    <li>Extreme or unrealistic values may result in errors. For example, a height of 0 cm or weight of 0 kg is invalid.</li>
                    <li>The calculator uses standard BMI formulas and WHO classifications to provide meaningful health feedback.</li>
                </ul>
            </div>
        </div>
<div class="note-card">
    <h3>‚úÖ Output Validations</h3>
    <p>This section ensures the BMI calculator provides reliable and clinically meaningful results:</p>
    <ul>
        <li><strong>BMI Range:</strong> Valid BMI is between <strong>10 ‚Äì 70 kg/m¬≤</strong>. Values outside this range indicate unrealistic input combinations and trigger an error.</li>
        <li><strong>BMI Prime:</strong> Calculated as BMI √∑ 25. Valid range is <strong>0.4 ‚Äì 2.8</strong>. Out-of-range values indicate extreme BMI.</li>
        <li><strong>Category Mapping:</strong> The calculated BMI must correspond to one of the WHO-defined categories:
            <ul>
                <li>&lt;16 ‚Üí Severe Thinness</li>
                <li>16 ‚Äì 16.99 ‚Üí Moderate Thinness</li>
                <li>17 ‚Äì 18.49 ‚Üí Mild Thinness</li>
                <li>18.5 ‚Äì 24.99 ‚Üí Normal</li>
                <li>25 ‚Äì 29.99 ‚Üí Overweight</li>
                <li>30 ‚Äì 34.99 ‚Üí Obese Class I</li>
                <li>35 ‚Äì 39.99 ‚Üí Obese Class II</li>
                <li>‚â•40 ‚Üí Obese Class III</li>
            </ul>
        </li>
        <li><strong>Errors/Warnings:</strong>
            <ul>
                <li>Height = 0 triggers division by zero error.</li>
                <li>Negative or zero weight triggers error.</li>
                <li>Age must be integer between 2‚Äì120. Non-integer or out-of-range triggers error.</li>
                <li>Calculated BMI outside 10‚Äì70 triggers warning to check inputs.</li>
            </ul>
        </li>
        <li><strong>Compliance Rationale:</strong> Ensures results follow WHO/CDC standards and provides meaningful health guidance for adults and children.</li>
    </ul>
</div>

        <div class="note-card">
    <h3>üìò Governing Principle</h3>
    <p>
        The Body Mass Index (BMI) calculator is based on a simple mathematical formula that relates a person's weight to their height. 
        It uses either the SI (metric) standard or the US customary (imperial) standard:
    </p>
    <ul>
        <li><strong>SI Standard (Metric):</strong> BMI = weight (kg) √∑ [height (m)]¬≤. Weight is in kilograms, height in meters.</li>
        <li><strong>US Customary (Imperial):</strong> BMI = weight (lb) √∑ [height (in)]¬≤ √ó 703. Weight is in pounds, height in inches; 703 is a conversion factor.</li>
    </ul>
    <p>
        BMI provides a standardized measure of body fatness, which is widely used for assessing underweight, normal weight, overweight, and obesity. 
        While BMI does not distinguish between fat and muscle mass, it offers a quick, objective, and universally accepted method for health risk assessment.
    </p>
</div>
<div class="note-card">
    <h3>üìò Conclusion</h3>
    <p>
        The BMI calculator is a simple yet effective screening tool to assess an individual‚Äôs body fat status and potential health risks. 
        Regular monitoring of BMI and BMI prime can help detect underweight or overweight conditions early, enabling timely lifestyle or medical interventions. 
        For accurate interpretation, always consider BMI alongside other health indicators, age, gender, and clinical assessments. 
        Consult healthcare professionals to discuss results and plan appropriate measures.
    </p>
</div>


    </div>

</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const printDateEl = document.getElementById('printDate');
    if (printDateEl) {
        const now = new Date();
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        printDateEl.textContent = now.toLocaleDateString('en-US', options);
    }
});

function calculateBMI() {
    const errorBox = document.getElementById('resultError'),
        errorMessage = document.getElementById('errorMessage'),
        placeholder = document.getElementById('placeholder'),
        resultValueDiv = document.getElementById('resultValue');

    const ageInput = document.getElementById('age').value.trim(),
        weightInput = document.getElementById('weight').value.trim(),
        heightInput = document.getElementById('height').value.trim(),
        gender = document.getElementById('gender').value;

    let errors = [];

    const age = parseInt(ageInput),
        weight = parseFloat(weightInput),
        heightCm = parseFloat(heightInput);

    // ---- INPUT VALIDATION ----
    if (isNaN(age) || age < 2 || age > 120) errors.push("üëâ Age must be between 2 and 120 years.");
    if (!Number.isInteger(age)) errors.push("üëâ Age must be a whole number.");
    if (!gender) errors.push("üëâ Please select a gender.");
    if (isNaN(weight) || weight <= 0 || weight < 2 || weight > 300) errors.push("üëâ Weight must be between 2 kg and 300 kg.");
    if (isNaN(heightCm) || heightCm <= 0 || heightCm < 50 || heightCm > 250) errors.push("üëâ Height must be between 50 cm and 250 cm.");

    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");       // Show error
        placeholder.classList.add("hidden");       // Hide placeholder
        resultValueDiv.classList.add("hidden");    // Hide result
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    // ---- BMI CALCULATION ----
    const heightM = heightCm / 100;
    const bmi = weight / (heightM * heightM);
    const bmiPrime = bmi / 25;

    // Output validations
    if (bmi < 10 || bmi > 70) {
        errorMessage.innerHTML = "‚ùå Calculated BMI is unrealistic. Please check inputs.";
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValueDiv.classList.add("hidden");
        return;
    }
    if (bmiPrime < 0.4 || bmiPrime > 2.8) {
        errorMessage.innerHTML = "‚ùå Calculated BMI Prime is outside valid range (0.4 ‚Äì 2.8). Check inputs.";
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValueDiv.classList.add("hidden");
        return;
    }

    // ---- CATEGORY & FEEDBACK ----
    let category = '', meter = {}, feedback = '';

    if (bmi < 16) {
        category = 'Severe Thinness'; meter = { width: '10%', color: '#3498db' };
        feedback = "Severe underweight. Medical consultation recommended.";
    } else if (bmi >= 16 && bmi < 17) {
        category = 'Moderate Thinness'; meter = { width: '15%', color: '#2980b9' };
        feedback = "Moderate underweight. Review nutrition.";
    } else if (bmi >= 17 && bmi < 18.5) {
        category = 'Mild Thinness'; meter = { width: '20%', color: '#5dade2' };
        feedback = "Mild underweight. Maintain a balanced diet.";
    } else if (bmi >= 18.5 && bmi < 25) {
        category = 'Normal'; meter = { width: '40%', color: '#2ecc71' };
        feedback = "Normal weight. Keep an active and healthy lifestyle.";
    } else if (bmi >= 25 && bmi < 30) {
        category = 'Overweight'; meter = { width: '65%', color: '#f1c40f' };
        feedback = "Overweight. Monitor diet and exercise.";
    } else if (bmi >= 30 && bmi < 35) {
        category = 'Obese Class I'; meter = { width: '80%', color: '#e74c3c' };
        feedback = "Obese. Seek medical guidance for weight management.";
    } else if (bmi >= 35 && bmi < 40) {
        category = 'Obese Class II'; meter = { width: '90%', color: '#c0392b' };
        feedback = "Severe obesity. Professional consultation required.";
    } else {
        category = 'Obese Class III'; meter = { width: '100%', color: '#8e0c0c' };
        feedback = "Very severe obesity. Immediate medical attention recommended.";
    }

    // ---- DISPLAY RESULTS ----
    document.getElementById('resultContent').innerHTML = `
        <p><strong>BMI:</strong> ${bmi.toFixed(2)} kg/m¬≤</p>
        <p><strong>Category:</strong> ${category}</p>
        <p><strong>BMI Prime:</strong> ${bmiPrime.toFixed(2)}</p>
        <p>${feedback}</p>
    `;

    const meterFill = document.getElementById('meterFill');
    meterFill.style.width = meter.width;
    meterFill.style.backgroundColor = meter.color;

    placeholder.classList.add('hidden');
    resultValueDiv.classList.remove('hidden');
    errorBox.classList.add('hidden');
}

function printReport() {
    const printDateEl = document.getElementById('printDate');
    if (printDateEl) {
        const now = new Date();
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        printDateEl.textContent = now.toLocaleDateString('en-US', options);
    }
    window.print();
}
</script>



</body>
</html>
{% endblock %}

<!-- 
1. Analysis of Calculator Inputs, Outputs, and Formula
Inputs
Field	Description	Observations
Age	Age in years	Must be ‚â•2 (children excluded here for adult BMI, can extend to 120 for adults). Integer only.
Gender	Male/Female	Required for percentile or demographic analysis (optional for standard BMI).
Weight	Body weight in kg	Must be >0, reasonable upper limit (‚â§300 kg).
Height	Body height in cm	Must be >0, reasonable range (50‚Äì250 cm). Converted to meters for BMI calculation.
Outputs
Field	Description	Observations
BMI	Weight (kg) √∑ Height¬≤ (m¬≤)	Must be meaningful (10‚Äì70 kg/m¬≤).
Category	Based on WHO BMI classification	Severe Thinness ‚Üí Obese Class III.
BMI Prime	BMI √∑ 25	Provides normalized measure. Useful in occupational health reporting.
Formula
BMI = weight_kg / (height_m)^2
BMI Prime = BMI / 25


Standard WHO/CDC formula.

Must ensure height ‚â† 0 to prevent division by zero.

2. Recommended Input Validation Rules (QEHS / Safety Perspective)
Field	Acceptable Range	Units	Decimals	Notes / Cross-Field Checks
Age	2 ‚Äì 120	years	integer only	Prevents biologically impossible ages; integer ensures consistency in reporting.
Gender	male / female	n/a	n/a	Must be selected; optional for BMI calculation.
Weight	2 ‚Äì 300	kg	0‚Äì1 dp	Avoids extreme outliers that can skew results; ensures realistic occupational health data.
Height	50 ‚Äì 250	cm	0‚Äì1 dp	Prevents division by zero and unrealistic BMI.
Logical combination	BMI should realistically fall between 10‚Äì70	kg/m¬≤	1 dp	Detects unrealistic input combinations.
3. Edge Case Validations

Division by zero: Height must not be 0.

Negative values: Age, weight, height must be positive.

Extreme BMI: Reject BMI <10 or >70 as unrealistic.

Missing inputs: All fields required.

Non-integer age: Age must be integer.

Height/Weight mismatch: Very low height with very high weight could produce unrealistic BMI.

4. Output Validation Logic
WHO BMI Classification
BMI (kg/m¬≤)	Category
<16	Severe Thinness
16 ‚Äì 16.99	Moderate Thinness
17 ‚Äì 18.49	Mild Thinness
18.5 ‚Äì 24.99	Normal
25 ‚Äì 29.99	Overweight
30 ‚Äì 34.99	Obese Class I
35 ‚Äì 39.99	Obese Class II
‚â•40	Obese Class III

Compliance Rationale: Matches WHO standards; critical for occupational health reports and audits.
-->
