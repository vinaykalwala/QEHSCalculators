{% extends 'base.html' %}
{% block title %}Acidity Calculator based on Hydrogen Ion Concentration{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acidity Calculator based on Hydrogen Ion Concentration</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Radio buttons */
        .radio-group {
            margin-bottom: 20px;
        }
        
        .main-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: #fff;
        }
        
        .radio-option {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .radio-option input[type="radio"] {
            margin-right: 10px;
        }
        
        .radio-option label {
            color: #fff;
            font-weight: normal;
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 16px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        .btn-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040);
            color: #ffffff;
            border: 2px solid #1560bd;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd;
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'qualitycategory_calculators' %}" class="back-btn">Back To Quality Calculators</a>
    </div>

    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Acidity Calculator Based On Hydrogen Ion Concentration</h1>
            <p>Calculates pH from hydrogen ion concentration or vice versa, with environmental impact assessment</p>
        </div>

        <div class="calc-content">
            <!-- Calculator Input Card -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                
                <div class="radio-group">
                    <label class="main-label">Calculation Options:</label>
                  
                    <div class="radio-option">
                      <input type="radio" id="calcPH" name="calcOption" value="ph" checked>
                      <label for="calcPH">Calculate pH from [H⁺]</label>
                    </div>
                  
                    <div class="radio-option">
                      <input type="radio" id="calcHConc" name="calcOption" value="hconc">
                      <label for="calcHConc">Calculate [H⁺] from pH</label>
                    </div>
                </div>

                <div class="form-group" id="hydrogenGroup">
                    <label for="hydrogenConcentration">Hydrogen Ion Concentration [H⁺] (mol/L)</label>
                    <input type="number" id="hydrogenConcentration" class="form-input" placeholder="Enter value between 0 to 1" step="1e-14" min="1e-14" max="1">
                </div>

                <div class="form-group hidden" id="phGroup">
                    <label for="phValue">pH Value</label>
                    <input type="number" id="phValue" class="form-input" placeholder="Enter pH value" min="0" max="14" step="0.01">
                </div>

                <button class="calculate-btn" onclick="calculatePH()">Calculate</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="pH illustration">
                    <p>This tool calculates <strong>pH from hydrogen ion concentration</strong> or vice versa. Select calculation type and enter values to see results.</p>
                </div>

                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">❌</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>

                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Calculation Results</h2>
                    </div>
                    <div class="rate-value" id="resultOutput">0.00</div>
                    <div class="rate-label" id="resultLabel"></div>
                    
                    <div class="result-feedback">
                        <div class="feedback-title">Environmental Impact Assessment</div>
                        <div class="feedback-content" id="phFeedback"></div>
                    </div>
                    
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">
            
<div class="note-card">
    <h3>🔎 About This Calculator</h3>
    <p>
        The <strong>Acidity Calculator</strong> determines the acidity or alkalinity of a solution. pH affects chemical reactions, biological processes, and material stability in water, soil, and industrial systems. Monitoring pH is important for drinking water safety, wastewater management, protecting aquatic life, maintaining soil quality, and ensuring industrial compliance.
    </p>
</div>
             
        <div class="note-card">
            <h3>⚙️ Parameters Used</h3>
    <ul class="note-list">
        <li><strong>[H⁺] – Hydrogen Ion Concentration:</strong> The amount of hydrogen ions (protons) present in a solution, measured in moles per liter (mol/L). Determines the acidity of the solution.</li>
        <li><strong>pH – Potential of Hydrogen:</strong> A measure of how acidic or basic a solution is, with 7 being neutral.</li>
        <li><strong>pOH – Potential of Hydroxide:</strong> A measure of the hydroxide ion concentration in a solution. Provides a complementary indication of alkalinity.</li>
        <li><strong>[OH⁻] – Hydroxide Ion Concentration:</strong> The concentration of hydroxide ions in a solution, measured in moles per liter (mol/L). Indicates the basicity of the solution.</li>
    </ul>
</div>


    <div class="note-card">
        <h3>📌 Input Validation Rules</h3>
        <ul class="note-list">
            <li><strong>Hydrogen Ion Concentration [H⁺]:</strong> Required when calculating pH. Must be a positive number. Practical range: 1e-16 to 1 mol/L. Extreme values outside this range trigger warnings. Precision: Up to 14 significant digits. Reject if resulting pH is unrealistic.</li>
            <li><strong>pH Value:</strong> Required when calculating [H⁺]. Normal range: 0–14. Extended range allowed: −2 to 16 (warnings for values outside 0–14). Precision: Up to 4 decimals. Reject if resulting [H⁺] is unrealistic.</li>
            <li><strong>Common Formatting Rules:</strong> Trim spaces, replace commas with dots, allow scientific notation, reject non-numeric strings, ensure numeric input is finite.</li>
            <li><strong>Output Display Rules:</strong> pH and [H⁺] values should be shown with appropriate precision. Also display complementary measures and classification. Color-coded warnings for extreme values.</li>
            <li><strong>Edge Cases:</strong> [H⁺] ≤ 0 → reject. Very small [H⁺] → warn. Very large [H⁺] → warn. pH outside −2 to 16 → reject. NaN or Infinity → reject. Excessive digits → warn.</li>
        </ul>
    </div>


            
        <div class="note-card">
    <h3>📋 Output Validations</h3>
    <ul class="note-list">
        <li><strong>Highly acidic (pH &lt; 3):</strong> ⚠️ Highly acidic: May be corrosive and unsafe for handling without protection. Environmental hazard - can damage ecosystems and infrastructure.</li>
        <li><strong>Acidic (pH 3–6.5):</strong> ⚠️ Acidic: Might be harmful to living organisms or cause metal corrosion. Requires treatment before environmental release.</li>
        <li><strong>Near neutral (pH 6.5–7.5):</strong> ✅ Near neutral: Suitable for most biological and environmental conditions. Ideal for drinking water and aquatic life.</li>
        <li><strong>Mildly alkaline (pH 7.5–9):</strong> ⚠️ Mildly alkaline: Generally safe, but can affect chemical reactions or aquatic life. Monitor for changes.</li>
        <li><strong>Alkaline (pH 9–11):</strong> ⚠️ Alkaline: Can be irritating to skin and eyes, handle with care. May require neutralization before disposal.</li>
        <li><strong>Highly alkaline (pH &gt; 11):</strong> ⚠️ Highly alkaline: May be caustic or damaging to tissues and materials. Significant environmental impact - requires treatment.</li>
    </ul>
</div>
    
         <div class="note-card">
    <h3>📐 Governance Principles</h3>
    <p>Governance principles guide decision-making, accountability, and ethical management in organizations and systems. They ensure transparency, responsibility, fairness, and sustainability in all processes.</p>
    <strong>👨‍🔬 About Søren Peter Lauritz Sørensen</strong>
    <p>Søren Peter Lauritz Sørensen (9 January 1868 – 12 February 1939) was a Danish chemist, best known for introducing the concept of pH, a scale for measuring the acidity or alkalinity of a solution.</p>
</div>
  
            
            <div class="note-card">
                <h3>💡 Conclusion</h3>
                <p>pH measurement is one of the most important parameters in environmental science and water quality management. Understanding pH relationships helps protect ecosystems, ensure safe drinking water, and maintain industrial processes. Regular pH monitoring is essential for detecting pollution events and maintaining regulatory compliance across multiple sectors.</p>
            </div>
        </div>
    </div>

    <script>
    // Helper: robust numeric parsing (accepts scientific notation, trims, handles comma decimals)
    function parseNumericInput(raw) {
        if (typeof raw !== 'string') raw = String(raw || '');
        raw = raw.trim();
        // Replace comma decimal separators (common in some locales) with dot, but don't allow thousands separators
        raw = raw.replace(',', '.');
        // Reject if empty
        if (raw === '') return { ok: false, reason: 'empty' };
        // Quick validation: only allow digits, dot, sign, e/E for exponent
        if (!/^[-+]?(\d+(\.\d*)?|\.\d+)([eE][-+]?\d+)?$/.test(raw)) {
            return { ok: false, reason: 'format' };
        }
        const val = Number(raw);
        if (!isFinite(val)) return { ok: false, reason: 'non-finite' };
        return { ok: true, value: val };
    }

    // Main calculation function with robust validation
    function calculatePH() {
        const calcOption = document.querySelector('input[name="calcOption"]:checked').value;

        const errorBox = document.getElementById('resultError');
        const errorMessage = document.getElementById('errorMessage');
        const placeholder = document.getElementById('placeholder');
        const resultValue = document.getElementById('resultValue');
        const resultOutput = document.getElementById('resultOutput');
        const resultLabel = document.getElementById('resultLabel');
        const feedbackBox = document.getElementById('phFeedback');

        let errors = [];
        let warnings = [];

        // Reset display
        errorBox.classList.add("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        errorMessage.innerHTML = '';

        // Constants and practical thresholds
        const KW_25C = 1e-14;            // Kw at 25 °C
        const HCONC_MIN_PRACTICAL = 1e-16; // pH = 16 --> outside typical 0-14 scale
        const HCONC_MAX_PRACTICAL = 1;   // pH = 0
        const PH_MIN = -2;               // reject pH < -2 as unrealistic
        const PH_MAX = 16;               // reject pH > 16 as unrealistic
        const STANDARD_PH_MIN = 0;
        const STANDARD_PH_MAX = 14;

        if (calcOption === 'ph') {
            // Calculate pH from [H+]
            const raw = document.getElementById("hydrogenConcentration").value || '';
            const parsed = parseNumericInput(String(raw));

            // Validation
            if (!parsed.ok) {
                if (parsed.reason === 'empty') errors.push("👉 Please enter the hydrogen ion concentration ([H⁺], mol/L).");
                else if (parsed.reason === 'format') errors.push("👉 Hydrogen ion concentration format is invalid. Use numeric or scientific notation, e.g., 1e-7.");
                else errors.push("👉 Hydrogen ion concentration must be a finite number.");
            } else {
                const hConc = parsed.value;
                // Essential numeric checks
                if (!(hConc > 0)) {
                    errors.push("👉 Hydrogen ion concentration must be greater than 0 (non-zero, positive).");
                } else {
                    // Practical range checks
                    if (hConc < HCONC_MIN_PRACTICAL) {
                        warnings.push("⚠️ Entered [H⁺] is extremely small (pH > 16). This is outside the typical analytical 0–14 scale and may indicate temperature effects or measurement error. Results are approximate.");
                    }
                    if (hConc > HCONC_MAX_PRACTICAL) {
                        warnings.push("⚠️ Entered [H⁺] > 1 mol/L (pH < 0). This indicates a very strong acid — verify measurement and ensure appropriate safety measures.");
                    }
                    // significant digits warning (instrument precision)
                    const rawDigits = raw.replace(/[^0-9]/g, '');
                    if (rawDigits.length > 14) {
                        warnings.push("⚠️ Input precision is very high (more than 14 significant digits). Validate instrument accuracy.");
                    }
                    // compute values (safe now)
                    const pH = -Math.log10(hConc);
                    if (!isFinite(pH)) {
                        errors.push("👉 Computed pH is not finite. Check the [H⁺] input.");
                    } else if (pH < PH_MIN || pH > PH_MAX) {
                        errors.push(`👉 Computed pH (${pH.toFixed(4)}) is beyond realistic bounds (${PH_MIN} to ${PH_MAX}). Verify input and temperature.`);
                    } else {
                        const pOH = 14 - pH;
                        // [OH-] from Kw; protect division
                        let ohConc = null;
                        if (hConc === 0) {
                            ohConc = NaN;
                        } else {
                            ohConc = KW_25C / hConc;
                        }
                        const classification = getPHClassification(pH);

                        // Build output HTML with clear units and precision
                        resultOutput.innerHTML = `
                            <strong>pH:</strong> ${pH.toFixed(4)}<br>
                            <strong>Classification:</strong> ${classification}<br>
                            <strong>pOH:</strong> ${pOH.toFixed(4)} | <strong>[OH⁻]:</strong> ${Number(ohConc).toExponential(4)} mol/L
                        `;
                        resultLabel.innerHTML = `<strong>pH Value (assumes 25 °C)</strong>`;
                        feedbackBox.innerHTML = getPHFeedback(pH, classification) + (warnings.length ? ("<br><em>Warnings:</em><br>" + warnings.join("<br>")) : "");
                        feedbackBox.style.color = getFeedbackColor(pH);

                        // show results
                        resultValue.classList.remove("hidden");
                        return; // successful path
                    }
                }
            }
        } else {
            // Calculate [H+] from pH
            const raw = document.getElementById("phValue").value || '';
            const parsed = parseNumericInput(String(raw));

            if (!parsed.ok) {
                if (parsed.reason === 'empty') errors.push("👉 Please enter the pH value.");
                else if (parsed.reason === 'format') errors.push("👉 pH value format is invalid. Use a numeric value (e.g., 7.00).");
                else errors.push("👉 pH must be a finite number.");
            } else {
                const pHVal = parsed.value;
                // Basic range checks
                if (pHVal < PH_MIN || pHVal > PH_MAX) {
                    errors.push(`👉 pH appears unrealistic (allowed range ${PH_MIN} to ${PH_MAX}). If this is correct, please verify that the sample temperature and measurement method are appropriate.`);
                } else {
                    // Warn if outside typical 0-14
                    if (pHVal < STANDARD_PH_MIN || pHVal > STANDARD_PH_MAX) {
                        warnings.push("⚠️ pH is outside the standard 0–14 scale. Verify measurement and sample conditions.");
                    }
                    // Calculate [H+]
                    const hConc = Math.pow(10, -pHVal);
                    if (!isFinite(hConc) || hConc === 0) {
                        errors.push("👉 Computed [H⁺] not finite. Check pH input.");
                    } else {
                        const pOH = 14 - pHVal;
                        const ohConc = KW_25C / hConc;
                        const classification = getPHClassification(pHVal);

                        // If hConc extremely small or large, warn
                        if (hConc < HCONC_MIN_PRACTICAL) {
                            warnings.push("⚠️ Computed [H⁺] is extremely small (pH > 16). This is outside typical analytical range.");
                        }
                        if (hConc > HCONC_MAX_PRACTICAL) {
                            warnings.push("⚠️ Computed [H⁺] > 1 mol/L (pH < 0). This indicates a very strong acid; verify.");
                        }

                        resultOutput.innerHTML = `
                            <strong>[H⁺] Concentration:</strong> ${hConc.toExponential(4)} mol/L<br>
                            <strong>Classification:</strong> ${classification}<br>
                            <strong>pOH:</strong> ${pOH.toFixed(4)} | <strong>[OH⁻]:</strong> ${Number(ohConc).toExponential(4)} mol/L
                        `;
                        resultLabel.innerHTML = `<strong>Hydrogen Ion Concentration (assumes 25 °C)</strong>`;
                        feedbackBox.innerHTML = getPHFeedback(pHVal, classification) + (warnings.length ? ("<br><em>Warnings:</em><br>" + warnings.join("<br>")) : "");
                        feedbackBox.style.color = getFeedbackColor(pHVal);

                        // show results
                        resultValue.classList.remove("hidden");
                        return; // successful path
                    }
                }
            }
        }

        // If here, we had errors or warnings only
        if (errors.length > 0) {
            errorMessage.innerHTML = errors.join("<br>");
            errorBox.classList.remove("hidden");
            // keep placeholder hidden (we already hid it)
            return;
        } else if (warnings.length > 0) {
            // show warnings inside result area as non-blocking messages — but still display placeholder result region if none computed
            errorMessage.innerHTML = warnings.join("<br>");
            errorBox.classList.remove("hidden");
            return;
        } else {
            // fallback
            errorMessage.innerHTML = "👉 Unknown error. Verify inputs.";
            errorBox.classList.remove("hidden");
            return;
        }
    }

   // Keep your existing helper functions (unified wording)
function getPHClassification(pH) {
    if (pH < 3) return "⚠️ Highly acidic";
    if (pH < 6.5) return "⚠️ Acidic";
    if (pH <= 7.5) return "✅ Near neutral";
    if (pH < 9) return "⚠️ Mildly alkaline";
    if (pH <= 11) return "⚠️ Alkaline";
    return "⚠️ Highly alkaline";
}

function getFeedbackColor(pH) {
    if (pH < 3 || pH > 11) return 'red';
    if (pH < 6.5 || pH > 7.5) return 'orange';
    return 'green';
}

function getPHFeedback(pH, classification) {
    if (pH < 3) return '⚠️ Highly acidic: May be corrosive and unsafe for handling without protection. Environmental hazard - can damage ecosystems and infrastructure.';
    if (pH < 6.5) return '⚠️ Acidic: Might be harmful to living organisms or cause metal corrosion. Requires treatment before environmental release.';
    if (pH <= 7.5) return '✅ Near neutral: Suitable for most biological and environmental conditions. Ideal for drinking water and aquatic life.';
    if (pH < 9) return '⚠️ Mildly alkaline: Generally safe, but can affect chemical reactions or aquatic life. Monitor for changes.';
    if (pH <= 11) return '⚠️ Alkaline: Can be irritating to skin and eyes, handle with care. May require neutralization before disposal.';
    return '⚠️ Highly alkaline: May be caustic or damaging to tissues and materials. Significant environmental impact - requires treatment.';
}

    // Print function and toggle listeners unchanged
    function printReport() { window.print(); }

    function toggleInputFields() {
        const calcOption = document.querySelector('input[name="calcOption"]:checked').value;
        const hydrogenGroup = document.getElementById('hydrogenGroup');
        const phGroup = document.getElementById('phGroup');

        if (calcOption === 'ph') {
            hydrogenGroup.classList.remove('hidden');
            phGroup.classList.add('hidden');
        } else {
            hydrogenGroup.classList.add('hidden');
            phGroup.classList.remove('hidden');
        }
    }

    window.onload = function () {
        toggleInputFields();
        document.querySelectorAll('input[name="calcOption"]').forEach((radio) => {
            radio.addEventListener('change', toggleInputFields);
        });
    };
</script>

    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--

==========Hydrogen Ion Concentration [H⁺] (for pH calculation)===========

Required if option = "Calculate pH"

Type: Number (decimal or scientific notation, e.g., 1e-7)

Unit: mol/L (must be shown)

Range:

Strict: > 0

Practical: 1e-16 ≤ [H⁺] ≤ 1

<1e-16 → Warning (pH >16, unusual)

1 → Warning (very strong acid, safety risk)

Precision: Up to 14 digits, no silent rounding

Logic checks: Reject if pH < −2 or >16

============pH value (for [H⁺] calculation)=============

Required if option = "Calculate [H⁺]"

Type: Number (decimal allowed)

Range:

Normal: 0–14

Extended: Allow −2 to 16 (show warnings outside 0–14)

<−2 or >16 → Reject unless confirmed

Precision: Accept up to 4 decimals; warn if too many decimals (>4)

Logic checks: Ensure resulting [H⁺] is realistic (between 1e-16 and 1)

========= Input Formatting Rules (Both)===========

Trim spaces, replace commas with dots

Allow exponential notation (e.g., 1E-7)

Reject non-numeric strings

Validate with isFinite() before calculation

========Output Rules===========

pH: Show to 4 decimals (e.g., 7.0000)

[H⁺]: Show in scientific notation with 4 significant figures (e.g., 1.0000e-07 mol/L)

Also show: pOH and [OH⁻] (assume Kw = 1e-14 at 25 °C)

Classification (color-coded):

pH < 3 → Strong Acid (Red, Hazardous)

3–6.5 → Acidic (Orange, Harm)

6.5–8.5 → Neutral (Green, Safe)

8.5–11 → Alkaline (Orange/Red)

11 → Strong Base (Red, Hazardous)

Regulatory Warning: Flag if outside 6.5–8.5 (typical discharge limits)

Temperature note: Results valid at 25 °C

=======Edge Cases============

[H⁺] ≤ 0 → Reject (invalid)

Very small [H⁺] (<1e-16) → Allow but warn (pH >16)

Very large [H⁺] (>1) → Allow but warn (strong acid, PPE needed)

pH < −2 or >16 → Reject unless confirmed

NaN/Infinity → Reject

Too many digits (>14) → Warn (instrument error likely)

Underflow (< Number.MIN_VALUE) → Warn


-->