{% extends 'base.html' %}
{% block title %}Pressure Drop & Friction Loss Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pressure Drop & Friction Loss Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'qualitycategory_calculators' %}" class="back-btn">Back To Quality Calculators</a>
    </div>

    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Pressure Drop & Friction Loss Calculator</h1>
            <p>Calculates the pressure drop and friction loss in a pipeline based on upstream and downstream pressures</p>
        </div>

        <div class="calc-content">
            <!-- Calculator Input Card -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="pressure1">Upstream Pressure (P‚ÇÅ, Pa)</label>
                    <input type="number" id="pressure1" class="form-input" min="0" placeholder="Enter P‚ÇÅ value">
                </div>

                <div class="form-group">
                    <label for="pressure2">Downstream Pressure (P‚ÇÇ, Pa)</label>
                    <input type="number" id="pressure2" class="form-input" min="0" placeholder="Enter P‚ÇÇ value">
                </div>

                <button class="calculate-btn" onclick="calculateFrictionLoss()">Calculate Friction Loss</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                <img src="{% static 'images/resultimage.png' %}" alt="Orifice">
                    <p>This tool calculates the <strong>friction loss</strong> in Pa. Enter your pressure values to see results.</p>
                </div>

                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>

                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Friction Loss</h2>
                    </div>
                    <div class="rate-value" id="frictionLossValue">0.00</div>
                    <div class="rate-label"><strong>Pa</strong></div>
                    
                    <div class="result-feedback">
                        <div class="feedback-title">Friction Loss Interpretation</div>
                        <div class="feedback-content" id="frictionFeedback"></div>
                    </div>
                    
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">

    <!-- About Calculator -->
    <div class="note-card">
        <h3>üîé About This Calculator</h3>
        <p>
            The <strong>Pressure Drop & Friction Loss Calculator</strong> computes the energy loss in a pipeline segment 
            using upstream pressure (<strong>P‚ÇÅ</strong>) and downstream pressure (<strong>P‚ÇÇ</strong>). 
            It identifies friction losses, flags unusual conditions, and helps engineers monitor system efficiency.
        </p>
    </div>

    <!-- Parameters Used -->
    <div class="note-card">
        <h3>‚ùì Parameters Used</h3>
        <ul class="note-list">
            <li><strong>Upstream Pressure (P‚ÇÅ):</strong> Pressure at the inlet of the pipe segment (Pa).</li>
            <li><strong>Downstream Pressure (P‚ÇÇ):</strong> Pressure at the outlet of the pipe segment (Pa).</li>
            <li><strong>Friction Loss (ŒîP):</strong> The difference between P‚ÇÅ and P‚ÇÇ (Pa), representing energy loss.</li>
            <li><strong>Percentage Drop:</strong> Ratio of ŒîP to P‚ÇÅ, expressed as a percentage (%).</li>
        </ul>
    </div>

    <!-- Input Validation Rules -->
    <div class="note-card">
        <h3>üìå Input Validation Rules</h3>
        <ul class="note-list">
            <li>üëâ Please enter the upstream pressure (P‚ÇÅ) in Pa.</li>
            <li>üëâ Please enter the downstream pressure (P‚ÇÇ) in Pa.</li>
            <li>üëâ Upstream pressure (P‚ÇÅ) must be a finite number.</li>
            <li>üëâ Downstream pressure (P‚ÇÇ) must be a finite number.</li>
            <li>üëâ P‚ÇÅ must be between 0 and 100,000,000 Pa (0‚Äì100 MPa).</li>
            <li>üëâ P‚ÇÇ must be between 0 and 100,000,000 Pa (0‚Äì100 MPa).</li>
            <li>üëâ P‚ÇÅ: allow up to 2 decimal places.</li>
            <li>üëâ P‚ÇÇ: allow up to 2 decimal places.</li>
            <li>‚ùå Upstream pressure (P‚ÇÅ) cannot be less than downstream pressure (P‚ÇÇ).</li>
            <li>‚ÑπÔ∏è Your entries look like kPa values. Ensure inputs are in Pa as required.</li>
        </ul>
    </div>

    <!-- Output Validations -->
    <div class="note-card">
        <h3>‚úÖ Output Validations</h3>
        <ul class="note-list">
            <li>‚úÖ Zero Friction Loss: No measurable pressure drop across the segment.</li>
            <li>‚ö†Ô∏è Low Friction Loss: Normal for short/large-bore runs or low flow.</li>
            <li>‚ö†Ô∏è Moderate Friction Loss: Monitor energy loss; consider periodic inspection.</li>
            <li>‚ùå High Friction Loss: Investigate for scaling, fouling, partially closed valves, or undersized pipe.</li>
            <li>üö® Critical Friction Loss: Likely obstruction or incorrect measurement setup‚Äîtake immediate action.</li>
            <li>‚ö†Ô∏è Low absolute drop. Verify measurement context; P‚ÇÅ = 0 prevents % interpretation.</li>
            <li>‚ö†Ô∏è Moderate absolute drop. Review system state; % interpretation unavailable (P‚ÇÅ = 0).</li>
            <li>‚ùå High absolute drop. Investigate system; % interpretation unavailable (P‚ÇÅ = 0).</li>
            <li>‚ö†Ô∏è Unusually high percentage pressure drop (>50%). Check for restrictions, partly shut valves, or fouling.</li>
            <li>üö® Critical pressure drop (>90%). Possible blockage/closed valve or incorrect tap locations/units.</li>
            <li>‚ÑπÔ∏è Both pressures are zero. This usually indicates the line is not pressurized or the context/units are incorrect.</li>
            <li>‚ÑπÔ∏è Measured pressure drop is very small (&lt; 50 Pa). This may be within instrument noise for typical DP transmitters.</li>
        </ul>
    </div>

    <!-- Governing Principle -->
    <div class="note-card">
        <h3>‚öô Governing Principle</h3>
        <p>
            This calculator is based on the principle that <strong>frictional energy losses</strong> in a fluid system 
            manifest as a measurable <strong>pressure drop (ŒîP = P‚ÇÅ ‚àí P‚ÇÇ)</strong>. 
            The percentage loss relative to P‚ÇÅ indicates system efficiency and potential blockages.
        </p>
    </div>

    <!-- Conclusion -->
    <div class="note-card">
        <h3>üí° Conclusion</h3>
        <p>
            The calculator provides engineers with a reliable way to identify normal, abnormal, and critical pressure drops. 
            By applying strict input validations and output classifications, it ensures safe, efficient, and optimized operation 
            of pipelines and fluid systems.
        </p>
    </div>

</div>

    </div>

    <script>
        function calculateFrictionLoss() {
    const P1raw = document.getElementById("pressure1").value.trim();
    const P2raw = document.getElementById("pressure2").value.trim();

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');
    const outputValue = document.getElementById('frictionLossValue');
    const feedbackBox = document.getElementById('frictionFeedback');

    const errors = [];
    const warnings = [];

    // Helpers
    const isFiniteNumber = (x) => typeof x === "number" && isFinite(x);
    const countDecimals = (v) => {
        const s = String(v);
        if (!s.includes('.')) return 0;
        return s.split('.')[1].length;
    };
    const parseStrict = (s) => {
        // Allow scientific notation; reject commas and spaces inside numbers
        if (s === "" || /[, ]/.test(s)) return NaN;
        const n = Number(s);
        return n;
    };

    // --- Parse
    const P1 = parseStrict(P1raw);
    const P2 = parseStrict(P2raw);

    // --- Presence
    if (P1raw === "") errors.push("üëâ Please enter the upstream pressure (P‚ÇÅ) in Pa.");
    if (P2raw === "") errors.push("üëâ Please enter the downstream pressure (P‚ÇÇ) in Pa.");

    // --- Numeric & finite
    if (!isFiniteNumber(P1)) errors.push("üëâ Upstream pressure (P‚ÇÅ) must be a finite number.");
    if (!isFiniteNumber(P2)) errors.push("üëâ Downstream pressure (P‚ÇÇ) must be a finite number.");

    // Stop early if not numeric
    if (errors.length === 0) {
        // --- Range 0 .. 1e8 Pa
        if (P1 < 0 || P1 > 1e8) errors.push("üëâ P‚ÇÅ must be between 0 and 100,000,000 Pa (0‚Äì100 MPa).");
        if (P2 < 0 || P2 > 1e8) errors.push("üëâ P‚ÇÇ must be between 0 and 100,000,000 Pa (0‚Äì100 MPa).");

        // --- Decimals (max 2)
        if (countDecimals(P1raw) > 2) errors.push("üëâ P‚ÇÅ: allow up to 2 decimal places.");
        if (countDecimals(P2raw) > 2) errors.push("üëâ P‚ÇÇ: allow up to 2 decimal places.");

        // --- Logical consistency
        if (P1 < P2) errors.push("‚ùå Upstream pressure (P‚ÇÅ) cannot be less than downstream pressure (P‚ÇÇ).");

        // --- Heuristic unit check (kPa typed as Pa)
        if (P1 >= 100 && P1 <= 2000 && P2 >= 100 && P2 <= 2000) {
            warnings.push("‚ÑπÔ∏è Your entries look like kPa values. Ensure inputs are in Pa as required.");
        }
    }

    // --- Show errors if any
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.concat(warnings).join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    // --- Compute ŒîP
    const dP = P1 - P2; // Pa

    // Secondary sanity checks and KPI (%)
    let percentDropText = "";
    let percentDrop = null;

    if (P1 === 0 && P2 === 0) {
        warnings.push("‚ÑπÔ∏è Both pressures are zero. This usually indicates the line is not pressurized or the context/units are incorrect.");
    }
    if (Math.abs(dP) < 50) {
        warnings.push("‚ÑπÔ∏è Measured pressure drop is very small (< 50 Pa). This may be within instrument noise for typical DP transmitters.");
    }

    if (P1 > 0) {
        percentDrop = (dP / P1) * 100;
        percentDropText = ` (‚âà ${percentDrop.toFixed(2)}%)`;
        if (percentDrop > 50 && percentDrop <= 90) {
            warnings.push("‚ö†Ô∏è Unusually high percentage pressure drop (>50%). Check for restrictions, partly shut valves, or fouling.");
        } else if (percentDrop > 90) {
            warnings.push("üö® Critical pressure drop (>90%). Possible blockage/closed valve or incorrect tap locations/units.");
        }
    } else {
        percentDropText = " (percentage drop not computed because P‚ÇÅ = 0)";
    }

    // --- Output value (Pa)
    outputValue.textContent = dP.toFixed(2);

    // --- Feedback classification (percent-first, then absolute fallback)
    let feedback = "";
    let color = "black";

    if (dP === 0) {
        feedback = "‚úÖ Zero Friction Loss: No measurable pressure drop across the segment.";
        color = "green";
    } else if (percentDrop !== null) {
        if (percentDrop < 1) {
            feedback = "‚ö†Ô∏è Low Friction Loss: Normal for short/large-bore runs or low flow.";
            color = "blue";
        } else if (percentDrop < 5) {
            feedback = "‚ö†Ô∏è Moderate Friction Loss: Monitor energy loss; consider periodic inspection.";
            color = "orange";
        } else if (percentDrop <= 50) {
            feedback = "‚ùå High Friction Loss: Investigate for scaling, fouling, partially closed valves, or undersized pipe.";
            color = "red";
        } else {
            feedback = "üö® Critical Friction Loss: Likely obstruction or incorrect measurement setup‚Äîtake immediate action.";
            color = "darkred";
        }
    } else {
        // Fallback if P1 == 0 (no percent)
        if (dP <= 500) {
            feedback = "‚ö†Ô∏è Low absolute drop. Verify measurement context; P‚ÇÅ = 0 prevents % interpretation.";
            color = "blue";
        } else if (dP <= 2000) {
            feedback = "‚ö†Ô∏è Moderate absolute drop. Review system state; % interpretation unavailable (P‚ÇÅ = 0).";
            color = "orange";
        } else {
            feedback = "‚ùå High absolute drop. Investigate system; % interpretation unavailable (P‚ÇÅ = 0).";
            color = "red";
        }
    }

    const warnBlock = warnings.length ? `<div style="margin-top:6px;">${warnings.join("<br>")}</div>` : "";
    feedbackBox.innerHTML = `<span style="color:${color};">${feedback}${percentDropText}</span>${warnBlock}`;

    // --- Reveal result
    placeholder.classList.add('hidden');
    resultValue.classList.remove('hidden');
}

function printReport() {
    window.print();
}

    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--

====================Input validation rules (audit-ready)================

Units: Both inputs in Pascals (Pa). Show ‚ÄúPa‚Äù on fields and output.

Baseline numeric rules (apply to both P‚ÇÅ & P‚ÇÇ):

Required.

Numeric, finite (reject NaN, Infinity).

Range (physical/practical): 0 ‚â§ P ‚â§ 1e8 Pa (0‚Äì100 MPa).

Rationale: Encompasses most water/steam/process systems (typical fire-water 0.2‚Äì1.6 MPa; process up to several MPa). Everything above 100 MPa is non-typical for your use-case and likely a data-entry error.

Decimals: Allow up to 2 decimal places (consistent with your UI and printable reports). Reject >2; or auto-round and warn (I implement reject to be strict).

Cross-field / logical consistency:

P‚ÇÅ ‚â• P‚ÇÇ (otherwise ŒîP would be negative‚Äîindicates reversed taps, wrong entry, or pump head addition rather than friction).

Both zero ‚Üí allowed but warn: ‚Äúno pressure; measurement context likely invalid.‚Äù

Sensor resolution sanity: If |P‚ÇÅ ‚àí P‚ÇÇ| < 50 Pa, warn ‚Äúbelow typical DPT resolution / could be noise.‚Äù (Typical plant ŒîP transmitters are hundreds to thousands of Pa full scale; <50 Pa is often within noise unless you‚Äôre using a high-accuracy low-range cell.)

Outlier & plausibility checks:

Relative drop check: ŒîP% = (P‚ÇÅ ‚àí P‚ÇÇ)/P‚ÇÅ * 100

If P‚ÇÅ = 0 and P‚ÇÇ = 0 ‚Üí ŒîP% undefined; handle separately.

If P‚ÇÅ > 0:

ŒîP% < 0 ‚Üí impossible (caught by P‚ÇÅ ‚â• P‚ÇÇ).

ŒîP% > 50% ‚Üí strong warning: ‚ÄúUnusually high loss‚Äîcheck closed valves, blockages, or instrumentation.‚Äù

ŒîP% > 90% ‚Üí critical: likely valve shut/plugged strainer/wrong taps.

Contextual hints for fire systems (non-blocking warnings):

If P‚ÇÅ or P‚ÇÇ < 100 kPa (‚âà1 bar) and you‚Äôre assessing fire-water, warn ‚Äúpressures unusually low for fire service‚Äîverify scope/units.‚Äù

3) Edge-case validations to add

Empty strings / whitespace ‚Üí reject.

Scientific notation ‚Üí allowed but must parse to finite numbers.

P‚ÇÅ = P‚ÇÇ ‚Üí ŒîP = 0; valid, return ‚ÄúZero friction loss‚Äù (but add precision note if both small).

Very large ŒîP with small P‚ÇÅ (e.g., P‚ÇÅ=2000 Pa, P‚ÇÇ=0) ‚Üí check ŒîP% and flag as implausible for most water systems.

Mixed units risk (operator typed kPa into Pa field) ‚Üí if values in range 100‚Äì2000 that look like kPa but labeled Pa, you‚Äôll get tiny numbers. Add a heuristic warning if both inputs are in [100..2000]: ‚ÄúThese look like kPa. Ensure inputs are in Pa.‚Äù

4) Output validation & thresholds (meaningful KPI)

You already show ŒîP in Pa. Add an internal KPI percentage drop for interpretation only (do not change primary output):

Compute ŒîP = P‚ÇÅ ‚àí P‚ÇÇ (Pa), and if P‚ÇÅ > 0, compute ŒîP% = 100 √ó ŒîP / P‚ÇÅ.

Interpretation bands (system-agnostic, audit-friendly):

ŒîP = 0 Pa: ‚úÖ Zero friction loss (no measurable drop)

ŒîP% < 1%: ‚ö†Ô∏è Low loss‚Äînormal for short/large-bore runs or low flow

1% ‚â§ ŒîP% < 5%: ‚ö†Ô∏è Moderate‚Äîmonitor energy loss / possible minor fouling

5% ‚â§ ŒîP% ‚â§ 50%: ‚ùå High‚Äîinvestigate restrictions, partially shut valves, scaling

>50%: üö® Critical‚Äîlikely obstruction or wrong tap locations/units

If P‚ÇÅ = 0 then ŒîP% is not defined; show ŒîP only and note: ‚ÄúCannot compute percentage drop because P‚ÇÅ = 0.‚Äù

These % bands are robust because they scale across different absolute pressure regimes (HVAC vs. high-pressure process) and are consistent with how audit narratives justify action thresholds.



-->