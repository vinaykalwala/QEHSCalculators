{% extends 'base.html' %}
{% block title %}The Evaporation Factor Of A Boiler From Its 'From & At' Rating Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Evaporation Factor Of A Boiler From Its 'From & At' Rating Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
    </style>
</head>
<body>
     <div class="btn-container">
    <a href="{% url 'qualitycategory_calculators' %}" class="back-btn">Back To Quality Calculators</a>
</div>
   <div class="calculator-container printable" id="printArea">

    <!-- Include header/footer for print -->
    {% include "includes/print_header_footer.html" %}

       

        <div class="calculator-header">
            <h1> The Evaporation Factor Of A Boiler From Its 'From & At' Rating Calculator</h1>
            <p>Calculates the efficiency of a boiler in converting feedwater into steam based on enthalpy values</p>
        </div>

        <div class="calc-content">
            <!-- Calculator Input Card -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="A">Specific Enthalpy of Evaporation (A) [kJ/kg]</label>
                    <input type="number" id="A" class="form-input" step="0.01" placeholder="Enter value of A" required>
                </div>

                <div class="form-group">
                    <label for="B">Specific Enthalpy of Steam (B) [kJ/kg]</label>
                    <input type="number" id="B" class="form-input" step="0.01" placeholder="Enter value of B" required>
                </div>

                <div class="form-group">
                    <label for="C">Specific Enthalpy of Feedwater (C) [kJ/kg]</label>
                    <input type="number" id="C" class="form-input" step="0.01" placeholder="Enter value of C" required>
                </div>

                <button class="calculate-btn" onclick="calculateEvaporationFactor()">Calculate Evaporation Factor</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Boiler efficiency illustration">
                    <p>This tool calculates the <strong>evaporation factor</strong> of a boiler. Enter your enthalpy values to see results.</p>
                </div>

                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">❌</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>

                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Evaporation Factor</h2>
                    </div>
                    <div class="rate-value" id="factorValue">0.00</div>
                    <div class="rate-label"><strong>Ratio</strong></div>
                    
                    <div class="result-feedback">
                        <div class="feedback-title">Evaporation Factor Interpretation</div>
                        <div class="feedback-content" id="factorFeedback"></div>
                    </div>
                    
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">
            <div class="note-card">
                <h3>🔎 About This Calculator</h3>
                <p>
                    The <strong>Evaporation Factor Calculator</strong> determines the efficiency of a boiler in converting feedwater into steam. It helps analyze steam generation performance by calculating the ratio of energy available for phase change. A higher factor indicates better efficiency and minimal energy loss.
                </p> 
            </div>

            <div class="note-card">
                <h3>📌 Input Validations</h3>
                <ul class="note-list">
                    <li><strong>Enthalpy of Evaporation (A):</strong> Required, must be > 0</li>
                    <li><strong>Enthalpy of Steam (B):</strong> Required, must be > 0</li>
                    <li><strong>Enthalpy of Feedwater (C):</strong> Required, must be ≥ 0</li>
                    <li><strong>Value Relationship:</strong> B must be greater than C</li>
                </ul>
            </div>

            <div class="note-card">
                <h3>❓ Explanation of Parameters</h3>
                <ul class="note-list">
                    <li><strong>A (Specific Enthalpy of Evaporation):</strong> The amount of heat energy required to convert water into steam at atmospheric pressure (measured in kJ/kg).</li>
                    <li><strong>B (Specific Enthalpy of Steam):</strong> The total heat energy present in steam at the operating pressure of the boiler (measured in kJ/kg).</li>
                    <li><strong>C (Specific Enthalpy of Feedwater):</strong> The heat energy contained in feedwater before it enters the boiler, usually at a lower temperature (measured in kJ/kg).</li>
                </ul>
            </div>
      
            

            <div class="note-card">
                <h3>📊 Real-Life Applications</h3>
                <ul class="note-list">
                    <li><strong>Industrial Boilers:</strong> Measure and optimize steam generation efficiency</li>
                    <li><strong>Power Plants:</strong> Analyze fuel consumption for cost savings</li>
                    <li><strong>Thermal Power Stations:</strong> Improve electricity generation efficiency</li>
                    <li><strong>Manufacturing Industries:</strong> Optimize processes in food processing, chemical plants, and textile industries where steam is a key component</li>
                </ul>
            </div>
            
            <div class="note-card">
                <h3>💡 Conclusion</h3>
                <p>The Evaporation Factor is a crucial metric for evaluating boiler efficiency and operational performance. By optimizing steam generation based on this factor, industries can improve fuel efficiency, reduce costs, and enhance energy utilization. Regular monitoring of this value ensures sustainable and cost-effective boiler operations.</p>
            </div>
        </div>
    </div>

    <script>
        function calculateEvaporationFactor() {
    const A = document.getElementById("A").value.trim();
    const B = document.getElementById("B").value.trim();
    const C = document.getElementById("C").value.trim();

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');
    const outputValue = document.getElementById('factorValue');
    const feedbackBox = document.getElementById('factorFeedback'); 

    let errors = [];
    let warnings = [];

    // Helper: check decimals
    function hasTooManyDecimals(value) {
        return value.includes('.') && value.split('.')[1].length > 2;
    }

    // Validate A
    if (A === "") {
        errors.push("👉 Please enter the Specific Enthalpy of Evaporation (A).");
    } else if (isNaN(A)) {
        errors.push("👉 Enthalpy of Evaporation must be a number.");
    } else if (parseFloat(A) <= 0) {
        errors.push("👉 Enthalpy of Evaporation must be greater than 0.");
    } else if (parseFloat(A) < 1000 || parseFloat(A) > 3000) {
        warnings.push("⚠️ Enthalpy of Evaporation typically lies between 1000–3000 kJ/kg. Please verify.");
    } else if (hasTooManyDecimals(A)) {
        warnings.push("⚠️ A should be reported with max 2 decimals for compliance reports.");
    }

    // Validate B
    if (B === "") {
        errors.push("👉 Please enter the Specific Enthalpy of Steam (B).");
    } else if (isNaN(B)) {
        errors.push("👉 Enthalpy of Steam must be a number.");
    } else if (parseFloat(B) <= 0) {
        errors.push("👉 Enthalpy of Steam must be greater than 0.");
    } else if (parseFloat(B) > 4000) {
        errors.push("👉 Enthalpy of Steam above 4000 kJ/kg is unrealistic.");
    } else if (hasTooManyDecimals(B)) {
        warnings.push("⚠️ B should be reported with max 2 decimals for compliance reports.");
    }

    // Validate C
    if (C === "") {
        errors.push("👉 Please enter the Specific Enthalpy of Feedwater (C).");
    } else if (isNaN(C)) {
        errors.push("👉 Enthalpy of Feedwater must be a number.");
    } else if (parseFloat(C) < 0) {
        errors.push("👉 Enthalpy of Feedwater cannot be negative.");
    } else if (parseFloat(C) > 500) {
        warnings.push("⚠️ Enthalpy of Feedwater above 500 kJ/kg is unusually high.");
    } else if (hasTooManyDecimals(C)) {
        warnings.push("⚠️ C should be reported with max 2 decimals for compliance reports.");
    }

    // Cross-field validation
    if (errors.length === 0) {
        const BNum = parseFloat(B);
        const CNum = parseFloat(C);
        if (BNum <= CNum) {
            errors.push("👉 Enthalpy of Steam (B) must be greater than Enthalpy of Feedwater (C).");
        }
    }

    // Show errors
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    const ANum = parseFloat(A);
    const BNum = parseFloat(B);
    const CNum = parseFloat(C);

    // Prevent division by zero
    const denominator = BNum - CNum;
    if (denominator === 0) {
        errorMessage.innerHTML = "👉 Denominator (B - C) cannot be zero.";
        errorBox.classList.remove("hidden");
        resultValue.classList.add("hidden");
        return;
    }

    // Calculate evaporation factor
    const evaporationFactor = ANum / denominator;
    outputValue.textContent = evaporationFactor.toFixed(4);

    // Feedback
    let feedback = "";
    if (evaporationFactor < 0.8) {
        feedback = "⚠️ Low Efficiency (< 0.8) – Possible scaling, fuel losses, or poor operation.";
    } else if (evaporationFactor < 0.9) {
        feedback = "📊 Moderate Efficiency (0.8–0.9) – Acceptable but improvement advised.";
    } else if (evaporationFactor < 1.0) {
        feedback = "✅ Good Efficiency (0.9–1.0) – Meets safety & performance expectations.";
    } else if (evaporationFactor < 1.1) {
        feedback = "🔥 High Efficiency (1.0–1.1) – Excellent operation, minimal losses.";
    } else {
        feedback = "🚨 Very High Efficiency (>1.1) – Check input values, may indicate error.";
    }

    if (warnings.length > 0) {
        feedback += " | Notes: " + warnings.join(" ");
    }

    feedbackBox.textContent = feedback;
    placeholder.classList.add('hidden');
    resultValue.classList.remove('hidden');
}

    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--
Input Validation Rules (Real-world QEHS / Fire Safety Perspective)
Input Parameters

A = Specific Enthalpy of Evaporation [kJ/kg]

B = Specific Enthalpy of Steam [kJ/kg]

C = Specific Enthalpy of Feedwater [kJ/kg]

✅ Validation Rules

General Requirements

All inputs are mandatory.

Must be numeric values only (no text, special chars).

Only up to 2 decimal places accepted for meaningful reporting.

Range Validations (Based on thermodynamic & safety references)

A (Enthalpy of Evaporation):

Must be > 0

Typical range: 2000 – 2300 kJ/kg at atmospheric pressure.

Set soft threshold: 1000 – 3000 kJ/kg. Values outside flagged as abnormal.

B (Enthalpy of Steam):

Must be > 0

Normal operating range for boilers: 2000 – 3500 kJ/kg.

Max allowed: ≤ 4000 kJ/kg (beyond this = unrealistic in safe industrial conditions).

C (Enthalpy of Feedwater):

Must be ≥ 0

Typical: 100 – 300 kJ/kg (depends on feedwater temperature).

Safety max: ≤ 500 kJ/kg (above this, feedwater temp ~120°C, unusual unless using economizer).

Cross-Field Dependencies

B must be strictly greater than C (otherwise denominator becomes zero/negative).

A must be consistent with (B – C). Example: If B – C < A/5, likely incorrect inputs.

Edge Case Validations

Division by zero: Prevent when B = C.

Negative factor: Must not occur; warn if appears.

Extremely high factor (>2): Flag as likely input error.

Extremely low factor (<0.5): Warn about possible boiler inefficiency or faulty measurement.

🔎 2. Output Validation & Threshold Explanations

Evaporation Factor = A ÷ (B – C)

📊 Thresholds (based on boiler audit benchmarks, IBR & ISO 16528 references):

< 0.8 → Low efficiency (unsafe / poor combustion, scaling, or losses).

0.8 – 0.9 → Moderate efficiency (common in older boilers, improvement possible).

0.9 – 1.0 → Good efficiency (meets industrial standards, safe operation).

1.0 – 1.1 → High efficiency (modern optimized boilers, excellent condition).

> 1.1 → Unusual → Input error OR superheated steam misclassified. Needs investigation.

Outputs should always display:

Factor value (4 decimals)

Efficiency category + safety interpretation

Warnings if inputs unrealistic

Edge Cases & Handling

Empty fields → Error message, no calc.

Negative inputs → Blocked (physically impossible).

Division by zero (B=C) → Error, prevent crash.

A too large but B–C too small → Factor > 2 → warn user.

Extremely small denominator (< 10 kJ/kg) → Warn: "Values inconsistent".


            <div class="note-card formula-card">
                <h3>🧮 Formula</h3>
                <p>The Evaporation Factor is calculated using the following formula:</p>
                <code>Evaporation Factor = A / (B - C)</code>
                <p>Where:</p>
                <ul class="note-list">
                    <li>A = Specific Enthalpy of Evaporation (kJ/kg)</li>
                    <li>B = Specific Enthalpy of Steam (kJ/kg)</li>
                    <li>C = Specific Enthalpy of Feedwater (kJ/kg)</li>
                </ul>
            </div>
-->