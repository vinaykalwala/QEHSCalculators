{% extends 'base.html' %}
{% block title %}First Pass Yield (FPY) Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>First Pass Yield (FPY) Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }

        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2rem;
        }

        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }

        @media (max-width: 900px) {
            .calc-content {
                flex-direction: column;
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }

        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }

        .calc-card:hover {
            transform: translateY(-5px);
        }

        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }

        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }

        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd, #000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }

        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }

        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }

        .result-value {
            width: 100%;
        }

        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }

        .rate-label {
            color: #7f8c8d;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }

        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .feedback-content {
            color: #34495e;
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease;
        }

        .note-card:hover {
            transform: translateY(-2px);
        }

        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }

        .note-card p,
        .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }

        .note-list {
            margin: 0;
            padding-left: 18px;
        }

        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }

        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }

        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }

        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden {
            display: none;
        }

        .btn-container {
            display: flex;
            justify-content: center;
            /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background: linear-gradient(#1560bd, #000040);
            /* Dark navy background */
            color: #ffffff;
            /* White text */
            border: 2px solid #1560bd;
            /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none;
            /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd;
            /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05);
            /* Subtle hover effect */
        }

        /* FPY-specific styles */
        .feedback-content.excellent {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            color: #2e7d32;
        }

        .feedback-content.very-good {
            background: #f1f8e9;
            border-left: 4px solid #8bc34a;
            color: #558b2f;
        }

        .feedback-content.good {
            background: #fffde7;
            border-left: 4px solid #ffeb3b;
            color: #f57f17;
        }

        .feedback-content.average {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            color: #ef6c00;
        }

        .feedback-content.poor {
            background: #ffebee;
            border-left: 4px solid #f44336;
            color: #c62828;
        }
    </style>
</head>

<body>
    <div class="btn-container">
        <a href="{% url 'qualitycategory_calculators' %}" class="back-btn">Back To Quality Calculators</a>
    </div>
    <div class="calculator-container printable" id="printArea">

        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}



        <div class="calculator-header">
            <h1>First Pass Yield (FPY) Calculator</h1>
            <p>Calculates the percentage of products manufactured correctly on the first attempt without needing rework
            </p>
        </div>

        <div class="calc-content">
            <!-- Calculator Input Card -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="totalUnits">Total Units Produced</label>
                    <input type="number" id="totalUnits" class="form-input" min="1" step="1"
                        placeholder="Enter Total Units">
                </div>

                <div class="form-group">
                    <label for="defectiveUnits">Defective Units</label>
                    <input type="number" id="defectiveUnits" class="form-input" min="0" step="1"
                        placeholder="Enter Defective Units">
                </div>

                <button class="calculate-btn" onclick="calculateFPY()">Calculate FPY</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="/static/images/resultimage.png" alt="Quality control illustration">
                    <p>This tool calculates the <strong>First Pass Yield (FPY)</strong> percentage. Enter your
                        production data to see results.</p>
                </div>

                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>

                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType"
                        style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>First Pass Yield</h2>
                    </div>
                    <div class="rate-value" id="fpyValue">0.00</div>
                    <div class="rate-label"><strong>%</strong></div>

                    <div class="result-feedback">
                        <div class="feedback-title">Assessment</div>
                        <div class="feedback-content" id="fpyFeedback"></div>
                    </div>

                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">
            <div class="note-card">
                <h3>üîé About This Calculator</h3>
                <p>
                    The <strong>First Pass Yield (FPY) Calculator</strong> is a powerful tool that helps evaluate the
                    efficiency and quality of a process by measuring the percentage of products manufactured correctly
                    on the first attempt‚Äîwithout needing rework or corrections. It is an essential metric in industries
                    focused on optimizing production, reducing waste, and improving overall performance.
                </p>
            </div>

            <div class="note-card">
                <h3>‚öô Parameters Used</h3>
                <ul class="note-list">
                    <li><strong>Total Units Produced:</strong> The total number of units manufactured in a process.</li>
                    <li><strong>Defective Units:</strong> The number of units that contain defects and require rework or
                        scrapping.</li>
                    <li><strong>First Pass Yield (FPY):</strong> The percentage of units successfully produced without
                        rework, reflecting the efficiency and quality of your process.</li>
                </ul>
            </div>

            <div class="note-card">
                <h3>‚úÖ Input Validation Rules</h3>
                <ul class="note-list">
                    <li>All inputs are mandatory.</li>
                    <li>Total Units must be an integer ‚â• 1 and ‚â§ 1,000,000.</li>
                    <li>Defective Units must be an integer ‚â• 0 and ‚â§ Total Units.</li>
                    <li>Logical consistency: Defective units cannot exceed total units.</li>
                    <li>No decimals allowed; units are whole numbers.</li>
                </ul>
            </div>

            <div class="note-card">
                <h3>üìä Output Validations </h3>
                <p>
                    Thresholds (Industry Benchmark):<br>
                    ‚â• 99.9% ‚Üí üåü World-Class Process: Zero Defect Goal achieved.<br>
                    95‚Äì99.8% ‚Üí ‚úÖ Excellent Process: Highly reliable, minimal defects.<br>
                    85‚Äì94.9% ‚Üí üëç Good Process: Acceptable but needs continuous improvement.<br>
                    70‚Äì84.9% ‚Üí ‚ö†Ô∏è Average Process: Inefficient, review required for compliance.<br>
                    < 70% ‚Üí ‚ùå Poor Process: High defect rate, non-compliant, immediate corrective action needed. </p>
            </div>

            <div class="note-card">
                <h3>üìê Governing Principle</h3>
                <p>
                    The First Pass Yield (FPY) metric does not originate from a single, universal standard, but rather
                    emerged from quality control practices pioneered by individuals like Dr. Joseph Juran and became a
                    key principle in Lean manufacturing and Six Sigma methodologies. While there isn't one specific
                    standard, FPY is deeply integrated into quality management standards such as ISO 22400, ISO 9001,
                    and related Lean/Six Sigma guidelines, which are used for manufacturing operations management. These
                    standards provide guidance on process efficiency measurement, quality assessment, and standardized
                    reporting across industries.
                </p>
            </div>


            <div class="note-card">
                <h3>üí° Conclusion</h3>
                <p>
                    FPY is a crucial metric for assessing process efficiency and product quality. By monitoring and
                    optimizing FPY, industries can reduce waste, improve throughput, enhance customer satisfaction, and
                    support continuous improvement initiatives.
                </p>
            </div>
        </div>


        <script>
            function calculateFPY() {
                const totalUnits = document.getElementById("totalUnits").value.trim();
                const defectiveUnits = document.getElementById("defectiveUnits").value.trim();

                const errorBox = document.getElementById('resultError');
                const errorMessage = document.getElementById('errorMessage');
                const placeholder = document.getElementById('placeholder');
                const resultValue = document.getElementById('resultValue');
                const outputValue = document.getElementById('fpyValue');
                const feedbackBox = document.getElementById('fpyFeedback');

                let errors = [];

                // Validation: Total Units
                if (totalUnits === "") {
                    errors.push("üëâ Please enter the Total Units Produced.");
                } else if (!Number.isInteger(Number(totalUnits))) {
                    errors.push("üëâ Total Units must be a whole number.");
                } else if (parseInt(totalUnits) < 1) {
                    errors.push("üëâ Total Units must be at least 1.");
                } else if (parseInt(totalUnits) > 1000000) {
                    errors.push("üëâ Total Units cannot exceed 1,000,000 (unrealistic batch size).");
                }

                // Validation: Defective Units
                if (defectiveUnits === "") {
                    errors.push("üëâ Please enter the Defective Units.");
                } else if (!Number.isInteger(Number(defectiveUnits))) {
                    errors.push("üëâ Defective Units must be a whole number.");
                } else if (parseInt(defectiveUnits) < 0) {
                    errors.push("üëâ Defective Units cannot be negative.");
                } else if (parseInt(defectiveUnits) > 1000000) {
                    errors.push("üëâ Defective Units cannot exceed 1,000,000.");
                }

                // Cross-field validation
                if (errors.length === 0) {
                    const totalNum = parseInt(totalUnits);
                    const defectiveNum = parseInt(defectiveUnits);

                    if (defectiveNum > totalNum) {
                        errors.push("üëâ Defective Units cannot exceed Total Units.");
                    }
                }

                // Show errors
                if (errors.length > 0) {
                    errorMessage.innerHTML = errors.join("<br>");
                    errorBox.classList.remove("hidden");
                    placeholder.classList.add("hidden");
                    resultValue.classList.add("hidden");
                    return;
                } else {
                    errorBox.classList.add("hidden");
                }

                const totalNum = parseInt(totalUnits);
                const defectiveNum = parseInt(defectiveUnits);

                // FPY Calculation
                const FPY = ((totalNum - defectiveNum) / totalNum) * 100;
                outputValue.textContent = FPY.toFixed(2);

                // Feedback Interpretation
                let feedback = "";
                if (FPY >= 99.9) {
                    feedback = "üåü World-Class Process: Zero Defect Goal achieved.";
                } else if (FPY >= 95) {
                    feedback = "‚úÖ Excellent Process: Highly reliable, minimal defects.";
                } else if (FPY >= 85) {
                    feedback = "üëç Good Process: Acceptable but needs continuous improvement.";
                } else if (FPY >= 70) {
                    feedback = "‚ö†Ô∏è Average Process: Inefficient, review required for compliance.";
                } else {
                    feedback = "‚ùå Poor Process: High defect rate, non-compliant, immediate corrective action needed.";
                }

                feedbackBox.textContent = feedback;

                placeholder.classList.add('hidden');
                resultValue.classList.remove('hidden');
            }

        </script>
        <script src="{% static 'js/print.js' %}"></script>
</body>

</html>
{% endblock %}
<!--
Input Validation Rules (Industry-Based)
Total Units Produced

Must be required.

Must be an integer ‚â• 1 (you can‚Äôt produce 0 or negative units).

Max cap: 1,000,000 per batch (reasonable industry threshold).

No decimals allowed (units are whole products).

Defective Units

Must be required.

Must be an integer ‚â• 0.

Cannot exceed Total Units.

Recommended max: 1,000,000 (aligns with total).

Cross-Field Validations

Defective ‚â§ Total Units (logical consistency).

If Defective = Total ‚Üí FPY = 0% (catastrophic).

If Defective = 0 ‚Üí FPY = 100% (ideal).

3Ô∏è‚É£ Edge Case Validations

Zero Division: Prevented (Total Units ‚â• 1).

Negative Inputs: Blocked.

Extremes:

FPY = 100% (world-class process, Six Sigma target).

FPY = 0% (total failure).

Non-integers: Not allowed (fractions of units don‚Äôt exist).

Huge numbers: If inputs exceed 1,000,000 ‚Üí reject as unrealistic.

4Ô∏è‚É£ Output Validation & Thresholds

Formula:

FPY = ((Total Units ‚àí Defective Units) √∑ Total Units) √ó 100

Interpretation (Industry Benchmark)

‚â• 99.9% ‚Üí üåü World-Class / Zero Defect (Six Sigma, aerospace/fire equipment standard).

95‚Äì99.8% ‚Üí ‚úÖ Excellent Process (compliant, highly reliable).

85‚Äì94.9% ‚Üí üëç Good Process (acceptable, continuous improvement needed).

70‚Äì84.9% ‚Üí ‚ö†Ô∏è Average Process (inefficient, safety risks possible).

< 70% ‚Üí ‚ùå Poor Process (non-compliant, high fire safety/quality risk).





<div class="note-card formula-card">
                <h3>üßÆ Formula</h3>
                <p>The First Pass Yield is calculated using the following formula:</p>
                <code>FPY = ((Total Units - Defective Units) / Total Units) √ó 100</code>
                <p>Where:</p>
                <ul class="note-list">
                    <li>FPY = First Pass Yield (%)</li>
                    <li>Total Units = Total number of units produced</li>
                    <li>Defective Units = Number of defective units requiring rework</li>
                </ul>
            </div>


-->