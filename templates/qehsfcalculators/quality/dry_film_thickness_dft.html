{% extends 'base.html' %}
{% block title %}Dry Film Thickness (DFT) Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dry Film Thickness (DFT) Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }

        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2rem;
        }

        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }

        @media (max-width: 900px) {
            .calc-content {
                flex-direction: column;
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }

        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }

        .calc-card:hover {
            transform: translateY(-5px);
        }

        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }

        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }

        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd, #000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }

        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }

        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }

        .result-value {
            width: 100%;
        }

        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }

        .rate-label {
            color: #7f8c8d;
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }

        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .feedback-content {
            color: #34495e;
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease;
        }

        .note-card:hover {
            transform: translateY(-2px);
        }

        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }

        .note-card p,
        .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }

        .note-list {
            margin: 0;
            padding-left: 18px;
        }

        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }

        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }

        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }

        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden {
            display: none;
        }

        .btn-container {
            display: flex;
            justify-content: center;
            /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background: linear-gradient(#1560bd, #000040);
            /* Dark navy background */
            color: #ffffff;
            /* White text */
            border: 2px solid #1560bd;
            /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none;
            /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd;
            /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05);
            /* Subtle hover effect */
        }

        .wft-link {
            display: block;
            text-align: center;
            margin: 20px 0;
        }

        .wft-link a {
            background-color: #1560bd;
            padding: 12px 24px;
            color: white;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 600;
            transition: background-color 0.3s;
        }

        .wft-link a:hover {
            background-color: #0d47a1;
        }
    </style>
</head>

<body>
    <div class="btn-container">
        <a href="{% url 'qualitycategory_calculators' %}" class="back-btn">Back To Quality Calculators</a>
    </div>
    <div class="calculator-container printable" id="printArea">

        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}


        <div class="calculator-header">
            <h1>Dry Film Thickness (DFT) Calculator</h1>
            <p>Calculates the final thickness of coating after drying based on wet film thickness and volume solids
                percentage</p>
        </div>

        <div class="calc-content">
            <!-- Calculator Input Card -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="wft">Wet Film Thickness (WFT) - ¬µm</label>
                    <input type="number" id="wft" class="form-input" min="0" step="0.01" placeholder="Enter WFT value">
                </div>

                <div class="form-group">
                    <label for="vs">Volume Solids (VS) - %</label>
                    <input type="number" id="vs" class="form-input" min="0" step="0.01" placeholder="Enter VS value">
                </div>

                <button class="calculate-btn" onclick="calculateDFT()">Calculate DFT</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="/static/images/resultimage.png" alt="Coating thickness illustration">
                    <p>This tool calculates the <strong>Dry Film Thickness (DFT)</strong> in ¬µm. Enter your WFT and VS
                        values to see results.</p>
                </div>

                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>

                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType"
                        style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Dry Film Thickness</h2>
                    </div>
                    <div class="rate-value" id="dftValue">0.00</div>
                    <div class="rate-label"><strong>¬µm</strong></div>

                    <div class="result-feedback">
                        <div class="feedback-title">Assessment</div>
                        <div class="feedback-content" id="dftFeedback"></div>
                    </div>

                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">

            <div class="note-card">
                <h3>üìò About This Calculator</h3>
                <p>
                    The <strong>Dry Film Thickness (DFT) Calculator</strong> estimates the final coating thickness after
                    drying, based on the applied Wet Film Thickness (WFT) and the Volume Solids (VS) percentage.
                    It ensures proper coating application, compliance with standards, and long-term protection against
                    corrosion and fire risks.
                </p>
            </div>

            <div class="note-card">
                <h3>‚öô Parameters Used</h3>
                <ul class="note-list">
                    <li><strong>Wet Film Thickness (WFT):</strong> Applied coating thickness before drying, measured in
                        micrometers (¬µm).</li>
                    <li><strong>Volume Solids (VS):</strong> The percentage of solid material in the coating that
                        remains after drying.</li>
                    <li><strong>Dry Film Thickness (DFT):</strong> The final thickness of the coating after it dries or
                        cures, measured in micrometers (¬µm).</li>
                </ul>
            </div>

            <div class="note-card">
                <h3>‚úÖ Input Validation Rules</h3>
                <ul class="note-list">
                    <li><strong>WFT:</strong> Required, numeric, must be &gt; 0. Typical range: 50‚Äì500 ¬µm. Warning if
                        &lt;10 ¬µm (too thin) or &gt;1000 ¬µm (too thick).</li>
                    <li><strong>VS:</strong> Required, numeric, must be &gt; 0 and ‚â§ 100. Typical range: 30‚Äì80%. Warning
                        if &lt;20% or &gt;80%.</li>
                    <li><strong>DFT:</strong> Must calculate positive; reject if ‚â§ 0.</li>
                    <li>Allowed decimals: up to 2 places.</li>
                </ul>
            </div>

            <div class="note-card">
                <h3>üìä Output Validations</h3>
                <ul class="note-list">
                    <li><strong>&lt; 50 ¬µm:</strong> ‚ùå Too low ‚Äì unlikely to meet corrosion/fire protection standards.
                    </li>
                    <li><strong>50 ‚Äì 200 ¬µm:</strong> ‚úÖ Standard coating thickness ‚Äì suitable for most protective
                        systems.</li>
                    <li><strong>200 ‚Äì 500 ¬µm:</strong> üìä Heavy-duty system ‚Äì typical for epoxy/fireproofing.</li>
                    <li><strong>&gt; 500 ¬µm:</strong> üö® Excessive ‚Äì risk of sagging, cracking, waste, and higher fire
                        load.</li>
                </ul>

            </div>

            <div class="note-card">
                <h3>üìê Governing Principle</h3>
                <p>
                    The calculation of Dry Film Thickness (DFT) is based on the principle that only the solid portion of
                    the applied coating remains after the solvents evaporate.
                    This relationship between Wet Film Thickness (WFT) and Volume Solids (VS) determines the final DFT,
                    which is critical for ensuring the intended protection and performance of the coating.
                </p>
                <p>Relevant standards and guidelines include:</p>
                <ul class="note-list">
                    <li><strong>ISO 19840:</strong> Paints and varnishes ‚Äî Corrosion protection of steel structures by
                        protective paint systems ‚Äî Measurement of, and acceptance criteria for, the thickness of dry
                        films on rough surfaces.</li>
                    <li><strong>SSPC-PA 2:</strong> Measurement of Dry Coating Thickness with Magnetic Gages.</li>
                    <li><strong>ISO 2178:</strong> Non-magnetic coatings on magnetic substrates ‚Äî Measurement of coating
                        thickness.</li>
                    <li><strong>ISO 2360:</strong> Non-conductive coatings on non-magnetic metal substrates ‚Äî
                        Measurement of coating thickness.</li>
                    <li><strong>ASTM D7091:</strong> Standard Practice for Nondestructive Measurement of Dry Film
                        Thickness of Nonmagnetic Coatings Applied to Ferrous and Non-Ferrous Metals.</li>
                    <li><strong>NACE SP0178:</strong> Design, Fabrication, and Surface Finish Practices for Coating
                        Systems.</li>
                </ul>
            </div>

            <div class="note-card">
                <h3>üìù Conclusion</h3>
                <p>
                    The Dry Film Thickness Calculator provides a quick and reliable way to verify coating quality and
                    compliance.
                    By validating WFT and VS inputs and interpreting DFT outputs with clear assessment messages,
                    it supports coating integrity, corrosion protection, fire safety, and adherence to international
                    standards.
                </p>
            </div>

        </div>


        <script>
            function calculateDFT() {
                const wft = document.getElementById("wft").value.trim();
                const vs = document.getElementById("vs").value.trim();

                const errorBox = document.getElementById('resultError');
                const errorMessage = document.getElementById('errorMessage');
                const placeholder = document.getElementById('placeholder');
                const resultValue = document.getElementById('resultValue');
                const outputValue = document.getElementById('dftValue');
                const feedbackBox = document.getElementById('dftFeedback');

                let errors = [];
                let warnings = [];

                // Validate WFT
                if (wft === "") {
                    errors.push("üëâ Please enter the Wet Film Thickness (WFT).");
                } else if (isNaN(wft)) {
                    errors.push("üëâ WFT must be a number.");
                } else {
                    const wftNum = parseFloat(wft);
                    if (wftNum <= 0) errors.push("üëâ WFT must be greater than 0 ¬µm.");
                    else if (wftNum < 10) warnings.push("‚ö†Ô∏è WFT below 10 ¬µm ‚Äì may not provide adequate protection.");
                    else if (wftNum > 1000) warnings.push("‚ö†Ô∏è WFT above 1000 ¬µm ‚Äì risk of sagging/cracking. Verify.");
                }

                // Validate VS
                if (vs === "") {
                    errors.push("üëâ Please enter the Volume Solids (VS).");
                } else if (isNaN(vs)) {
                    errors.push("üëâ VS must be a number.");
                } else {
                    const vsNum = parseFloat(vs);
                    if (vsNum <= 0) errors.push("üëâ VS must be greater than 0%.");
                    else if (vsNum > 100) errors.push("üëâ VS cannot exceed 100%.");
                    else if (vsNum < 20) warnings.push("‚ö†Ô∏è VS <20% ‚Äì very low, verify technical datasheet.");
                    else if (vsNum > 80) warnings.push("‚ö†Ô∏è VS >80% ‚Äì unusually high, verify technical datasheet.");
                }

                // Show errors if any
                if (errors.length > 0) {
                    errorMessage.innerHTML = errors.join("<br>");
                    errorBox.classList.remove("hidden");
                    placeholder.classList.add("hidden");
                    resultValue.classList.add("hidden");
                    return;
                } else {
                    errorBox.classList.add("hidden");
                }

                const wftNum = parseFloat(wft);
                const vsNum = parseFloat(vs);

                // Calculate DFT
                const dft = (wftNum * vsNum) / 100;
                if (dft <= 0) {
                    errors.push("üëâ Calculated DFT is zero or negative ‚Äì check inputs.");
                }

                outputValue.textContent = dft.toFixed(2);

                // Feedback interpretation
                let feedback = `Based on WFT = ${wftNum.toFixed(2)} ¬µm and VS = ${vsNum.toFixed(2)}%, the calculated Dry Film Thickness (DFT) is ${dft.toFixed(2)} ¬µm. `;

                if (dft < 50) {
                    feedback += "‚ùå DFT too low ‚Äì unlikely to meet corrosion/fire protection standards.";
                } else if (dft <= 200) {
                    feedback += "‚úÖ Standard coating thickness ‚Äì suitable for most protective systems.";
                } else if (dft <= 500) {
                    feedback += "üìä Heavy-duty coating system ‚Äì typical for epoxy/fireproofing.";
                } else {
                    feedback += "üö® Excessive DFT ‚Äì risk of sagging, cracking, waste, and increased fire load.";
                }

                if (warnings.length > 0) {
                    feedback += " | Note: " + warnings.join(" ");
                }

                feedbackBox.textContent = feedback;

                placeholder.classList.add('hidden');
                resultValue.classList.remove('hidden');
            }

        </script>
        <script src="{% static 'js/print.js' %}"></script>
</body>

</html>
{% endblock %}
<!--

Analysis of Inputs, Outputs, and Formula

Formula Used:

\text{DFT (¬µm)} = \frac{\text{WFT (¬µm)} \times \text{VS (%)}}{100}

Inputs:

Wet Film Thickness (WFT, ¬µm) ‚Üí applied coating thickness before curing/drying.

Volume Solids (VS, %) ‚Üí portion of the coating that remains after solvent evaporation.

Output:

Dry Film Thickness (DFT, ¬µm) ‚Üí final protective coating thickness.

QEHS & Fire Safety Relevance:

Correct DFT ensures fire resistance, corrosion protection, and compliance with OEM and ISO/NACE standards.

Under-application ‚Üí reduced protection.

Over-application ‚Üí cracking, fire load increase, VOC waste.

2. Comprehensive Input Validation Rules
Wet Film Thickness (WFT, ¬µm)

Required (cannot be empty).

Numeric only.

> 0 ¬µm (cannot have zero or negative thickness).

Practical Range:

50 ‚Äì 500 ¬µm (common in protective coatings, ISO 19840).

Acceptable max = 1000 ¬µm, above which warnings must trigger.

Allowed Decimals: 2 decimal places max.

Volume Solids (VS, %)

Required (cannot be empty).

Numeric only.

Range:

> 0% and ‚â§ 100%.

Typical: 30 ‚Äì 80% (SSPC/ISO paint data sheets).

Edge Warning Thresholds:

<20% ‚Üí unusually low, check manufacturer data.

80% ‚Üí unusually high, check manufacturer data.

Allowed Decimals: 2 decimal places max.

3. Edge Case Validations

Division by zero ‚Üí not possible here, but validate VS = 0 ‚Üí reject.

Extremely low WFT (e.g., <10 ¬µm) ‚Üí warn (ineffective coating).

Extremely high WFT (>1000 ¬µm) ‚Üí warn (may cause sagging/cracking).

VS > 100% ‚Üí reject (physically impossible).

VS negative ‚Üí reject.

Output DFT = 0 ¬µm ‚Üí reject (indicates error).

4. Output Validation Logic

DFT Calculation ‚Üí Must always be positive.

Thresholds for compliance interpretation:

<50 ¬µm ‚Üí ‚ùå Likely non-compliant, poor corrosion/fire protection.

50‚Äì200 ¬µm ‚Üí ‚úÖ Standard protective coatings (primer, single coat).

200‚Äì500 ¬µm ‚Üí üìä Heavy-duty/epoxy systems, common for fireproofing.

>500 ¬µm ‚Üí üö® Over-application risk, cracking, waste, fire load issues.
            <div class="note-card formula-card">
                <h3>üßÆ Formula</h3>
                <p>The Dry Film Thickness is calculated using the following formula:</p>
                <code>DFT = (WFT √ó VS) / 100</code>
                <p>Where:</p>
                <ul class="note-list">
                    <li>DFT = Dry Film Thickness (¬µm)</li>
                    <li>WFT = Wet Film Thickness (¬µm)</li>
                    <li>VS = Volume Solids (%)</li>
                </ul>
            </div>
-->