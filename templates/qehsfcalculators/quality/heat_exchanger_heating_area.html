{% extends 'base.html' %}
{% block title %}Heat Exchanger Heating Area Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heat Exchanger Heating Area Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        .btn-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040);
            color: #ffffff;
            border: 2px solid #1560bd;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd;
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'qualitycategory_calculators' %}" class="back-btn">Back To Quality Calculators</a>
    </div>
    
    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Heat Exchanger Heating Area Calculator</h1>
            <p>Calculates the required heating area for a heat exchanger based on heat transfer rate, coefficient, and temperature difference</p>
        </div>

        <div class="calc-content">
            <!-- Calculator Input Card -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="heatTransferRate">Mean Heat Transfer Rate (W)</label>
                    <input type="number" id="heatTransferRate" class="form-input" min="0" placeholder="Enter heat transfer rate">
                </div>

                <div class="form-group">
                    <label for="heatTransferCoeff">Heat Transfer Coefficient (W/m²°C)</label>
                    <input type="number" id="heatTransferCoeff" class="form-input" min="0" placeholder="Enter heat transfer coefficient">
                </div>

                <div class="form-group">
                    <label for="tempDifference">Mean Temperature Difference (°C)</label>
                    <input type="number" id="tempDifference" class="form-input" min="0" placeholder="Enter temperature difference">
                </div>

                <button class="calculate-btn" onclick="calculateHeatingArea()">Calculate Heating Area</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="/static/images/resultimage.png" alt="Heat exchanger illustration">
                    <p>This tool calculates the <strong>required heating area</strong> in m². Enter your heat transfer parameters to see results.</p>
                </div>

                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">❌</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>

                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Heating Area</h2>
                    </div>
                    <div class="rate-value" id="heatingAreaValue">0.00</div>
                    <div class="rate-label"><strong>m²</strong></div>
                    
                    <div class="result-feedback">
                        <div class="feedback-title">Heat Exchanger Interpretation</div>
                        <div class="feedback-content" id="heatingFeedback"></div>
                    </div>
                    
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">

    <!-- About This Calculator -->
    <div class="note-card">
        <h3>🔎 About This Calculator</h3>
        <p>
            The <strong>Heat Exchanger Heating Area Calculator</strong> determines the required surface area for efficient heat transfer based on the heat transfer rate, coefficient, and temperature difference. It helps design efficient thermal systems for various industrial applications.
        </p> 
    </div>

    <!-- Parameters Used -->
    <div class="note-card">
        <h3>⚙ Parameters Used</h3>
        <ul class="note-list">
            <li><strong>Q̇ (Mean Heat Transfer Rate):</strong> Heat energy transferred per unit time, W</li>
            <li><strong>U (Heat Transfer Coefficient):</strong> Efficiency of heat transfer per unit area per degree, W/m²°C</li>
            <li><strong>ΔTm (Mean Temperature Difference):</strong> Temperature difference between hot and cold fluids, °C</li>
            <li><strong>A (Heating Area):</strong> Required surface area for heat exchange, m²</li>
        </ul>
    </div>

    <!-- Input Validation Rules -->
    <div class="note-card">
        <h3>✅ Input Validation Rules</h3>
        <ul class="note-list">
            <li>Q̇: Required, positive number, typical industrial range 1–1e9 W</li>
            <li>U: Required, positive number, typical range 10–20,000 W/m²·°C</li>
            <li>ΔTm: Required, positive number, 1–500 °C</li>
            <li>Cross-field validation: Q̇ = U × A × ΔTm → denominator cannot be zero</li>
            <li>Decimals allowed up to 2 places</li>
        </ul>
    </div>

    <!-- Output Validations -->
    <div class="note-card">
        <h3>📊 Output Validations & Feedback</h3>
        <ul class="note-list">
            <li>A < 0.1 m² → ⚠️ Unrealistically small area – check inputs</li>
            <li>0.1 ≤ A ≤ 10 m² → ✅ Compact area – suitable for lab/HVAC systems</li>
            <li>10 < A ≤ 100 m² → ✅ Moderate area – standard industrial range</li>
            <li>100 < A ≤ 10,000 m² → ⚠️ Large area – may indicate inefficiency or large-scale system</li>
            <li>A > 10,000 m² → ❌ Extremely large area – outside safe practical limits</li>
            <li>Feedback messages are displayed along with the calculated area in the results</li>
        </ul>
    </div>

    <!-- Governing Principle -->
    <div class="note-card">
        <h3>📐 Governing Principle</h3>
        <p>
            A Heat Exchanger Heating Area Calculator isn't based on a single "standard" but rather on fundamental heat transfer principles and equations,  along with design guidelines from organizations like TEMA (Tubular Exchanger Manufacturers Association) or European standards such as EN 12831 for specific applications like building heat load calculations.
        </p>
        <h3>Relevant Principles & Standards:</h3>
        <ul class="note-list">
            <li>TEMA Guidelines: Design and fabrication of industrial tubular heat exchangers</li>
            <li>EN 12831: Calculation of heating requirements for buildings</li>
            <li>Compliance: Ensures energy efficiency, safe operation, and adherence to industrial thermal design standards</li>
        </ul>
    </div>

    <!-- Conclusion -->
    <div class="note-card">
        <h3>💡 Conclusion</h3>
        <p>
            Accurate calculation of heating area ensures optimal heat exchange efficiency, safe operation, and cost-effective design in industrial and environmental systems. Feedback is integrated with calculated results, allowing engineers to immediately interpret whether the area is compact, standard, large, or exceeds safe practical limits.
        </p>
    </div>

</div>

    <script>
       function calculateHeatingArea() {
    const heatTransferRate = Number(document.getElementById("heatTransferRate").value);
    const heatTransferCoeff = Number(document.getElementById("heatTransferCoeff").value);
    const tempDifference = Number(document.getElementById("tempDifference").value);

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');
    const heatingAreaValue = document.getElementById('heatingAreaValue');
    const feedbackBox = document.getElementById('heatingFeedback');

    let errors = [];

    // 🔹 Input Validations
    if (isNaN(heatTransferRate) || heatTransferRate <= 0 || heatTransferRate > 1e9) {
        errors.push("❌ Heat Transfer Rate (Q) must be between 1 and 1e9 W.");
    }

    if (isNaN(heatTransferCoeff) || heatTransferCoeff <= 0 || heatTransferCoeff > 20000) {
        errors.push("❌ Heat Transfer Coefficient (U) must be between 1 and 20,000 W/m²·°C.");
    }

    if (isNaN(tempDifference) || tempDifference <= 0 || tempDifference > 500) {
        errors.push("❌ Temperature Difference (ΔT) must be between 1 and 500 °C.");
    }

    // 🔹 Show Errors
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    // 🔹 Prevent division by zero
    if (heatTransferCoeff === 0 || tempDifference === 0) {
        errorMessage.innerHTML = "❌ U and ΔT must not be zero (division by zero).";
        errorBox.classList.remove("hidden");
        return;
    }

    // ✅ Calculate A = Q / (U × ΔT)
    const heatingArea = heatTransferRate / (heatTransferCoeff * tempDifference);
    heatingAreaValue.textContent = heatingArea.toFixed(4);

    // 🔹 Feedback interpretation
    let feedback = "";
    if (heatingArea < 0.1) {
        feedback = "⚠️ Unrealistically small area (< 0.1 m²) – check inputs.";
    } else if (heatingArea <= 10) {
        feedback = "✅ Compact Area (0.1–10 m²) – suitable for HVAC/lab systems.";
    } else if (heatingArea <= 100) {
        feedback = "✅ Moderate Area (10–100 m²) – standard industrial range.";
    } else if (heatingArea <= 10000) {
        feedback = "⚠️ Large Area (> 100 m²) – may indicate design inefficiency or special large-scale system.";
    } else {
        feedback = "❌ Extremely large area (> 10,000 m²) – outside safe practical limits.";
    }

    feedbackBox.textContent = feedback;
    placeholder.classList.add('hidden');
    resultValue.classList.remove('hidden');
}

    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--
Input Validation Rules (Real-World Standards)
Parameter	Typical Industrial Range	Validation Rules	Why it Matters (QEHS / Fire Safety)
Heat Transfer Rate (Q, W)	1,000 W → 1e8 W (lab to refinery scale)	Required, must be > 0, realistic upper limit (e.g., ≤ 1e9 W). Allow decimals up to 2 places.	Too low → meaningless design; too high → unrealistic, unsafe equipment sizing.
Heat Transfer Coefficient (U, W/m²·°C)	10 → 20,000 W/m²·°C (depends on fluids/surfaces)	Required, > 0, ≤ 20,000, max 2 decimals.	Values outside range may indicate wrong material assumptions → compliance & safety hazard.
Temperature Difference (ΔT, °C)	1 → 500 °C	Required, > 0, ≤ 500, decimals allowed.	ΔT must be > 0 to drive heat flow; > 500 °C = fire/explosion risk if uncontrolled.
Cross-field Consistency	Q = U × A × ΔT	Ensure denominator not 0, ensure outputs within practical ranges.	Prevents invalid or misleading KPIs.
2️⃣ Output Validation (Meaningful Results)

Formula:

𝐴
=
𝑄
𝑈
×
Δ
𝑇
A=
U×ΔT
Q
	​


A < 0.1 m² → Too small to be realistic → flag possible input error.

0.1 ≤ A < 10 m² → Typical for compact exchangers (labs, small HVAC).

10 ≤ A ≤ 100 m² → Standard industrial exchangers.

> 100 m² → Very large system → flag with caution (may indicate inefficiency or poor parameter selection).

3️⃣ Edge Case Validations

Division by zero: U = 0 or ΔT = 0 → Stop calculation with clear error.

Negative values: reject with compliance warning (“Physical properties cannot be negative”).

Unrealistically high Q with tiny ΔT → results in absurdly large A. Flag as potential design hazard.

Outliers: If A > 10,000 m² → show warning: “Design exceeds practical safety thresholds – reevaluate process.”

4️⃣ Why Validations are Essential (Compliance Rationale)

OSHA/ISO 45001 → Requires safe equipment design & avoidance of unsafe operating limits.

NFPA (fire prevention) → Ensures ΔT not so extreme it risks ignition or rupture.

ILO Standards → Prevents unsafe energy systems in workplaces by enforcing practical boundaries.

QEHS audits → Regulators look for documented safe design ranges; unrealistic calculator outputs could compromise compliance evidence.



            <div class="note-card formula-card">
                <h3>🧮 Formula</h3>
                <p>The heating area is calculated using the formula:</p>
                <code>A = Q̇ / (U × ΔTm)</code>
                <p>Where:</p>
                <ul class="note-list">
                    <li><strong>A</strong> = Heating Area (m²)</li>
                    <li><strong>Q̇</strong> = Mean Heat Transfer Rate (W)</li>
                    <li><strong>U</strong> = Heat Transfer Coefficient (W/m²°C)</li>
                    <li><strong>ΔTm</strong> = Mean Temperature Difference (°C)</li>
                </ul>
            </div>
-->