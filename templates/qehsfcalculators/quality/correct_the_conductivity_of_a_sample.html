{% extends 'base.html' %}
{% block title %}Correct the Conductivity of a Sample Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Correct the Conductivity of a Sample Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding:0 20px;
            border-radius: 12px;
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
            margin-bottom: 20px;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
         .btn-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }
         .back-btn {
            background:linear-gradient(#1560bd,#000040);
            color: #ffffff;
            border: 2px solid #1560bd;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd;
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
     <div class="btn-container">
        <a href="{% url 'qualitycategory_calculators' %}" class="back-btn">Back To Quality Calculators</a>
    </div>

   <div class="calculator-container printable" id="printArea">

    <!-- Include header/footer for print -->
    {% include "includes/print_header_footer.html" %}

   

        <div class="calculator-header">
            <h1>Correct The Conductivity Of A Sample Calculator</h1>
            <p>Calculate the corrected conductivity of a water sample based on temperature variations</p>
        </div>

        <div class="calc-content">
            <!-- Calculator Input Card -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="conductivity25">Conductivity at 25°C (σ₂₅) (µS/cm)</label>
                    <input type="number" id="conductivity25" class="form-input" min="0" step="any" placeholder="Enter conductivity at 25°C">
                </div>

                <div class="form-group">
                    <label for="temperatureCoefficient">Temperature Coefficient (α) per °C</label>
                    <input type="number" id="temperatureCoefficient" class="form-input" min="0" step="any" placeholder="Enter temperature coefficient" value="0.02">
                </div>

                <div class="form-group">
                    <label for="temperature">Temperature (T) (°C)</label>
                    <input type="number" id="temperature" class="form-input" step="any" placeholder="Enter temperature in °C">
                </div>

                <button class="calculate-btn" onclick="calculateCorrectedConductivity()">Calculate Conductivity</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Conductivity illustration">
                    <p>This tool calculates the <strong>corrected conductivity</strong> of a water sample. Enter your data to see results.</p>
                </div>

                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">❌</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>

                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Corrected Conductivity</h2>
                    </div>
                    <div class="rate-value" id="conductivityValue">0.00</div>
                    <div class="rate-label"><strong>µS/cm</strong></div>
                    
                    <div class="result-feedback">
                        <div class="feedback-title">Interpretation</div>
                        <div class="feedback-content" id="feedbackContent"></div>
                    </div>
                    
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="note-section">
  <div class="note-card">
    <h3>🔎 About This Calculator</h3>
    <p>
      This calculator determines the <strong>corrected conductivity</strong> of a water sample at a given temperature based on its conductivity measured at 25°C. 
      It adjusts for temperature effects, which influence ion mobility, ensuring accurate water quality assessment in environmental monitoring, laboratory analysis, and industrial processes.
    </p>
  </div>

  <div class="note-card">
            <h3>⚙️ Parameters Used</h3>
    <ul class="note-list">
      <li><strong>Conductivity at 25°C (σ₂₅, µS/cm):</strong> Reference conductivity of the water sample at 25°C.</li>
      <li><strong>Temperature Coefficient (α, per °C):</strong> Correction factor representing the relative change in conductivity per °C (typically 0.02 for natural waters).</li>
      <li><strong>Temperature (T, °C):</strong> Actual temperature of the water sample at measurement.</li>
    </ul>
  </div>

  <div class="note-card">
    <h3>📌 Input Validation Rules</h3>
    <ul class="note-list">
        <li>
            <strong>Conductivity at 25°C (σ₂₅, µS/cm):</strong> 
            Must be within <strong>0.1 – 2,000,000 µS/cm</strong>. 
            This range covers ultra-pure water, drinking water, wastewater, and brines. 
            Values ≤ 0 or negative are <strong>invalid</strong>. Precision should not exceed <strong>3 decimal places</strong>.
        </li>
        <li>
            <strong>Temperature Coefficient (α, per °C):</strong> 
            Acceptable range is <strong>0.001 – 0.1</strong>. Typical natural waters have α between <strong>0.01 – 0.03</strong>; values outside this range trigger a <strong>warning</strong>. 
            Negative or zero values are <strong>invalid</strong>. Precision should not exceed <strong>4 decimal places</strong>.
        </li>
        <li>
            <strong>Temperature (T, °C):</strong> 
            Valid range is <strong>0 – 100°C</strong>. Values below 0 or above 100 are <strong>invalid</strong>. 
            Precision should not exceed <strong>2 decimal places</strong>.
        </li>
        <li>
            <strong>Cross-check:</strong> 
            If T = 25°C, the correction factor is 1 and no adjustment is needed. 
            This ensures consistency with standard reference conditions.
        </li>
        <li>
            <strong>General Notes:</strong>
            All inputs must be numeric. Empty fields or non-numeric entries will prevent calculation and trigger an error message.
        </li>
    </ul>
</div>


 <div class="note-card">
    <h3>📊 Output Validations</h3>
    <ul class="note-list">
        <li>α outside 0.01–0.03 — ⚠️ α is outside the typical range for natural waters (0.01–0.03).</li>
        <li>Corrected conductivity &gt; 200,000 µS/cm — ⚠️ Extremely high conductivity — likely brine or input error.</li>
        <li>Corrected conductivity &lt; 0.1 µS/cm — ⚠️ Very low conductivity — could indicate ultrapure water (check meter sensitivity).</li>
        <li>Temperature &gt; 25°C — Conductivity increased due to higher temperature.</li>
        <li>Temperature &lt; 25°C — Conductivity decreased due to lower temperature.</li>
        <li>Temperature = 25°C — No correction needed at 25°C.</li>
    </ul>
</div>



  <div class="note-card">
    <h3>📐 Governance Principles</h3>
    <p>
     "The calculator adheres to standards set by the International Organization for Standardization (ISO) and is also aligned with national standards, such as the Bureau of Indian Standards (BIS) specification IS 3025-14 (1984), to ensure accurate and standardized conductivity measurements."
  </div>

  <div class="note-card">
    <h3>💡 Conclusion</h3>
    <p>
      This tool provides reliable adjustment of conductivity readings for temperature effects, ensuring accurate water quality assessment. 
      Proper use allows environmental scientists, laboratories, and industries to make informed decisions, maintain compliance, and optimize process control.
    </p>
  </div>
</div>

    </div>

    <script>
function calculateCorrectedConductivity() {
    const conductivity25Raw = document.getElementById('conductivity25').value.trim();
    const alphaRaw = document.getElementById('temperatureCoefficient').value.trim();
    const tempRaw = document.getElementById('temperature').value.trim();

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');
    const conductivityValue = document.getElementById('conductivityValue');
    const feedbackContent = document.getElementById('feedbackContent');

    let errors = [];
    let warnings = [];

    // Presence checks
    if (!conductivity25Raw) errors.push("👉 Enter conductivity at 25°C (µS/cm).");
    if (!alphaRaw) errors.push("👉 Enter temperature coefficient (α).");
    if (!tempRaw) errors.push("👉 Enter sample temperature (°C).");

    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    }

    // Parse as numbers
    const conductivity25 = Number(conductivity25Raw);
    const alpha = Number(alphaRaw);
    const temp = Number(tempRaw);

    // Validation rules
    if (conductivity25 < 0.1 || conductivity25 > 2000000) {
        errors.push("👉 σ₂₅ must be between 0.1 and 2,000,000 µS/cm.");
    }
    if (alpha < 0.001 || alpha > 0.1) {
        errors.push("👉 α must be between 0.001 and 0.1 per °C.");
    }
    if (temp < 0 || temp > 100) {
        errors.push("👉 Temperature must be between 0 and 100 °C.");
    }

    // Stop if hard errors
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    }

    // Compute corrected conductivity
    const correctedConductivity = conductivity25 * (1 + alpha * (temp - 25));

    if (!Number.isFinite(correctedConductivity) || correctedConductivity < 0) {
        errorMessage.innerHTML = "❌ Invalid calculation result (check inputs).";
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    }

    // Display result
    conductivityValue.textContent = correctedConductivity.toFixed(3);

    // Feedback interpretation
    let feedback = "";
    if (temp > 25) feedback = "Conductivity increased due to higher temperature.";
    else if (temp < 25) feedback = "Conductivity decreased due to lower temperature.";
    else feedback = "No correction needed at 25°C.";

    // Soft warnings
    if (alpha < 0.01 || alpha > 0.03) {
        warnings.push("⚠️ α is outside the typical range for natural waters (0.01–0.03).");
    }
    if (correctedConductivity > 200000) {
        warnings.push("⚠️ Extremely high conductivity — likely brine or input error.");
    }
    if (correctedConductivity < 0.1) {
        warnings.push("⚠️ Very low conductivity — could indicate ultrapure water (check meter sensitivity).");
    }

    if (warnings.length > 0) {
        feedback += " " + warnings.join(" ");
        errorMessage.innerHTML = warnings.join("<br>");
        errorBox.classList.remove("hidden");
    } else {
        errorBox.classList.add("hidden");
    }

    feedbackContent.textContent = feedback;

    placeholder.classList.add("hidden");
    resultValue.classList.remove("hidden");
}


    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--

==========Real-World Input Validation Rules (QEHS Standards)==============
Inputs

Conductivity at 25 °C (σ₂₅, µS/cm):

Acceptable range: 0.1 – 2,000,000 µS/cm
(covers ultra-pure water, drinking water, wastewater, brines).

Precision: ≤ 3 decimals (µS/cm meters generally report up to 0.001).

Unit must always be µS/cm (don’t allow mS/cm mix-ups unless converted).
---------------------------------------------------------------------------------
🚨 Validation needed: reject 0 or negative values.

Temperature Coefficient (α, per °C):

Normal range: 0.01 – 0.03 (i.e., 1–3% per °C for aqueous systems).

Expanded valid range: 0.001 – 0.1 (for brines and unusual chemicals).

Precision: ≤ 4 decimals.
-------------------------------------------------------------------------
🚨 Validation needed: reject 0 or negative coefficients.

Sample Temperature (T, °C):

Range: 0 – 100 °C (matches most water quality meters & lab standards).

Precision: ≤ 2 decimals.
------------------------------------------------------------------------------
🚨 Validation needed: reject unrealistic field values (<0 or >100).

Cross-check: If T = 25, correction factor must be 1.000 (no correction).

========================= Output Validation & Threshold Logic===============================

Formula:
σ T=σ 25×(1+α×(T−25))

Output Rules:

Must always be ≥ 0.

Round to 3 decimals for reporting.

Provide interpretation:

T > 25 °C → Conductivity increased (due to higher ion mobility).

T < 25 °C → Conductivity decreased.

T = 25 °C → No correction needed.

Threshold Alerts:

If corrected σ > 200,000 µS/cm → likely seawater/brine or input error.

If σ < 0.1 µS/cm → probably ultrapure water; warn about measurement sensitivity.

If α outside 0.01–0.03 → warn as “unusual for natural water”.
=================Edge Case Handling============================

Division by zero: Not possible in this formula, but we prevent α = 0.

Negative conductivity: Blocked at input stage.

Unrealistic α (e.g., 1.5): Caught by validation.

Extreme temperature (e.g., 200 °C): Rejected as invalid.

Floating point issues: Limited to 3 decimals for output.

All inputs at zero: Returns error, not misleading “0.00 µS/cm”.


-->
