{% extends 'base.html' %}
{% block title %}Wet Film Thickness (WFT) Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wet Film Thickness (WFT) Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'qualitycategory_calculators' %}" class="back-btn">Back To Quality Calculators</a>
    </div>

    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Wet Film Thickness (WFT) Calculator</h1>
            <p>Calculates the required wet film thickness based on dry film thickness and volume solids percentage</p>
        </div>

        <div class="calc-content">
            <!-- Calculator Input Card -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="dft">Dry Film Thickness (DFT) - Âµm</label>
                    <input type="number" id="dft" class="form-input" min="0" step="0.01" placeholder="Enter DFT value">
                </div>

                <div class="form-group">
                    <label for="vs">Volume Solids (VS) - %</label>
                    <input type="number" id="vs" class="form-input" min="0" step="0.01" placeholder="Enter VS value">
                </div>

                <button class="calculate-btn" onclick="calculateWFT()">Calculate WFT</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="https://cdn-icons-png.flaticon.com/512/2942/2942789.png" alt="Coating illustration">
                    <p>This tool calculates the <strong>Wet Film Thickness (WFT)</strong> in Âµm. Enter your DFT and Volume Solids to see results.</p>
                </div>

                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">â</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>

                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Wet Film Thickness</h2>
                    </div>
                    <div class="rate-value" id="wftValue">0.00</div>
                    <div class="rate-label"><strong>Âµm</strong></div>
                    
                    <div class="result-feedback">
                        <div class="feedback-title">Application Guidance</div>
                        <div class="feedback-content" id="wftFeedback"></div>
                    </div>
                    
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">
            <div class="note-card">
                <h3>ð About This Calculator</h3>
                <p>
                    The <strong>Wet Film Thickness (WFT) Calculator</strong> determines the required thickness of coating application before drying based on the desired dry film thickness and the volume solids percentage of the coating. This helps ensure proper application and performance of protective coatings.
                </p> 
            </div>
            
            <div class="note-card">
                <h3>ð Input Validations</h3>
                <ul class="note-list">
                    <li><strong>Dry Film Thickness (DFT):</strong> Required, must be > 0 Âµm</li>
                    <li><strong>Volume Solids (VS):</strong> Required, must be > 0% and â¤ 100%</li>
                    <li><strong>Volume Solids Range:</strong> Typically 30â90% for most coatings</li>
                    <li><strong>Volume Solids:</strong> Cannot be zero (division by zero)</li>
                </ul>
            </div>

            <div class="note-card">
                <h3>â Explanation of Parameters</h3>
                <ul class="note-list">
                    <li><strong>Dry Film Thickness (DFT):</strong> The final thickness of the coating after drying, measured in micrometers (Âµm).</li>
                    <li><strong>Volume Solids (VS):</strong> The percentage of solid material in the coating that remains after the solvent evaporates.</li>
                    <li><strong>Wet Film Thickness (WFT):</strong> The thickness of the coating as applied, before drying, measured in micrometers (Âµm).</li>
                </ul>
            </div>
            

            <div class="note-card">
                <h3>ð Real-Life Applications</h3>
                <ul class="note-list">
                    <li><strong>Protective Coatings:</strong> Ensure proper thickness for corrosion protection.</li>
                    <li><strong>Paint Application:</strong> Achieve consistent appearance and coverage.</li>
                    <li><strong>Quality Control:</strong> Verify coating application meets specifications.</li>
                    <li><strong>Cost Estimation:</strong> Calculate required material quantities for projects.</li>
                </ul>
            </div>
            
            <div class="note-card">
                <h3>ð¡ Conclusion</h3>
                <p>Proper calculation of wet film thickness is essential for achieving the desired dry film thickness and ensuring coating performance. This calculator helps applicators, inspectors, and engineers determine the correct application parameters to meet project specifications, ensure durability, and avoid costly rework.</p>
            </div>
            
            <div class="note-card">
                <h3>ð Related Calculators</h3>
                <p>If you need assistance calculating the Dry Film Thickness, please use the following link:</p>
                <div style="text-align: center; margin-top: 15px;">
                    <a href="{% url 'quality_dry_film_thickness_dft_calculator' %}" style="background-color: #1560bd; padding: 12px 24px; color: white; border-radius: 10px; text-decoration: none; font-weight: 600; display: inline-block;">Dry Film Thickness (DFT) Calculator</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        function calculateWFT() {
    const dftInput = document.getElementById("dft").value.trim();
    const vsInput = document.getElementById("vs").value.trim();

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');
    const outputValue = document.getElementById('wftValue');
    const feedbackBox = document.getElementById('wftFeedback'); 

    let errors = [];
    let warnings = [];

    // --- DFT Validation ---
    if (dftInput === "") {
        errors.push("ð Please enter the Dry Film Thickness (DFT).");
    } else if (isNaN(dftInput)) {
        errors.push("ð Dry Film Thickness must be a number.");
    } else {
        const dft = parseFloat(dftInput);
        if (dft <= 0) errors.push("ð Dry Film Thickness must be greater than 0.");
        if (dft > 2000) warnings.push("â ï¸ DFT value is unusually high (>2000 Âµm). Check specification.");
        if (dft < 15) warnings.push("â ï¸ DFT value is unusually low (<15 Âµm). Check specification.");
    }

    // --- Volume Solids Validation ---
    if (vsInput === "") {
        errors.push("ð Please enter the Volume Solids percentage.");
    } else if (isNaN(vsInput)) {
        errors.push("ð Volume Solids must be a number.");
    } else {
        const vs = parseFloat(vsInput);
        if (vs <= 0) errors.push("ð Volume Solids must be greater than 0.");
        if (vs > 100) errors.push("ð Volume Solids cannot exceed 100%.");
        if (vs < 30 || vs > 90) warnings.push("â ï¸ Volume Solids outside typical range (30â90%). Verify product data sheet.");
    }

    // --- Error Handling ---
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    const dftNum = parseFloat(dftInput);
    const vsNum = parseFloat(vsInput);

    if (vsNum === 0) {
        errorMessage.innerHTML = "â Volume Solids cannot be zero (division by zero).";
        errorBox.classList.remove("hidden");
        return;
    }

    // --- Calculation ---
    const wft = (dftNum / vsNum) * 100;

    // --- Output Validation ---
    if (wft < 25) warnings.push("â ï¸ WFT below 25 Âµm may not provide adequate protection.");
    if (wft > 1000) warnings.push("â ï¸ WFT above 1000 Âµm may cause sagging, cracking, or solvent entrapment.");

    outputValue.textContent = wft.toFixed(2);

    // --- Feedback ---
    let feedback = `To achieve a Dry Film Thickness (DFT) of ${dftNum.toFixed(2)} Âµm with ${vsNum.toFixed(2)}% Volume Solids, apply a Wet Film Thickness (WFT) of ${wft.toFixed(2)} Âµm.`;
    if (warnings.length > 0) {
        feedback += " | " + warnings.join(" ");
    }
    feedbackBox.textContent = feedback;

    placeholder.classList.add('hidden');
    resultValue.classList.remove('hidden');
}

    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--

=====Real-World Input & Output Analysis=====

Inputs:

--------Dry Film Thickness (DFT, Âµm):----------------

This is the final dried thickness of the coating that provides corrosion/fire protection.

In practice: Typically 25â500 Âµm (depending on system, e.g., 25 Âµm for decorative paint, 300â500 Âµm for intumescent fireproofing, 200â300 Âµm for anti-corrosion coatings).

----------Volume Solids (VS, %):--------------

Represents solids in coating that remain after evaporation.

In practice: Common range 30â90%. Special coatings (e.g., 100% solids epoxy, solventless fireproofing) can approach 100%.

------------Output:-----------

Wet Film Thickness (WFT, Âµm):

Formula: WFT = (DFT / VS) Ã 100

Practical range: Usually between 30â1000 Âµm depending on product.

Too low â coating fails prematurely (corrosion/fire risk).

Too high â sagging, cracking, solvent entrapment (fire hazard during curing).

================Comprehensive Validation Rules====================
Dry Film Thickness (DFT)

Required

Type: numeric only (no text, no negatives)

Range: > 0 Âµm and â¤ 2000 Âµm (absolute upper threshold for very heavy-duty intumescent or thermal coatings)

Practical Warning Range: If < 15 Âµm or > 1000 Âµm â issue warning (outside normal industry spec).

Volume Solids (VS)

Required

Type: numeric only

Range: > 0 and â¤ 100

Practical Warning Range: 30â90%.

Cross-field dependency: If VS < 10% and DFT > 500 Âµm â unrealistic combination. Flag warning.

Decimals

Allow up to 2 decimal places (Âµm and % are measured to 0.01 resolution in labs but usually rounded to 1 decimal in field).

===========Edge Case Validations=============

Division by Zero:
If VS = 0 â reject input (division error).

Extreme Outliers:

DFT = 5000 Âµm â unrealistic, likely mis-entry.

VS = 200% â impossible.

Logical Consistency:

WFT < DFT â impossible (should never occur).

Negative / Non-numeric Inputs:
Reject gracefully.

==============Output Validation & Thresholds=================

Practical WFT range:

< 25 Âµm â coating too thin â insufficient protection.

1000 Âµm â risk of runs, cracking, or solvent entrapment.

Compliance Note: For safety/fireproofing coatings, application tolerance is typically Â±10% of target WFT.

Output should warn if calculated WFT falls outside this tolerance band.
-->