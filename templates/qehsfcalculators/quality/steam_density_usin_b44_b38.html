{% extends 'base.html' %}
{% block title %}Steam Density Calculator (Using Dryness Fraction){% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steam Density Calculator (Using Dryness Fraction)</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
    </style>
</head>
<body>
    <div class="btn-container">
        <a href="{% url 'qualitycategory_calculators' %}" class="back-btn">Back To Quality Calculators</a>
    </div>

    <div class="calculator-container printable" id="printArea">
        <!-- Include header/footer for print -->
        {% include "includes/print_header_footer.html" %}

        <div class="calculator-header">
            <h1>Steam Density Calculator (Using Dryness Fraction)</h1>
            <p>Calculates the density of steam based on specific volume of dry steam and dryness fraction</p>
        </div>

        <div class="calc-content">
            <!-- Calculator Input Card -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="specificVolume">Specific Volume of Dry Steam (v<sub>g</sub>, m¬≥/kg)</label>
                    <input type="number" id="specificVolume" class="form-input" min="0" placeholder="Enter specific volume">
                </div>

                <div class="form-group">
                    <label for="drynessFraction">Dryness Fraction (œá)</label>
                    <input type="number" id="drynessFraction" class="form-input" min="0" max="1" step="0.01" placeholder="Enter dryness fraction (0 to 1)">
                </div>

                <button class="calculate-btn" onclick="calculateDensity()">Calculate Density</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                <img src="{% static 'images/resultimage.png' %}" alt="Orifice">
                    <p>This tool calculates the <strong>density of steam</strong> in kg/m¬≥. Enter specific volume and dryness fraction to see results.</p>
                </div>

                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>

                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Steam Density</h2>
                    </div>
                    <div class="rate-value" id="densityValue">0.00</div>
                    <div class="rate-label"><strong>kg/m¬≥</strong></div>
                    
                    <div class="result-feedback">
                        <div class="feedback-title">Steam Quality Interpretation</div>
                        <div class="feedback-content" id="densityFeedback"></div>
                    </div>
                    
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">

    <!-- About the Calculator -->
    <div class="note-card">
        <h3>üîé About This Calculator</h3>
        <p>
            The <strong>Steam Density Calculator</strong> estimates the density of steam based on its dryness fraction and the specific volume of dry steam. 
            It helps assess steam quality, optimize energy use, and maintain efficient operations in thermal systems.
        </p>
    </div>

    <!-- Parameters -->
    <div class="note-card">
        <h3>‚ùì Parameters Explained</h3>
        <ul class="note-list">
            <li><strong>Specific Volume (v<sub>g</sub>):</strong> Volume occupied by 1 kg of dry steam at a given pressure (m¬≥/kg).</li>
            <li><strong>Dryness Fraction (œá):</strong> Fraction of the steam in vapor phase (0‚Äì1). 1 = completely dry.</li>
            <li><strong>Density (œÅ):</strong> Mass per unit volume of steam (kg/m¬≥), calculated as œÅ = 1 / (v<sub>g</sub> √ó œá).</li>
        </ul>
    </div>

    <!-- Input Validations -->
    <div class="note-card">
        <h3>üìå Input Validations</h3>
        <ul class="note-list">
            <li>Specific Volume: Required, numeric, >0 m¬≥/kg, typical range 0.1‚Äì1.7 m¬≥/kg.</li>
            <li>Dryness Fraction: Required, numeric, 0‚Äì1, values below 0.5 indicate very wet steam.</li>
            <li>Soft warnings for unusually low/high specific volume or dryness fraction.</li>
        </ul>
    </div>

    <!-- Output Validations -->
    <div class="note-card">
        <h3>üìä Output Validations</h3>
        <ul class="note-list">
            <li>Density: Typical operating range 0.1‚Äì100 kg/m¬≥.</li>
            <li>Dryness fraction 1 ‚Üí Dry Steam.</li>
            <li>Dryness fraction 0.8‚Äì1 ‚Üí High-Quality Steam.</li>
            <li>Dryness fraction 0.5‚Äì0.8 ‚Üí Wet Steam, reduced efficiency.</li>
            <li>Dryness fraction &lt;0.5 ‚Üí Very Wet Steam, risk of turbine/piping damage.</li>
        </ul>
    </div>

    <!-- Governing Principle -->
<div class="note-card">
    <h3>‚öñÔ∏è Governing Principle</h3>
    <p>
        The density of steam is governed by the relationship between its <strong>specific volume of dry steam (v<sub>g</sub>)</strong> and the <strong>dryness fraction (œá)</strong>. 
        Mathematically, the principle is expressed as:
    </p>
    <p style="text-align:center; font-weight:bold;">
        œÅ = 1 / (v<sub>g</sub> √ó œá)
    </p>
    <p>
        Where œÅ is the steam density in kg/m¬≥. This principle ensures that the mass per unit volume of steam accounts for both the vapor and liquid phases. 
        Accurate determination of steam density is essential for energy calculations, flow design, and process safety in thermal systems.
    </p>
</div>


    <!-- Conclusion -->
    <div class="note-card">
        <h3>üí° Conclusion</h3>
        <p>
            Calculating steam density considering dryness fraction is essential for energy efficiency, equipment safety, and operational compliance. 
            Regular assessment of steam quality helps reduce energy wastage, prevent damage, and improve overall thermal system performance.
        </p>
    </div>

</div>

    </div>

    <script>
function calculateDensity() {
    const specificVolume = document.getElementById("specificVolume").value.trim();
    const drynessFraction = document.getElementById("drynessFraction").value.trim();

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');
    const densityValue = document.getElementById('densityValue');
    const feedbackBox = document.getElementById('densityFeedback');

    let errors = [];
    let warnings = [];

    // ‚úÖ Specific Volume Validation
    if (specificVolume === "") {
        errors.push("üëâ Please enter the specific volume of dry steam (m¬≥/kg).");
    } else if (isNaN(specificVolume)) {
        errors.push("üëâ Specific volume must be a valid number.");
    } else {
        const sv = parseFloat(specificVolume);
        if (sv <= 0) {
            errors.push("üëâ Specific volume must be greater than 0.");
        } else if (sv < 0.05) {
            warnings.push("‚ö†Ô∏è Specific volume unusually low (<0.05 m¬≥/kg). Check inputs.");
        } else if (sv > 5) {
            warnings.push("‚ö†Ô∏è Specific volume exceeds typical maximum (5 m¬≥/kg). Please verify.");
        }
    }

    // ‚úÖ Dryness Fraction Validation
    if (drynessFraction === "") {
        errors.push("üëâ Please enter the dryness fraction (0‚Äì1).");
    } else if (isNaN(drynessFraction)) {
        errors.push("üëâ Dryness fraction must be a valid number.");
    } else {
        const df = parseFloat(drynessFraction);
        if (df <= 0 || df > 1) {
            errors.push("üëâ Dryness fraction must be between 0 and 1.");
        } else if (df < 0.5) {
            warnings.push("‚ö†Ô∏è Very wet steam (<0.5 dryness fraction) ‚Äì efficiency and safety risk.");
        }
    }

    // ‚úÖ Show Errors
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    // ‚úÖ Calculation
    const sv = parseFloat(specificVolume);
    const df = parseFloat(drynessFraction);
    const density = 1 / (sv * df);

    // ‚úÖ Output range checks
    if (density < 0.1 || density > 100) {
        warnings.push("‚ö†Ô∏è Calculated density is outside normal operating range (0.1‚Äì100 kg/m¬≥). Check inputs.");
    }

    densityValue.textContent = density.toFixed(4);

    // ‚úÖ Feedback messages
    let feedback = "";
    if (df === 1) {
        feedback = "‚úÖ Dry Steam: Completely dry steam.";
    } else if (df >= 0.8) {
        feedback = "‚ö†Ô∏è High-Quality Steam: Mostly dry steam with minor moisture.";
    } else if (df >= 0.5) {
        feedback = "‚ùå Wet Steam: Significant moisture content ‚Äì not efficient.";
    } else {
        feedback = "üîª Very Wet Steam: High water content ‚Äì risk of turbine/piping damage.";
    }

    if (warnings.length > 0) {
        feedback += " | " + warnings.join(" ");
    }

    feedbackBox.textContent = feedback;

    placeholder.classList.add('hidden');
    resultValue.classList.remove('hidden');
}

    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--
*----------Input Validation Rules -------------------*
Specific Volume (v<sub>g</sub>, m¬≥/kg)

Required: Must be entered.

Range:

Typical range in boilers: 0.1 ‚Äì 1.7 m¬≥/kg (at 1‚Äì100 bar).

Upper bound for alerts: Max 5 m¬≥/kg ‚Üí beyond this indicates input/data error.

Minimum threshold: > 0 (cannot be zero or negative ‚Üí would imply infinite or undefined density).

Decimals: Up to 4 decimals (as industrial steam tables are precise).

Units: Must be m¬≥/kg only.

Dryness Fraction (œá)

Required: Must be entered.

Range:

0 < œá ‚â§ 1 (0 = fully water, 1 = dry steam).

Below 0.5 ‚Üí ‚Äúvery wet steam‚Äù, unsafe for turbines.

Decimals: Accept 2‚Äì3 decimals for precision (e.g., 0.875).

Logical Consistency: If œá = 0, density ‚Üí ‚àû (impossible). Must be rejected.

Cross-check: If œá = 1 and specific volume > 2.5, warn: ‚ÄúInput does not match typical dry steam conditions.‚Äù

*----------- 2. Output Validation Logic & Thresholds------------------*

Formula:

ùúå
=
1
ùë£
ùëî
√ó
ùúí
œÅ=
v
g
	‚Äã

√óœá
1
	‚Äã


Output range:

Typical steam density in boilers: 0.3 ‚Äì 10 kg/m¬≥.

If œÅ > 100 ‚Üí unrealistic ‚Üí alert: ‚ÄúCheck input values; density outside expected range.‚Äù

If œÅ < 0.1 ‚Üí too low ‚Üí likely input error.

Feedback Interpretation:

œá = 1 ‚Üí ‚Äú‚úÖ Dry Steam‚Äù

0.8 ‚â§ œá < 1 ‚Üí ‚Äú‚ö†Ô∏è High-quality steam (minor moisture)‚Äù

0.5 ‚â§ œá < 0.8 ‚Üí ‚Äú‚ùå Wet steam (not ideal for efficiency)‚Äù

<0.5 ‚Üí ‚Äúüîª Very wet steam (unsafe, risk to turbines).‚Äù
*----Edge Case Validations-----------*

Division by Zero: If œá = 0 or v<sub>g</sub> = 0, block calculation (density ‚Üí ‚àû).

Negative Inputs: Reject immediately (not possible physically).

Extreme Values:

œá > 1 ‚Üí impossible, reject.

v<sub>g</sub> > 5 ‚Üí warning (likely wrong pressure input).

Rounding: Keep 4 decimals for density (audits require high precision).
*-----------------------------------------------------------------------------------------*
            <div class="note-card formula-card">
                <h3>üìê Formula</h3>
                <p>The density of steam is calculated using:</p>
                <code>œÅ = 1 / (v<sub>g</sub> √ó œá)</code>
                <p>Where:</p>
                <ul class="note-list">
                    <li><strong>œÅ</strong> = Density of steam (kg/m¬≥)</li>
                    <li><strong>v<sub>g</sub></strong> = Specific volume of dry steam (m¬≥/kg)</li>
                    <li><strong>œá</strong> = Dryness fraction (0 to 1)</li>
                </ul>
            </div>
-->