{% extends 'base.html' %}
{% block title %}Mass Flow Rate of Steam Through an Orifice Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mass Flow Rate of Steam Through an Orifice Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .formula-card {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 6px solid #0d47a1;
        }
        
        .formula-card code {
            display: inline-block;
            background: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            color: #0d47a1;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }

        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }
    </style>
</head>
<body>
     <div class="btn-container">
    <a href="{% url 'qualitycategory_calculators' %}" class="back-btn">Back To Quality Calculators</a>
</div>
   <div class="calculator-container printable" id="printArea">

    <!-- Include header/footer for print -->
    {% include "includes/print_header_footer.html" %}

       
        <div class="calculator-header">
            <h1>Mass Flow Rate Of Steam Through An Orifice Calculator</h1>
            <p>Calculates the mass flow rate of steam through an orifice based on velocity, orifice area, and specific volume</p>
        </div>

        <div class="calc-content">
            <!-- Calculator Input Card -->
            <div class="calc-card">
                <h2>Enter Data</h2>
                <div class="form-group">
                    <label for="velocity">Steam Velocity (m/s)</label>
                    <input type="number" id="velocity" class="form-input" min="0" placeholder="Enter velocity">
                </div>

                <div class="form-group">
                    <label for="area">Orifice Area (m¬≤)</label>
                    <input type="number" id="area" class="form-input" min="0" placeholder="Enter orifice area">
                </div>

                <div class="form-group">
                    <label for="volume">Specific Volume (m¬≥/kg)</label>
                    <input type="number" id="volume" class="form-input" min="0.001" step="0.001" placeholder="Enter specific volume">
                </div>

                <button class="calculate-btn" onclick="calculateMassFlow()">Calculate Mass Flow</button>
            </div>

            <!-- Result Section -->
            <div class="result-card">
                <div class="result-placeholder" id="placeholder">
                    <img src="/static/images/resultimage.png" alt="Steam flow illustration">
                    <p>This tool calculates the <strong>mass flow rate</strong> in kg/s. Enter steam velocity, orifice area, and specific volume to see results.</p>
                </div>

                <div class="result-error hidden" id="resultError">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-message" id="errorMessage"></div>
                </div>

                <div class="result-value hidden" id="resultValue">
                    <div class="calculation-type" id="calculationType" style="font-weight:bold; font-size:16px; margin-bottom:5px; color:#1560bd;">
                        <h2>Mass Flow Rate</h2>
                    </div>
                    <div class="rate-value" id="massFlowValue">0.00</div>
                    <div class="rate-label"><strong>kg/s</strong></div>
                    
                    <div class="result-feedback">
                        <div class="feedback-title">Flow Rate Interpretation</div>
                        <div class="feedback-content" id="flowFeedback"></div>
                    </div>
                    
                    <div class="btn-wrapper">
                        <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="note-section">

    <!-- About This Calculator -->
    <div class="note-card">
        <h3>üîé About This Calculator</h3>
        <p>
            The <strong>Mass Flow Rate of Steam Through an Orifice Calculator</strong> calculates the rate at which steam flows through an orifice based on velocity, orifice area, and specific volume. This is essential in steam systems to determine the amount of steam passing through a restriction, ensuring system efficiency and preventing energy loss.
        </p> 
    </div>

    <!-- Parameters Used -->
    <div class="note-card">
        <h3>‚öô Parameters Used</h3>
        <ul class="note-list">
            <li><strong>Velocity (V):</strong> Steam speed through the orifice (m/s)</li>
            <li><strong>Orifice Area (A):</strong> Cross-sectional area of the orifice (m¬≤)</li>
            <li><strong>Specific Volume (v):</strong> Volume per unit mass of steam (m¬≥/kg)</li>
            <li><strong>Mass Flow Rate (·πÅ):</strong> Rate of steam flow (kg/s)</li>
        </ul>
    </div>

    <!-- Input Validation Rules -->
    <div class="note-card">
        <h3>‚úÖ Input Validation Rules</h3>
        <ul class="note-list">
            <li>Velocity: Required, >0 m/s, typical industrial range 20‚Äì200 m/s, ‚ö†Ô∏è warn if >300 m/s</li>
            <li>Orifice Area: Required, >0 m¬≤, typical range 0.0001‚Äì10 m¬≤, ‚ö†Ô∏è warn if >10 m¬≤</li>
            <li>Specific Volume: Required, ‚â•0.001 m¬≥/kg, typical range 0.001‚Äì1.5 m¬≥/kg, must not be zero</li>
            <li>All inputs must be positive numbers</li>
        </ul>
    </div>

    <!-- Output Validations -->
    <div class="note-card">
        <h3>üìä Output Validations & Feedback</h3>
        <ul class="note-list">
            <li>Mass Flow Rate < 0.1 kg/s ‚Üí ‚ö†Ô∏è Very Low Flow Rate ‚Äì Check orifice size, velocity, or measurement; feedback displayed with result</li>
            <li>0.1 ‚â§ Mass Flow Rate ‚â§ 10 kg/s ‚Üí ‚úÖ Moderate Flow Rate ‚Äì Normal industrial range; feedback displayed with result</li>
            <li>10 < Mass Flow Rate ‚â§ 100 kg/s ‚Üí üî• High Flow Rate ‚Äì Ensure monitoring, insulation, and safety compliance; feedback displayed with result</li>
            <li>Mass Flow Rate > 100 kg/s ‚Üí üö® Very High Flow Rate ‚Äì Critical utility-scale system; mandatory safety checks; feedback displayed with result</li>
            <li>Warnings for extreme input values (V>300 m/s, A>10 m¬≤, v>1.5 m¬≥/kg) are included in the feedback</li>
        </ul>
    </div>

    <!-- Governing Principle -->
    <div class="note-card">
        <h3>üìê Governing Principle</h3>
        <p>
            A mass flow rate of steam through an orifice is calculated based on established fluid dynamics standards. Key standards include:
        </p>
        <ul class="note-list">
            <li><strong>ISO 5167-1:</strong> General principles for the measurement of fluid flow using pressure differential devices.</li>
            <li><strong>ISO 5167-2:</strong> Specific guidelines for orifice plates.</li>
            <li><strong>ASME MFC-3M:</strong> Standard for orifice flowmeters, including installation, geometry, and flow calculations.</li>
        </ul>
        <p>
            These standards provide the methodology to accurately measure flow rates, accounting for orifice geometry, steam properties, and system conditions, ensuring reliability, safety, and compliance in industrial applications.
        </p>
    </div>


    <!-- Conclusion -->
    <div class="note-card">
        <h3>üí° Conclusion</h3>
        <p>
            Accurate mass flow rate calculations help industries optimize steam systems, reduce energy waste, and maintain safe operating conditions. Feedback is integrated with the result to highlight whether the flow is within normal industrial limits or if safety actions are needed, ensuring operational reliability and compliance with QEHS standards.
        </p>
    </div>

</div>


    <script>function calculateMassFlow() {
    const velocityInput = document.getElementById("velocity").value.trim();
    const areaInput = document.getElementById("area").value.trim();
    const volumeInput = document.getElementById("volume").value.trim();

    const errorBox = document.getElementById('resultError');
    const errorMessage = document.getElementById('errorMessage');
    const placeholder = document.getElementById('placeholder');
    const resultValue = document.getElementById('resultValue');
    const outputValue = document.getElementById('massFlowValue');
    const feedbackBox = document.getElementById('flowFeedback');

    let errors = [];
    let warnings = [];

    // Convert inputs to float
    const velocity = parseFloat(velocityInput);
    const area = parseFloat(areaInput);
    const volume = parseFloat(volumeInput);

    // --- Input Validations ---
    if (!velocityInput || isNaN(velocity)) {
        errors.push("üëâ Enter a valid steam velocity (m/s).");
    } else if (velocity <= 0) {
        errors.push("üëâ Steam velocity must be greater than 0 m/s.");
    } else if (velocity > 300) {
        warnings.push("‚ö†Ô∏è Velocity unusually high (>300 m/s). Check input.");
    }

    if (!areaInput || isNaN(area)) {
        errors.push("üëâ Enter a valid orifice area (m¬≤).");
    } else if (area <= 0) {
        errors.push("üëâ Orifice area must be >0 m¬≤.");
    } else if (area > 10) {
        warnings.push("‚ö†Ô∏è Orifice area unusually large (>10 m¬≤). Check input.");
    }

    if (!volumeInput || isNaN(volume)) {
        errors.push("üëâ Enter a valid specific volume (m¬≥/kg).");
    } else if (volume <= 0) {
        errors.push("üëâ Specific volume must be >0.");
    } else if (volume < 0.001) {
        errors.push("üëâ Specific volume too low (<0.001 m¬≥/kg).");
    } else if (volume > 1.5) {
        warnings.push("‚ö†Ô∏è Specific volume exceeds typical steam ranges (>1.5 m¬≥/kg).");
    }

    // Cross-field logical check
    if (errors.length > 0) {
        errorMessage.innerHTML = errors.join("<br>");
        errorBox.classList.remove("hidden");
        placeholder.classList.add("hidden");
        resultValue.classList.add("hidden");
        return;
    } else {
        errorBox.classList.add("hidden");
    }

    // Division by zero safeguard
    if (volume === 0) {
        errorMessage.innerHTML = "‚ùå Specific volume cannot be zero.";
        errorBox.classList.remove("hidden");
        return;
    }

    // --- Mass Flow Calculation ---
    const massFlow = (velocity * area) / volume;
    outputValue.textContent = massFlow.toFixed(6);

    // --- Feedback & Safety Interpretation ---
    let feedback = "";
    if (massFlow < 0.1) {
        feedback = "‚ö†Ô∏è Very Low Flow Rate (<0.1 kg/s) ‚Äì Check orifice size, velocity, or measurement.";
    } else if (massFlow < 10) {
        feedback = "‚úÖ Moderate Flow Rate (0.1‚Äì10 kg/s) ‚Äì Normal industrial range.";
    } else if (massFlow < 100) {
        feedback = "üî• High Flow Rate (10‚Äì100 kg/s) ‚Äì Ensure monitoring, insulation, and safety compliance.";
    } else {
        feedback = "üö® Very High Flow Rate (>100 kg/s) ‚Äì Critical utility-scale system. Mandatory safety checks.";
    }

    if (warnings.length > 0) {
        feedback += " | " + warnings.join(" ");
    }

    feedbackBox.textContent = feedback;

    placeholder.classList.add("hidden");
    resultValue.classList.remove("hidden");
}

    </script>
    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}
<!--
Input Validation Rules (QEHS/Fire Safety Perspective)
Input	Units	Min/Max	Precision	Notes / QEHS Rationale
Steam Velocity (V)	m/s	0.1 ‚Äì 300	Up to 2 decimals	0 m/s or negative values are non-physical. Typical industrial velocities: 20‚Äì200 m/s. >300 m/s indicates potential instrumentation or input error. Excess velocity can cause erosion or vibration hazards.
Orifice Area (A)	m¬≤	0.0001 ‚Äì 10	Up to 6 decimals	Extremely small orifice (<0.0001 m¬≤) may cause choking; very large (>10 m¬≤) is unrealistic. From safety audits, check consistency with pipe diameter.
Specific Volume (v)	m¬≥/kg	0.001 ‚Äì 1.5	Up to 3 decimals	0.001‚Äì1.5 covers saturated & superheated steam ranges. <0.001 is physically impossible; >1.5 may indicate low-pressure errors. Avoid division by zero.

Cross-field Dependencies / Logical Checks:

Mass Flow Rate = (Velocity √ó Area) / Specific Volume.

If velocity or area is very small but volume is large ‚Üí output < 0.01 kg/s ‚Üí flag as ‚Äúnegligible flow‚Äù.

If mass flow rate exceeds 100 kg/s, warn: "Utility-scale flow, ensure compliance with safety & design standards."

Ensure all inputs are numbers, not strings or NaN.

2Ô∏è‚É£ Output Validation Logic

Mass Flow Rate Thresholds (kg/s):

Range	Interpretation	QEHS Significance
<0.1	Very Low	Potential leak, blocked line, or incorrect measurement.
0.1 ‚Äì 10	Normal industrial flow	Safe operating range; aligns with ISO 45001 monitoring practices.
10 ‚Äì 100	High	Requires close monitoring; ensure proper insulation and pressure relief systems (NFPA, OSHA).
>100	Critical / Utility-scale	Mandatory safety checks; risk of overpressure, steam hazards, and PPE requirements.
3Ô∏è‚É£ Edge Case Validations

Division by Zero ‚Üí specific volume = 0 ‚Üí cannot calculate.

Negative Inputs ‚Üí physically impossible, must reject.

Excessively high values ‚Üí input warning (velocity >300 m/s, area >10 m¬≤, specific volume >1.5 m¬≥/kg).

Null/empty fields ‚Üí prompt user to enter value.

Unrealistic combinations:

Very low velocity but very large area ‚Üí mass flow unusually high.

Very high velocity but extremely small area ‚Üí may cause noise, vibration, safety issues.


            <div class="note-card formula-card">
                <h3>üßÆ Formula</h3>
                <p>The mass flow rate is calculated using the formula:</p>
                <code>·πÅ = (V √ó A) / v</code>
                <p>Where:</p>
                <ul class="note-list">
                    <li>·πÅ = Mass flow rate (kg/s)</li>
                    <li>V = Steam velocity (m/s)</li>
                    <li>A = Orifice area (m¬≤)</li>
                    <li>v = Specific volume (m¬≥/kg)</li>
                </ul>
            </div>
-->