{% extends 'base.html' %}
{% block title %}Base Design Quantity for CO‚ÇÇ Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accident Rate Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
        /* Remove list dots & align horizontally */
.note-section ul {
    list-style: none;       /* removes bullets */
    
   
}

/* Space between items if more links later */


    </style>
</head>
<body>
   <div class="btn-container">
    <a href="{% url 'firecategory_calculators' %}" class="back-btn">Back To Fire Calculators</a>
</div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <!-- Calculator Header -->
    <div class="calculator-header">
        <h1>Base Design Quantity for CO‚ÇÇ Calculator</h1>
        <p>
            Determine the <strong>Base Design Quantity (m<sub>BD</sub>)</strong> of CO‚ÇÇ required for fire suppression in a given hazard space.
            This is a critical parameter in ensuring compliance, fire suppression effectiveness, and system optimization.
        </p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Data</h2>
            <div class="form-group">
                <label for="Vnet">Net Hazard Volume (V<sub>net</sub>)</label>
                <input type="number" id="Vnet" class="form-input" placeholder="Enter Net Hazard Volume (m¬≥)">
            </div>
            <div class="form-group">
                <label for="FF">Flooding Factor (FF)</label>
                <input type="number" id="FF" class="form-input" placeholder="Enter Flooding Factor">
            </div>
            <button class="calculate-btn" onclick="calculateBaseDesignQuantity()">Calculate Base Design Quantity</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <!-- Placeholder -->
            <div class="result-placeholder" id="placeholder">
                <img src="{% static 'images/co2.jpg' %}" alt="CO‚ÇÇ Illustration">
                <p>
                    This tool calculates the <strong>Base Design Quantity</strong> of CO‚ÇÇ required for fire suppression.
                    Enter your values to see results and insights here.
                </p>
            </div>

            <!-- Error -->
            <div class="result-error hidden" id="resultError" style="font-size: 28px;"></div>

            <!-- Result -->
            <div class="result-value hidden" id="resultValue">
                <div class="rate-value" id="mBDValue">0.00</div>
                <div class="rate-label" style="font-size:16px; font-weight:bold;">kg of CO‚ÇÇ Required</div>
                <div class="result-feedback" id="feedbackContent"></div>
                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notes Section -->
    <div class="note-section">

        <!-- About -->
        <div class="note-card">
            <h3>üìò About This Calculator</h3>
            <p>
                This calculator determines the <strong>Base Design Quantity (m<sub>BD</sub>)</strong> of CO‚ÇÇ required for fire suppression in a given space.
                The base design quantity is a critical parameter in designing fire suppression systems, ensuring that the correct amount of CO‚ÇÇ is used to effectively suppress fires.
            </p>
            <p>
                Fire suppression systems rely on achieving the correct quantity of CO‚ÇÇ to effectively suppress fires.
                Too little CO‚ÇÇ may be ineffective, while excessive CO‚ÇÇ could pose risks to personnel and equipment.
            </p>
        </div>

       <div class="note-card">
    <h3>‚öôÔ∏è Parameters</h3>
    <ul class="note-list">
        <li><strong>Net Hazard Volume (V<sub>net</sub>):</strong> The total volume of the hazard area (m¬≥) that must be protected.</li>
        <li><strong>Flooding Factor (FF):</strong> A coefficient provided in standards (e.g., NFPA 12), dependent on hazard type and space.</li>
    </ul>
</div>


        <!-- Interpretation -->
        <div class="note-card">
            <h3>üí° Why This Matters</h3>
            <p>Properly calculating the base design quantity ensures:</p>
            <ul class="note-list">
                <li>‚úÖ Compliance with fire safety standards and regulations.</li>
                <li>üí∞ Optimal use of CO‚ÇÇ, reducing waste and costs.</li>
                <li>üî• Effective fire suppression without unnecessary risks to life or equipment.</li>
            </ul>
        </div>

        <!-- Validations -->
       <div class="note-card">
    <h3>üõ°Ô∏è Input Validations</h3>
    <ul class="note-list">
        <li>‚úÖ All fields are <strong>mandatory</strong> and must be completed before calculation.</li>
        <li>‚úÖ <strong>Numeric values only:</strong> Non-numeric entries are invalid.</li>
        <li>‚úÖ <strong>Positive values required:</strong> Zero or negative numbers are not allowed.</li>
        <li>‚úÖ <strong>Net Hazard Volume (V<sub>net</sub>):</strong> 
            Must be between <strong>1 m¬≥ and 100,000 m¬≥</strong>. 
            Values outside this range will trigger warnings or errors.
        </li>
        <li>‚úÖ <strong>Flooding Factor (FF):</strong> 
            Must be between <strong>0.3 and 1.2</strong>, in line with NFPA/ISO design standards. 
            Typical values are 0.5‚Äì1.0 for gaseous agents.
        </li>
        <li>‚úÖ <strong>Result validation:</strong> 
            Very low CO‚ÇÇ (<100 kg) or very high (>20,000 kg) outputs will trigger warnings for review.
        </li>
        <li>‚ö†Ô∏è Any error or warning will be displayed in the result box (default image will disappear).</li>
    </ul>
</div>

        <!-- Usage -->
        <div class="note-card">
            <p>
                Enter the required values and click <strong>"Calculate Base Design Quantity"</strong> to see the result.
                This calculation aids fire safety engineers and facility managers in designing effective suppression systems.
            </p>
            <!-- <p>
                If you need help calculating the Net Hazard Volume, please use the following tool:
            </p>
           <ul style="display:flex; flex-wrap:wrap; justify-content:center; padding:0; margin:0; list-style:none;">
    <li style="margin:10px; flex:1 1 100%; text-align:center;">
        <a href="#" style="background-color:#1560bd; padding:12px 24px; color:white; border-radius:10px; text-decoration:none; font-weight:500; display:inline-block; width:90%; max-width:300px;">
            Net Hazard Volume Calculator
        </a> -->
    </li>
</ul>

        </div>
    </div>
</div>

<script>
function calculateBaseDesignQuantity() {
    const VnetInput = document.getElementById("Vnet").value.trim();
    const FFInput = document.getElementById("FF").value.trim();
    const resultValue = document.getElementById("resultValue");
    const placeholder = document.getElementById("placeholder");
    const feedbackContent = document.getElementById("feedbackContent");
    const resultError = document.getElementById("resultError");

    // Reset display
    resultError.classList.add("hidden");
    resultValue.classList.add("hidden");
    placeholder.classList.add("hidden");
    resultError.innerHTML = "";
    feedbackContent.innerHTML = "";

    // Empty check
    if (VnetInput === "" || FFInput === "") {
        resultError.innerHTML = "‚ö†Ô∏è Please fill in all required fields.";
        resultError.style.color = "orange";
        resultError.classList.remove("hidden");
        return;
    }

    const Vnet = parseFloat(VnetInput);
    const FF = parseFloat(FFInput);

    // Numeric check
    if (isNaN(Vnet) || isNaN(FF)) {
        resultError.innerHTML = "‚ùå Invalid entry. Please enter numeric values only.";
        resultError.style.color = "red";
        resultError.classList.remove("hidden");
        return;
    }

    // Range checks for Vnet
    if (Vnet <= 0) {
        resultError.innerHTML = "‚ùå Net Hazard Volume must be greater than zero.";
        resultError.style.color = "red";
        resultError.classList.remove("hidden");
        return;
    }
    if (Vnet < 1) {
        resultError.innerHTML = "‚ö†Ô∏è Net Hazard Volume is unrealistically small for CO‚ÇÇ flooding (<1 m¬≥).";
        resultError.style.color = "orange";
        resultError.classList.remove("hidden");
        return;
    }
    if (Vnet > 100000) {
        resultError.innerHTML = "‚ö†Ô∏è Net Hazard Volume exceeds typical NFPA design limits (>100,000 m¬≥).";
        resultError.style.color = "orange";
        resultError.classList.remove("hidden");
        return;
    }

    // Range checks for FF
    if (FF <= 0) {
        resultError.innerHTML = "‚ùå Flooding Factor must be greater than zero.";
        resultError.style.color = "red";
        resultError.classList.remove("hidden");
        return;
    }
    if (FF < 0.3 || FF > 1.2) {
        resultError.innerHTML = "‚ùå Flooding Factor must be between 0.3 and 1.2 as per NFPA/ISO guidelines.";
        resultError.style.color = "red";
        resultError.classList.remove("hidden");
        return;
    }

    // Calculation
    const mBD = Vnet * FF;
    document.getElementById("mBDValue").innerText = mBD.toFixed(2);
    resultValue.classList.remove("hidden");

    // Feedback interpretation
    let feedback = "";
    if (mBD < 100) {
        feedback = "‚ö†Ô∏è Very low CO‚ÇÇ quantity (<100 kg). Confirm if total flooding is applicable.";
        feedbackContent.style.color = "orange";
    } else if (mBD > 20000) {
        feedback = "‚ö†Ô∏è Very high CO‚ÇÇ requirement (>20,000 kg). Check practicality and confirm inputs.";
        feedbackContent.style.color = "orange";
    } else {
        feedback = "‚úÖ Successfully calculated Base Design Quantity. Within typical suppression range.";
        feedbackContent.style.color = "green";
    }
    feedbackContent.innerHTML = feedback;
}

</script>


    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- 1. Real-world inputs & formula

Your calculator uses:

Net Hazard Volume (Vnet, m¬≥): total volume of the enclosure that must be protected.

Flooding Factor (FF): standard coefficient from NFPA 12/ISO guidelines.

Formula:

ùëö
ùêµ
ùê∑
=
ùëâ
ùëõ
ùëí
ùë°
√ó
ùêπ
ùêπ
m
BD
	‚Äã

=V
net
	‚Äã

√óFF

where 
ùëö
ùêµ
ùê∑
m
BD
	‚Äã

 = CO‚ÇÇ mass required (kg).

This is correct for gaseous suppression design in principle.

2. Validation rules (industry-based)
General rules

All fields mandatory.

Numeric only.

No negative or zero values.

Net Hazard Volume (Vnet)

Unit: cubic meters (m¬≥).

Minimum realistic threshold: ‚â• 10 m¬≥ (anything smaller is not normally protected with total flooding, but allow ‚â•1 for flexibility in testing).

Maximum reasonable threshold: ‚â§ 100,000 m¬≥ (above that, CO‚ÇÇ flooding impractical).

Decimals: up to 2 decimal places allowed (e.g., 452.75 m¬≥).

Flooding Factor (FF)

Unit: dimensionless coefficient.

NFPA 12 typical range: 0.5 ‚Äì 1.0 for gaseous agents.

Acceptable extended range: 0.3 ‚Äì 1.2 (for edge cases or manufacturer variations).

Decimals: up to 3 decimal places allowed.

Output (mBD)

Must be positive.

Round to 2 decimals.

Provide context thresholds:

< 100 kg: very small hazard, confirm coverage.

100 ‚Äì 20,000 kg: typical for enclosures.

> 20,000 kg: warning, check feasibility.

3. Edge case validations

Empty fields: already covered.

Non-numeric: reject with error.

Extremely small Vnet (e.g., 0.1 m¬≥): warn "unlikely practical for CO‚ÇÇ flooding."

Extremely large Vnet (>100,000 m¬≥): warn "outside practical NFPA range."

FF out of standard range (e.g., 2.5): error, not allowed.

Division by zero: not applicable here, but zero inputs must be rejected.

4. Output validation logic

After computing mBD = Vnet √ó FF:

Always show kg of CO‚ÇÇ with two decimals.

Provide feedback interpretation:

‚úÖ "Within standard suppression range."

‚ö†Ô∏è "Value unusually high; confirm inputs or design feasibility."

‚ö†Ô∏è "Value unusually low; check if local flooding method applies instead."

This ensures output is audit-ready and compliant. -->