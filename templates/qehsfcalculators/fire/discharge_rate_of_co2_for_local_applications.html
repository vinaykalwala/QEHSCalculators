{% extends 'base.html' %}
{% block title %}Design Quantity of co2 Calculator for local applications{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
        /* Remove list dots & align horizontally */
.note-section ul {
    list-style: none;       /* removes bullets */
    
   
}

/* Space between items if more links later */


    </style>
</head>
<body>
   <div class="btn-container">
    <a href="{% url 'firecategory_calculators' %}" class="back-btn">Back To Fire Calculators</a>
</div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <!-- Calculator Header -->
    <div class="calculator-header">
        <h1>Design Quantity Of CO‚ÇÇ Calculator For Local Application</h1>
        <p>
<p>
    Quickly calculate the <strong>Design Quantity of CO‚ÇÇ (m<sub>DQ</sub>)</strong> ‚Äî the total mass of CO‚ÇÇ required for effective fire suppression in a local application system. 
</p>
        </p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Data</h2>
            <div class="form-group">
                <label for="W">Rate of Discharge (W) (kg/s)</label>
                <input type="number" id="W" class="form-input" placeholder="Enter Rate of Discharge (W)">
            </div>
            <div class="form-group">
                <label for="t">Discharge Time (t) (seconds)</label>
                <input type="number" id="t" class="form-input" placeholder="Enter Discharge Time (t)">
            </div>
            <div class="form-group">
                <label for="E">High Pressure Efficiency Factor (E)</label>
                <input type="number" id="E" class="form-input" placeholder="Enter Efficiency Factor (E)">
            </div>
            <button class="calculate-btn" onclick="calculateDesignQuantity()">Calculate Design Quantity</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <div class="result-placeholder" id="placeholder">
                <img src="{% static 'images/co2.jpg' %}" alt="CO‚ÇÇ Illustration">
                <p>
                    Enter your values to calculate the <strong>Design Quantity (m<sub>DQ</sub>)</strong> of CO‚ÇÇ for local application.
                </p>
            </div>

            <!-- Error -->
            <div class="result-error hidden" id="resultError" style="font-size: 28px;"></div>

            <!-- Result -->
            <div class="result-value hidden" id="resultValue">
                 <div class="rate-label" style="font-size:16px; font-weight:bold;">
    Required CO‚ÇÇ (kg) for local application
</div>
                <div class="rate-value" id="mDQValue">0.00</div>

                <div class="result-feedback" id="feedbackContent"></div>
                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notes Section -->
    <div class="note-section">
        <div class="note-card">
            <h3>üìò About This Calculator</h3>
            <p>
                This calculator determines the <strong>Design Quantity of CO‚ÇÇ (m<sub>DQ</sub>)</strong> needed for local application fire suppression systems. 
                It uses the <strong>Rate of Discharge (W)</strong>, <strong>Discharge Time (t)</strong>, and <strong>High Pressure Efficiency Factor (E)</strong> to calculate the total CO‚ÇÇ required. 
                This ensures sufficient gas is delivered for effective fire suppression while optimizing system efficiency and safety compliance.
            </p>
        </div>

        <div class="note-card">
    <h3>‚öôÔ∏è Parameters Used</h3>
            <ul class="note-list">
                <li><strong>Rate of Discharge (W):</strong> CO‚ÇÇ released per second (kg/s).</li>
                <li><strong>Discharge Time (t):</strong> Duration of CO‚ÇÇ release (seconds).</li>
                <li><strong>High Pressure Efficiency Factor (E):</strong> Correction factor for system efficiency.</li>
            </ul>
        </div>

        

       <div class="note-card">
    <h3>üìå Input Validation Rules</h3>
    <ul class="note-list">
        <li>‚úÖ <strong>All fields mandatory:</strong> Rate of Discharge (W), Discharge Time (t), and Efficiency Factor (E) must be filled.</li>
        <li>‚úÖ <strong>Numeric values only:</strong> Letters, symbols, or empty inputs are invalid.</li>
        <li>‚úÖ <strong>Positive values required:</strong> W, t, and E must be greater than zero.</li>
        <li>‚úÖ <strong>Practical ranges:</strong> W: 0.1‚Äì500 kg/s, t: 5‚Äì300 s, E: 0.7‚Äì1.0 (per NFPA/ISO guidelines).</li>
        <li>‚úÖ <strong>Decimal precision:</strong> W and t max 2 decimals, E max 4 decimals.</li>
        <li>‚ö†Ô∏è <strong>Edge cases:</strong> Extremely low/high inputs or unrealistic combinations trigger warnings. m<sub>DQ</sub> < 50 kg or > 50,000 kg alerts user.</li>
    </ul>
</div>
<div class="note-card">
    <h3>üìä Output Validations</h3>
    <p>
        This section provides feedback on the calculated <strong>Design Quantity of CO‚ÇÇ (m<sub>DQ</sub>)</strong> for local applications. 
        It helps users quickly understand whether the computed CO‚ÇÇ quantity is within a safe and practical range, or if adjustments are needed for system sizing and safety compliance.
    </p>
    <ul class="note-list">
    <li>If CO‚ÇÇ Quantity &lt; 50 kg ‚Üí ‚ö†Ô∏è Very low CO‚ÇÇ quantity. Check system sizing.</li>
    <li>If CO‚ÇÇ Quantity &gt; 50,000 kg ‚Üí ‚ö†Ô∏è Very high CO‚ÇÇ quantity. Verify practicality and safety.</li>
    <li>If CO‚ÇÇ Quantity 50‚Äì50,000 kg ‚Üí ‚úÖ Design Quantity calculated successfully and Value is within typical range for local applications.</li>
</ul>
</div>

<div class="note-card">
    <h3>üìê Governing Principle</h3>
    <p>
        For local application CO‚ÇÇ fire suppression systems, the industry standard is 
        <strong>NFPA 12, Standard on Carbon Dioxide Extinguishing Systems</strong>. 
        This standard dictates the requirements for designing, installing, and maintaining 
        the system, including the calculation of discharge rates.
    </p>

    <p>
        Other standards are also referenced for CO‚ÇÇ systems:
    </p>
    <ul class="note-list">
        <li><strong>Indian Standard (IS) 15528:</strong> This is an Indian standard for gaseous fire extinguishing systems.</li>
        <li><strong>British Standard (BS) 5306:</strong> This British standard also applies to CO‚ÇÇ fire extinguishing systems.</li>
        <li><strong>ISO 6183:</strong> This ISO standard provides requirements and recommendations for fixed carbon dioxide firefighting systems.</li>
    </ul>

    <p>
        <strong style="color: #1976d2;">Key aspects of local application discharge rate calculation under NFPA 12:</strong>
    </p>
    <ul class="note-list">
        <li>A local application system discharges CO‚ÇÇ directly onto the fire, rather than flooding an entire enclosed space.</li>
        <li>The calculation is based on the protected surface area, not the volume of the room.</li>
        <li>The system uses a ‚Äúrate-by-area‚Äù method to determine the required flow rate.</li>
        <li>Nozzles are spaced according to the manufacturer‚Äôs rated coverage.</li>
        <li>The total system flow rate is found by multiplying the number of nozzles by the flow rate per nozzle.</li>
        <li>The minimum discharge time for local application is 30 seconds.</li>
        <li>The calculations also factor in a percentage increase to compensate for the vapor portion of the discharge and to ensure sufficient agent is discharged.</li>
    </ul>

    <p>
        The <strong>Discharge Rate of CO‚ÇÇ for local applications</strong> is governed by NFPA 12, 
        which provides guidance for systems that protect only part of a hazard. 
        It defines the required CO‚ÇÇ quantity, nozzle discharge characteristics, and safety measures 
        to ensure effective fire suppression while protecting personnel and equipment. 
        Following these standards ensures that local-application CO‚ÇÇ systems operate safely and efficiently.
    </p>
</div>



<div class="note-card">
    <h3>üí° Conclusion</h3>
    <p>
        This calculator provides a quick and reliable way to determine the <strong>Design Quantity of CO‚ÇÇ (m<sub>DQ</sub>)</strong> required for local application fire suppression systems. 
        By inputting the <strong>Rate of Discharge (W)</strong>, <strong>Discharge Time (t)</strong>, and <strong>Efficiency Factor (E)</strong>, users can ensure that the system delivers the correct amount of CO‚ÇÇ to effectively suppress fires while optimizing safety and compliance.
    </p>
    <p>
        Using this tool helps fire safety engineers, facility managers, and system designers to: 
        <ul>
            <li>Verify that the CO‚ÇÇ quantity is within the typical safe range (50‚Äì50,000 kg).</li>
            <li>Identify potential under-sizing or over-sizing issues.</li>
            <li>Ensure compliance with NFPA and ISO guidelines for local application systems.</li>
            <li>Provide operational guidance for efficient and safe fire suppression system design.</li>
        </ul>
    </p>
</div>

    </div>
</div>

<script>
function calculateDesignQuantity() {
    const WInput = document.getElementById("W").value.trim();
    const tInput = document.getElementById("t").value.trim();
    const EInput = document.getElementById("E").value.trim();
    const resultValue = document.getElementById("resultValue");
    const placeholder = document.getElementById("placeholder");
    const feedbackContent = document.getElementById("feedbackContent");
    const resultError = document.getElementById("resultError");

    // Reset display
    resultError.classList.add("hidden");
    resultValue.classList.add("hidden");
    placeholder.classList.add("hidden");
    resultError.innerHTML = "";
    feedbackContent.innerHTML = "";

    // 1Ô∏è‚É£ Check empty fields
    if (!WInput || !tInput || !EInput) {
        resultError.innerHTML = "‚ö†Ô∏è Please fill in all required fields.";
        resultError.style.color = "orange";
        resultError.classList.remove("hidden");
        return;
    }

    const W = parseFloat(WInput);
    const t = parseFloat(tInput);
    const E = parseFloat(EInput);

    // 2Ô∏è‚É£ Check numeric
    if (isNaN(W) || isNaN(t) || isNaN(E)) {
        resultError.innerHTML = "‚ùå Invalid entry. Please enter numeric values only.";
        resultError.style.color = "red";
        resultError.classList.remove("hidden");
        return;
    }

    // 3Ô∏è‚É£ Check positive
    if (W <= 0 || t <= 0 || E <= 0) {
        resultError.innerHTML = "‚ùå Values must be greater than zero.";
        resultError.style.color = "red";
        resultError.classList.remove("hidden");
        return;
    }

   // 4Ô∏è‚É£ Check realistic ranges
if (W < 0.1 || W > 500) {
    resultError.innerHTML = "‚ö†Ô∏è Rate of Discharge (W) ‚Äî the CO‚ÇÇ released per second ‚Äî is outside the practical range of 0.1 to 500 kilograms per second.";
    resultError.style.color = "orange";
    resultError.classList.remove("hidden");
    return;
}
if (t < 5 || t > 300) {
    resultError.innerHTML = "‚ö†Ô∏è Discharge Time (t) ‚Äî the duration over which CO‚ÇÇ is released ‚Äî is outside the practical range of 5 to 300 seconds.";
    resultError.style.color = "orange";
    resultError.classList.remove("hidden");
    return;
}
if (E < 0.7 || E > 1.0) {
    resultError.innerHTML = "‚ö†Ô∏è High Pressure Efficiency Factor (E) ‚Äî the system efficiency correction factor ‚Äî must be between 0.7 and 1.0.";
    resultError.style.color = "orange";
    resultError.classList.remove("hidden");
    return;
}

// 5Ô∏è‚É£ Decimal precision
if (W.toString().split(".")[1]?.length > 2) {
    resultError.innerHTML = "‚ö†Ô∏è Rate of Discharge (W) should not have more than 2 decimal places.";
    resultError.style.color = "orange";
    resultError.classList.remove("hidden");
    return;
}
if (t.toString().split(".")[1]?.length > 2) {
    resultError.innerHTML = "‚ö†Ô∏è Discharge Time (t) should not have more than 2 decimal places.";
    resultError.style.color = "orange";
    resultError.classList.remove("hidden");
    return;
}
if (E.toString().split(".")[1]?.length > 4) {
    resultError.innerHTML = "‚ö†Ô∏è High Pressure Efficiency Factor (E) should not have more than 4 decimal places.";
    resultError.style.color = "orange";
    resultError.classList.remove("hidden");
    return;
}

    // ‚úÖ Calculation
    const mDQ = W * t * E;
    document.getElementById("mDQValue").innerText = mDQ.toFixed(2);
    resultValue.classList.remove("hidden");

    // 6Ô∏è‚É£ Feedback / output validation
    let feedback = "";
    if (mDQ < 50) {
        feedback = "‚ö†Ô∏è Very low CO‚ÇÇ quantity. Check system sizing.";
        feedbackContent.style.color = "orange";
    } else if (mDQ > 50000) {
        feedback = "‚ö†Ô∏è Very high CO‚ÇÇ quantity. Verify practicality and safety.";
        feedbackContent.style.color = "orange";
    } else {
        feedback = "‚úÖ Design Quantity calculated successfully and within typical range for local applications.";
        feedbackContent.style.color = "green";
    }
    feedbackContent.innerHTML = feedback;
}

// Optional print function
function printReport() {
    window.print();
}

</script>



    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- 1. Detailed Input Validation Rules
Input	Units	Min / Max	Decimal Precision	Notes / Compliance
Rate of Discharge (W)	kg/s	0.1 ‚Äì 500	Max 2 decimals	Must be numeric and positive. NFPA/ISO recommends practical system limits. Values below 0.1 kg/s may be ineffective; values above 500 kg/s are extremely high for local applications.
Discharge Time (t)	seconds	5 ‚Äì 300	Max 2 decimals	Typical local application systems discharge in 5‚Äì300 seconds. Too short may risk safety; too long may reduce effectiveness.
Efficiency Factor (E)	dimensionless	0.7 ‚Äì 1.0	Max 4 decimals	Accounts for system efficiency (high-pressure losses). Must be ‚â§1.0 (cannot exceed 100% efficiency). NFPA and ISO require conservative estimation to ensure adequate suppression.

Cross-field dependencies / logical checks:

mDQ = W √ó t √ó E should produce a total CO‚ÇÇ between 50 kg and 50,000 kg for local applications.

Extremely high W and t combinations (e.g., W=500, t=300) should trigger warnings.

E cannot exceed 1.0; if input >1.0, reject or correct to 1.0.

2. Output Validation Logic and Thresholds

mDQ < 50 kg ‚Üí Warning: system may be undersized.

mDQ > 50,000 kg ‚Üí Warning: system may be oversized or unrealistic.

mDQ between 50‚Äì50,000 kg ‚Üí OK, within typical local application range.

Feedback color coding:

Orange ‚Üí Warning

Green ‚Üí Safe / typical range

Red ‚Üí Invalid input or critical error

Rationale: ensures compliance with NFPA total flooding/local application guidance, prevents unsafe designs, and avoids wasted CO‚ÇÇ.

3. Edge Cases and Handling
Case	Handling
Empty input	Show ‚ÄúPlease fill all fields‚Äù
Non-numeric input	Show ‚ÄúInvalid entry. Enter numeric values only.‚Äù
Negative or zero	Show ‚ÄúValues must be greater than zero.‚Äù
W, t, or E outside practical ranges	Show warning with orange color, allow user to correct
Division by zero	Not applicable in this formula (no division)
Extreme outliers	Feedback warning (‚ÄúVery low‚Äù or ‚ÄúVery high‚Äù CO‚ÇÇ quantity)
Efficiency factor > 1.0	Show error or auto-correct to 1.0
 -->
