{% extends 'base.html' %}
{% block title %}Discharge Rate Calculator for CO‚ÇÇ{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
        /* Remove list dots & align horizontally */
.note-section ul {
    list-style: none;       /* removes bullets */
    
   
}

/* Space between items if more links later */


    </style>
</head>
<body>
   <div class="btn-container">
    <a href="{% url 'firecategory_calculators' %}" class="back-btn">Back To Fire Calculators</a>
</div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <!-- Calculator Header -->
    <div class="calculator-header">
        <h1>Discharge Rate Calculator For CO‚ÇÇ</h1>
        <p>
                    Quickly calculate the CO‚ÇÇ discharge rate for fire suppression.

        </p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Data</h2>
            <div class="form-group">
                <label for="mFD">Final Design Quantity (m<sub>FD</sub>)</label>
                <input type="number" id="mFD" class="form-input" placeholder="Enter Final Design Quantity (kg)">
            </div>
            <div class="form-group">
                <label for="t">Discharge Time (seconds) (t)</label>
                <input type="number" id="t" class="form-input" placeholder="Enter Discharge Time (s)">
            </div>
            <button class="calculate-btn" onclick="calculateDischargeRate()">Calculate Discharge Rate</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <div class="result-placeholder" id="placeholder">
                <img src="{% static 'images/co2.jpg' %}" alt="CO‚ÇÇ Illustration">
                <p>
                    This tool calculates the <strong>Discharge Rate</strong> of CO‚ÇÇ.
                    Enter your values to see results and feedback here.
                </p>
            </div>

            <!-- Error -->
            <div class="result-error hidden" id="resultError" style="font-size: 28px;"></div>

            <!-- Result -->
            <div class="result-value hidden" id="resultValue">
                                <div class="rate-value" style="font-size: 24px;">Discharge Rate</div>

                <div class="rate-value" id="WValue">0.00</div>
                <div class="rate-label" style="font-size:16px; font-weight:bold;">kg/s of CO‚ÇÇ</div>
                <div class="result-feedback" id="feedbackContent"></div>
                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notes Section -->
    <div class="note-section">
       <div class="note-card">
    <h3>üìò About This Calculator</h3>
<p>
    This calculator helps determine the <strong>Discharge Rate (W)</strong> of CO‚ÇÇ required for fire suppression in a protected area. 
    It takes the <strong>Final Design Quantity (m<sub>FD</sub>)</strong> ‚Äî which represents the total amount of CO‚ÇÇ needed for effective fire suppression ‚Äî 
    and the <strong>Discharge Time (t)</strong> ‚Äî the duration over which the CO‚ÇÇ will be released ‚Äî to calculate how fast the gas should be discharged. 
</p>
<p>
    Understanding the discharge rate is essential for designing and operating CO‚ÇÇ fire suppression systems. 
    If the gas is released too slowly, it may not suppress the fire effectively. 
    If it is released too quickly, it could pose safety risks to personnel and damage equipment. 
</p>
<p>
    This tool is intended for fire safety engineers, facility managers, and designers to ensure that CO‚ÇÇ systems are sized correctly, work efficiently, 
    and comply with fire safety standards. By entering the required inputs, users can quickly assess whether the system will deliver CO‚ÇÇ at an appropriate rate 
    for the protected space.
</p>

</div>


        <div class="note-card">
    <h3>‚öôÔ∏è Parameters Used</h3>
            <ul class="note-list">
                 <li><strong>Final Design Quantity (m<sub>FD</sub>):</strong> The total amount of CO‚ÇÇ required (kg).</li>
        <li><strong>Discharge Time (t):</strong> The time over which the CO‚ÇÇ is discharged (seconds).</li>
           </ul>
        </div>

      

        <div class="note-card">
    <h3>üìå Input Validation Rules</h3>
    <ul class="note-list">
        <li>‚úÖ <strong>All fields are mandatory:</strong> Both Final Design Quantity (m<sub>FD</sub>) and Discharge Time (t) must be filled.</li>
        <li>‚úÖ <strong>Numeric values only:</strong> Letters, special characters, or empty input are invalid.</li>
        <li>‚úÖ <strong>Positive values required:</strong> Zero or negative values are not allowed.</li>
        <li>‚úÖ <strong>Final Design Quantity (m<sub>FD</sub>):</strong> Must be between <strong>50 kg and 50,000 kg</strong>. Values outside this range trigger warnings.</li>
        <li>‚úÖ <strong>Discharge Time (t):</strong> Must be between <strong>5 and 300 seconds</strong>, as per NFPA/ISO total flooding CO‚ÇÇ guidelines.</li>
        <li>‚úÖ <strong>Decimal precision:</strong> m<sub>FD</sub> max 4 decimals; t max 2 decimals to ensure realistic reporting.</li>
        <li>‚ö†Ô∏è <strong>Discharge Rate :</strong> Outputs below 1 kg/s or above 500 kg/s trigger warnings for review.</li>
        <li>‚ö†Ô∏è <strong>Edge cases:</strong> Division by zero, extremely low/high inputs, or unrealistic combinations will display error messages and hide the placeholder.</li>
    </ul>
</div>

<div class="note-card">
    <h3>üìä Output Validations</h3>
    <ul class="note-list">
        <li>If Discharge Rate &lt; 1 kg/s ‚Üí ‚ö†Ô∏è Very low discharge rate. Check system sizing and inputs.</li>
        <li>If Discharge Rate &gt; 500 kg/s ‚Üí ‚ö†Ô∏è Very high discharge rate. Verify practicality and safety.</li>
        <li>If Discharge Rate 1‚Äì500 kg/s ‚Üí ‚úÖ Discharge rate calculated successfully and within typical range. System is functioning as expected.</li>
    </ul>
</div>


 <div class="note-card">
    <h3>üìê Governing Principle</h3>
    <p>
        <strong>Discharge Rate for CO‚ÇÇ (flooding)</strong> ‚Üí NFPA 12 (Standard): This standard specifies the minimum discharge rates and times for CO‚ÇÇ flooding systems. 
        It ensures that CO‚ÇÇ is released at a rate sufficient to suppress fires effectively in protected spaces while maintaining safety for personnel and equipment.
    </p>
    <p>
        By following these guidelines, designers and engineers can size CO‚ÇÇ systems appropriately, ensuring that the protected area receives the necessary concentration of CO‚ÇÇ within the required discharge time.
    </p>
</div>


       <div class="note-card">
                                    <h3>üí° Conclusion</h3>
                                    <p> <p>
        This CO‚ÇÇ Discharge Rate Calculator provides a quick and reliable method to determine the discharge rate (W = m<sub>FD</sub> / t) for fire suppression systems. 
        By entering the <strong>Final Design Quantity (m<sub>FD</sub>)</strong> and <strong>Discharge Time (t)</strong>, users can ensure that the CO‚ÇÇ is released at a rate that is both effective for fire suppression and safe for personnel and equipment. 
        The calculator also incorporates input validation rules and feedback to maintain compliance with NFPA, ISO, and OSHA fire safety standards.
    </p></p>
       </div>
        <div class="note-card">
                                               <h3>üîó Related Calculators</h3>

            <p>
                If you need help calculating the Final Design Quantity (m<sub>FD</sub>), use this tool:
            </p>
            <ul style="display:flex; flex-wrap:wrap; justify-content:center; padding:0; margin:0; list-style:none;">
                <li style="margin:10px; flex:1 1 100%; text-align:center;">
                    <a href="{% url 'fire_final_design_quantity_for_co2_calculator' %}" style="background-color:#1560bd; padding:12px 24px; color:white; border-radius:10px; text-decoration:none; font-weight:500; display:inline-block; width:90%; max-width:300px;">
                        Final Design Quantity Of CO‚ÇÇ
                    </a>
                </li>
            </ul>
        </div> 
    </div>
    </div>
</div>

<script>
function calculateDischargeRate() {
    const mFDInput = document.getElementById("mFD").value.trim();
    const tInput = document.getElementById("t").value.trim();
    const resultValue = document.getElementById("resultValue");
    const placeholder = document.getElementById("placeholder");
    const feedbackContent = document.getElementById("feedbackContent");
    const resultError = document.getElementById("resultError");

    // Reset display
    resultError.classList.add("hidden");
    resultValue.classList.add("hidden");
    placeholder.classList.add("hidden");
    resultError.innerHTML = "";
    feedbackContent.innerHTML = "";

    // Empty check
    if (!mFDInput || !tInput) {
        resultError.innerHTML = "‚ö†Ô∏è Please fill in all required fields.";
        resultError.style.color = "orange";
        resultError.classList.remove("hidden");
        return;
    }

    const mFD = parseFloat(mFDInput);
    const t = parseFloat(tInput);

    // Numeric check
    if (isNaN(mFD) || isNaN(t)) {
        resultError.innerHTML = "‚ùå Invalid entry. Please enter numeric values only.";
        resultError.style.color = "red";
        resultError.classList.remove("hidden");
        return;
    }

    // Positive value check
    if (mFD <= 0 || t <= 0) {
        resultError.innerHTML = "‚ùå Values must be greater than zero.";
        resultError.style.color = "red";
        resultError.classList.remove("hidden");
        return;
    }

    // Decimal place check
    if (mFD.toString().split(".")[1]?.length > 4) {
        resultError.innerHTML = "‚ö†Ô∏è Final Design Quantity should not have more than 4 decimal places.";
        resultError.style.color = "orange";
        resultError.classList.remove("hidden");
        return;
    }
    if (t.toString().split(".")[1]?.length > 2) {
        resultError.innerHTML = "‚ö†Ô∏è Discharge Time should not have more than 2 decimal places.";
        resultError.style.color = "orange";
        resultError.classList.remove("hidden");
        return;
    }

    // Realistic range checks
    if (mFD < 50 || mFD > 50000) {
        resultError.innerHTML = "‚ö†Ô∏è Final Design Quantity is outside typical range (50‚Äì50,000 kg).";
        resultError.style.color = "orange";
        resultError.classList.remove("hidden");
        return;
    }
    if (t < 5 || t > 300) {
        resultError.innerHTML = "‚ö†Ô∏è Discharge Time is outside typical range (5‚Äì300 s).";
        resultError.style.color = "orange";
        resultError.classList.remove("hidden");
        return;
    }

    // Calculation
    const W = mFD / t;
    document.getElementById("WValue").innerText = W.toFixed(2);
    resultValue.classList.remove("hidden");

    // Feedback interpretation
    let feedback = "";
    if (W < 1) {
        feedback = "‚ö†Ô∏è Very low discharge rate. Check system sizing and inputs.";
        feedbackContent.style.color = "orange";
    } else if (W > 500) {
        feedback = "‚ö†Ô∏è Very high discharge rate. Verify practicality and safety.";
        feedbackContent.style.color = "orange";
    } else {
        feedback = "‚úÖ Discharge rate calculated successfully and within typical range.";
        feedbackContent.style.color = "green";
    }
    feedbackContent.innerHTML = feedback;
}

</script>


    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- 1. Analysis of Calculator Inputs, Outputs, and Formula

Inputs:

Input	Description	Units	Typical Values	Notes
mFD	Final Design Quantity	kg	100‚Äì20,000 kg (depending on hazard size)	Total CO‚ÇÇ required for the protected area. Must be positive and realistic.
t	Discharge Time	seconds	10‚Äì300 s	Duration over which CO‚ÇÇ is released. Must be positive and realistic for system type.

Output:

Output	Description	Units	Acceptable Range
W	Discharge Rate	kg/s	Typically 1‚Äì500 kg/s

Calculation Formula:

ùëä
=
ùëö
ùêπ
ùê∑
ùë°
W=
t
m
FD
	‚Äã

	‚Äã


Simple division, but in real-world QEHS audits, must ensure inputs are valid to prevent division by zero or unrealistic outcomes.

2. Recommended Input Validation Rules (QEHS/Fire Safety Standards)
Input	Validation Rule	Reason/Compliance Justification
mFD	Mandatory, numeric, >0	Cannot calculate rate without quantity; negative or zero CO‚ÇÇ makes no sense.
mFD	Realistic min: 50 kg, max: 50,000 kg (adjust per facility/hazard size)	Below minimum: system cannot suppress fire; above maximum: impractical, risks equipment damage.
mFD	Max 4 decimal places	Avoid over-precision, ensures readability in reports.
t	Mandatory, numeric, >0	Discharge time must be defined to calculate rate.
t	Min 5 s, max 300 s (per NFPA 12 for total flooding CO‚ÇÇ)	Shorter: risk of system overpressure; longer: fire may not be suppressed.
t	Max 2 decimal places	Reasonable precision for reporting and calculations.
Cross-field	W = mFD / t must result in 1‚Äì500 kg/s	Ensures system effectiveness and safety.
3. Edge Case Validations

Division by zero: t = 0 ‚Üí error.

Extremely small/large mFD: Warn user if mFD < 50 kg or >50,000 kg.

Unrealistic discharge rates: Warn if W <1 kg/s (ineffective) or W >500 kg/s (unsafe).

Non-numeric inputs: Reject letters, special characters, or empty fields.

Negative or zero values: Reject both mFD and t ‚â§ 0.

Overly precise decimals: Reject more than 4 decimals for mFD, 2 for t.

4. Output Validation and Feedback

Low W (<1 kg/s): ‚ö†Ô∏è ‚ÄúVery low discharge rate; may not suppress fire effectively.‚Äù

High W (>500 kg/s): ‚ö†Ô∏è ‚ÄúVery high discharge rate; potential risk to personnel/equipment.‚Äù

Normal range: ‚úÖ ‚ÄúDischarge rate is within acceptable range for typical fire suppression systems.‚Äù

These outputs are critical for audits, compliance reports, and QEHS verification because they ensure operational safety and regulatory adherence.

7. Why Each Validation Is Essential (QEHS Compliance)

Mandatory & numeric checks: Prevent errors in audits and ensure KPI calculations are valid.

Positive values: Fire suppression systems cannot operate with zero/negative gas.

Decimal precision limits: Reflect practical reporting and system tolerances.

Range limits: Align with NFPA 12, ISO 14520, OSHA, and practical engineering constraints.

Cross-field W checks: Ensures calculated rate is safe and effective; prevents operational hazards.

Edge cases (division by zero, unrealistic inputs): Avoid system failure, audit red flags, and safety incidents. -->