{% extends 'base.html' %}
{% block title %}Equivalent Orifice Area Calculator for co2{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>
   <div class="btn-container">
    <a href="{% url 'firecategory_calculators' %}" class="back-btn">Back To Fire Calculators</a>
</div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <div class="calculator-header">
        <h1>Equivalent Orifice Area Calculator for CO₂</h1>
        <p>Determine the size of the nozzle opening (A<sub>eq</sub>) required to discharge CO₂ efficiently for fire suppression.</p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Data</h2>
            <div class="form-group">
                <label for="Q">Flow Rate (Q) (m³/s or L/s)</label>
                <input type="number" id="Q" class="form-input" placeholder="Enter Flow Rate (Q)">
            </div>
            <div class="form-group">
                <label for="W">Discharge Rate (W) (kg/s)</label>
                <input type="number" id="W" class="form-input" placeholder="Enter Discharge Rate (W)">
            </div>
            <button class="calculate-btn" onclick="calculateOrificeArea()">Calculate Orifice Area</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <div class="result-placeholder" id="placeholder">
                <img src="{% static 'images/orifice.png' %}" alt="Orifice Illustration">
                <p>This tool will calculate the <strong>Equivalent Orifice Area</strong>. Enter your data to see results and insights here.</p>
            </div>

            <div class="result-error hidden" id="resultError" style="font-size: 24px;"></div>

            <div class="result-value hidden" id="resultValue">
                <div class="rate-value" style="font-size:18px;">
        Equivalent Orifice Area (A<sub>eq</sub>)
    </div>
                <div class="rate-value" id="orificeAreaValue">0.0000</div>
                <div class="rate-label" style="font-size:16px; font-weight:bold;">m²</div>
                <div class="result-feedback" id="feedbackContent"></div>
                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notes Section -->
    <div class="note-section">
        <div class="note-card">
            <h3>📘 About This Calculator</h3>
            <p>
                The <strong>Equivalent Orifice Area (A<sub>eq</sub>)</strong> represents the size of the nozzle opening required to allow a specific discharge of CO₂ gas at a given flow rate. 
                Proper calculation ensures the CO₂ system discharges the correct amount efficiently, optimizing fire suppression performance.
            </p>
        </div>

        <div class="note-card">
    <h3>⚙️ Parameters Used</h3>
            <ul class="note-list">
                <li><strong>Flow Rate (Q):</strong> Volume of CO₂ flow per second (m³/s or L/s).</li>
                <li><strong>Discharge Rate (W):</strong> Amount of CO₂ released per second (kg/s).</li>
               
            </ul>
        </div>

       

        <div class="note-card">
    <h3>📌 Input Validation Rules</h3>
    <ul class="note-list">
        <li>All fields are <strong>mandatory</strong>. Leaving any field empty triggers a warning.</li>
        <li><strong>Numeric values only:</strong> Non-numeric entries are invalid and blocked.</li>
        <li><strong>Positive values required:</strong> Flow Rate (Q) and Discharge Rate (W) must be greater than zero.</li>
        <li><strong>Flow Rate (Q) realistic range:</strong> 0.001 – 50 m³/s or L/s. Values outside this range trigger a caution.</li>
        <li><strong>Discharge Rate (W) realistic range:</strong> 0.001 – 10 kg/s. Values outside this range trigger a caution.</li>
        <li><strong>Division by zero:</strong> W cannot be zero to avoid invalid or infinite orifice area.</li>
        <li><strong>Output threshold checks:</strong> 
            <ul>
                <li>A_eq < 0.0001 m² → undersized nozzle, warn user.</li>
                <li>0.0001 ≤ A_eq ≤ 0.5 m² → nominal, safe range.</li>
                <li>0.5 < A_eq ≤ 1.5 m² → large nozzle, caution.</li>
                <li>A_eq > 1.5 m² → extreme, immediate review required.</li>
            </ul>
        </li>
    </ul>
</div>

<div class="note-card">
    <h3>📊 Output Validations</h3>
    <p>
        This section provides feedback on the <strong>Equivalent Orifice Area</strong> calculated by the tool based on QEHS thresholds:
    </p>
    <ul class="note-list">
        <li>⚠️ Undersized nozzle detected. Check CO₂ flow and discharge rate. (Equivalent Orifice Area &lt; 0.0001 m²)</li>
        <li>✅ Equivalent Orifice Area is within nominal range. (0.0001 ≤ Equivalent Orifice Area ≤ 0.5 m²)</li>
        <li>⚠️ Large orifice detected. Ensure system capacity supports this size. (0.5 &lt; Equivalent Orifice Area ≤ 1.5 m²)</li>
        <li>🚨 Extreme orifice size! Immediate review required. (Equivalent Orifice Area &gt; 1.5 m²)</li>
    </ul>
</div>

<div class="note-card">
    <h3>📐 Governing Principle</h3>
    <p>
        The <strong>Equivalent Orifice Area calculation</strong> is governed by <strong>ISO 5167</strong>, which provides guidance for orifice and nozzle flow measurement. 
        It defines the methodology to determine accurate flow coefficients, ensuring consistent and precise computation of equivalent orifice areas across various applications. 
        Following this standard ensures CO₂ systems discharge efficiently and reliably while ensuring compliance with <strong>NFPA 12</strong> (CO₂ systems), <strong>ISO 14520</strong>, and <strong>OSHA</strong> safety requirements.
    </p>
</div>

        <div class="note-card">
                                    <h3>💡 Conclusion</h3>
            <p>
                Click <strong>"Calculate Orifice Area"</strong> to determine the equivalent nozzle size required for the given CO₂ flow and discharge rate. 
                Ensuring the correct orifice size is crucial for efficient fire suppression.
            </p>
           <p>
                If you need help calculating the Net Hazard Volume, please use the following tool:
            </p>
           <ul style="display:flex; flex-wrap:wrap; justify-content:center; padding:0; margin:0; list-style:none;">
    <li style="margin:10px; flex:1 1 100%; text-align:center;">
        <a href="{% url 'fire_discharge_rate_for_co2_calculator' %}" style="background-color:#1560bd; padding:12px 24px; color:white; border-radius:10px; text-decoration:none; font-weight:500; display:inline-block; width:90%; max-width:300px;">
          Discharge Rate Calculation
        </a>
        </div>
    </div>
</div>

<script>
function calculateOrificeArea() {
    const Qinput = document.getElementById("Q").value.trim();
    const Winput = document.getElementById("W").value.trim();

    const resultValue = document.getElementById("resultValue");
    const placeholder = document.getElementById("placeholder");
    const feedbackContent = document.getElementById("feedbackContent");
    const resultError = document.getElementById("resultError");
    const orificeAreaValue = document.getElementById("orificeAreaValue");

    // Reset display
    resultError.classList.add('hidden');
    resultValue.classList.add('hidden');
    placeholder.classList.add('hidden');
    resultError.innerHTML = "";
    feedbackContent.innerHTML = "";

    // Mandatory field check
    if (Qinput === "" || Winput === "") {
        resultError.innerHTML = "⚠️ Please fill in all required fields.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    const Q = parseFloat(Qinput);
    const W = parseFloat(Winput);

    // Numeric check
    if (isNaN(Q) || isNaN(W)) {
        resultError.innerHTML = "❌ Invalid entry. Numeric values only.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

    // Positive values check
    if (Q <= 0 || W <= 0) {
        resultError.innerHTML = "❌ Flow Rate and Discharge Rate must be greater than zero.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

    // Industry realistic range check
    if (Q < 0.001 || Q > 50) {
        resultError.innerHTML = "⚠️ Flow Rate seems unrealistic. Must be 0.001 – 50 m³/s or L/s.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }
    if (W < 0.001 || W > 10) {
        resultError.innerHTML = "⚠️ Discharge Rate seems unrealistic. Must be 0.001 – 10 kg/s.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    // Calculate Equivalent Orifice Area
    const Aeq = Q / W;
    orificeAreaValue.innerText = Aeq.toFixed(4);
    resultValue.classList.remove('hidden');

    // Output feedback based on QEHS thresholds
    if (Aeq < 0.0001) {
        feedbackContent.innerHTML = "⚠️ Undersized nozzle detected. Check CO₂ flow and discharge rate.";
        feedbackContent.style.color = "orange";
    } else if (Aeq <= 0.5) {
        feedbackContent.innerHTML = "✅ Equivalent Orifice Area is within nominal range.";
        feedbackContent.style.color = "green";
    } else if (Aeq <= 1.5) {
        feedbackContent.innerHTML = "⚠️ Large orifice detected. Ensure system capacity supports this size.";
        feedbackContent.style.color = "orange";
    } else {
        feedbackContent.innerHTML = "🚨 Extreme orifice size! Immediate review required.";
        feedbackContent.style.color = "red";
    }
}

function printReport() {
    window.print();
}

</script>



    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- 1️⃣ Inputs, Outputs, and Formula Analysis

Calculator Purpose:

Computes Equivalent Orifice Area (A_eq) for CO₂ fire suppression systems.

Formula:

𝐴
𝑒
𝑞
=
𝑄
𝑊
A
eq
	​

=
W
Q
	​


Where:

𝑄
Q = Flow Rate of CO₂ (m³/s or L/s)

𝑊
W = Discharge Rate (kg/s)

𝐴
𝑒
𝑞
A
eq
	​

 = Required nozzle orifice area (m²)

Real-World Considerations:

Flow rates and discharge rates are constrained by system specifications (pressure, nozzle size, room volume).

Unrealistic values can indicate user error or misinterpretation of units.

Zero or negative inputs are non-physical and unsafe.

Outputs:

Equivalent Orifice Area (A_eq) in m².

Feedback message indicating proper calculation.

2️⃣ Input Validation Rules (QEHS-Compliant)
Field	Required	Type	Unit	Min	Max	Decimals	Notes
Flow Rate (Q)	✅	Numeric	m³/s or L/s	0.001	50	≤4	Must be physically reasonable for CO₂ systems. Prevents extreme small/large flow.
Discharge Rate (W)	✅	Numeric	kg/s	0.001	10	≤4	Prevent unrealistic CO₂ release; ensures safety and audit compliance.

Additional Cross-Field Rules:

Division by zero: W must never be zero.

Logical consistency: 
𝑄
/
𝑊
Q/W should produce an area within feasible nozzle range (typically 0.0001 – 5 m²).

Extreme outliers: Warn if 
𝐴
𝑒
𝑞
<
0.0001
 
m²
A
eq
	​

<0.0001m² or 
𝐴
𝑒
𝑞
>
5
 
m²
A
eq
	​

>5m².

Edge Cases:

Q = extremely small, W = extremely large → A_eq near zero → warn about undersized nozzle.

Q = extremely large, W = small → A_eq very large → warn about oversize orifice.

Non-numeric or empty input → show warning.

Negative numbers → reject.

3️⃣ Output Validation Logic & Threshold Explanation
Output	Range	Interpretation	QEHS Action
A_eq < 0.0001 m²	Too small	Undersized nozzle; insufficient CO₂ release	⚠️ Review system; increase orifice
0.0001 ≤ A_eq ≤ 0.5 m²	Nominal	Correct size	✅ Safe, standard compliance
0.5 < A_eq ≤ 1.5 m²	Large	CO₂ release high; check system capacity	⚠️ Ensure safe operation; audit check
A_eq > 1.5 m²	Extreme	Oversized nozzle; inefficient	🚨 Immediate review; system redesign

Why important:

Prevents unsafe conditions, over/under CO₂ release.

Ensures compliance with NFPA 12 (CO₂ systems), ISO 14520, OSHA.

Avoids waste, fire suppression failure, or excessive pressure buildup. -->