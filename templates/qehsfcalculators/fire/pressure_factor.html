{% extends 'base.html' %}
{% block title %}Pressure Factor Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
         @media (max-width: 768px) {
    .rate-value {
        font-size: 28px; /* smaller font for tablets/mobiles */
    }
}

@media (max-width: 480px) {
    .rate-value {
        font-size: 24px; /* even smaller for phones */
    }
}
    </style>
</head>
<body>
   <div class="btn-container">
    <a href="{% url 'firecategory_calculators' %}" class="back-btn">Back To Fire Calculators</a>
</div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <div class="calculator-header">
        <h1>Pressure Factor Calculator</h1>
        <p>Determine the pressure drop per unit length in a pipeline to assess flow efficiency and system performance.</p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Data</h2>
            <div class="form-group">
                <label for="p1">Inlet Pressure (P‚ÇÅ) [Pa]</label>
                <input type="number" id="p1" class="form-input" placeholder="Enter inlet pressure" step="any">
            </div>
            <div class="form-group">
                <label for="p2">Pressure at Distance (P‚ÇÇ) [Pa]</label>
                <input type="number" id="p2" class="form-input" placeholder="Enter pressure at distance" step="any">
            </div>
            <div class="form-group">
                <label for="length">Pipe Length (L) [m]</label>
                <input type="number" id="length" class="form-input" placeholder="Enter pipe length" min="0.001" step="any">
            </div>
            <button class="calculate-btn" onclick="calculatePressureFactor()">Calculate Pressure Factor</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <div class="result-placeholder" id="placeholder">
                <img src="{% static 'images/pressure.jpg' %}" alt="Pressure Factor Illustration">
                <p>This tool will calculate the <strong>Pressure Factor</strong>. Enter your data to see results and insights here.</p>
            </div>

            <div class="result-error hidden" id="resultError" style="font-size: 28px;"></div>

            <div class="result-value hidden" id="resultValue">
                <div class="rate-value">Pressure Factor</div>
                <div class="rate-value" id="pressureFactorValue">0.0000</div>
                <div class="rate-label" style="font-size:16px; font-weight:bold;">Pa/m</div>
                <div class="result-feedback" id="feedbackContent"></div>
                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

<!-- Notes Section -->
<div class="note-section">

    <!-- About This Calculator -->
    <div class="note-card">
        <h3>üìò About This Calculator</h3>
        <p>
            The <strong>Pressure Factor Calculator</strong> estimates the <strong>Pressure Factor (F)</strong>, 
            representing the rate of pressure drop per unit length of a pipeline.  
            This is a key parameter in fluid mechanics and pipeline engineering, helping engineers understand how pressure changes along the pipe due to friction, elevation, or other effects.
        </p>
        <p>
            Understanding F is vital to prevent excessive pressure drops (which cause energy losses and inefficient operation) 
            and abnormal pressure gains (which may indicate pump influence or system anomalies).  
            By calculating F, engineers can optimize pipe sizing, select appropriate pumps, and ensure overall system efficiency.
        </p>
    </div>

    <!-- Parameters Used -->
    <div class="note-card">
        <h3>‚öôÔ∏è Parameters Used</h3>
        <ul class="note-list">
            <li><strong>Inlet Pressure (P‚ÇÅ)</strong>: Pressure at the start of the pipe (Pa).</li>
            <li><strong>Pressure at Distance (P‚ÇÇ)</strong>: Pressure at a length L along the pipe (Pa).</li>
            <li><strong>Pipe Length (L)</strong>: Distance over which the pressure drop is measured (m).</li>
            <li><strong>Pressure Factor (F)</strong>: Rate of pressure drop per unit length (Pa/m).</li>
        </ul>
    </div>

    <!-- Input Validation Rules -->
<div class="note-card">
    <h3>‚úÖ Input Validation Rules</h3>
    <ul class="note-list">
        <li><strong>Mandatory Fields:</strong> P‚ÇÅ, P‚ÇÇ, and L must be provided; empty inputs trigger a warning.</li>
        <li><strong>Numeric Values Only:</strong> Only numeric entries allowed; non-numeric triggers an error.</li>
        <li><strong>Pipe Length (L):</strong> 0.01 m ‚â§ L ‚â§ 10,000 m; must be &gt; 0 to avoid division by zero.</li>
        <li><strong>Inlet Pressure (P‚ÇÅ):</strong> 0 Pa ‚â§ P‚ÇÅ ‚â§ 10,000,000 Pa (0‚Äì10 MPa); ensures industrial realism.</li>
        <li><strong>Pressure at Distance (P‚ÇÇ):</strong> 0 Pa ‚â§ P‚ÇÇ ‚â§ 10,000,000 Pa (0‚Äì10 MPa); normally P‚ÇÇ ‚â§ P‚ÇÅ, otherwise caution for pump influence or anomaly.</li>
        <li><strong>Decimal Precision:</strong> Up to 4 decimal places for all inputs.</li>
        <li><strong>Unit Consistency:</strong> Use Pa for pressures and meters for length only.</li>
        <li><strong>Cross-Field Check:</strong> If P‚ÇÇ &gt; P‚ÇÅ, display warning ‚ÄúPump boost or system anomaly suspected.‚Äù</li>
        <li><strong>Extreme Values:</strong> P‚ÇÅ or P‚ÇÇ &gt; 10 MPa triggers a caution message for exceeding typical design limits.</li>
    </ul>
</div>


    <!-- Output Validations -->
   <div class="note-card">
    <h3>üìä Output Validations</h3>
    <p>
        The output validations below help interpret the calculated Pressure Factor (F) values. 
        Each range represents a specific system condition, allowing users to quickly identify whether 
        the pressure behavior is normal, moderate, or critical, and take appropriate action accordingly.
    </p>
    <ul class="note-list">
        <li>‚úÖ <strong>F > 0 and ‚â§ 1000 Pa/m:</strong> Normal Pressure Drop: Within safe operating limits for pipelines and fire protection systems.</li>
        <li>‚ö†Ô∏è <strong>F > 1000 and ‚â§ 5000 Pa/m:</strong> Moderate Pressure Drop: Monitor system; may indicate friction, scaling, or minor obstructions.</li>
        <li>üö® <strong>F > 5000 Pa/m:</strong> High Pressure Drop: Risk of pipeline strain, blockage, or fire system inefficiency ‚Äì inspection advised.</li>
        <li>‚ö†Ô∏è <strong>F < 0:</strong>  Pressure Gain Detected: Possible pump influence, backpressure, or measurement error.</li>
        <li>‚ùå <strong>F = 0:</strong>  No Pressure Change: Verify input values; possible blocked or static system.</li>
    </ul>
</div>


    <!-- Governing Principle -->
  <div class="note-card">
    <h3>üìê Governing Principle</h3>
    <p>
        A Pressure Factor Calculator isn't tied to one specific standard; it is a tool to perform calculations based on various pressure units and conversion factors, such as the International System of Units (SI), Imperial units (like psi), and others like bar, atmospheres, and manometric units. The relevant standard depends entirely on the context or industry in which the calculator is being used.
    </p>
    <h3>How Pressure Factor Calculators Work</h3>
    <ul>
        <li><strong>Pressure Unit Conversion:</strong> These calculators convert pressure values between different units, such as converting from pounds per square inch (psi) to kilopascals (kPa).</li>
        <li><strong>Defining Pressure:</strong> Pressure itself is a fundamental physical quantity defined as force applied per unit area (P = F/A).</li>
        <li><strong>Context is Key:</strong> The specific "standard" a calculator uses depends on the application:</li>
        <ul style="margin-left: 20px;">
            <li><strong>Engineering:</strong> May use SI units like Pascals (Pa) or Megapascals (MPa).</li>
            <li><strong>Industrial:</strong> Might use units like pounds per square inch (psi) or bars.</li>
            <li><strong>Scientific:</strong> Often employs SI units or sometimes standard atmospheric pressure (atm) for specific measurements.</li>
        </ul>
    </ul>
</div>


    <!-- Conclusion -->
    <div class="note-card">
        <h3>üèÅ Conclusion</h3>
        <p>
            This calculator allows engineers and safety officers to quickly determine the pressure factor along a pipeline.  
            By combining validated inputs, output thresholds, and adherence to the ASME standard, the tool ensures safe, reliable, and auditable assessments.  
            Feedback provided alongside results directly informs operational decisions, highlighting normal, moderate, or critical pressure conditions in pipelines and related systems.
        </p>
    </div>

</div>


<script>
function calculatePressureFactor() {
    const inletPressureInput = document.getElementById('p1').value.trim();
    const pressureAtDistanceInput = document.getElementById('p2').value.trim();
    const pipeLengthInput = document.getElementById('length').value.trim();

    const resultValue = document.getElementById('resultValue');
    const placeholder = document.getElementById('placeholder');
    const feedbackContent = document.getElementById('feedbackContent');
    const resultError = document.getElementById('resultError');

    // Reset previous outputs and messages
    resultError.classList.add('hidden');
    resultValue.classList.add('hidden');
    placeholder.classList.add('hidden');
    resultError.innerHTML = "";
    feedbackContent.innerHTML = "";

    // ---- Mandatory Field Check ----
    if (inletPressureInput === "" || pressureAtDistanceInput === "" || pipeLengthInput === "") {
        resultError.innerHTML = "‚ö†Ô∏è All fields are required: Inlet Pressure, Pressure at Distance, and Pipe Length.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    // Parse inputs as floats
    const inletPressure = parseFloat(inletPressureInput);
    const pressureAtDistance = parseFloat(pressureAtDistanceInput);
    const pipeLength = parseFloat(pipeLengthInput);

    // ---- Numeric Validation ----
    if (isNaN(inletPressure) || isNaN(pressureAtDistance) || isNaN(pipeLength)) {
        resultError.innerHTML = "‚ùå Invalid input. Only numeric values are accepted for Inlet Pressure, Pressure at Distance, and Pipe Length.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

    // ---- Range & Logical Checks ----
    if (pipeLength <= 0) {
        resultError.innerHTML = "‚ùå Pipe Length must be greater than zero (0.01 m ‚Äì 10,000 m) to avoid division by zero errors.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

    if (inletPressure < 0 || pressureAtDistance < 0) {
        resultError.innerHTML = "‚ùå Negative pressures are physically invalid. Enter values ‚â• 0 Pa.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

    if (inletPressure > 10000000 || pressureAtDistance > 10000000) {
        resultError.innerHTML = "‚ö†Ô∏è Pressure input exceeds typical industrial range (0 ‚Äì 10,000,000 Pa or 0 ‚Äì 10 MPa). Verify against ASME or ISO pressure class ratings.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    if (pressureAtDistance > inletPressure) {
        resultError.innerHTML = "‚ö†Ô∏è Pressure at Distance exceeds Inlet Pressure ‚Äì possible pump boost, elevation gain, or measurement anomaly. Proceed with caution.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        // Continue calculation but display caution
    }

    // ---- Calculate Pressure Factor (Pa/m) ----
    const pressureFactor = (inletPressure - pressureAtDistance) / pipeLength;
    document.getElementById('pressureFactorValue').innerText = pressureFactor.toFixed(4);
    resultValue.classList.remove('hidden');

    // ---- Feedback Logic Based on QEHS Standards ----
    let feedbackMessage = "";
    if (pressureFactor > 0 && pressureFactor <= 1000) {
        feedbackMessage = "‚úÖ Normal Pressure Drop: Within safe operating limits for pipelines and fire protection systems.";
        feedbackContent.style.color = "green";
    } else if (pressureFactor > 1000 && pressureFactor <= 5000) {
        feedbackMessage = "‚ö†Ô∏è Moderate Pressure Drop: Monitor system; may indicate friction, scaling, or minor obstructions.";
        feedbackContent.style.color = "orange";
    } else if (pressureFactor > 5000) {
        feedbackMessage = "üö® High Pressure Drop: Risk of pipeline strain, blockage, or fire system inefficiency ‚Äì inspection advised.";
        feedbackContent.style.color = "red";
    } else if (pressureFactor < 0) {
        feedbackMessage = "‚ö†Ô∏è Pressure Gain Detected: Possible pump influence, backpressure, or measurement error.";
        feedbackContent.style.color = "orange";
    } else {
        feedbackMessage = "‚ùå No Pressure Change: Verify input values; possible blocked or static system.";
        feedbackContent.style.color = "red";
    }

    feedbackContent.innerHTML = feedbackMessage;
}
</script>




    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- üß© 1Ô∏è‚É£ Real-World QEHS & Fire Safety Analysis

The Pressure Factor (F) = (P‚ÇÅ ‚àí P‚ÇÇ) / L
represents pressure drop per unit length, crucial for evaluating:

Pump and compressor performance

Flow losses and friction in piping systems

Fire suppression network performance (e.g., hydrants, sprinklers)

Ventilation duct design under OSHA indoor air standards

High-pressure gas or chemical systems (NFPA 30, 55, 99)

Why it matters:

Excessive pressure drops ‚Üí reduced system reliability, potential fire water unavailability, or compressor overheating.

Zero/negative drops ‚Üí pump backpressure or reverse flow hazards.

Out-of-range readings ‚Üí risk of mechanical failure, pipe burst, or OSHA Process Safety Management non-compliance.

üìä 2Ô∏è‚É£ Comprehensive Input Validation Rules
Parameter	Unit	Acceptable Range	Validation Rule	Reason / Standard Reference
P‚ÇÅ (Inlet Pressure)	Pascal (Pa)	0 to 10,000,000 Pa (10 MPa)	Must be ‚â• 0 and ‚â§ 10 MPa	ASME B31.3 and NFPA 30/99 piping safety limits
P‚ÇÇ (Pressure at distance)	Pascal (Pa)	0 to 10,000,000 Pa (10 MPa)	Must be ‚â• 0 and ‚â§ P‚ÇÅ in passive systems; can exceed P‚ÇÅ only if pump assist or booster indicated	Prevents misinterpretation and enforces physical realism
L (Pipe Length)	meter (m)	0.01 to 10,000 m	Must be > 0.01 m to avoid division by zero	ISO 5167 flow measurement principles
Decimal Precision	‚Äî	Up to 4 decimals	Values beyond 4 decimals are rounded	Maintains practical precision per ISO 5167-1
Unit Consistency	‚Äî	Pa and m only	All inputs must share same unit system	Prevents incorrect conversions between psi/bar/Pa
Cross-Field Validation	‚Äî	‚Äî	If P‚ÇÇ > P‚ÇÅ, show warning ‚ÄúPump or elevation gain suspected‚Äù	Ensures logical consistency and helps in hazard identification
Extreme Pressure Alert	‚Äî	P‚ÇÅ or P‚ÇÇ > 10 MPa	Warn user: ‚ÄúPressure exceeds standard design limit; use pressure-rated piping per ASME Section VIII‚Äù	Protects from exceeding design strength of standard Class 150-300 pipes
‚öôÔ∏è 3Ô∏è‚É£ Edge Case Validations
Scenario	Risk / Meaning	Action
Division by zero (L = 0)	Infinite pressure factor, invalid physical scenario	Block calculation and show ‚ÄúPipe length must be > 0‚Äù
Negative pressures	Physically impossible for most industrial liquids	Show ‚ÄúInvalid input: negative pressures not allowed‚Äù
P‚ÇÅ = P‚ÇÇ	No pressure change	Show feedback ‚ÄúVerify inputs ‚Äì possible blocked or static system‚Äù
P‚ÇÇ > P‚ÇÅ significantly	Indicates pump boost or reverse flow	Warn ‚ÄúPossible pump influence or measurement error‚Äù
Unrealistically high drop (F > 5000 Pa/m)	Potential blockage or pipe damage	Alert ‚ÄúHigh loss ‚Äì inspect for fouling, scaling, or valve closure‚Äù
Extremely low drop (F < 1 Pa/m)	May indicate oversized pipe or sensor error	Suggest verification for accuracy
Non-numeric / empty	Input error	Prevent calculation and show user-friendly warning
üìà 4Ô∏è‚É£ Output Validation Logic & Interpretation
Range (Pa/m)	Condition	Interpretation	QEHS/Fire Safety Meaning
0 < F ‚â§ 1000	‚úÖ Normal	System within safe design limit	Normal flow, no safety concerns
1000 < F ‚â§ 5000	‚ö†Ô∏è Moderate	Flow restriction or partial scaling	Reduced efficiency, maintenance due
F > 5000	üö® High	Abnormal loss or obstruction	High energy loss, check for fire loop blockage or line rupture
F = 0	‚ùå None	Static or blocked system	Could affect firefighting line readiness
F < 0	‚ö†Ô∏è Reverse	Pump effect or backpressure	Investigate for backflow, pump malfunction

These outputs align with NFPA 14, ISO 4126, and ASME B31.1 guidelines for maintaining pressure integrity and avoiding unsafe hydraulic conditions. -->