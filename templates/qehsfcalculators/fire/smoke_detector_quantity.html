{% extends 'base.html' %}
{% block title %}Smoke detector quantity calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
         @media (max-width: 768px) {
    .rate-value {
        font-size: 28px; /* smaller font for tablets/mobiles */
    }
}

@media (max-width: 480px) {
    .rate-value {
        font-size: 24px; /* even smaller for phones */
    }
}
.field-warning {
    font-size: 13px;
    color: orange;
    margin-top: 4px;
}

    </style>
</head>
<body>
   <div class="btn-container">
    <a href="{% url 'firecategory_calculators' %}" class="back-btn">Back To Fire Calculators</a>
</div>
<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <!-- Header -->
    <div class="calculator-header">
        <h1>Smoke Detector Quantity Calculator</h1>
        <p>Determine the minimum number of smoke detectors required based on area coverage and protection level.</p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Data</h2>
<div class="form-group">
    <label for="area">Total Area to be Protected (S) (m¬≤)</label>
    <input type="number" id="area" class="form-input" placeholder="Enter total area">
    <div id="areaWarning" class="field-warning"></div>
</div>
<div class="form-group">
    <label for="coverage">Coverage Area per Detector (A) (m¬≤)</label>
    <input type="number" id="coverage" class="form-input" placeholder="Enter coverage area per detector">
    <div id="coverageWarning" class="field-warning"></div>
</div>
<div class="form-group">
    <label for="coefficient">Correction Coefficient (K)</label>
    <select id="coefficient" class="form-input">
        <option value="">-- Select Protection Level --</option>
        <option value="0.75">Special Protection (0.7‚Äì0.8)</option>
        <option value="0.85">First-Class Protection (0.8‚Äì0.9)</option>
        <option value="0.95">Second-Class Protection (0.9‚Äì1)</option>
    </select>
    <div id="coefficientWarning" class="field-warning"></div>
</div>

            <button class="calculate-btn" onclick="calculateSmokeDetectorQuantity()">Calculate Required Detectors</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <!-- Placeholder -->
            <div class="result-placeholder" id="placeholder">
                <img src="{% static 'images/smoke.jpg' %}" alt="Smoke Detector Illustration">
                <p>This tool will calculate the <strong>minimum number of smoke detectors</strong>. Enter your data to see results and insights here.</p>
            </div>

            <!-- Error -->
            <div class="result-error hidden" id="resultError" style="font-size: 22px;"></div>

            <!-- Result -->
            <div class="result-value hidden" id="resultValue">
                <div class="rate-value">Required Detectors</div>
                <div class="rate-value" id="detectorValue">0</div>
                <div class="rate-label" style="font-size:16px; font-weight:bold;">units</div>
                <div class="result-feedback" id="feedbackContent"></div>
                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

   <!-- Notes Section -->
   <div class="note-section">

    <!-- About This Calculator -->
    <div class="note-card">
        <h3>üìò About This Calculator</h3>
        <p>
            This calculator determines the <strong>minimum number of smoke detectors</strong> needed for effective fire detection in a space. 
            It considers total area, detector coverage, and an adjustment factor reflecting the required protection level.
        </p>
        <p>
            The result is always rounded up to ensure full coverage, as detectors cannot be fractional. This helps maintain compliance with 
            fire safety regulations such as <strong>NFPA 72</strong>, <strong>EN standards</strong>, or local building codes.
        </p>
    </div>

    <!-- Parameters Used -->
    <div class="note-card">
        <h3>‚öôÔ∏è Parameters Used</h3>
        <ul class="note-list">
            <li><strong>Total Area to be Protected (S):</strong> Total surface area (m¬≤) to be monitored.</li>
            <li><strong>Coverage Area per Detector (A):</strong> Manufacturer or code-defined coverage of one detector (m¬≤).</li>
            <li><strong>Correction Coefficient (K):</strong> Adjustment factor for protection level:
                <ul>
                    <li>Special Protection (0.7‚Äì0.8): High-risk areas.</li>
                    <li>First-Class Protection (0.8‚Äì0.9): Standard office/commercial spaces.</li>
                    <li>Second-Class Protection (0.9‚Äì1): Low-risk environments.</li>
                </ul>
            </li>
        </ul>
    </div>

    <!-- Input Validation Rules -->
    <div class="note-card">
        <h3>‚úÖ Input Validation Rules</h3>
        <ul class="note-list">
            <li>All fields are <strong>mandatory</strong>; empty or missing values trigger a calculation error.</li>
            <li>Numeric values only; non-numeric inputs will trigger an error.</li>
            <li>Positive values required; zero or negative numbers are invalid.</li>
            <li>Total Area (S) must be > 0; >100,000 m¬≤ triggers a caution warning.</li>
            <li>Coverage per Detector (A) must be > 0; >500 m¬≤ triggers a caution warning.</li>
            <li>Correction Coefficient (K) must be within 0.7‚Äì1.0; outside range triggers a caution warning.</li>
            <li>Errors appear in the result box; warnings appear under input fields.</li>
        </ul>
    </div>

    <!-- Output Validations -->
  <!-- Output Validations -->
<div class="note-card">
    <h3>üßæ Output Validations</h3>
    <ul class="note-list">
        <li>detectorsRequired ‚â§ 5 ‚Üí ‚úÖ Low requirement: Suitable for small areas, ensure spacing meets standards.</li>
        <li>5 < detectorsRequired ‚â§ 20 ‚Üí ‚ö†Ô∏è Moderate requirement: Ensure proper zoning and placement.</li>
        <li>20 < detectorsRequired ‚â§ 100 ‚Üí üö® High requirement: Large facility, detailed fire system design needed.</li>
        <li>detectorsRequired > 100 ‚Üí üî¥ Extreme requirement: Very large/high-risk facility, professional fire safety engineering required.</li>
    </ul>
</div>

    <!-- Governing Principle -->
<div class="note-card">
    <h3>üìè Governing Principle</h3>
    <p>
        A smoke detector quantity calculator is based on international and regional standards such as the 
        NFPA 72 (National Fire Protection Association), BS 5839 (British Standard), EN 54 (European Standard), 
        and IS 2189 (Indian Standard) for fire detection and alarm systems. 
        The specific standard a calculator adheres to determines the coverage area per detector, placement rules, and other factors.
    </p>
    <p>
        Here are some examples of standards and their influence on smoke detector quantity calculation:
    </p>
    <ul class="note-list">
        <li>
            <strong>NFPA 72 (USA):</strong> This standard provides guidelines for detector spacing and coverage, 
            typically for smooth, flat ceilings, often resulting in a maximum coverage area per detector of around 
            84 square meters (900 sq ft).
        </li>
        <li>
            <strong>BS 5839 (UK) & EN 54 (Europe):</strong> These standards also define smoke detector coverage, 
            with BS 5839 often citing a coverage area of approximately 60 square meters per detector.
        </li>
        <li>
            <strong>IS 2189 (India):</strong> The Indian standard for fire detection systems, IS 2189, 
            aligns with BS 5839 in its requirements for smoke detector spacing and coverage.
        </li>
    </ul>
    <p>
        When using a calculator, it's essential to understand which local or international standard it is following, 
        as it will affect the number of detectors and their placement.
    </p>
</div>

    <!-- Conclusion -->
    <div class="note-card">
        <h3>üìå Conclusion</h3>
        <p>
            This calculator provides a quick estimate of smoke detector requirements based on area, coverage, and protection level. 
            Feedback indicates low, moderate, high, or extreme requirements, guiding fire safety planning and compliance with NFPA 72, EN standards, and local codes. 
            Always validate with manufacturer guidelines and professional assessment for final implementation.
        </p>
    </div>

</div>

</div>

<script>
function calculateSmokeDetectorQuantity() {
    const areaInput = document.getElementById('area').value.trim();
    const coverageInput = document.getElementById('coverage').value.trim();
    const coefficientInput = document.getElementById('coefficient').value.trim();

    const resultValue = document.getElementById('resultValue');
    const placeholder = document.getElementById('placeholder');
    const feedbackContent = document.getElementById('feedbackContent');
    const resultError = document.getElementById('resultError');

    // Warning fields
    const areaWarning = document.getElementById('areaWarning');
    const coverageWarning = document.getElementById('coverageWarning');
    const coefficientWarning = document.getElementById('coefficientWarning');

    // Reset
    resultError.classList.add('hidden');
    resultValue.classList.add('hidden');
    placeholder.classList.add('hidden');
    resultError.innerHTML = "";
    feedbackContent.innerHTML = "";
    areaWarning.innerHTML = "";
    coverageWarning.innerHTML = "";
    coefficientWarning.innerHTML = "";

    // Empty check
    if (areaInput === "" || coverageInput === "" || coefficientInput === "") {
        resultError.innerHTML = "‚ö†Ô∏è Please fill in all required fields.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

    const S = parseFloat(areaInput);
    const A = parseFloat(coverageInput);
    const K = parseFloat(coefficientInput);

    // Numeric + positivity checks
    if (isNaN(S) || isNaN(A) || isNaN(K)) {
        resultError.innerHTML = "‚ùå Invalid entry. Please enter numeric values only.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }
    if (S <= 0) {
        resultError.innerHTML = "‚ùå Total Area must be greater than zero.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }
    if (A <= 0) {
        resultError.innerHTML = "‚ùå Coverage Area per Detector must be greater than zero.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

    // Field-level warnings (non-blocking)
    if (S > 100000) {
        areaWarning.innerHTML = "‚ö†Ô∏è Very large area (>100,000 m¬≤). Please verify the total area and detector coverage input values.";
    }
    if (A > 500) {
        coverageWarning.innerHTML = "‚ö†Ô∏è Coverage per detector seems unrealistic (>500 m¬≤). Please verify.";
    }
    if (K < 0.7 || K > 1.0) {
        coefficientWarning.innerHTML = "‚ö†Ô∏è Coefficient should usually be between 0.7 and 1.0.";
    }

    // Calculation
    const N = S / (K * A);
    if (!isFinite(N)) {
        resultError.innerHTML = "‚ùå Calculation error. Please check your inputs.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

    const detectorsRequired = Math.ceil(N);
    document.getElementById('detectorValue').innerText = detectorsRequired;
    resultValue.classList.remove('hidden');

    // Feedback
    let feedback = "";
    if (detectorsRequired <= 5) {
        feedback = "‚úÖ Low requirement: Suitable for small areas, ensure spacing meets standards.";
        feedbackContent.style.color = "green";
    } else if (detectorsRequired <= 20) {
        feedback = "‚ö†Ô∏è Moderate requirement: Ensure proper zoning and placement.";
        feedbackContent.style.color = "orange";
    } else if (detectorsRequired <= 100) {
        feedback = "üö® High requirement: Large facility, detailed fire system design needed.";
        feedbackContent.style.color = "red";
    } else {
        feedback = "üî¥ Extreme requirement: Very large/high-risk facility, professional fire safety engineering required.";
        feedbackContent.style.color = "darkred";
    }
    feedbackContent.innerHTML = feedback;
}
</script>


    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


