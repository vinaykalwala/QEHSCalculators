{% extends 'base.html' %}
{% block title %}Burn Rate Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
         @media (max-width: 768px) {
    .rate-value {
        font-size: 28px; /* smaller font for tablets/mobiles */
    }
}

@media (max-width: 480px) {
    .rate-value {
        font-size: 24px; /* even smaller for phones */
    }
}
    </style>
</head>
<body>
   <div class="btn-container">
    <a href="{% url 'firecategory_calculators' %}" class="back-btn">Back To Fire Calculators</a>
</div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <div class="calculator-header">
        <h1>Burn Rate Calculator</h1>
        <p>Determine the concentration of a released substance per cubic meter per hour to assess fire, explosion, or toxic exposure risk.</p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Data</h2>
            <div class="form-group">
                <label for="releaseRate">Rate of Release (kg/hr)</label>
                <input type="number" id="releaseRate" class="form-input" placeholder="Enter Rate of Release">
            </div>
            <div class="form-group">
                <label for="spaceVolume">Volume of Space (m¬≥)</label>
                <input type="number" id="spaceVolume" class="form-input" placeholder="Enter Volume of Space">
            </div>
            <button class="calculate-btn" onclick="calculateBurnRate()">Calculate Burn Rate</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <!-- Placeholder -->
            <div class="result-placeholder" id="placeholder">
                <img src="{% static 'images/burn.png' %}" alt="Burn Rate Illustration">
                <p>This tool will calculate the <strong>Burn Rate</strong>. Enter your data to see results and insights here.</p>
            </div>

            <!-- Error -->
            <div class="result-error hidden" id="resultError" style="font-size: 28px;"></div>

            <!-- Result -->
            <div class="result-value hidden" id="resultValue">
                <div class="rate-value">Burn Rate</div>

                <div class="rate-value" id="burnRateValue">0.0000</div>
                <div class="rate-label" style="font-size:16px; font-weight:bold;">kg/m¬≥ per hour</div>
                <div class="result-feedback" id="feedbackContent"></div>
                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

   <!-- Notes Section -->
   <!-- Notes Section -->
<div class="note-section">

    <!-- About This Calculator -->
    <div class="note-card">
        <h3>üìò About This Calculator</h3>
        <p>
            This calculator helps determine the <strong>burn rate</strong>, which represents the concentration of a released substance per cubic meter per hour. 
            It is an important factor in fire safety and hazardous material management, as it helps assess the risk of fire, explosion, 
            or toxic exposure in an enclosed space.
        </p>
    </div>

    <!-- Parameters -->
    <div class="note-card">
    <h3>‚öôÔ∏è Parameters Used</h3>
        <ul class="note-list">
            <li><strong>Rate of Release (kg/hr):</strong> Amount of a substance (gas, vapor, or particulate) released into the space every hour.
                <ul>
                    <li>Measured in kilograms per hour (kg/hr).</li>
                    <li>A higher rate of release means more substance accumulates in the space, increasing potential hazard.</li>
                </ul>
            </li>
            <li><strong>Volume of Space (m¬≥):</strong> Total enclosed volume where the released substance disperses.
                <ul>
                    <li>Measured in cubic meters (m¬≥).</li>
                    <li>Larger spaces allow better dispersion and lower concentration, reducing risk.</li>
                    <li>Smaller spaces with poor ventilation can lead to higher accumulation, increasing danger.</li>
                </ul>
            </li>
           
        </ul>
    </div>
 <!-- Validations -->
   <div class="note-card">
    <h3>üìå Input Validation Rules</h3>
    <ul class="note-list">
        <li><strong>Mandatory Fields:</strong> All fields must be filled. Leaving any empty triggers a warning: 
            <code>"‚ö†Ô∏è Please fill in all required fields."</code>
        </li>
        <li><strong>Numeric Values Only:</strong> Non-numeric entries are invalid. Error displayed as: 
            <code>"‚ùå Invalid entry. Please enter numeric values only."</code>
        </li>
        <li><strong>Positive Values Required:</strong> Zero or negative numbers are invalid.
            <ul>
                <li>Rate of Release ‚â§ 0 ‚Üí <code>"‚ùå Rate of Release must be greater than zero."</code></li>
                <li>Volume of Space ‚â§ 0 ‚Üí <code>"‚ùå Volume of Space must be greater than zero."</code></li>
            </ul>
        </li>
        <li><strong>Rate of Release (kg/hr):</strong>
            <ul>
                <li>Type: Positive real number, decimals allowed (up to 4 places).</li>
                <li>Minimum: > 0.0001 kg/hr (values lower are negligible or likely input error).</li>
                <li>Maximum: 10,000 kg/hr (extremely high values trigger caution warning: 
                    <code>"‚ö†Ô∏è Input seems unrealistic (&gt;10,000 kg/hr). Please verify units."</code>
                ).</li>
                <li>Unit consistency: Must be in kg/hr. Conversion needed if other units are used.</li>
            </ul>
        </li>
        <li><strong>Volume of Space (m¬≥):</strong>
            <ul>
                <li>Type: Positive real number, decimals allowed (up to 2 places).</li>
                <li>Minimum: 1 m¬≥ (smaller volumes are illogical for safety monitoring).</li>
                <li>Maximum: 1,000,000 m¬≥ (very large spaces trigger caution warning: 
                    <code>"‚ö†Ô∏è Very large space volume entered (&gt;1,000,000 m¬≥). Please verify units."</code>
                ).</li>
                <li>Unit consistency: Must be in cubic meters.</li>
            </ul>
        </li>
        <li><strong>Cross-Field Validation:</strong>
            <ul>
                <li>Division by zero prevented (space volume cannot be zero).</li>
                <li>Trace amounts: <code>releaseRate &lt; 0.001 kg/hr</code> with very large space (&gt;100,000 m¬≥) shows negligible risk message.</li>
            </ul>
        </li>
        <li><strong>Error Handling:</strong> Any validation failure will:
            <ul>
                <li>Display a clear error/warning message in the result box.</li>
                <li>Hide the default placeholder or previous results.</li>
            </ul>
        </li>
           </ul>
</div>

    <!-- Interpretation -->
   <div class="note-card">
    <h3>üìä Output Validations</h3>
    <ul class="note-list">
        <li>‚úÖ <strong>Low Burn Rate (&lt; 0.01):</strong> Safe conditions. Ensure ventilation and monitoring.</li>
        <li>‚ö†Ô∏è <strong>Moderate Burn Rate (0.01 ‚Äì 0.1):</strong> Monitor environment, consider PPE and ventilation.</li>
        <li>üö® <strong>High Burn Rate (0.1 ‚Äì 1.0):</strong> Immediate action required! Increase ventilation and reduce release.</li>
        <li>üî¥ <strong>Extreme Hazard (&gt; 1.0):</strong> Catastrophic release scenario. Evacuate and follow emergency protocols.</li>
    </ul>
</div>

<div class="note-card">
    <h3>üìê Governing Principle</h3>
    <p>
        The <strong>Burn Rate Calculator</strong> aligns with recognized occupational safety standards to assess chemical release hazards in enclosed spaces.
    </p>
    <ul class="note-list">
        <li><strong>OSHA 29 CFR 1910.1200 Appendix B:</strong> Defines how burn rate is used to classify flammable and combustible chemical hazards. It provides test methods and criteria for regulatory hazard communication.</li>
        <li><strong>NFPA Standards:</strong> Guides classification of burn rates into hazard levels for fire and explosion risk mitigation.</li>
            </ul>
    <p>
        These standards provide the framework for input validation, threshold categorization, and actionable feedback in this calculator, ensuring scientifically and legally sound hazard assessment.
    </p>
</div>

   

    <!-- Usage -->
    <div class="note-card">
                <h3>üí° Conclusion</h3>
        <p>
            Click <strong>"Calculate Burn Rate"</strong> to determine the concentration of the released substance in the given space. 
            Understanding and managing this value is crucial for workplace safety, fire prevention, and environmental compliance.
        </p>
    </div>

</div>

</div>

<script>
function calculateBurnRate() {
    const releaseRateInput = document.getElementById('releaseRate').value.trim();
    const spaceVolumeInput = document.getElementById('spaceVolume').value.trim();
    const resultValue = document.getElementById('resultValue');
    const placeholder = document.getElementById('placeholder');
    const feedbackContent = document.getElementById('feedbackContent');
    const resultError = document.getElementById('resultError');

    // Reset display states
    resultError.classList.add('hidden');
    resultValue.classList.add('hidden');
    placeholder.classList.add('hidden'); // Always hide placeholder once button clicked
    resultError.innerHTML = "";
    feedbackContent.innerHTML = "";

    // Empty check
    if (releaseRateInput === "" || spaceVolumeInput === "") {
        resultError.innerHTML = "‚ö†Ô∏è Please fill in all required fields.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    const releaseRate = parseFloat(releaseRateInput);
    const spaceVolume = parseFloat(spaceVolumeInput);

    // Validation
    if (isNaN(releaseRate) || isNaN(spaceVolume)) {
        resultError.innerHTML = "‚ùå Invalid entry. Please enter numeric values only.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

    if (releaseRate <= 0) {
        resultError.innerHTML = "‚ùå Rate of Release must be greater than zero.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

    if (spaceVolume <= 0) {
        resultError.innerHTML = "‚ùå Volume of Space must be greater than zero.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

   if (releaseRate > 10000) {
    resultError.innerHTML = "‚ö†Ô∏è Rate of Release seems unrealistic (>10,000 kg/hr). Please verify units.";
    resultError.style.color = "orange";
    resultError.classList.remove('hidden');
    return;
}

if (spaceVolume > 1000000) {
    resultError.innerHTML = "‚ö†Ô∏è Volume of Space seems very large (>1,000,000 m¬≥). Please verify units.";
    resultError.style.color = "orange";
    resultError.classList.remove('hidden');
    return;
}


    // Calculation
    const burnRate = releaseRate / spaceVolume;

    document.getElementById('burnRateValue').innerText = burnRate.toFixed(4);
    resultValue.classList.remove('hidden');

    // Feedback logic
    let feedback = "";
    if (burnRate < 0.01) {
        feedback = "‚úÖ Low Burn Rate: Safe conditions. Ensure ventilation and monitoring.";
        feedbackContent.style.color = "green";
    } else if (burnRate <= 0.1) {
        feedback = "‚ö†Ô∏è Moderate Burn Rate: Monitor environment, consider PPE and ventilation.";
        feedbackContent.style.color = "orange";
    } else if (burnRate <= 1.0) {
        feedback = "üö® High Burn Rate: Immediate action required! Increase ventilation and reduce release.";
        feedbackContent.style.color = "red";
    } else {
        feedback = "üî¥ Extreme Hazard: Catastrophic release scenario. Evacuate and follow emergency protocols.";
        feedbackContent.style.color = "darkred";
    }
    feedbackContent.innerHTML = feedback;
}

function printReport() {
    window.print();
}
</script>


    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- 1. Input Validation Rules (Industry-Based)
1.1 Rate of Release (kg/hr)

Type: Positive real number (decimal allowed).

Minimum: > 0.0001 kg/hr (values lower than this are negligible, may indicate input error).

Maximum: 10,000 kg/hr (extremely large for enclosed environments; anything beyond should trigger a warning).

Decimals: Up to 4 decimal places (to capture precision in gas/vapor release monitoring).

Unit Consistency: Always in kg/hr (user should not enter g/hr, but if UI extended, automatic conversion is required).

1.2 Volume of Space (m¬≥)

Type: Positive real number.

Minimum: 1 m¬≥ (anything smaller is illogical for occupational safety, unless micro-chamber analysis).

Maximum: 1,000,000 m¬≥ (e.g., warehouses, hangars). Above this, safety monitoring usually requires CFD modeling.

Decimals: Up to 2 decimal places (more precision unnecessary for room dimensions).

Unit Consistency: Always in cubic meters.

1.3 Cross-field Validation

Must prevent division by zero (space volume cannot be zero).

Must reject unrealistic ratios:

If releaseRate / spaceVolume > 10 kg/m¬≥¬∑hr, it‚Äôs an extreme hazard and should trigger an emergency warning output.

If releaseRate < 0.001 and spaceVolume > 100,000, result is negligible ‚Üí should display "trace amount, negligible risk".

2. Output Validation & Thresholds

Based on NFPA fire/explosion guidelines and OSHA exposure assessments:

Burn Rate (kg/m¬≥¬∑hr)	Interpretation	Why it Matters
< 0.01	‚úÖ Low Burn Rate	Safe, within ventilation capacity.
0.01 ‚Äì 0.1	‚ö†Ô∏è Moderate	Requires continuous monitoring, possible PPE, OSHA exposure checks.
0.1 ‚Äì 1.0	üö® High	Dangerous accumulation; fire/explosion/exposure possible. Requires immediate corrective action.
> 1.0	üî¥ Extreme Hazard	Impractical for safe work; indicates catastrophic release scenario (e.g., pipeline rupture).
3. Edge Case Validations

Empty inputs ‚Üí Error box: "Please fill in all required fields."

Negative or zero values ‚Üí Error: "Inputs must be positive numbers."

Non-numeric values ‚Üí Error: "Invalid entry. Please enter numeric values only."

Division by zero ‚Üí Explicit block: "Space Volume cannot be zero."

Extreme outliers:

releaseRate > 10,000 ‚Üí "Unrealistic input. Please check units (kg/hr).".

spaceVolume > 1,000,000 ‚Üí "Large volume entered. Ensure units are in cubic meters.".

Why Each Validation is Essential (Compliance View)

Positive values only ‚Üí required by OSHA/ISO 45001 for meaningful exposure analysis.

Unit consistency & range checks ‚Üí ensures audit-ready reports and prevents input errors (e.g., g/hr vs kg/hr).

Extreme value warnings ‚Üí aligns with NFPA catastrophic event modeling (avoids false reassurance).

Threshold-based outputs ‚Üí maps to fire/explosion hazard categories used in risk assessments.

Cross-field validation ‚Üí ensures logical consistency (e.g., no infinite burn rate from zero volume). -->