{% extends 'base.html' %}
{% block title %}FM-200 / NOVEC 1230 - Net Hazard Volume Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accident Rate Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
           @media (max-width: 768px) {
    .rate-value {
        font-size: 28px; /* smaller font for tablets/mobiles */
    }
}

@media (max-width: 480px) {
    .rate-value {
        font-size: 24px; /* even smaller for phones */
    }
}
    </style>
</head>
<body>
   <div class="btn-container">
    <a href="{% url 'firecategory_calculators' %}" class="back-btn">Back To Fire Calculators</a>
</div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <div class="calculator-header">
        <h1>FM-200 / NOVEC 1230 - Net Hazard Volume Calculator</h1>
        <p>Calculate the internal air volume of a protected space to determine the required quantity of fire suppression agents.</p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Room Dimensions</h2>
            <div class="form-group">
                <label for="length">Room Length (m)</label>
                <input type="number" id="length" class="form-input" placeholder="Enter room length">
            </div>
            <div class="form-group">
                <label for="width">Room Width (m)</label>
                <input type="number" id="width" class="form-input" placeholder="Enter room width">
            </div>
            <div class="form-group">
                <label for="height">Room Height (m)</label>
                <input type="number" id="height" class="form-input" placeholder="Enter room height">
            </div>
            <button class="calculate-btn" onclick="calculateNetHazardVolume()">Calculate Net Hazard Volume</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <!-- Placeholder -->
            <div class="result-placeholder" id="placeholder">
                <img src="{% static 'images/fm200.png' %}" alt="Net Hazard Volume Illustration">
                <p>This tool will calculate the <strong>Net Hazard Volume</strong>. Enter room dimensions to see results and insights here.</p>
            </div>

            <!-- Error -->
            <div class="result-error hidden" id="resultError" style="font-size: 28px;"></div>

            <!-- Result -->
            <div class="result-value hidden" id="resultValue">
                <div class="rate-value">Net Hazard Volume</div>
                <div class="rate-value" id="nhvValue">0.00</div>
                <div class="rate-label" style="font-size:16px; font-weight:bold;">m¬≥</div>
                <div class="result-feedback" id="feedbackContent"></div>
                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notes Section -->
    <div class="note-section">
        <div class="note-card">
            <h3>üìò About This Calculator</h3>
            <p>
                This calculator helps determine the <strong>Net Hazard Volume (NHV)</strong>,
                representing the total internal air volume of a protected space. This is crucial for sizing FM-200 or NOVEC 1230 fire suppression systems.
            </p>
        </div>

        <div class="note-card">
            <h3>‚öôÔ∏è Parameters</h3>
            <ul class="note-list">
                <li><strong>Room Length (L):</strong> Distance from one end of the room to the other (meters).</li>
                <li><strong>Room Width (W):</strong> Distance across the room from side to side (meters).</li>
                <li><strong>Room Height (H):</strong> Vertical distance from floor to ceiling (meters).</li>
            </ul>
        </div>

        <div class="note-card">
    <h3>üí° What is Net Hazard Volume?</h3>
    <p>
        Net Hazard Volume (NHV) refers to the total air space inside a room or protected area that needs to be safeguarded by a fire suppression system. 
        It represents the entire internal volume of the room, taking into account its length, width, and height, and is measured in cubic meters (m¬≥). 
        Knowing the NHV is crucial because it determines how much fire suppression agent is required to effectively protect the space from fire hazards.
    </p>
</div>


        <div class="note-card">
            <h3>üî• Why is NHV Important?</h3>
            <ul class="note-list">
                <li><strong>Accurate Agent Calculation:</strong> Ensures correct fire suppression agent quantity.</li>
                <li><strong>System Efficiency:</strong> Optimizes nozzle and pipe sizing.</li>
                <li><strong>Regulatory Compliance:</strong> Supports NFPA 2001 fire safety standards.</li>
                <li><strong>Cost Optimization:</strong> Prevents overuse or underuse of agents.</li>
            </ul>
        </div>

        <div class="note-card">
    <h3>üõ°Ô∏è Input Validations</h3>
    <ul class="note-list">
        <li><strong>All fields are mandatory:</strong> Room Length, Width, and Height must be entered. Empty fields will trigger a warning.</li>
        <li><strong>Numeric values only:</strong> Enter positive numbers; non-numeric entries are not allowed.</li>
        <li><strong>Positive and realistic ranges:</strong>
            <ul>
                <li>Length: 0.5 m ‚Äì 100 m</li>
                <li>Width: 0.5 m ‚Äì 100 m</li>
                <li>Height: 2 m ‚Äì 20 m</li>
            </ul>
        </li>
        <li><strong>Logical consistency:</strong> Avoid unrealistic proportions, such as extremely tall rooms with tiny floor area. Length/Width ratio should not exceed 10, Height to Length/Width ratio should not exceed 3.</li>
        <li><strong>Suspicious or extreme values:</strong> Values resulting in NHV above 200,000 m¬≥ will trigger a warning to review inputs.</li>
        <li><strong>Edge cases:</strong> Zero or negative numbers are invalid; very small or excessively large dimensions generate caution messages.</li>
        <li><strong>Feedback on NHV:</strong> The calculator provides guidance based on calculated volume: 
            <ul>
                <li>Very small (<50 m¬≥): low agent requirement</li>
                <li>Normal (50‚Äì500 m¬≥): typical agent design</li>
                <li>Medium (500‚Äì5000 m¬≥): check system sizing</li>
                <li>Large (5000‚Äì200,000 m¬≥): verify design, may require multiple nozzles</li>
                <li>Unrealistic (>200,000 m¬≥): review inputs</li>
            </ul>
        </li>
        <li><strong>Compliance rationale:</strong> These validations ensure data integrity, regulatory compliance (NFPA 2001), and accurate system design for fire safety audits.</li>
    </ul>
</div>


        <div class="note-card">
            <p>
                Click <strong>"Calculate Net Hazard Volume"</strong> to determine the space volume for fire suppression system design. Understanding NHV ensures proper protection, regulatory compliance, and cost efficiency.
            </p>
        </div>
    </div>
</div>

<script>
function calculateNetHazardVolume() {
    const lengthInput = document.getElementById('length').value.trim();
    const widthInput = document.getElementById('width').value.trim();
    const heightInput = document.getElementById('height').value.trim();

    const resultValue = document.getElementById('resultValue');
    const placeholder = document.getElementById('placeholder');
    const feedbackContent = document.getElementById('feedbackContent');
    const resultError = document.getElementById('resultError');

    // Reset displays
    resultError.classList.add('hidden');
    resultValue.classList.add('hidden');
    placeholder.classList.add('hidden');
    resultError.innerHTML = "";
    feedbackContent.innerHTML = "";

    // Empty check
    if (!lengthInput || !widthInput || !heightInput) {
        resultError.innerHTML = "‚ö†Ô∏è Please fill in all required fields.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    const length = parseFloat(lengthInput);
    const width = parseFloat(widthInput);
    const height = parseFloat(heightInput);

    // Numeric check
    if (isNaN(length) || isNaN(width) || isNaN(height)) {
        resultError.innerHTML = "‚ùå Invalid entry. Please enter numeric values only.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

    // Positive and realistic limits
    if (length < 0.5 || length > 100) {
        resultError.innerHTML = "‚ö†Ô∏è Length should be between 0.5 m and 100 m.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    if (width < 0.5 || width > 100) {
        resultError.innerHTML = "‚ö†Ô∏è Width should be between 0.5 m and 100 m.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    if (height < 2 || height > 20) {
        resultError.innerHTML = "‚ö†Ô∏è Height should be between 2 m and 20 m.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    // Suspicious ratios
    if (length / width > 10 || width / length > 10) {
        resultError.innerHTML = "‚ö†Ô∏è Length and width ratio seems unrealistic.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    if (height / length > 3 || height / width > 3) {
        resultError.innerHTML = "‚ö†Ô∏è Height seems disproportionately large compared to floor dimensions.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    // Calculation
    const nhv = length * width * height;

    // Output threshold feedback
    let feedback = "";
    let color = "green";
    if (nhv < 50) {
        feedback = "‚úÖ Very small room, low agent requirement.";
    } else if (nhv <= 500) {
        feedback = "‚úÖ Normal room, typical agent design.";
    } else if (nhv <= 5000) {
        feedback = "‚ö†Ô∏è Medium volume; check system sizing.";
        color = "orange";
    } else if (nhv <= 200000) {
        feedback = "üö® Large space; verify design, may require multiple nozzles.";
        color = "red";
    } else {
        feedback = "üî¥ Unrealistic volume entered; review inputs.";
        color = "darkred";
    }

    document.getElementById('nhvValue').innerText = nhv.toFixed(2);
    resultValue.classList.remove('hidden');
    feedbackContent.innerHTML = feedback;
    feedbackContent.style.color = color;
}

function printReport() {
    window.print();
}

</script>


    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- 1. Analysis of Inputs, Outputs, and Formula

Inputs:

Room Length (m): Linear dimension along one axis.

Room Width (m): Linear dimension perpendicular to length.

Room Height (m): Vertical distance.

Output:

Net Hazard Volume (m¬≥): Represents the total air volume to be protected by the fire suppression system. This is critical for calculating agent quantity per NFPA 2001 standards.

Formula Used:

NHV = Length √ó Width √ó Height

From a QEHS perspective, this is correct for enclosed spaces, but inputs must reflect realistic dimensions and constraints used in fire system design.

2. Recommended Input Validation Rules
Parameter	Unit	Minimum	Maximum	Decimals	Notes / Logical Checks
Length	meters (m)	0.5	100	2	Avoids extremely small or unrealistically large rooms. Length must be positive and reasonable.
Width	meters (m)	0.5	100	2	Same rationale as length.
Height	meters (m)	2	20	2	Minimum height ensures human occupancy; maximum based on typical industrial/commercial ceilings.
NHV (calculated)	m¬≥	>1	200,000	2	Ensures calculation is within physically possible and design-relevant volumes.

Additional Logical Checks:

All inputs must be numeric.

No negative or zero values.

Inputs should be consistent: for example, a height of 15 m with a length of 1 m may indicate an error.

Extremely large NHV (>200,000 m¬≥) triggers a warning for potential unrealistic entry.

3. Edge Case Validations

Empty fields: Must trigger warning.

Zero or negative numbers: Invalid.

Non-numeric input: Invalid.

Extremely high values: Warn user (e.g., Length >100 m, Width >100 m, Height >20 m).

Division by zero: Not applicable here directly (multiplication), but zero inputs would yield zero volume ‚Äî should be invalid.

Suspicious ratios: For example, L/W > 10 or H/L > 3 could indicate a data entry error.

4. Output Validation / Feedback Logic
NHV (m¬≥)	Feedback / Interpretation	Color
<50	Very small room, low agent requirement.	green
50‚Äì500	Normal room, typical agent design.	green
500‚Äì5000	Medium volume; check system sizing.	orange
5000‚Äì200,000	Large space; verify design, may require multiple nozzles.	red
>200,000	Unrealistic; review input.	dark red

Why: Real audits and NFPA design calculations consider NHV to size agent cylinders, nozzle placement, and system efficiency. -->