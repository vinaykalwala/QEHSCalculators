{% extends 'base.html' %}
{% block title %}FM-200 / NOVEC 1230 - Net Hazard Volume Calculator{% endblock %}
{% block content %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accident Rate Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/print.css' %}">
    <style>
        /* Main container */
        .calculator-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            border-radius: 12px;
        }
        .btn-container {
            display: flex;
            justify-content: center; /* Horizontally center */
            margin: 30px 0;
        }

        .back-btn {
            background:linear-gradient(#1560bd,#000040); /* Dark navy background */
            color: #ffffff; /* White text */
            border: 2px solid #1560bd; /* Highlight border */
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            text-decoration: none; /* Remove underline for link */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #1560bd; /* Highlight on hover */
            color: #ffffff;
            border-color: #000040;
            transform: scale(1.05); /* Subtle hover effect */
        }

        /* Header */
        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .calculator-header h1 {
            color: #1560bd;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .calculator-header p {
            color: #7f8c8d;
            font-size: 18px;
            margin: 0 auto;
        }

        /* Layout */
        .calc-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: stretch;
        }
        
        @media (max-width: 900px) {
            .calc-content { 
                flex-direction: column; 
            }
        }

        /* Cards */
        .result-card {
            flex: 1;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            border: 2px solid #1560bd;
        }
        
        .calc-card {
            flex: 1;
            background: linear-gradient(135deg, #1560bd, #1560bd, #000040);
            color: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            height: 420px;
            overflow-y: auto;
        }
        
        .calc-card:hover { 
            transform: translateY(-5px); 
        }
        
        .calc-card h2 {
            color: #ffff;
            margin-bottom: 25px;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 10px;
            font-weight: 600;
        }

        /* Inputs */
        .form-group { 
            margin-bottom: 20px; 
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #fff;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #f9fbfd;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
        }

        /* Button */
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: #ffc107;
            color: #000;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-wrapper {
            text-align: center;
            margin-top: 20px;
        }

        .print-btn {
            display: inline-block;
            background: linear-gradient(#1560bd,#000040);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: auto !important;
        }

        .print-btn:hover {
            background: #1560bd;
        }

        /* Result Card */
        .result-card {
            justify-content: center;
            align-items: center;
            min-height: 420px;
            text-align: center;
        }
        
        .result-placeholder img {
            max-width: 240px;
            margin-bottom: 20px;
            opacity: 0.85;
        }
        
        .result-placeholder p {
            color: #7f8c8d;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .result-value { 
            width: 100%; 
        }
        
        .rate-value {
            font-size: 42px;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 10px;
        }
        
        .rate-label { 
            color: #7f8c8d; 
        }

        /* Feedback */
        .result-feedback {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #3498db;
            text-align: left;
            margin-top: 20px;
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feedback-content { 
            color: #34495e; 
        }

        .note-section {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0faff;
            padding: 15px;
            margin-top: 60px;
            border-radius: 12px;
        }

        .note-card {
            background: #ffffff;
            border-left: 6px solid #1976d2;
            padding: 18px 22px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .note-card:hover {
            transform: translateY(-2px);
        }
        
        .note-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #1976d2;
        }
        
        .note-card p, .note-card li {
            font-size: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        
        .note-list {
            margin: 0;
            padding-left: 18px;
        }
        
        .good { 
            color: #2e7d32; 
            font-weight: 600; 
        }
        
        .average { 
            color: #f9a825; 
            font-weight: 600; 
        }
        
        .bad { 
            color: #c62828; 
            font-weight: 600; 
        }

        .result-error {
            background: #ffe6e6;
            border: 2px solid #e74c3c;
            color: #c0392b;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            gap: 12px;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 76px;
            flex-shrink: 0;
            text-align: center;
        }
        
        .error-message {
            font-size: 24px;
            line-height: 1.6;
        }

        /* Toggle helper */
        .hidden { 
            display: none; 
        }
           @media (max-width: 768px) {
    .rate-value {
        font-size: 28px; /* smaller font for tablets/mobiles */
    }
}

@media (max-width: 480px) {
    .rate-value {
        font-size: 24px; /* even smaller for phones */
    }
}
    </style>
</head>
<body>
   <div class="btn-container">
    <a href="{% url 'firecategory_calculators' %}" class="back-btn">Back To Fire Calculators</a>
</div>

<div class="calculator-container printable" id="printArea">
    {% include "includes/print_header_footer.html" %}

    <div class="calculator-header">
        <h1>FM-200 / NOVEC 1230 - Net Hazard Volume Calculator</h1>
        <p>Calculate the internal air volume of a protected space to determine the required quantity of fire suppression agents.</p>
    </div>

    <div class="calc-content">
        <!-- Input Card -->
        <div class="calc-card">
            <h2>Enter Room Dimensions</h2>
            <div class="form-group">
                <label for="length">Room Length (m)</label>
                <input type="number" id="length" class="form-input" placeholder="Enter room length">
            </div>
            <div class="form-group">
                <label for="width">Room Width (m)</label>
                <input type="number" id="width" class="form-input" placeholder="Enter room width">
            </div>
            <div class="form-group">
                <label for="height">Room Height (m)</label>
                <input type="number" id="height" class="form-input" placeholder="Enter room height">
            </div>
            <button class="calculate-btn" onclick="calculateNetHazardVolume()">Calculate Net Hazard Volume</button>
        </div>

        <!-- Result Card -->
        <div class="result-card">
            <!-- Placeholder -->
            <div class="result-placeholder" id="placeholder">
                <img src="{% static 'images/fm200.png' %}" alt="Net Hazard Volume Illustration">
                <p>This tool will calculate the <strong>Net Hazard Volume</strong>. Enter room dimensions to see results and insights here.</p>
            </div>

            <!-- Error -->
            <div class="result-error hidden" id="resultError" style="font-size: 28px;"></div>

            <!-- Result -->
            <div class="result-value hidden" id="resultValue">
                <div class="rate-value">Net Hazard Volume</div>
                <div class="rate-value" id="nhvValue">0.00</div>
                <div class="rate-label" style="font-size:16px; font-weight:bold;">m³</div>
                <div class="result-feedback" id="feedbackContent"></div>
                <div class="btn-wrapper">
                    <button class="calculate-btn print-btn" onclick="printReport()">Print Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notes Section -->
<div class="note-section">

  <!-- 1️⃣ About -->
  <div class="note-card">
      <h3>📘 About This Calculator</h3>
      <p>
          The <strong>Net Hazard Volume (NHV) Calculator</strong> determines the internal air volume of a protected space, 
          which is critical for sizing gaseous fire suppression systems such as <strong>FM-200</strong> or <strong>NOVEC 1230</strong>. 
          By knowing NHV, engineers can estimate the required suppression agent quantity, ensure system efficiency, and achieve compliance with international fire safety standards.
      </p>
  </div>

  <!-- 2️⃣ Parameters -->
  <div class="note-card">
      <h3>⚙️ Parameters Used</h3>
      <ul class="note-list">
          <li><strong>Room Length (L):</strong> Linear dimension of the room (0.5 – 100 m).</li>
          <li><strong>Room Width (W):</strong> Perpendicular linear dimension (0.5 – 100 m).</li>
          <li><strong>Room Height (H):</strong> Vertical dimension from floor to ceiling (2 – 20 m).</li>
      </ul>
  </div>

  <!-- 3️⃣ Input Validation -->
  <div class="note-card">
      <h3>✅ Input Validation Rules</h3>
      <ul class="note-list">
          <li><strong>Mandatory Fields:</strong> Length, Width, and Height must all be provided.</li>
          <li><strong>Numeric Values Only:</strong> Inputs must be positive numbers, no text/symbols.</li>
          <li><strong>Allowed Ranges:</strong>
              <ul>
                  <li>Length: 0.5 – 100 m</li>
                  <li>Width: 0.5 – 100 m</li>
                  <li>Height: 2 – 20 m</li>
              </ul>
          </li>
          <li><strong>Suspicious Ratios:</strong> 
              <ul>
                  <li>Length/Width ≤ 10</li>
                  <li>Height/Length ≤ 3, Height/Width ≤ 3</li>
              </ul>
          </li>
          <li><strong>NHV Maximum:</strong> Values above 200,000 m³ trigger a warning for unrealistic input.</li>
          <li><strong>Edge Cases:</strong> Zero, negative, or extremely high values are invalid or flagged.</li>
          <li><strong>Compliance Rationale:</strong> Ensures realistic data entry, aligns with <strong>NFPA 2001</strong> requirements, and supports fire safety audit integrity.</li>
      </ul>
  </div>

  <!-- 4️⃣ Output Validation -->
  <div class="note-card">
      <h3>📊 Output Validations</h3>
      <ul class="note-list">
          <li><strong>Validation Ranges:</strong> NHV must be between 1 m³ and 200,000 m³.</li>
          <li><strong>Feedback Categories (same as result screen):</strong>
              <ul>
                  <li>✅ <strong>Very Small (&lt;50 m³):</strong> Low agent requirement.</li>
                  <li>✅ <strong>Normal (50–500 m³):</strong> Typical agent design volume.</li>
                  <li>⚠️ <strong>Medium (500–5000 m³):</strong> Check system sizing.</li>
                  <li>🚨 <strong>Large (5000–200,000 m³):</strong> Verify design, may require multiple nozzles.</li>
                  <li>🔴 <strong>Unrealistic (&gt;200,000 m³):</strong> Review inputs.</li>
              </ul>
          </li>
      </ul>
  </div>

  <!-- 5️⃣ Governing Principle -->
<div class="note-card">
    <h3>📐 Governing Principle</h3>
    <p>
        The calculation of the net hazard volume (NHV) for FM-200 and Novec (1230) fire suppression systems is based on the 
        <strong>NFPA 2001: Standard on Clean Agent Fire Extinguishing Systems</strong>. This standard provides the guidelines 
        and formulas for determining the required quantity of clean agents, including the calculation of the protected volume.
    </p>

    <h5>📘 Standard for Net Hazard Volume Calculation</h5>
    <p>
        NHV is the basis for determining extinguishing agent quantity in gaseous suppression systems. This methodology is 
        universally applied in fire safety engineering, but the actual design rules are anchored to NFPA 2001 and equivalent 
        international codes.
    </p>
</div>


  <!-- 6️⃣ Conclusion -->
  <div class="note-card">
      <h3>🔎 Conclusion</h3>
      <p>
          The NHV calculator ensures accurate fire suppression system design by calculating the protected volume 
          and mapping it to agent requirements. This reduces fire risk, ensures compliance with NFPA 2001, 
          and helps balance safety with cost efficiency. Always confirm final design with certified fire protection engineers and local authorities.
      </p>
  </div>

</div>


<script>
function calculateNetHazardVolume() {
    const lengthInput = document.getElementById('length').value.trim();
    const widthInput = document.getElementById('width').value.trim();
    const heightInput = document.getElementById('height').value.trim();

    const resultValue = document.getElementById('resultValue');
    const placeholder = document.getElementById('placeholder');
    const feedbackContent = document.getElementById('feedbackContent');
    const resultError = document.getElementById('resultError');

    // Reset displays
    resultError.classList.add('hidden');
    resultValue.classList.add('hidden');
    placeholder.classList.add('hidden');
    resultError.innerHTML = "";
    feedbackContent.innerHTML = "";

    // Empty check
    if (!lengthInput || !widthInput || !heightInput) {
        resultError.innerHTML = "⚠️ Please fill in all required fields.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    const length = parseFloat(lengthInput);
    const width = parseFloat(widthInput);
    const height = parseFloat(heightInput);

    // Numeric check
    if (isNaN(length) || isNaN(width) || isNaN(height)) {
        resultError.innerHTML = "❌ Invalid entry. Please enter numeric values only.";
        resultError.style.color = "red";
        resultError.classList.remove('hidden');
        return;
    }

    // Positive and realistic limits
    if (length < 0.5 || length > 100) {
        resultError.innerHTML = "⚠️ Length should be between 0.5 m and 100 m.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    if (width < 0.5 || width > 100) {
        resultError.innerHTML = "⚠️ Width should be between 0.5 m and 100 m.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    if (height < 2 || height > 20) {
        resultError.innerHTML = "⚠️ Height should be between 2 m and 20 m.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    // Suspicious ratios
    if (length / width > 10 || width / length > 10) {
        resultError.innerHTML = "⚠️ Length and width ratio seems unrealistic.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    if (height / length > 3 || height / width > 3) {
        resultError.innerHTML = "⚠️ Height seems disproportionately large compared to floor dimensions.";
        resultError.style.color = "orange";
        resultError.classList.remove('hidden');
        return;
    }

    // Calculation
    const nhv = length * width * height;

    // Output threshold feedback
    let feedback = "";
    let color = "green";
    if (nhv < 50) {
        feedback = "✅ Very small room, low agent requirement.";
    } else if (nhv <= 500) {
        feedback = "✅ Normal room, typical agent design.";
    } else if (nhv <= 5000) {
        feedback = "⚠️ Medium volume; check system sizing.";
        color = "orange";
    } else if (nhv <= 200000) {
        feedback = "🚨 Large space; verify design, may require multiple nozzles.";
        color = "red";
    } else {
        feedback = "🔴 Unrealistic volume entered; review inputs.";
        color = "darkred";
    }

    document.getElementById('nhvValue').innerText = nhv.toFixed(2);
    resultValue.classList.remove('hidden');
    feedbackContent.innerHTML = feedback;
    feedbackContent.style.color = color;
}

function printReport() {
    window.print();
}

</script>


    <script src="{% static 'js/print.js' %}"></script>
</body>
</html>
{% endblock %}


<!-- 1. Analysis of Inputs, Outputs, and Formula

Inputs:

Room Length (m): Linear dimension along one axis.

Room Width (m): Linear dimension perpendicular to length.

Room Height (m): Vertical distance.

Output:

Net Hazard Volume (m³): Represents the total air volume to be protected by the fire suppression system. This is critical for calculating agent quantity per NFPA 2001 standards.

Formula Used:

NHV = Length × Width × Height

From a QEHS perspective, this is correct for enclosed spaces, but inputs must reflect realistic dimensions and constraints used in fire system design.

2. Recommended Input Validation Rules
Parameter	Unit	Minimum	Maximum	Decimals	Notes / Logical Checks
Length	meters (m)	0.5	100	2	Avoids extremely small or unrealistically large rooms. Length must be positive and reasonable.
Width	meters (m)	0.5	100	2	Same rationale as length.
Height	meters (m)	2	20	2	Minimum height ensures human occupancy; maximum based on typical industrial/commercial ceilings.
NHV (calculated)	m³	>1	200,000	2	Ensures calculation is within physically possible and design-relevant volumes.

Additional Logical Checks:

All inputs must be numeric.

No negative or zero values.

Inputs should be consistent: for example, a height of 15 m with a length of 1 m may indicate an error.

Extremely large NHV (>200,000 m³) triggers a warning for potential unrealistic entry.

3. Edge Case Validations

Empty fields: Must trigger warning.

Zero or negative numbers: Invalid.

Non-numeric input: Invalid.

Extremely high values: Warn user (e.g., Length >100 m, Width >100 m, Height >20 m).

Division by zero: Not applicable here directly (multiplication), but zero inputs would yield zero volume — should be invalid.

Suspicious ratios: For example, L/W > 10 or H/L > 3 could indicate a data entry error.

4. Output Validation / Feedback Logic
NHV (m³)	Feedback / Interpretation	Color
<50	Very small room, low agent requirement.	green
50–500	Normal room, typical agent design.	green
500–5000	Medium volume; check system sizing.	orange
5000–200,000	Large space; verify design, may require multiple nozzles.	red
>200,000	Unrealistic; review input.	dark red

Why: Real audits and NFPA design calculations consider NHV to size agent cylinders, nozzle placement, and system efficiency. -->