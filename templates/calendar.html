{% extends 'base.html' %}
{% block title %}Calendar{% endblock %}
{% block content %}
{% load static %}

<style>
/* ----------------- Page Hero ----------------- */
.hero {
    width: 100%;
    padding: 40px 20px;
    background: linear-gradient(135deg, #000040, #1560bd);
    text-align: center;
    margin-bottom: 30px;
    color: white;
}

.hero h1 {
    font-size: 2.5rem;
    font-weight: bold;
    margin-bottom: 10px;
    letter-spacing: 2px;
}

.hero p {
    font-size: 1.2rem;
    opacity: 0.9;
}

/* ----------------- Year Selector ----------------- */
.year-selector {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 30px;
    gap: 12px;
    flex-wrap: wrap;
}

.year-selector label {
    font-weight: 600;
    font-size: 1rem;
    color: #012d64;
}

.year-selector select {
    padding: 8px 16px;
    border-radius: 6px;
    border: 1px solid #1560bd;
    font-size: 1rem;
    outline: none;
    cursor: pointer;
    background: white;
    min-width: 140px;
    transition: all 0.3s ease;
}

.year-selector select:hover,
.year-selector select:focus {
    border-color: #000040;
    box-shadow: 0 0 8px rgba(21,96,189,0.5);
}

/* ----------------- Calendar Grid ----------------- */
.months {
    display: grid;
    grid-template-columns: repeat(4, 1fr); 
    gap: 20px;
    justify-items: center;
    margin-bottom: 40px;
    padding: 0 20px;
}

@media (max-width: 1500px) {
    .months { grid-template-columns: repeat(4,1fr); }
}
@media (max-width: 1200px) {
    .months { grid-template-columns: repeat(3,1fr); }
}
@media (max-width: 992px) {
    .months { grid-template-columns: repeat(2,1fr); }
}
@media (max-width: 600px) {
    .months { grid-template-columns: repeat(1,1fr); }
}

.month-card {
    width: 100%;
    background: linear-gradient(45deg, #1560bd, #000040);
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    overflow: hidden;
    color: white;
}

.month-card h3 {
    text-align: center;
    font-size: 1rem;
    padding: 12px 0;
    background: rgba(0,0,0,0.2);
    margin: 0;
}

.month-card img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    display: block;
}

.calendar-table {
    width: 100%;
    border-collapse: collapse;
    background-color: white;
    color: black;
    margin-top: 10px;
}

.calendar-table th, .calendar-table td {
    padding: 6px;
    text-align: center;
    border: 1px solid #ccc;
    font-size: 0.9rem;
}

.calendar-table th {
    background-color: #a6d7fa;
}

/* ----------------- Safety Dates ----------------- */
.safety-dates {
    background: linear-gradient(135deg, #1560bd, #000040);
    padding: 20px;
    border-radius: 10px;
    max-width: 1200px;
    margin: 40px auto;
    color: white;
    text-align: center;
}

.safety-dates h3 {
    margin-bottom: 20px;
    font-size: 1.4rem;
}

.safety-dates li {
    background: rgba(255,255,255,0.2);
    padding: 10px;
    border-radius: 6px;
    font-size: 1rem;
}

.safety-dates ul {
    display: grid;
    gap: 10px;
    list-style: none;
    padding: 0;
    grid-template-columns: repeat(3, 1fr);
}

@media (min-width: 1500px) {
    .safety-dates ul {
        grid-template-columns: repeat(4, 1fr);
    }
}
@media (max-width: 992px) {
    .safety-dates ul {
        grid-template-columns: repeat(2, 1fr);
    }
}
@media (max-width: 600px) {
    .safety-dates ul {
        grid-template-columns: repeat(1, 1fr);
    }
}

/* ----------------- Tooltip ----------------- */
td[data-event] {
    position: relative;
    overflow: visible;
    background: #ffcccb;
    font-weight: bold;
}

td[data-event]::after {
    content: attr(data-event);
    position: absolute;
    bottom: 100%; 
    left: 1%;
    transform: translateX(-50%) translateY(-5px);
    background: #000040;
    color: white;
    padding: 4px 8px;
    font-size: 12px;
    border-radius: 4px;
    white-space: normal;
    max-width: 180px;
    text-align: center;
    z-index: 1200;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s ease, transform 0.2s ease;
}

td[data-event]:hover::after {
    opacity: 1;
    transform: translateX(-50%) translateY(-10px);
}

/* Adjust tooltip at screen edges */
td[data-event].tooltip-left::after {
    left: 0;
    transform: translateX(0) translateY(-10px);
}
td[data-event].tooltip-right::after {
    left: 100%;
    transform: translateX(-100%) translateY(-10px);
}
.heading-container {
  text-align: center;
  margin: 30px 0;
}

.heading {
  font-family: 'Arial', sans-serif;
  font-size: 36px;
  font-weight: bold;
  color: #2D2D2D;
  background: linear-gradient(90deg, #1560bd, #012d64);
  -webkit-background-clip: text;
  color: transparent;
  letter-spacing: 2px;
 
  text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
  animation: textEffect 2s ease-in-out infinite;
}

@keyframes textEffect {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.1);
  }
  100% {
    transform: scale(1);
  }
}

.gallery-container {
    position: relative;
    width: 100%;
    overflow-x: hidden;
    overflow-y: hidden; /* prevent vertical scroll */
}

.gallery {
    display: flex;
    gap: 10px;
    scroll-behavior: smooth;
    overflow-x: auto;
    overflow-y: hidden; /* prevent vertical scroll */
    -ms-overflow-style: none;
    scrollbar-width: none;
}

.gallery img {
    flex-shrink: 0; /* prevent images from shrinking */
    width: 800px;
    height: auto;
    border-radius: 8px;
    object-fit: cover;
}


.gallery::-webkit-scrollbar {
    display: none; /* Hides scrollbar in Chrome/Safari */
}


/* Scroll buttons */
.scroll-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background-color: rgba(2, 7, 90, 0.5);
    color: white;
    border: none;
    padding: 10px 15px;
    cursor: pointer;
    font-size: 24px;
    border-radius: 50%;
    transition: 0.3s ease-in-out;
}

.scroll-btn:hover {
    background-color: rgba(0, 0, 0, 0.8);
}

/* Position buttons */
.left {
    left: 10px;
}

.right {
    right: 10px;
}

@media (max-width: 768px) {
    .heading-container {
  text-align: center;
  margin: 30px 30px;
}
}
</style>

<!-- ---------------- Page Hero ---------------- -->
<div class="hero">
    <h1>MLC QEHS Century Calendar</h1>
    <p>View all monthly schedules, important QEHS dates, and special events</p>
</div>

<!-- ---------------- Year Selector ---------------- -->
<div class="year-selector">
    <label for="year">Select Year:</label>
    <select id="year" onchange="generateCalendar()"></select>
</div>

<!-- ---------------- Calendar Months ---------------- -->
<div class="months" id="calendar"></div>

<!-- ---------------- Safety Dates ---------------- -->
<div class="safety-dates">
    <h3>Important QEHS Dates</h3>
    <ul id="safety-list"></ul>
</div>
<div class="heading-container">
    <h1 class="heading">Check Out the 2024 Calender Special</h1>
  </div>
  
  <div class="gallery-container">
    <button class="scroll-btn left" onclick="scrollGallery(-1)">&#10094;</button>
    <div class="gallery">
        <img src="{% static 'images/jan.png' %}" alt="January">
<img src="{% static 'images/feb.png' %}" alt="February">
<img src="{% static 'images/march.png' %}" alt="March">
<img src="{% static 'images/april.png' %}" alt="April">
<img src="{% static 'images/may.png' %}" alt="May">
<img src="{% static 'images/june.png' %}" alt="June">
<img src="{% static 'images/july.png' %}" alt="July">
<img src="{% static 'images/aug.png' %}" alt="August">
<img src="{% static 'images/september.png' %}" alt="September">
<img src="{% static 'images/oct.png' %}" alt="October">
<img src="{% static 'images/nov.png' %}" alt="November">
<img src="{% static 'images/dec.png' %}" alt="December">

    </div>
    <button class="scroll-btn right" onclick="scrollGallery(1)">&#10095;</button>
</div>
<br>
  <script>
    function scrollGallery(direction) {
    const gallery = document.querySelector(".gallery");
    const scrollAmount = 800; // Adjust based on image width
    gallery.scrollBy({ left: direction * scrollAmount, behavior: "smooth" });
}

  </script>
<script>
// ---------------- Safety Events ----------------
const safetyEvents = {
    "01-24": "International Day of Education",
    "01-26": "International Customs Day-Republic Day",
    "01-11": "Road safety week Start",
    "01-17": "Road safety week End",
    "01-30": "World Neglected Tropical Diseases Day",
    "01-30": "World Leprosy Day",
    "02-02": "World Wetlands Day",
    "02-04": "World Cancer Day",
    "03-03": "World Wildlife Day",
    "03-04": "National Safety Day (India)",
    "03-08": "International Women’s Day",
    "03-22": "World Water day",
    "04-07": "World Health Day",
    "04-22": "Earth Day",
    "04-14": "Fire Service Day",
    "05-01": "International Workers’ Day (Labour Day)",
    "05-22": "International Day for Biological Diversity",
    "05-31": "Anti-Tobacco Day",
    "06-05": "World Environment Day",
    "06-08": "World Oceans Day",
    "08-15": "Independence Day",
    "09-16": "International Day for the Preservation of the Ozone Layer",
    "10-02": "Gandhi Jayanti",
    "10-06": "World WildLife Day",
    "10-10": "World Mental Health Day",
    "10-13": "International Day for Disaster Risk Reduction",
    "10-16": "World Food Day",
    "11-01": "Kannada Rajyotsava",
    "12-02": "National Pollution Control Day",
    "12-05": "World Soil Day",
    "12-11": "International Mountain Day"
};

const qehsThemes = [
    "MLC ISO Certifications","Mlc QEHS Documentation","MLC Internal Audits","MLC Employment Services",
    "MLC Fire Consultancy Services","MLC PPE Services","MLC QEHS Trainings","MLC Safety Studies",
    "MLC ESG Services","MLC Incident Investigations","MLC Power System Studies","MLC Statutory Compliance"
];

// ---------------- Generate Calendar ----------------
function generateCalendar() {
    const year = document.getElementById("year").value;
    const calendarDiv = document.getElementById("calendar");
    const safetyList = document.getElementById("safety-list");
    calendarDiv.innerHTML = "";
    safetyList.innerHTML = "";

    const months = ["January","February","March","April","May","June","July","August","September","October","November","December"];
    
    months.forEach((month,index) => {
        const card = document.createElement("div");
        card.className = "month-card";
        card.innerHTML = `
            <h3>${month} - ${qehsThemes[index]}</h3>
            <img src="{% static 'images/' %}${month}.jpg" alt="${month}">
            ${generateMonthTable(year,index)}
        `;
        calendarDiv.appendChild(card);
    });

    for (let date in safetyEvents) {
        let fullDate = `${year}-${date}`;
        let li = document.createElement("li");
        li.textContent = `${fullDate}: ${safetyEvents[date]}`;
        safetyList.appendChild(li);
    }

    // adjust tooltips for edges
    document.querySelectorAll("td[data-event]").forEach(td=>{
        td.addEventListener("mouseenter",()=>adjustTooltip(td));
    });
}

// ---------------- Generate Month Table ----------------
function generateMonthTable(year,monthIndex){
    let date = new Date(year, monthIndex,1);
    let table = `<table class="calendar-table"><tr><th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th></tr><tr>`;

    for (let i=0;i<date.getDay();i++) table+="<td></td>";

    while(date.getMonth()===monthIndex){
        let day=date.getDate();
        let key=`${String(monthIndex+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
        let highlight=safetyEvents[key]?"background-color:#ffcccb;font-weight:bold;":""; 
        let sundayHighlight=date.getDay()===0?"background-color:#a6d7fa;":""; 
        let tooltip=safetyEvents[key]?`data-event="${safetyEvents[key]}"`:"";

        table+=`<td style="${highlight} ${sundayHighlight}" ${tooltip}>${day}</td>`;
        if(date.getDay()===6) table+="</tr><tr>";
        date.setDate(day+1);
    }
    table+="</tr></table>";
    return table;
}

// ---------------- Populate Years ----------------
function populateYearOptions(){
    const select = document.getElementById("year");
    const currentYear = new Date().getFullYear();
    for(let i=currentYear-100; i<=currentYear+50; i++){
        let option = document.createElement("option");
        option.value = i;
        option.textContent = i;
        if(i === currentYear) option.selected = true;
        select.appendChild(option);
    }
    generateCalendar();
}
populateYearOptions();

// ---------------- Tooltip Edge Adjustment ----------------
function adjustTooltip(td){
    const tooltipWidth = 180; // must match CSS max-width
    const rect = td.getBoundingClientRect();
    td.classList.remove("tooltip-left","tooltip-right");

    if(rect.left + rect.width/2 + tooltipWidth/2 > window.innerWidth){
        td.classList.add("tooltip-right");
    } else if(rect.left - tooltipWidth/2 < 0){
        td.classList.add("tooltip-left");
    }
}

</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
